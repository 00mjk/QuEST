<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Distributed QuEST: qubits.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>qubits.c File Reference</h1>
<p>The core of the QuEST Library.  
<a href="#_details">More...</a></p>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;assert.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="precision_8h_source.html">precision.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="qubits_8h_source.html">qubits.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="qubits__internal_8h_source.html">qubits_internal.h</a>&quot;</code><br/>
<code>#include &lt;omp.h&gt;</code><br/>

<p><a href="qubits_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>&nbsp;&nbsp;&nbsp;0</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (const int locationOfBitFromRight, const long long int theEncodedNumber)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the value of the bit at a particular index in a number.  <a href="#a100463f6ec212c76a5fad99579000505"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a9c02591bc64c2918503afa231d90d83f">createMultiQubit</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> *multiQubit, int numQubits, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a <a class="el" href="structMultiQubit.html" title="Represents a system of qubits.">MultiQubit</a> object representing a set of qubits.  <a href="#a9c02591bc64c2918503afa231d90d83f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#ae5d6acc322314d7a3d8a2eccf00d3b19">destroyMultiQubit</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deallocate a <a class="el" href="structMultiQubit.html" title="Represents a system of qubits.">MultiQubit</a> object representing a set of qubits Free memory allocated to state vector of probability amplitudes, including temporary vector for values copied from another chunk if running the distributed version.  <a href="#ae5d6acc322314d7a3d8a2eccf00d3b19"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a96f4de9ce7fefc7680a44d601fc3d894">reportState</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print the current state vector of probability amplitudes for a set of qubits to file.  <a href="#a96f4de9ce7fefc7680a44d601fc3d894"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a842d6884e063a5865a2232cba56b65ac">reportStateToScreen</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>, int reportRank)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print the current state vector of probability amplitudes for a set of qubits to standard out.  <a href="#a842d6884e063a5865a2232cba56b65ac"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#aa5e77e0e64f3a4a3d3f5cc7382bffcd9">reportMultiQubitParams</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Report metainformation about a set of qubits: number of qubits, number of probability amplitudes.  <a href="#aa5e77e0e64f3a4a3d3f5cc7382bffcd9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a8f10aabf9f607f19093aee54630caa21">getEnvironmentString</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>, <a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, char str[200])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#acb5b2eff794339090004d29f02a70d9a">initStateZero</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> *multiQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialise the state vector of probability amplitudes for a set of qubits to the zero state: |000...00&gt;.  <a href="#acb5b2eff794339090004d29f02a70d9a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a43bcb279fc9717fbd06a19cdef48b9d8">initStatePlus</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> *multiQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialise the state vector of probability amplitudes for a set of qubits to an equal real superposition of all amplitudes: |+++.  <a href="#a43bcb279fc9717fbd06a19cdef48b9d8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a7169fd0442cbc3418f3fac4d13363ca2">initStateOfSingleQubit</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> *multiQubit, int qubitId, int outcome)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialise the state vector of probability amplitudes such that one qubit is set to 'outcome' and all other qubits are in an equal superposition of zero and one.  <a href="#a7169fd0442cbc3418f3fac4d13363ca2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a03b3577a891731d505bc4b879fcca9d3">initStateDebug</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> *multiQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialise the state vector of probability amplitudes to an (unphysical) state with each component of each probability amplitude a unique floating point value.  <a href="#a03b3577a891731d505bc4b879fcca9d3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a433876ee9f3bcc54af346300f571fc3c">initializeStateFromSingleFile</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> *multiQubit, char filename[200], <a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a793584932ae384c82e7e42db7d35d18d">compareStates</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> mq1, <a class="el" href="structMultiQubit.html">MultiQubit</a> mq2, REAL precision)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#ae4fea133d1a8f09ff8da03038100adb2">validateMatrixIsUnitary</a> (<a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#ae2b2c14a07dd7d50ff86032a3ca101d7">validateAlphaBeta</a> (<a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a71c14976f63cfcda70026fa20ee531fe">validateUnitVector</a> (REAL ux, REAL uy, REAL uz)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a7fadb225fc385db789e844c87fcba9e1">rotateAroundAxis</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, REAL angle, <a class="el" href="structVector.html">Vector</a> unitAxis)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit a certain angle about an axis.  <a href="#a7fadb225fc385db789e844c87fcba9e1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a6cc7fa705a2f2e6b486b49c5589d5df5">rotateX</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, REAL angle)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit a certain angle about the x-axis.  <a href="#a6cc7fa705a2f2e6b486b49c5589d5df5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#ace0d3592d38a990e81a434c4e9681500">rotateY</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, REAL angle)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit a certain angle about the y-axis.  <a href="#ace0d3592d38a990e81a434c4e9681500"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#abd621412ad30c1b034f4ce153c4afe10">rotateZ</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, REAL angle)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit a certain angle about the z-axis.  <a href="#abd621412ad30c1b034f4ce153c4afe10"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a9cee2d8716667a3318420a3b672f5b92">compactUnitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes.  <a href="#a9cee2d8716667a3318420a3b672f5b92"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#ac134fb45b0a7248c5d15e16eb7139a35">unitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a20ee1878a63ae6112e8845f4a8787592">compactUnitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta, and a subset of the state vector with upper and lower block values stored seperately.  <a href="#a20ee1878a63ae6112e8845f4a8787592"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a2343b7240118e89aa615e2c9140b770b">unitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a unitary operation to a single qubit given a subset of the state vector with upper and lower block values stored seperately.  <a href="#a2343b7240118e89aa615e2c9140b770b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#afc77657651d52c47403b44b923a098a8">controlledCompactUnitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a control qubit.  <a href="#afc77657651d52c47403b44b923a098a8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a1309eabcba3cb97fbc3cd2e606d17766">multiControlledUnitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, long long int mask, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a control qubit.  <a href="#a1309eabcba3cb97fbc3cd2e606d17766"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a8a4afcff70195a306c082b8ed8d4e09a">controlledUnitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a control qubit.  <a href="#a8a4afcff70195a306c082b8ed8d4e09a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a717855e835e3161e08c18cdc15325d27">controlledCompactUnitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately.  <a href="#a717855e835e3161e08c18cdc15325d27"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a642093063a1f889f61a1311f6d6f2d3f">controlledUnitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately.  <a href="#a642093063a1f889f61a1311f6d6f2d3f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a9dbf856ebeea0cf0a3ee5aae6782f2d2">multiControlledUnitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, long long int mask, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a unitary operation to a single qubit in the state vector of probability amplitudes, given a subset of the state vector with upper and lower block values stored seperately.  <a href="#a9dbf856ebeea0cf0a3ee5aae6782f2d2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a74822fd86bb5d81766e6e8dbdcd62df1">sigmaXLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{0,1},{1,0}.  <a href="#a74822fd86bb5d81766e6e8dbdcd62df1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a2275fff50824fe47485890ff5a857785">sigmaXDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecIn, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{0,1},{1,0}.  <a href="#a2275fff50824fe47485890ff5a857785"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#ad357a43e80e3baf013975b1b70942f4c">controlledNotLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{0,1},{1,0} for elements where controlQubit is one.  <a href="#ad357a43e80e3baf013975b1b70942f4c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a05875a70b539a3efb28d027823403f34">controlledNotDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecIn, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{0,1},{1,0}.  <a href="#a05875a70b539a3efb28d027823403f34"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a81fbfaed65a742a7dfd622e17652245e">sigmaYLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{0,-i},{i,0}.  <a href="#a81fbfaed65a742a7dfd622e17652245e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#af5ef5166f00c0572354b4ac53dcf40cf">sigmaYDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecIn, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut, int updateUpper)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{0,-i},{i,0}.  <a href="#af5ef5166f00c0572354b4ac53dcf40cf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#aa9f0718b4dd794a3e1b143e3b153bfc5">hadamardLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{1,1},{1,-1}}/sqrt2.  <a href="#aa9f0718b4dd794a3e1b143e3b153bfc5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#ae6a897066979fc52d977007d959ca09d">hadamardDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut, int updateUpper)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{1,1},{1,-1}}/sqrt2.  <a href="#ae6a897066979fc52d977007d959ca09d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a3a54566b73ac84c312d7da4f56ffbc3b">phaseGateLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, enum <a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a> type)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{1,0},{0,p}} where p is a phase term determined by the type argument.  <a href="#a3a54566b73ac84c312d7da4f56ffbc3b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#af832ed00b02a0597b7fe0b714032c54a">phaseGateDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, enum <a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a> type)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{1,0},{0,p}} where p is a phase term determined by the type argument.  <a href="#af832ed00b02a0597b7fe0b714032c54a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#aebaab86326779de55d335cfea3efde8f">sigmaZ</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{1,0},{{0,-1}} -- apply a phase of -1 to |1&gt;.  <a href="#aebaab86326779de55d335cfea3efde8f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#adda6c47876a7676488ed0565a19eaa65">sGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#af764ea63a2e870098f4e1ce08562942e">tGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a7c02cd0e1b4eac19771a0525f023249e">findProbabilityOfZeroLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Measure the total probability of a specified qubit being in the zero state across all amplitudes in this chunk.  <a href="#a7c02cd0e1b4eac19771a0525f023249e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a9ac9bb717a889f09d307eda9f0b65957">findProbabilityOfZeroDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Measure the probability of a specified qubit being in the zero state across all amplitudes held in this chunk.  <a href="#a9ac9bb717a889f09d307eda9f0b65957"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a11a96159191cbf1b01a1080e7f045aac">controlledPhaseGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int idQubit1, const int idQubit2)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The control phase (the two qubit phase gate).  <a href="#a11a96159191cbf1b01a1080e7f045aac"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#afc1835c6b43b6e59ce7df7b13f274fc7">multiControlledPhaseGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, int *controlQubits, int numControlQubits)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The multiple qubit control phase gate.  <a href="#afc1835c6b43b6e59ce7df7b13f274fc7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a01d9a8b7ff0e09ec399e158389783aa9">collapseToOutcomeLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, int measureQubit, REAL totalProbability, int outcome)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update the state vector to be consistent with measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1.  <a href="#a01d9a8b7ff0e09ec399e158389783aa9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a7a1f63ec3c42d9ad72f1f01c14a885db">collapseToOutcomeDistributedRenorm</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit, const REAL totalProbability)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Renormalise parts of the state vector where measureQubit=0 or 1, based on the total probability of that qubit being in state 0 or 1.  <a href="#a7a1f63ec3c42d9ad72f1f01c14a885db"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a78908fe8e75a21fd4f7fa7dff05d6be1">collapseToOutcomeDistributedSetZero</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set all amplitudes in one chunk to 0.  <a href="#a78908fe8e75a21fd4f7fa7dff05d6be1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a799b10447d6dbdaf960a4d3eedd22014">getProbEl</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, long long int index)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get probability of the state at an index in the state vector.  <a href="#a799b10447d6dbdaf960a4d3eedd22014"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#aac1637696885c75b73a1ecf381cea713">errorCodes</a> []</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>The core of the QuEST Library. </p>

<p>Definition in file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="ad72dbcf6d0153db1b8d8a58001feed83"></a><!-- doxytag: member="qubits.c::DEBUG" ref="ad72dbcf6d0153db1b8d8a58001feed83" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG&nbsp;&nbsp;&nbsp;0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00015">15</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00123">calcTotalProbability()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00254">exchangeStateVectors()</a>, <a class="el" href="qubits_8c_source.html#l01759">findProbabilityOfZeroLocal()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00032">initQuESTEnv()</a>, <a class="el" href="qubits_8c_source.html#l00257">initStateOfSingleQubit()</a>, <a class="el" href="qubits_8c_source.html#l00218">initStatePlus()</a>, and <a class="el" href="qubits_8c_source.html#l00176">initStateZero()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a7a1f63ec3c42d9ad72f1f01c14a885db"></a><!-- doxytag: member="qubits.c::collapseToOutcomeDistributedRenorm" ref="a7a1f63ec3c42d9ad72f1f01c14a885db" args="(MultiQubit multiQubit, const int measureQubit, const REAL totalProbability)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL collapseToOutcomeDistributedRenorm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>totalProbability</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Renormalise parts of the state vector where measureQubit=0 or 1, based on the total probability of that qubit being in state 0 or 1. </p>
<p>Measure in Zero performs an irreversible change to the state vector: it updates the vector according to the event that the value 'outcome' has been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1. In the distributed version, one block (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) is spread over multiple chunks, meaning that each chunks performs only renormalisation or only setting amplitudes to 0. This function handles the renormalisation.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>totalProbability</em>&nbsp;</td><td>probability of qubit measureQubit being zero </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l02073">2073</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00693">collapseToOutcome()</a>, and <a class="el" href="qubits__env__mpi_8c_source.html#l00726">measureWithStats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02074"></a>02074 {
<a name="l02075"></a>02075         <span class="comment">// ----- temp variables</span>
<a name="l02076"></a>02076         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span>
<a name="l02077"></a>02077         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l02078"></a>02078         <span class="comment">// (good for shared memory parallelism)</span>
<a name="l02079"></a>02079 
<a name="l02080"></a>02080         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> renorm=1/sqrt(totalProbability);
<a name="l02081"></a>02081         
<a name="l02082"></a>02082         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l02083"></a>02083         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l02084"></a>02084 
<a name="l02085"></a>02085 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02086"></a>02086 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l02087"></a>02087 <span class="preprocessor">        shared    (numTasks,stateVecReal,stateVecImag) \</span>
<a name="l02088"></a>02088 <span class="preprocessor">        private   (thisTask)</span>
<a name="l02089"></a>02089 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02090"></a>02090 <span class="preprocessor"></span>        {
<a name="l02091"></a>02091 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02092"></a>02092 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule  (static)</span>
<a name="l02093"></a>02093 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02094"></a>02094 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l02095"></a>02095                         <span class="comment">// summation -- simple implementation</span>
<a name="l02096"></a>02096                         stateVecReal[thisTask] = stateVecReal[thisTask]*renorm;
<a name="l02097"></a>02097                         stateVecImag[thisTask] = stateVecImag[thisTask]*renorm;
<a name="l02098"></a>02098                 }
<a name="l02099"></a>02099         }
<a name="l02100"></a>02100         <span class="keywordflow">return</span> totalProbability;
<a name="l02101"></a>02101 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a78908fe8e75a21fd4f7fa7dff05d6be1"></a><!-- doxytag: member="qubits.c::collapseToOutcomeDistributedSetZero" ref="a78908fe8e75a21fd4f7fa7dff05d6be1" args="(MultiQubit multiQubit, const int measureQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void collapseToOutcomeDistributedSetZero </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set all amplitudes in one chunk to 0. </p>
<p>Measure in Zero performs an irreversible change to the state vector: it updates the vector according to the event that a zero have been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 or 1. In the distributed version, one block (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) is spread over multiple chunks, meaning that each chunks performs only renormalisation or only setting amplitudes to 0. This function handles setting amplitudes to 0.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l02116">2116</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00693">collapseToOutcome()</a>, and <a class="el" href="qubits__env__mpi_8c_source.html#l00726">measureWithStats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02117"></a>02117 {
<a name="l02118"></a>02118         <span class="comment">// ----- temp variables</span>
<a name="l02119"></a>02119         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span>
<a name="l02120"></a>02120         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l02121"></a>02121         <span class="comment">// (good for shared memory parallelism)</span>
<a name="l02122"></a>02122 
<a name="l02123"></a>02123         <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l02124"></a>02124         <span class="comment">//            find probability                                      //</span>
<a name="l02125"></a>02125         <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l02126"></a>02126 
<a name="l02127"></a>02127         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l02128"></a>02128         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l02129"></a>02129 
<a name="l02130"></a>02130 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02131"></a>02131 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l02132"></a>02132 <span class="preprocessor">        shared    (numTasks,stateVecReal,stateVecImag) \</span>
<a name="l02133"></a>02133 <span class="preprocessor">        private   (thisTask)</span>
<a name="l02134"></a>02134 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02135"></a>02135 <span class="preprocessor"></span>        {
<a name="l02136"></a>02136 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02137"></a>02137 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule  (static)</span>
<a name="l02138"></a>02138 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02139"></a>02139 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l02140"></a>02140                         <span class="comment">// summation -- simple implementation</span>
<a name="l02141"></a>02141                         stateVecReal[thisTask] = 0;
<a name="l02142"></a>02142                         stateVecImag[thisTask] = 0;
<a name="l02143"></a>02143                 }
<a name="l02144"></a>02144         }
<a name="l02145"></a>02145 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a01d9a8b7ff0e09ec399e158389783aa9"></a><!-- doxytag: member="qubits.c::collapseToOutcomeLocal" ref="a01d9a8b7ff0e09ec399e158389783aa9" args="(MultiQubit multiQubit, int measureQubit, REAL totalProbability, int outcome)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void collapseToOutcomeLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>totalProbability</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outcome</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Update the state vector to be consistent with measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1. </p>
<p>Performs an irreversible change to the state vector: it updates the vector according to the event that an outcome have been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 or 1 according to the value of outcome. In the local version, one or more blocks (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) fit entirely into one chunk.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>totalProbability</em>&nbsp;</td><td>probability of qubit measureQubit being either zero or one </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>outcome</em>&nbsp;</td><td>to measure the probability of and set the state to -- either zero or one </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01990">1990</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00195">collapseToOutcome()</a>, and <a class="el" href="qubits__env__local_8c_source.html#l00211">measureWithStats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01991"></a>01991 {
<a name="l01992"></a>01992         <span class="comment">// ----- sizes</span>
<a name="l01993"></a>01993         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock,                                           <span class="comment">// size of blocks</span>
<a name="l01994"></a>01994         sizeHalfBlock;                                       <span class="comment">// size of blocks halved</span>
<a name="l01995"></a>01995         <span class="comment">// ----- indices</span>
<a name="l01996"></a>01996         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock,                                           <span class="comment">// current block</span>
<a name="l01997"></a>01997              index;                                               <span class="comment">// current index for first half block</span>
<a name="l01998"></a>01998         <span class="comment">// ----- measured probability</span>
<a name="l01999"></a>01999         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   renorm;                                    <span class="comment">// probability (returned) value</span>
<a name="l02000"></a>02000         <span class="comment">// ----- temp variables</span>
<a name="l02001"></a>02001         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span>
<a name="l02002"></a>02002         <span class="comment">// (good for shared memory parallelism)</span>
<a name="l02003"></a>02003         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l02004"></a>02004 
<a name="l02005"></a>02005         <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l02006"></a>02006         <span class="comment">//            dimensions                                            //</span>
<a name="l02007"></a>02007         <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l02008"></a>02008         sizeHalfBlock = 1LL &lt;&lt; (measureQubit);                       <span class="comment">// number of state vector elements to sum,</span>
<a name="l02009"></a>02009         <span class="comment">// and then the number to skip</span>
<a name="l02010"></a>02010         sizeBlock     = 2LL * sizeHalfBlock;                           <span class="comment">// size of blocks (pairs of measure and skip entries)</span>
<a name="l02011"></a>02011         
<a name="l02012"></a>02012         renorm=1/sqrt(totalProbability);
<a name="l02013"></a>02013         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l02014"></a>02014         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l02015"></a>02015 
<a name="l02016"></a>02016 
<a name="l02017"></a>02017 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02018"></a>02018 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l02019"></a>02019 <span class="preprocessor">        default (none) \</span>
<a name="l02020"></a>02020 <span class="preprocessor">        shared    (numTasks,sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag,renorm,outcome) \</span>
<a name="l02021"></a>02021 <span class="preprocessor">        private   (thisTask,thisBlock,index)</span>
<a name="l02022"></a>02022 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02023"></a>02023 <span class="preprocessor"></span>        {
<a name="l02024"></a>02024                 <span class="keywordflow">if</span> (outcome==0){
<a name="l02025"></a>02025                         <span class="comment">// measure qubit is 0</span>
<a name="l02026"></a>02026 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02027"></a>02027 <span class="preprocessor"></span><span class="preprocessor">                        # pragma omp for schedule  (static)</span>
<a name="l02028"></a>02028 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02029"></a>02029 <span class="preprocessor"></span>                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l02030"></a>02030                                 thisBlock = thisTask / sizeHalfBlock;
<a name="l02031"></a>02031                                 index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l02032"></a>02032                                 stateVecReal[index]=stateVecReal[index]*renorm;
<a name="l02033"></a>02033                                 stateVecImag[index]=stateVecImag[index]*renorm;
<a name="l02034"></a>02034 
<a name="l02035"></a>02035                                 stateVecReal[index+sizeHalfBlock]=0;
<a name="l02036"></a>02036                                 stateVecImag[index+sizeHalfBlock]=0;
<a name="l02037"></a>02037                         }
<a name="l02038"></a>02038                 } <span class="keywordflow">else</span> {
<a name="l02039"></a>02039                         <span class="comment">// measure qubit is 1</span>
<a name="l02040"></a>02040 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02041"></a>02041 <span class="preprocessor"></span><span class="preprocessor">                        # pragma omp for schedule  (static)</span>
<a name="l02042"></a>02042 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02043"></a>02043 <span class="preprocessor"></span>                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l02044"></a>02044                                 thisBlock = thisTask / sizeHalfBlock;
<a name="l02045"></a>02045                                 index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l02046"></a>02046                                 stateVecReal[index]=0;
<a name="l02047"></a>02047                                 stateVecImag[index]=0;
<a name="l02048"></a>02048 
<a name="l02049"></a>02049                                 stateVecReal[index+sizeHalfBlock]=stateVecReal[index+sizeHalfBlock]*renorm;
<a name="l02050"></a>02050                                 stateVecImag[index+sizeHalfBlock]=stateVecImag[index+sizeHalfBlock]*renorm;
<a name="l02051"></a>02051                         }
<a name="l02052"></a>02052                 }
<a name="l02053"></a>02053         }
<a name="l02054"></a>02054 
<a name="l02055"></a>02055 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a20ee1878a63ae6112e8845f4a8787592"></a><!-- doxytag: member="qubits.c::compactUnitaryDistributed" ref="a20ee1878a63ae6112e8845f4a8787592" args="(MultiQubit multiQubit, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compactUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta, and a subset of the state vector with upper and lower block values stored seperately. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot1</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot2</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00648">648</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, and <a class="el" href="precision_8h_source.html#l00023">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00286">compactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00653"></a>00653 {
<a name="l00654"></a>00654 
<a name="l00655"></a>00655         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00656"></a>00656         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l00657"></a>00657         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00658"></a>00658 
<a name="l00659"></a>00659         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00660"></a>00660         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00661"></a>00661         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00662"></a>00662         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00663"></a>00663         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00664"></a>00664 
<a name="l00665"></a>00665 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00666"></a>00666 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00667"></a>00667 <span class="preprocessor">        default  (none) \</span>
<a name="l00668"></a>00668 <span class="preprocessor">        shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l00669"></a>00669 <span class="preprocessor">                        rot1Real,rot1Imag, rot2Real,rot2Imag) \</span>
<a name="l00670"></a>00670 <span class="preprocessor">        private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span>
<a name="l00671"></a>00671 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00672"></a>00672 <span class="preprocessor"></span>        {
<a name="l00673"></a>00673 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00674"></a>00674 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00675"></a>00675 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00676"></a>00676 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00677"></a>00677                         <span class="comment">// store current state vector values in temp variables</span>
<a name="l00678"></a>00678                         stateRealUp = stateVecRealUp[thisTask];
<a name="l00679"></a>00679                         stateImagUp = stateVecImagUp[thisTask];
<a name="l00680"></a>00680 
<a name="l00681"></a>00681                         stateRealLo = stateVecRealLo[thisTask];
<a name="l00682"></a>00682                         stateImagLo = stateVecImagLo[thisTask];
<a name="l00683"></a>00683 
<a name="l00684"></a>00684                         <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span>
<a name="l00685"></a>00685                         stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp + rot2Real*stateRealLo + rot2Imag*stateImagLo;
<a name="l00686"></a>00686                         stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp + rot2Real*stateImagLo - rot2Imag*stateRealLo;
<a name="l00687"></a>00687                 }
<a name="l00688"></a>00688         }
<a name="l00689"></a>00689 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9cee2d8716667a3318420a3b672f5b92"></a><!-- doxytag: member="qubits.c::compactUnitaryLocal" ref="a9cee2d8716667a3318420a3b672f5b92" args="(MultiQubit multiQubit, const int targetQubit, Complex alpha, Complex beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compactUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>alpha</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>beta</em>&nbsp;</td><td>rotation angle </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00509">509</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00101">compactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00510"></a>00510 {
<a name="l00511"></a>00511         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l00512"></a>00512         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l00513"></a>00513              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l00514"></a>00514 
<a name="l00515"></a>00515         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00516"></a>00516         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l00517"></a>00517         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l00518"></a>00518 
<a name="l00519"></a>00519         <span class="comment">// set dimensions</span>
<a name="l00520"></a>00520         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l00521"></a>00521         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l00522"></a>00522 
<a name="l00523"></a>00523         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l00524"></a>00524         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00525"></a>00525         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00526"></a>00526         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> alphaImag=alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>, alphaReal=alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;
<a name="l00527"></a>00527         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> betaImag=beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>, betaReal=beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;
<a name="l00528"></a>00528 
<a name="l00529"></a>00529 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00530"></a>00530 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00531"></a>00531 <span class="preprocessor">        default  (none) \</span>
<a name="l00532"></a>00532 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, alphaReal,alphaImag, betaReal,betaImag) \</span>
<a name="l00533"></a>00533 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span>
<a name="l00534"></a>00534 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00535"></a>00535 <span class="preprocessor"></span>        {
<a name="l00536"></a>00536 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00537"></a>00537 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00538"></a>00538 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00539"></a>00539 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00540"></a>00540 
<a name="l00541"></a>00541                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l00542"></a>00542                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l00543"></a>00543                         indexLo     = indexUp + sizeHalfBlock;
<a name="l00544"></a>00544 
<a name="l00545"></a>00545                         <span class="comment">// store current state vector values in temp variables</span>
<a name="l00546"></a>00546                         stateRealUp = stateVecReal[indexUp];
<a name="l00547"></a>00547                         stateImagUp = stateVecImag[indexUp];
<a name="l00548"></a>00548 
<a name="l00549"></a>00549                         stateRealLo = stateVecReal[indexLo];
<a name="l00550"></a>00550                         stateImagLo = stateVecImag[indexLo];
<a name="l00551"></a>00551 
<a name="l00552"></a>00552                         <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span>
<a name="l00553"></a>00553                         stateVecReal[indexUp] = alphaReal*stateRealUp - alphaImag*stateImagUp 
<a name="l00554"></a>00554                                 - betaReal*stateRealLo - betaImag*stateImagLo;
<a name="l00555"></a>00555                         stateVecImag[indexUp] = alphaReal*stateImagUp + alphaImag*stateRealUp 
<a name="l00556"></a>00556                                 - betaReal*stateImagLo + betaImag*stateRealLo;
<a name="l00557"></a>00557 
<a name="l00558"></a>00558                         <span class="comment">// state[indexLo] = beta  * state[indexUp] + conj(alpha) * state[indexLo]</span>
<a name="l00559"></a>00559                         stateVecReal[indexLo] = betaReal*stateRealUp - betaImag*stateImagUp 
<a name="l00560"></a>00560                                 + alphaReal*stateRealLo + alphaImag*stateImagLo;
<a name="l00561"></a>00561                         stateVecImag[indexLo] = betaReal*stateImagUp + betaImag*stateRealUp 
<a name="l00562"></a>00562                                 + alphaReal*stateImagLo - alphaImag*stateRealLo;
<a name="l00563"></a>00563                 } 
<a name="l00564"></a>00564         }
<a name="l00565"></a>00565 
<a name="l00566"></a>00566 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a793584932ae384c82e7e42db7d35d18d"></a><!-- doxytag: member="qubits.c::compareStates" ref="a793584932ae384c82e7e42db7d35d18d" args="(MultiQubit mq1, MultiQubit mq2, REAL precision)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int compareStates </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>mq1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>mq2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>precision</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00371">371</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00694">test_collapseToOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00341">test_compactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00470">test_controlledCompactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00249">test_controlledNot()</a>, <a class="el" href="runTests_8c_source.html#l00283">test_controlledPhaseGate()</a>, <a class="el" href="runTests_8c_source.html#l00515">test_controlledUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00165">test_hadamard()</a>, <a class="el" href="runTests_8c_source.html#l00055">test_initStatePlus()</a>, <a class="el" href="runTests_8c_source.html#l00032">test_initStateZero()</a>, <a class="el" href="runTests_8c_source.html#l00759">test_measure()</a>, <a class="el" href="runTests_8c_source.html#l00807">test_measureWithStats()</a>, <a class="el" href="runTests_8c_source.html#l00315">test_multiControlledPhaseGate()</a>, <a class="el" href="runTests_8c_source.html#l00567">test_multiControlledUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00193">test_sGate()</a>, <a class="el" href="runTests_8c_source.html#l00078">test_sigmaX()</a>, <a class="el" href="runTests_8c_source.html#l00107">test_sigmaY()</a>, <a class="el" href="runTests_8c_source.html#l00136">test_sigmaZ()</a>, <a class="el" href="runTests_8c_source.html#l00221">test_tGate()</a>, and <a class="el" href="runTests_8c_source.html#l00403">test_unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00371"></a>00371                                                                  {
<a name="l00372"></a>00372         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> diff;
<a name="l00373"></a>00373         <span class="keywordtype">int</span> chunkSize = mq1.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00374"></a>00374         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;chunkSize; i++){
<a name="l00375"></a>00375                 diff = mq1.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[i] - mq2.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[i];
<a name="l00376"></a>00376                 <span class="keywordflow">if</span> (diff&lt;0) diff *= -1;
<a name="l00377"></a>00377                 <span class="keywordflow">if</span> (diff&gt;precision) <span class="keywordflow">return</span> 0;
<a name="l00378"></a>00378                 diff = mq1.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[i] - mq2.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[i];
<a name="l00379"></a>00379                 <span class="keywordflow">if</span> (diff&lt;0) diff *= -1;
<a name="l00380"></a>00380                 <span class="keywordflow">if</span> (diff&gt;precision) <span class="keywordflow">return</span> 0;
<a name="l00381"></a>00381         }
<a name="l00382"></a>00382         <span class="keywordflow">return</span> 1;
<a name="l00383"></a>00383 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a717855e835e3161e08c18cdc15325d27"></a><!-- doxytag: member="qubits.c::controlledCompactUnitaryDistributed" ref="a717855e835e3161e08c18cdc15325d27" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledCompactUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately. </p>
<p>Only perform the rotation where the control qubit is one.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>qubit to determine whether or not to perform a rotation </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot1</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot2</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00993">993</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01887">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, and <a class="el" href="precision_8h_source.html#l00023">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00368">controlledCompactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00998"></a>00998 {
<a name="l00999"></a>00999 
<a name="l01000"></a>01000         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l01001"></a>01001         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01002"></a>01002         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01003"></a>01003         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01004"></a>01004         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01005"></a>01005 
<a name="l01006"></a>01006         <span class="keywordtype">int</span> controlBit;
<a name="l01007"></a>01007 
<a name="l01008"></a>01008     <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l01009"></a>01009         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l01010"></a>01010         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01011"></a>01011         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01012"></a>01012         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01013"></a>01013 
<a name="l01014"></a>01014 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01015"></a>01015 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01016"></a>01016 <span class="preprocessor">        default  (none) \</span>
<a name="l01017"></a>01017 <span class="preprocessor">        shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l01018"></a>01018 <span class="preprocessor">                        rot1Real,rot1Imag, rot2Real,rot2Imag) \</span>
<a name="l01019"></a>01019 <span class="preprocessor">        private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit)</span>
<a name="l01020"></a>01020 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01021"></a>01021 <span class="preprocessor"></span>        {
<a name="l01022"></a>01022 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01023"></a>01023 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01024"></a>01024 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01025"></a>01025 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01026"></a>01026                         controlBit = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);
<a name="l01027"></a>01027                         <span class="keywordflow">if</span> (controlBit){
<a name="l01028"></a>01028                                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l01029"></a>01029                                 stateRealUp = stateVecRealUp[thisTask];
<a name="l01030"></a>01030                                 stateImagUp = stateVecImagUp[thisTask];
<a name="l01031"></a>01031 
<a name="l01032"></a>01032                                 stateRealLo = stateVecRealLo[thisTask];
<a name="l01033"></a>01033                                 stateImagLo = stateVecImagLo[thisTask];
<a name="l01034"></a>01034 
<a name="l01035"></a>01035                                 <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span>
<a name="l01036"></a>01036                                 stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp + rot2Real*stateRealLo + rot2Imag*stateImagLo;
<a name="l01037"></a>01037                                 stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp + rot2Real*stateImagLo - rot2Imag*stateRealLo;
<a name="l01038"></a>01038                         }
<a name="l01039"></a>01039                 }
<a name="l01040"></a>01040         }
<a name="l01041"></a>01041 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="afc77657651d52c47403b44b923a098a8"></a><!-- doxytag: member="qubits.c::controlledCompactUnitaryLocal" ref="afc77657651d52c47403b44b923a098a8" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, Complex alpha, Complex beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledCompactUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a control qubit. </p>
<p>Only perform the rotation for elements where the control qubit is one.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>perform rotation if this qubit is 1 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>alpha</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>beta</em>&nbsp;</td><td>rotation angle </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00762">762</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01887">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00119">controlledCompactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00764"></a>00764 {
<a name="l00765"></a>00765         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l00766"></a>00766         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l00767"></a>00767              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l00768"></a>00768 
<a name="l00769"></a>00769         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00770"></a>00770         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l00771"></a>00771         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l00772"></a>00772         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00773"></a>00773         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l00774"></a>00774 
<a name="l00775"></a>00775         <span class="keywordtype">int</span> controlBit;
<a name="l00776"></a>00776 
<a name="l00777"></a>00777     <span class="comment">// set dimensions</span>
<a name="l00778"></a>00778         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l00779"></a>00779         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l00780"></a>00780 
<a name="l00781"></a>00781         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l00782"></a>00782         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00783"></a>00783         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00784"></a>00784         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> alphaImag=alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>, alphaReal=alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;
<a name="l00785"></a>00785         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> betaImag=beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>, betaReal=beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;
<a name="l00786"></a>00786 
<a name="l00787"></a>00787 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00788"></a>00788 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00789"></a>00789 <span class="preprocessor">        default  (none) \</span>
<a name="l00790"></a>00790 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, alphaReal,alphaImag, betaReal,betaImag) \</span>
<a name="l00791"></a>00791 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit) </span>
<a name="l00792"></a>00792 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00793"></a>00793 <span class="preprocessor"></span>        {
<a name="l00794"></a>00794 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00795"></a>00795 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00796"></a>00796 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00797"></a>00797 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00798"></a>00798 
<a name="l00799"></a>00799                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l00800"></a>00800                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l00801"></a>00801                         indexLo     = indexUp + sizeHalfBlock;
<a name="l00802"></a>00802 
<a name="l00803"></a>00803                         controlBit = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, indexUp+chunkId*chunkSize);
<a name="l00804"></a>00804                         <span class="keywordflow">if</span> (controlBit){
<a name="l00805"></a>00805                                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l00806"></a>00806                                 stateRealUp = stateVecReal[indexUp];
<a name="l00807"></a>00807                                 stateImagUp = stateVecImag[indexUp];
<a name="l00808"></a>00808 
<a name="l00809"></a>00809                                 stateRealLo = stateVecReal[indexLo];
<a name="l00810"></a>00810                                 stateImagLo = stateVecImag[indexLo];
<a name="l00811"></a>00811 
<a name="l00812"></a>00812                                 <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span>
<a name="l00813"></a>00813                                 stateVecReal[indexUp] = alphaReal*stateRealUp - alphaImag*stateImagUp 
<a name="l00814"></a>00814                                         - betaReal*stateRealLo - betaImag*stateImagLo;
<a name="l00815"></a>00815                                 stateVecImag[indexUp] = alphaReal*stateImagUp + alphaImag*stateRealUp 
<a name="l00816"></a>00816                                         - betaReal*stateImagLo + betaImag*stateRealLo;
<a name="l00817"></a>00817 
<a name="l00818"></a>00818                                 <span class="comment">// state[indexLo] = beta  * state[indexUp] + conj(alpha) * state[indexLo]</span>
<a name="l00819"></a>00819                                 stateVecReal[indexLo] = betaReal*stateRealUp - betaImag*stateImagUp 
<a name="l00820"></a>00820                                         + alphaReal*stateRealLo + alphaImag*stateImagLo;
<a name="l00821"></a>00821                                 stateVecImag[indexLo] = betaReal*stateImagUp + betaImag*stateRealUp 
<a name="l00822"></a>00822                                         + alphaReal*stateImagLo - alphaImag*stateRealLo;
<a name="l00823"></a>00823                         }
<a name="l00824"></a>00824                 } 
<a name="l00825"></a>00825         }
<a name="l00826"></a>00826 
<a name="l00827"></a>00827 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a05875a70b539a3efb28d027823403f34"></a><!-- doxytag: member="qubits.c::controlledNotDistributed" ref="a05875a70b539a3efb28d027823403f34" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledNotDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{0,1},{1,0}. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk. Only perform the rotation for elements where controlQubit is one.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecIn</em>&nbsp;</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01340">1340</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01887">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, and <a class="el" href="precision_8h_source.html#l00023">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00530">controlledNot()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01343"></a>01343 {
<a name="l01344"></a>01344 
<a name="l01345"></a>01345         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01346"></a>01346         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01347"></a>01347         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01348"></a>01348         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01349"></a>01349 
<a name="l01350"></a>01350         <span class="keywordtype">int</span> controlBit;
<a name="l01351"></a>01351 
<a name="l01352"></a>01352         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealIn=stateVecIn.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagIn=stateVecIn.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01353"></a>01353         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01354"></a>01354 
<a name="l01355"></a>01355 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01356"></a>01356 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01357"></a>01357 <span class="preprocessor">        default  (none) \</span>
<a name="l01358"></a>01358 <span class="preprocessor">        shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut) \</span>
<a name="l01359"></a>01359 <span class="preprocessor">        private  (thisTask,controlBit)</span>
<a name="l01360"></a>01360 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01361"></a>01361 <span class="preprocessor"></span>        {
<a name="l01362"></a>01362 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01363"></a>01363 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01364"></a>01364 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01365"></a>01365 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01366"></a>01366                         controlBit = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);
<a name="l01367"></a>01367                         <span class="keywordflow">if</span> (controlBit){
<a name="l01368"></a>01368                                 stateVecRealOut[thisTask] = stateVecRealIn[thisTask];
<a name="l01369"></a>01369                                 stateVecImagOut[thisTask] = stateVecImagIn[thisTask];
<a name="l01370"></a>01370                         }
<a name="l01371"></a>01371                 }
<a name="l01372"></a>01372         }
<a name="l01373"></a>01373 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad357a43e80e3baf013975b1b70942f4c"></a><!-- doxytag: member="qubits.c::controlledNotLocal" ref="ad357a43e80e3baf013975b1b70942f4c" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledNotLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{0,1},{1,0} for elements where controlQubit is one. </p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>qubit to determine whether or not to perform a rotation </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01274">1274</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01887">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00178">controlledNot()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01275"></a>01275 {
<a name="l01276"></a>01276         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01277"></a>01277         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01278"></a>01278              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01279"></a>01279 
<a name="l01280"></a>01280         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateImagUp;
<a name="l01281"></a>01281         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01282"></a>01282         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01283"></a>01283         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01284"></a>01284         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01285"></a>01285 
<a name="l01286"></a>01286         <span class="keywordtype">int</span> controlBit;
<a name="l01287"></a>01287 
<a name="l01288"></a>01288         <span class="comment">// set dimensions</span>
<a name="l01289"></a>01289         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01290"></a>01290         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01291"></a>01291 
<a name="l01292"></a>01292 
<a name="l01293"></a>01293         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l01294"></a>01294         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01295"></a>01295         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01296"></a>01296 
<a name="l01297"></a>01297 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01298"></a>01298 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01299"></a>01299 <span class="preprocessor">        default  (none) \</span>
<a name="l01300"></a>01300 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span>
<a name="l01301"></a>01301 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,controlBit) </span>
<a name="l01302"></a>01302 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01303"></a>01303 <span class="preprocessor"></span>        {
<a name="l01304"></a>01304 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01305"></a>01305 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01306"></a>01306 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01307"></a>01307 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01308"></a>01308                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l01309"></a>01309                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01310"></a>01310                         indexLo     = indexUp + sizeHalfBlock;
<a name="l01311"></a>01311 
<a name="l01312"></a>01312                         controlBit = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a>(controlQubit, indexUp+chunkId*chunkSize);
<a name="l01313"></a>01313                         <span class="keywordflow">if</span> (controlBit){
<a name="l01314"></a>01314                                 stateRealUp = stateVecReal[indexUp];
<a name="l01315"></a>01315                                 stateImagUp = stateVecImag[indexUp];
<a name="l01316"></a>01316 
<a name="l01317"></a>01317                                 stateVecReal[indexUp] = stateVecReal[indexLo];
<a name="l01318"></a>01318                                 stateVecImag[indexUp] = stateVecImag[indexLo];
<a name="l01319"></a>01319 
<a name="l01320"></a>01320                                 stateVecReal[indexLo] = stateRealUp;
<a name="l01321"></a>01321                                 stateVecImag[indexLo] = stateImagUp;
<a name="l01322"></a>01322                         }
<a name="l01323"></a>01323                 } 
<a name="l01324"></a>01324         }
<a name="l01325"></a>01325 
<a name="l01326"></a>01326 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a11a96159191cbf1b01a1080e7f045aac"></a><!-- doxytag: member="qubits.c::controlledPhaseGate" ref="a11a96159191cbf1b01a1080e7f045aac" args="(MultiQubit multiQubit, const int idQubit1, const int idQubit2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledPhaseGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>idQubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>idQubit2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The control phase (the two qubit phase gate). </p>
<p>For each state, if both input qubits are equal to one, multiply the amplitude of that state by -1. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>idQubit1,idQubit2</em>&nbsp;</td><td>specified qubits </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01898">1898</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01887">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::numQubits</a>, <a class="el" href="qubits__env__local_8c_source.html#l00242">QuESTAssert()</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00283">test_controlledPhaseGate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01899"></a>01899 {
<a name="l01900"></a>01900         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l01901"></a>01901         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l01902"></a>01902         <span class="keywordtype">int</span> bit1, bit2;
<a name="l01903"></a>01903 
<a name="l01904"></a>01904         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01905"></a>01905         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01906"></a>01906 
<a name="l01907"></a>01907     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(idQubit1 &gt;= 0 &amp;&amp; idQubit1 &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 2, __func__);
<a name="l01908"></a>01908     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(idQubit2 &gt;= 0 &amp;&amp; idQubit2 &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l01909"></a>01909     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(idQubit1 != idQubit2, 3, __func__);
<a name="l01910"></a>01910 
<a name="l01911"></a>01911         <span class="comment">// dimension of the state vector</span>
<a name="l01912"></a>01912         stateVecSize = multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01913"></a>01913         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01914"></a>01914         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01915"></a>01915 
<a name="l01916"></a>01916 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01917"></a>01917 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel for \</span>
<a name="l01918"></a>01918 <span class="preprocessor">        default  (none)                      \</span>
<a name="l01919"></a>01919 <span class="preprocessor">        shared   (stateVecSize, stateVecReal,stateVecImag ) \</span>
<a name="l01920"></a>01920 <span class="preprocessor">        private  (index,bit1,bit2)                     \</span>
<a name="l01921"></a>01921 <span class="preprocessor">        schedule (static)</span>
<a name="l01922"></a>01922 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01923"></a>01923 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l01924"></a>01924                 bit1 = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (idQubit1, index+chunkId*chunkSize);
<a name="l01925"></a>01925                 bit2 = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (idQubit2, index+chunkId*chunkSize);
<a name="l01926"></a>01926                 <span class="keywordflow">if</span> (bit1 &amp;&amp; bit2) {
<a name="l01927"></a>01927                         stateVecReal [index] = - stateVecReal [index];
<a name="l01928"></a>01928                         stateVecImag [index] = - stateVecImag [index];
<a name="l01929"></a>01929                 }
<a name="l01930"></a>01930         }
<a name="l01931"></a>01931 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a642093063a1f889f61a1311f6d6f2d3f"></a><!-- doxytag: member="qubits.c::controlledUnitaryDistributed" ref="a642093063a1f889f61a1311f6d6f2d3f" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately. </p>
<p>Only perform the rotation where the control qubit is one.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>qubit to determine whether or not to perform a rotation </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot1</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot2</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01056">1056</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01887">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, and <a class="el" href="precision_8h_source.html#l00023">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00411">controlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01061"></a>01061 {
<a name="l01062"></a>01062 
<a name="l01063"></a>01063         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l01064"></a>01064         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01065"></a>01065         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01066"></a>01066         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01067"></a>01067         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01068"></a>01068 
<a name="l01069"></a>01069         <span class="keywordtype">int</span> controlBit;
<a name="l01070"></a>01070 
<a name="l01071"></a>01071         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l01072"></a>01072         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l01073"></a>01073         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01074"></a>01074         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01075"></a>01075         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01076"></a>01076 
<a name="l01077"></a>01077 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01078"></a>01078 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01079"></a>01079 <span class="preprocessor">        default  (none) \</span>
<a name="l01080"></a>01080 <span class="preprocessor">        shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l01081"></a>01081 <span class="preprocessor">                        rot1Real,rot1Imag, rot2Real,rot2Imag) \</span>
<a name="l01082"></a>01082 <span class="preprocessor">        private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit)</span>
<a name="l01083"></a>01083 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01084"></a>01084 <span class="preprocessor"></span>        {
<a name="l01085"></a>01085 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01086"></a>01086 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01087"></a>01087 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01088"></a>01088 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01089"></a>01089                         controlBit = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);
<a name="l01090"></a>01090                         <span class="keywordflow">if</span> (controlBit){
<a name="l01091"></a>01091                                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l01092"></a>01092                                 stateRealUp = stateVecRealUp[thisTask];
<a name="l01093"></a>01093                                 stateImagUp = stateVecImagUp[thisTask];
<a name="l01094"></a>01094 
<a name="l01095"></a>01095                                 stateRealLo = stateVecRealLo[thisTask];
<a name="l01096"></a>01096                                 stateImagLo = stateVecImagLo[thisTask];
<a name="l01097"></a>01097 
<a name="l01098"></a>01098                 stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp 
<a name="l01099"></a>01099                     + rot2Real*stateRealLo - rot2Imag*stateImagLo;
<a name="l01100"></a>01100                 stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp 
<a name="l01101"></a>01101                     + rot2Real*stateImagLo + rot2Imag*stateRealLo;
<a name="l01102"></a>01102                         }
<a name="l01103"></a>01103                 }
<a name="l01104"></a>01104         }
<a name="l01105"></a>01105 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8a4afcff70195a306c082b8ed8d4e09a"></a><!-- doxytag: member="qubits.c::controlledUnitaryLocal" ref="a8a4afcff70195a306c082b8ed8d4e09a" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a control qubit. </p>
<p>Only perform the rotation for elements where the control qubit is one.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>perform rotation if this qubit is 1 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>alpha</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>beta</em>&nbsp;</td><td>rotation angle </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00914">914</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01887">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00027">ComplexMatrix2::r0c0</a>, <a class="el" href="qubits_8h_source.html#l00027">ComplexMatrix2::r0c1</a>, <a class="el" href="qubits_8h_source.html#l00028">ComplexMatrix2::r1c0</a>, <a class="el" href="qubits_8h_source.html#l00028">ComplexMatrix2::r1c1</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00130">controlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00916"></a>00916 {
<a name="l00917"></a>00917         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l00918"></a>00918         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l00919"></a>00919              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l00920"></a>00920 
<a name="l00921"></a>00921         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00922"></a>00922         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l00923"></a>00923         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l00924"></a>00924         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00925"></a>00925         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l00926"></a>00926 
<a name="l00927"></a>00927         <span class="keywordtype">int</span> controlBit;
<a name="l00928"></a>00928 
<a name="l00929"></a>00929     <span class="comment">// set dimensions</span>
<a name="l00930"></a>00930         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l00931"></a>00931         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l00932"></a>00932 
<a name="l00933"></a>00933         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l00934"></a>00934         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00935"></a>00935         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00936"></a>00936 
<a name="l00937"></a>00937 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00938"></a>00938 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00939"></a>00939 <span class="preprocessor">        default  (none) \</span>
<a name="l00940"></a>00940 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, u) \</span>
<a name="l00941"></a>00941 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit) </span>
<a name="l00942"></a>00942 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00943"></a>00943 <span class="preprocessor"></span>        {
<a name="l00944"></a>00944 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00945"></a>00945 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00946"></a>00946 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00947"></a>00947 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00948"></a>00948 
<a name="l00949"></a>00949                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l00950"></a>00950                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l00951"></a>00951                         indexLo     = indexUp + sizeHalfBlock;
<a name="l00952"></a>00952 
<a name="l00953"></a>00953                         controlBit = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, indexUp+chunkId*chunkSize);
<a name="l00954"></a>00954                         <span class="keywordflow">if</span> (controlBit){
<a name="l00955"></a>00955                                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l00956"></a>00956                                 stateRealUp = stateVecReal[indexUp];
<a name="l00957"></a>00957                                 stateImagUp = stateVecImag[indexUp];
<a name="l00958"></a>00958 
<a name="l00959"></a>00959                                 stateRealLo = stateVecReal[indexLo];
<a name="l00960"></a>00960                                 stateImagLo = stateVecImag[indexLo];
<a name="l00961"></a>00961 
<a name="l00962"></a>00962 
<a name="l00963"></a>00963                                 <span class="comment">// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]</span>
<a name="l00964"></a>00964                                 stateVecReal[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp 
<a name="l00965"></a>00965                                         + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo - u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;
<a name="l00966"></a>00966                                 stateVecImag[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp 
<a name="l00967"></a>00967                                         + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;
<a name="l00968"></a>00968 
<a name="l00969"></a>00969                                 <span class="comment">// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]</span>
<a name="l00970"></a>00970                                 stateVecReal[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp  - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp 
<a name="l00971"></a>00971                                         + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo  -  u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;
<a name="l00972"></a>00972                                 stateVecImag[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp 
<a name="l00973"></a>00973                                         + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;
<a name="l00974"></a>00974                         }
<a name="l00975"></a>00975                 } 
<a name="l00976"></a>00976         }
<a name="l00977"></a>00977 
<a name="l00978"></a>00978 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9c02591bc64c2918503afa231d90d83f"></a><!-- doxytag: member="qubits.c::createMultiQubit" ref="a9c02591bc64c2918503afa231d90d83f" args="(MultiQubit *multiQubit, int numQubits, QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void createMultiQubit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a> *&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create a <a class="el" href="structMultiQubit.html" title="Represents a system of qubits.">MultiQubit</a> object representing a set of qubits. </p>
<p>Allocate space for state vector of probability amplitudes, including space for temporary values to be copied from one other chunk if running the distributed version. Define properties related to the size of the set of qubits. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>numQubits</em>&nbsp;</td><td>number of qubits in the system </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment (local, multinode etc) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00041">41</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numChunks</a>, <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00062">QuESTEnv::numRanks</a>, <a class="el" href="qubits_8h_source.html#l00044">MultiQubit::pairStateVec</a>, <a class="el" href="qubits__env__local_8c_source.html#l00242">QuESTAssert()</a>, <a class="el" href="qubits_8h_source.html#l00061">QuESTEnv::rank</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="3sat_8c_source.html#l00101">main()</a>, <a class="el" href="runTests_8c_source.html#l00694">test_collapseToOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00341">test_compactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00470">test_controlledCompactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00249">test_controlledNot()</a>, <a class="el" href="runTests_8c_source.html#l00283">test_controlledPhaseGate()</a>, <a class="el" href="runTests_8c_source.html#l00515">test_controlledUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00649">test_findProbabilityOfOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00165">test_hadamard()</a>, <a class="el" href="runTests_8c_source.html#l00055">test_initStatePlus()</a>, <a class="el" href="runTests_8c_source.html#l00032">test_initStateZero()</a>, <a class="el" href="runTests_8c_source.html#l00759">test_measure()</a>, <a class="el" href="runTests_8c_source.html#l00807">test_measureWithStats()</a>, <a class="el" href="runTests_8c_source.html#l00315">test_multiControlledPhaseGate()</a>, <a class="el" href="runTests_8c_source.html#l00567">test_multiControlledUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00193">test_sGate()</a>, <a class="el" href="runTests_8c_source.html#l00078">test_sigmaX()</a>, <a class="el" href="runTests_8c_source.html#l00107">test_sigmaY()</a>, <a class="el" href="runTests_8c_source.html#l00136">test_sigmaZ()</a>, <a class="el" href="runTests_8c_source.html#l00221">test_tGate()</a>, and <a class="el" href="runTests_8c_source.html#l00403">test_unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00042"></a>00042 {
<a name="l00043"></a>00043     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(numQubits&gt;0, 9, __func__);
<a name="l00044"></a>00044         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = 1L &lt;&lt; numQubits;
<a name="l00045"></a>00045         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmpsPerRank = numAmps/env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>;
<a name="l00046"></a>00046 
<a name="l00047"></a>00047         multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a> = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>)));
<a name="l00048"></a>00048         multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a> = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>)));
<a name="l00049"></a>00049         <span class="keywordflow">if</span> (env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1){
<a name="l00050"></a>00050                 multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a> = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>)));
<a name="l00051"></a>00051                 multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a> = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>)));
<a name="l00052"></a>00052         }
<a name="l00053"></a>00053 
<a name="l00054"></a>00054         <span class="keywordflow">if</span> ( (!(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>) || !(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>))
<a name="l00055"></a>00055                  &amp;&amp; numAmpsPerRank ) {
<a name="l00056"></a>00056                 printf(<span class="stringliteral">&quot;Could not allocate memory!&quot;</span>);
<a name="l00057"></a>00057                 exit (EXIT_FAILURE);
<a name="l00058"></a>00058         }
<a name="l00059"></a>00059 
<a name="l00060"></a>00060         <span class="keywordflow">if</span> ( env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1 &amp;&amp; (!(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>) || !(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>))
<a name="l00061"></a>00061                  &amp;&amp; numAmpsPerRank ) {
<a name="l00062"></a>00062                 printf(<span class="stringliteral">&quot;Could not allocate memory!&quot;</span>);
<a name="l00063"></a>00063                 exit (EXIT_FAILURE);
<a name="l00064"></a>00064         }
<a name="l00065"></a>00065 
<a name="l00066"></a>00066         multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a> = numQubits;
<a name="l00067"></a>00067         multiQubit-&gt;<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a> = numAmpsPerRank;
<a name="l00068"></a>00068         multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a> = env.<a class="code" href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">rank</a>;
<a name="l00069"></a>00069         multiQubit-&gt;<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a> = env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>;
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae5d6acc322314d7a3d8a2eccf00d3b19"></a><!-- doxytag: member="qubits.c::destroyMultiQubit" ref="ae5d6acc322314d7a3d8a2eccf00d3b19" args="(MultiQubit multiQubit, QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void destroyMultiQubit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deallocate a <a class="el" href="structMultiQubit.html" title="Represents a system of qubits.">MultiQubit</a> object representing a set of qubits Free memory allocated to state vector of probability amplitudes, including temporary vector for values copied from another chunk if running the distributed version. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object to be deallocated </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment (local, multinode etc) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00078">78</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00062">QuESTEnv::numRanks</a>, <a class="el" href="qubits_8h_source.html#l00044">MultiQubit::pairStateVec</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="3sat_8c_source.html#l00101">main()</a>, <a class="el" href="runTests_8c_source.html#l00694">test_collapseToOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00341">test_compactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00470">test_controlledCompactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00249">test_controlledNot()</a>, <a class="el" href="runTests_8c_source.html#l00283">test_controlledPhaseGate()</a>, <a class="el" href="runTests_8c_source.html#l00515">test_controlledUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00649">test_findProbabilityOfOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00165">test_hadamard()</a>, <a class="el" href="runTests_8c_source.html#l00055">test_initStatePlus()</a>, <a class="el" href="runTests_8c_source.html#l00032">test_initStateZero()</a>, <a class="el" href="runTests_8c_source.html#l00759">test_measure()</a>, <a class="el" href="runTests_8c_source.html#l00807">test_measureWithStats()</a>, <a class="el" href="runTests_8c_source.html#l00315">test_multiControlledPhaseGate()</a>, <a class="el" href="runTests_8c_source.html#l00567">test_multiControlledUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00193">test_sGate()</a>, <a class="el" href="runTests_8c_source.html#l00078">test_sigmaX()</a>, <a class="el" href="runTests_8c_source.html#l00107">test_sigmaY()</a>, <a class="el" href="runTests_8c_source.html#l00136">test_sigmaZ()</a>, <a class="el" href="runTests_8c_source.html#l00221">test_tGate()</a>, and <a class="el" href="runTests_8c_source.html#l00403">test_unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00078"></a>00078                                                            {
<a name="l00079"></a>00079         free(multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>);
<a name="l00080"></a>00080         free(multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>);
<a name="l00081"></a>00081         <span class="keywordflow">if</span> (env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1){
<a name="l00082"></a>00082                 free(multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>);
<a name="l00083"></a>00083                 free(multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>);
<a name="l00084"></a>00084         }
<a name="l00085"></a>00085 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a100463f6ec212c76a5fad99579000505"></a><!-- doxytag: member="qubits.c::extractBit" ref="a100463f6ec212c76a5fad99579000505" args="(const int locationOfBitFromRight, const long long int theEncodedNumber)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int extractBit </td>
          <td>(</td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>locationOfBitFromRight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long long int&nbsp;</td>
          <td class="paramname"> <em>theEncodedNumber</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the value of the bit at a particular index in a number. </p>
<p>SCB edit: new definition of extractBit is much faster *** </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>locationOfBitFromRight</em>&nbsp;</td><td>location of bit in theEncodedNumber </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>theEncodedNumber</em>&nbsp;</td><td>number to search </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the value of the bit in theEncodedNumber </dd></dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01887">1887</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>Referenced by <a class="el" href="qubits_8c_source.html#l00993">controlledCompactUnitaryDistributed()</a>, <a class="el" href="qubits_8c_source.html#l00762">controlledCompactUnitaryLocal()</a>, <a class="el" href="qubits_8c_source.html#l01340">controlledNotDistributed()</a>, <a class="el" href="qubits_8c_source.html#l01274">controlledNotLocal()</a>, <a class="el" href="qubits_8c_source.html#l01898">controlledPhaseGate()</a>, <a class="el" href="qubits_8c_source.html#l01056">controlledUnitaryDistributed()</a>, <a class="el" href="qubits_8c_source.html#l00914">controlledUnitaryLocal()</a>, and <a class="el" href="qubits_8c_source.html#l00257">initStateOfSingleQubit()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01888"></a>01888 {
<a name="l01889"></a>01889         <span class="keywordflow">return</span> (theEncodedNumber &amp; ( 1LL &lt;&lt; locationOfBitFromRight )) &gt;&gt; locationOfBitFromRight;
<a name="l01890"></a>01890 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9ac9bb717a889f09d307eda9f0b65957"></a><!-- doxytag: member="qubits.c::findProbabilityOfZeroDistributed" ref="a9ac9bb717a889f09d307eda9f0b65957" args="(MultiQubit multiQubit, const int measureQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL findProbabilityOfZeroDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Measure the probability of a specified qubit being in the zero state across all amplitudes held in this chunk. </p>
<p>Size of regions to skip is a multiple of chunkSize.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>probability of qubit measureQubit being zero </dd></dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01832">1832</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00674">findProbabilityOfOutcome()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01834"></a>01834 {
<a name="l01835"></a>01835         <span class="comment">// ----- measured probability</span>
<a name="l01836"></a>01836         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   totalProbability;                                    <span class="comment">// probability (returned) value</span>
<a name="l01837"></a>01837         <span class="comment">// ----- temp variables</span>
<a name="l01838"></a>01838         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span>
<a name="l01839"></a>01839         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01840"></a>01840 
<a name="l01841"></a>01841         <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01842"></a>01842         <span class="comment">//            find probability                                      //</span>
<a name="l01843"></a>01843         <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01844"></a>01844 
<a name="l01845"></a>01845         <span class="comment">// initialise returned value</span>
<a name="l01846"></a>01846         totalProbability = 0.0;
<a name="l01847"></a>01847 
<a name="l01848"></a>01848         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01849"></a>01849         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01850"></a>01850 
<a name="l01851"></a>01851 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01852"></a>01852 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01853"></a>01853 <span class="preprocessor">        shared    (numTasks,stateVecReal,stateVecImag) \</span>
<a name="l01854"></a>01854 <span class="preprocessor">        private   (thisTask) \</span>
<a name="l01855"></a>01855 <span class="preprocessor">        reduction ( +:totalProbability )</span>
<a name="l01856"></a>01856 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01857"></a>01857 <span class="preprocessor"></span>        {
<a name="l01858"></a>01858 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01859"></a>01859 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule  (static)</span>
<a name="l01860"></a>01860 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01861"></a>01861 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01862"></a>01862                         <span class="comment">// summation -- simple implementation</span>
<a name="l01863"></a>01863                         totalProbability += stateVecReal[thisTask]*stateVecReal[thisTask]
<a name="l01864"></a>01864                                 + stateVecImag[thisTask]*stateVecImag[thisTask];
<a name="l01865"></a>01865 
<a name="l01866"></a>01866                         <span class="comment">/*</span>
<a name="l01867"></a>01867 <span class="comment">                        // summation -- kahan correction</span>
<a name="l01868"></a>01868 <span class="comment">                        y = stateVecReal[thisTask]*stateVecReal[thisTask]</span>
<a name="l01869"></a>01869 <span class="comment">                        + stateVecImag[thisTask]*stateVecImag[thisTask] - c;</span>
<a name="l01870"></a>01870 <span class="comment">                        t = totalProbability + y;</span>
<a name="l01871"></a>01871 <span class="comment">                        c = (t - totalProbability) - y;</span>
<a name="l01872"></a>01872 <span class="comment">                        totalProbability = t;</span>
<a name="l01873"></a>01873 <span class="comment">                        */</span>
<a name="l01874"></a>01874 
<a name="l01875"></a>01875                 }
<a name="l01876"></a>01876         }
<a name="l01877"></a>01877 
<a name="l01878"></a>01878         <span class="keywordflow">return</span> totalProbability;
<a name="l01879"></a>01879 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7c02cd0e1b4eac19771a0525f023249e"></a><!-- doxytag: member="qubits.c::findProbabilityOfZeroLocal" ref="a7c02cd0e1b4eac19771a0525f023249e" args="(MultiQubit multiQubit, const int measureQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL findProbabilityOfZeroLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Measure the total probability of a specified qubit being in the zero state across all amplitudes in this chunk. </p>
<p>Size of regions to skip is less than the size of one chunk.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>probability of qubit measureQubit being zero </dd></dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01759">1759</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8c_source.html#l00015">DEBUG</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00186">findProbabilityOfOutcome()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01761"></a>01761 {
<a name="l01762"></a>01762         <span class="comment">// ----- sizes</span>
<a name="l01763"></a>01763         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock,                                           <span class="comment">// size of blocks</span>
<a name="l01764"></a>01764         sizeHalfBlock;                                       <span class="comment">// size of blocks halved</span>
<a name="l01765"></a>01765         <span class="comment">// ----- indices</span>
<a name="l01766"></a>01766         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock,                                           <span class="comment">// current block</span>
<a name="l01767"></a>01767              index;                                               <span class="comment">// current index for first half block</span>
<a name="l01768"></a>01768         <span class="comment">// ----- measured probability</span>
<a name="l01769"></a>01769         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   totalProbability;                                    <span class="comment">// probability (returned) value</span>
<a name="l01770"></a>01770         <span class="comment">// ----- temp variables</span>
<a name="l01771"></a>01771         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span>
<a name="l01772"></a>01772         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01773"></a>01773 
<a name="l01774"></a>01774         <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01775"></a>01775         <span class="comment">//            dimensions                                            //</span>
<a name="l01776"></a>01776         <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01777"></a>01777         sizeHalfBlock = 1LL &lt;&lt; (measureQubit);                       <span class="comment">// number of state vector elements to sum,</span>
<a name="l01778"></a>01778         <span class="comment">// and then the number to skip</span>
<a name="l01779"></a>01779         sizeBlock     = 2LL * sizeHalfBlock;                           <span class="comment">// size of blocks (pairs of measure and skip entries)</span>
<a name="l01780"></a>01780 
<a name="l01781"></a>01781         <span class="comment">// initialise returned value</span>
<a name="l01782"></a>01782         totalProbability = 0.0;
<a name="l01783"></a>01783 
<a name="l01784"></a>01784         <span class="comment">// initialise correction for kahan summation</span>
<a name="l01785"></a>01785         <span class="keywordflow">if</span> (<a class="code" href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>) printf(<span class="stringliteral">&quot;sizeHalfBlock=%Ld sizeBlock=%Ld numTasks=%Ld\n&quot;</span>,sizeHalfBlock,sizeBlock,numTasks);
<a name="l01786"></a>01786 
<a name="l01787"></a>01787         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01788"></a>01788         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01789"></a>01789 
<a name="l01790"></a>01790 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01791"></a>01791 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01792"></a>01792 <span class="preprocessor">        shared    (numTasks,sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span>
<a name="l01793"></a>01793 <span class="preprocessor">        private   (thisTask,thisBlock,index) \</span>
<a name="l01794"></a>01794 <span class="preprocessor">        reduction ( +:totalProbability )</span>
<a name="l01795"></a>01795 <span class="preprocessor"></span><span class="preprocessor"># endif </span>
<a name="l01796"></a>01796 <span class="preprocessor"></span>        {
<a name="l01797"></a>01797 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01798"></a>01798 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule  (static)</span>
<a name="l01799"></a>01799 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01800"></a>01800 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01801"></a>01801                         thisBlock = thisTask / sizeHalfBlock;
<a name="l01802"></a>01802                         index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01803"></a>01803 
<a name="l01804"></a>01804                         <span class="keywordflow">if</span> (index&lt;0){ printf(<span class="stringliteral">&quot;ABORTING as index=%Ld with thisBlock = %Ld  thisTask=%Ld \n&quot;</span>, index,thisBlock,thisTask); exit(1);}
<a name="l01805"></a>01805 
<a name="l01806"></a>01806                         <span class="comment">// summation -- simple implementation</span>
<a name="l01807"></a>01807                         totalProbability += stateVecReal[index]*stateVecReal[index]
<a name="l01808"></a>01808                                 + stateVecImag[index]*stateVecImag[index];
<a name="l01809"></a>01809 
<a name="l01810"></a>01810                         <span class="comment">/*</span>
<a name="l01811"></a>01811 <span class="comment">                        // summation -- kahan correction</span>
<a name="l01812"></a>01812 <span class="comment">                        y = stateVecReal[index]*stateVecReal[index]</span>
<a name="l01813"></a>01813 <span class="comment">                        + stateVecImag[index]*stateVecImag[index] - c;</span>
<a name="l01814"></a>01814 <span class="comment">                        t = totalProbability + y;</span>
<a name="l01815"></a>01815 <span class="comment">                        c = (t - totalProbability) - y;</span>
<a name="l01816"></a>01816 <span class="comment">                        totalProbability = t;</span>
<a name="l01817"></a>01817 <span class="comment">                        */</span>
<a name="l01818"></a>01818 
<a name="l01819"></a>01819                 }
<a name="l01820"></a>01820         }
<a name="l01821"></a>01821         <span class="keywordflow">return</span> totalProbability;
<a name="l01822"></a>01822 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8f10aabf9f607f19093aee54630caa21"></a><!-- doxytag: member="qubits.c::getEnvironmentString" ref="a8f10aabf9f607f19093aee54630caa21" args="(QuESTEnv env, MultiQubit multiQubit, char str[200])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getEnvironmentString </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>str</em>[200]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00164">164</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::numQubits</a>, and <a class="el" href="qubits_8h_source.html#l00062">QuESTEnv::numRanks</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00164"></a>00164                                                                              {
<a name="l00165"></a>00165         <span class="keywordtype">int</span> numThreads=1;
<a name="l00166"></a>00166 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00167"></a>00167 <span class="preprocessor"></span>        numThreads=omp_get_max_threads(); 
<a name="l00168"></a>00168 <span class="preprocessor"># endif</span>
<a name="l00169"></a>00169 <span class="preprocessor"></span>        sprintf(str, <span class="stringliteral">&quot;%dqubits_CPU_%dranksx%dthreads&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>, numThreads);
<a name="l00170"></a>00170 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a799b10447d6dbdaf960a4d3eedd22014"></a><!-- doxytag: member="qubits.c::getProbEl" ref="a799b10447d6dbdaf960a4d3eedd22014" args="(MultiQubit multiQubit, long long int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL getProbEl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>index</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get probability of the state at an index in the state vector. </p>
<p>Get the probability of the state at an index in the state vector.</p>
<p>For debugging purposes. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing a set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>index</em>&nbsp;</td><td>index in state vector of probability amplitudes </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>real component * real component + imag component * imag component </dd></dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l02152">2152</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00097">getImagAmpEl()</a>, <a class="el" href="qubits__env__local_8c_source.html#l00093">getRealAmpEl()</a>, and <a class="el" href="precision_8h_source.html#l00023">REAL</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02152"></a>02152                                                           {
<a name="l02153"></a>02153         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> real;
<a name="l02154"></a>02154         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> imag;
<a name="l02155"></a>02155         real = <a class="code" href="qubits_8h.html#a317b786f577fa6bc136ea7f0ee7330a7" title="Get the real component of the probability amplitude at an index in the state vector...">getRealAmpEl</a>(multiQubit, index);
<a name="l02156"></a>02156         imag = <a class="code" href="qubits_8h.html#a3615f76fd5f57008d9b74bbd10533dd0" title="Get the imaginary component of the probability amplitude at an index in the state...">getImagAmpEl</a>(multiQubit, index);
<a name="l02157"></a>02157         <span class="keywordflow">return</span> real*real + imag*imag;
<a name="l02158"></a>02158 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae6a897066979fc52d977007d959ca09d"></a><!-- doxytag: member="qubits.c::hadamardDistributed" ref="ae6a897066979fc52d977007d959ca09d" args="(MultiQubit multiQubit, const int targetQubit, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut, int updateUpper)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hadamardDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>updateUpper</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{1,1},{1,-1}}/sqrt2. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecIn</em>&nbsp;</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>updateUpper</em>&nbsp;</td><td>flag, 1: updating upper values, 0: updating lower values in block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01546">1546</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, and <a class="el" href="precision_8h_source.html#l00023">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00616">hadamard()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01551"></a>01551 {
<a name="l01552"></a>01552 
<a name="l01553"></a>01553         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l01554"></a>01554         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01555"></a>01555         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01556"></a>01556 
<a name="l01557"></a>01557         <span class="keywordtype">int</span> sign;
<a name="l01558"></a>01558         <span class="keywordflow">if</span> (updateUpper) sign=1;
<a name="l01559"></a>01559         <span class="keywordflow">else</span> sign=-1;
<a name="l01560"></a>01560 
<a name="l01561"></a>01561         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> recRoot2 = 1.0/sqrt(2);
<a name="l01562"></a>01562 
<a name="l01563"></a>01563         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01564"></a>01564         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01565"></a>01565         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01566"></a>01566 
<a name="l01567"></a>01567 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01568"></a>01568 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01569"></a>01569 <span class="preprocessor">        default  (none) \</span>
<a name="l01570"></a>01570 <span class="preprocessor">        shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l01571"></a>01571 <span class="preprocessor">                        recRoot2, sign) \</span>
<a name="l01572"></a>01572 <span class="preprocessor">        private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span>
<a name="l01573"></a>01573 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01574"></a>01574 <span class="preprocessor"></span>        {
<a name="l01575"></a>01575 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01576"></a>01576 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01577"></a>01577 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01578"></a>01578 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01579"></a>01579                         <span class="comment">// store current state vector values in temp variables</span>
<a name="l01580"></a>01580                         stateRealUp = stateVecRealUp[thisTask];
<a name="l01581"></a>01581                         stateImagUp = stateVecImagUp[thisTask];
<a name="l01582"></a>01582 
<a name="l01583"></a>01583                         stateRealLo = stateVecRealLo[thisTask];
<a name="l01584"></a>01584                         stateImagLo = stateVecImagLo[thisTask];
<a name="l01585"></a>01585 
<a name="l01586"></a>01586                         stateVecRealOut[thisTask] = recRoot2*(stateRealUp + sign*stateRealLo);
<a name="l01587"></a>01587                         stateVecImagOut[thisTask] = recRoot2*(stateImagUp + sign*stateImagLo);
<a name="l01588"></a>01588                 }
<a name="l01589"></a>01589         }
<a name="l01590"></a>01590 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa9f0718b4dd794a3e1b143e3b153bfc5"></a><!-- doxytag: member="qubits.c::hadamardLocal" ref="aa9f0718b4dd794a3e1b143e3b153bfc5" args="(MultiQubit multiQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hadamardLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{1,1},{1,-1}}/sqrt2. </p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01484">1484</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00172">hadamard()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01485"></a>01485 {
<a name="l01486"></a>01486         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01487"></a>01487         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01488"></a>01488              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01489"></a>01489 
<a name="l01490"></a>01490         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l01491"></a>01491         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01492"></a>01492         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01493"></a>01493 
<a name="l01494"></a>01494         <span class="comment">// set dimensions</span>
<a name="l01495"></a>01495         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01496"></a>01496         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01497"></a>01497 
<a name="l01498"></a>01498         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l01499"></a>01499         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01500"></a>01500         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01501"></a>01501 
<a name="l01502"></a>01502         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> recRoot2 = 1.0/sqrt(2);
<a name="l01503"></a>01503 
<a name="l01504"></a>01504 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01505"></a>01505 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01506"></a>01506 <span class="preprocessor">        default  (none) \</span>
<a name="l01507"></a>01507 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, recRoot2) \</span>
<a name="l01508"></a>01508 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span>
<a name="l01509"></a>01509 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01510"></a>01510 <span class="preprocessor"></span>        {
<a name="l01511"></a>01511 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01512"></a>01512 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01513"></a>01513 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01514"></a>01514 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01515"></a>01515                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l01516"></a>01516                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01517"></a>01517                         indexLo     = indexUp + sizeHalfBlock;
<a name="l01518"></a>01518 
<a name="l01519"></a>01519                         stateRealUp = stateVecReal[indexUp];
<a name="l01520"></a>01520                         stateImagUp = stateVecImag[indexUp];
<a name="l01521"></a>01521 
<a name="l01522"></a>01522                         stateRealLo = stateVecReal[indexLo];
<a name="l01523"></a>01523                         stateImagLo = stateVecImag[indexLo];
<a name="l01524"></a>01524 
<a name="l01525"></a>01525                         stateVecReal[indexUp] = recRoot2*(stateRealUp + stateRealLo);
<a name="l01526"></a>01526                         stateVecImag[indexUp] = recRoot2*(stateImagUp + stateImagLo);
<a name="l01527"></a>01527 
<a name="l01528"></a>01528                         stateVecReal[indexLo] = recRoot2*(stateRealUp - stateRealLo);
<a name="l01529"></a>01529                         stateVecImag[indexLo] = recRoot2*(stateImagUp - stateImagLo);
<a name="l01530"></a>01530                 } 
<a name="l01531"></a>01531         }
<a name="l01532"></a>01532 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a433876ee9f3bcc54af346300f571fc3c"></a><!-- doxytag: member="qubits.c::initializeStateFromSingleFile" ref="a433876ee9f3bcc54af346300f571fc3c" args="(MultiQubit *multiQubit, char filename[200], QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initializeStateFromSingleFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a> *&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>filename</em>[200], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>fix -- format needs to work for single precision values </p>
</p>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00336">336</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numChunks</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>, and <a class="el" href="qubits__env__local_8c_source.html#l00032">syncQuESTEnv()</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00470">test_controlledCompactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00249">test_controlledNot()</a>, <a class="el" href="runTests_8c_source.html#l00283">test_controlledPhaseGate()</a>, <a class="el" href="runTests_8c_source.html#l00165">test_hadamard()</a>, <a class="el" href="runTests_8c_source.html#l00055">test_initStatePlus()</a>, <a class="el" href="runTests_8c_source.html#l00032">test_initStateZero()</a>, <a class="el" href="runTests_8c_source.html#l00315">test_multiControlledPhaseGate()</a>, <a class="el" href="runTests_8c_source.html#l00567">test_multiControlledUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00193">test_sGate()</a>, <a class="el" href="runTests_8c_source.html#l00078">test_sigmaX()</a>, <a class="el" href="runTests_8c_source.html#l00107">test_sigmaY()</a>, <a class="el" href="runTests_8c_source.html#l00136">test_sigmaZ()</a>, and <a class="el" href="runTests_8c_source.html#l00221">test_tGate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00336"></a>00336                                                                                             {
<a name="l00337"></a>00337         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;
<a name="l00338"></a>00338         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> indexInChunk, totalIndex;
<a name="l00339"></a>00339 
<a name="l00340"></a>00340         chunkSize = multiQubit-&gt;<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00341"></a>00341         stateVecSize = chunkSize*multiQubit-&gt;<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>;
<a name="l00342"></a>00342 
<a name="l00343"></a>00343         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00344"></a>00344         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00345"></a>00345         
<a name="l00346"></a>00346         FILE *fp;
<a name="l00347"></a>00347         <span class="keywordtype">char</span> line[200];
<a name="l00348"></a>00348 
<a name="l00349"></a>00349         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rank=0; rank&lt;(multiQubit-&gt;<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>); rank++){
<a name="l00350"></a>00350                 <span class="keywordflow">if</span> (rank==multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>){
<a name="l00351"></a>00351                         fp = fopen(filename, <span class="stringliteral">&quot;r&quot;</span>);
<a name="l00352"></a>00352                         indexInChunk = 0; totalIndex = 0;
<a name="l00353"></a>00353                         <span class="keywordflow">while</span> (fgets(line, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)*200, fp) != NULL &amp;&amp; totalIndex&lt;stateVecSize){
<a name="l00354"></a>00354                                 <span class="keywordflow">if</span> (line[0]!=<span class="charliteral">&apos;#&apos;</span>){
<a name="l00355"></a>00355                                         <span class="keywordtype">int</span> chunkId = totalIndex/chunkSize;
<a name="l00356"></a>00356                                         <span class="keywordflow">if</span> (chunkId==multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>){
<a name="l00358"></a>00358                                                 sscanf(line, <span class="stringliteral">&quot;%lf, %lf&quot;</span>, &amp;(stateVecReal[indexInChunk]), 
<a name="l00359"></a>00359                                                                 &amp;(stateVecImag[indexInChunk]));
<a name="l00360"></a>00360                                                 indexInChunk += 1;
<a name="l00361"></a>00361                                         }
<a name="l00362"></a>00362                                         totalIndex += 1;
<a name="l00363"></a>00363                                 }
<a name="l00364"></a>00364                         }       
<a name="l00365"></a>00365                         fclose(fp);
<a name="l00366"></a>00366                 }
<a name="l00367"></a>00367                 <a class="code" href="qubits_8h.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77" title="Guarantees that all code up to the given point has been executed on all nodes.">syncQuESTEnv</a>(env);
<a name="l00368"></a>00368         }
<a name="l00369"></a>00369 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a03b3577a891731d505bc4b879fcca9d3"></a><!-- doxytag: member="qubits.c::initStateDebug" ref="a03b3577a891731d505bc4b879fcca9d3" args="(MultiQubit *multiQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initStateDebug </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a> *&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialise the state vector of probability amplitudes to an (unphysical) state with each component of each probability amplitude a unique floating point value. </p>
<p>For debugging processes </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits to be initialised </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00304">304</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00341">test_compactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00470">test_controlledCompactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00249">test_controlledNot()</a>, <a class="el" href="runTests_8c_source.html#l00283">test_controlledPhaseGate()</a>, <a class="el" href="runTests_8c_source.html#l00515">test_controlledUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00165">test_hadamard()</a>, <a class="el" href="runTests_8c_source.html#l00315">test_multiControlledPhaseGate()</a>, <a class="el" href="runTests_8c_source.html#l00567">test_multiControlledUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00193">test_sGate()</a>, <a class="el" href="runTests_8c_source.html#l00078">test_sigmaX()</a>, <a class="el" href="runTests_8c_source.html#l00107">test_sigmaY()</a>, <a class="el" href="runTests_8c_source.html#l00136">test_sigmaZ()</a>, <a class="el" href="runTests_8c_source.html#l00221">test_tGate()</a>, and <a class="el" href="runTests_8c_source.html#l00403">test_unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00305"></a>00305 {
<a name="l00306"></a>00306         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize;
<a name="l00307"></a>00307         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00308"></a>00308 
<a name="l00309"></a>00309         <span class="comment">// dimension of the state vector</span>
<a name="l00310"></a>00310         chunkSize = multiQubit-&gt;<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00311"></a>00311 
<a name="l00312"></a>00312         <span class="comment">// Can&apos;t use multiQubit-&gt;stateVec as a private OMP var</span>
<a name="l00313"></a>00313         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00314"></a>00314         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00315"></a>00315 
<a name="l00316"></a>00316         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> chunkOffset = (2.0*chunkSize*multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>)/10.0;
<a name="l00317"></a>00317 
<a name="l00318"></a>00318         <span class="comment">// initialise the state to |0000..0000&gt;</span>
<a name="l00319"></a>00319 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00320"></a>00320 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00321"></a>00321 <span class="preprocessor">        default  (none) \</span>
<a name="l00322"></a>00322 <span class="preprocessor">        shared   (chunkSize, stateVecReal, stateVecImag, chunkOffset) \</span>
<a name="l00323"></a>00323 <span class="preprocessor">        private  (index) </span>
<a name="l00324"></a>00324 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00325"></a>00325 <span class="preprocessor"></span>        {
<a name="l00326"></a>00326 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00327"></a>00327 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00328"></a>00328 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00329"></a>00329 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {
<a name="l00330"></a>00330                         stateVecReal[index] = chunkOffset + (index*2.0)/10.0;
<a name="l00331"></a>00331                         stateVecImag[index] = chunkOffset + (index*2.0+1.0)/10.0;
<a name="l00332"></a>00332                 }
<a name="l00333"></a>00333         }
<a name="l00334"></a>00334 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7169fd0442cbc3418f3fac4d13363ca2"></a><!-- doxytag: member="qubits.c::initStateOfSingleQubit" ref="a7169fd0442cbc3418f3fac4d13363ca2" args="(MultiQubit *multiQubit, int qubitId, int outcome)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initStateOfSingleQubit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a> *&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>qubitId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outcome</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialise the state vector of probability amplitudes such that one qubit is set to 'outcome' and all other qubits are in an equal superposition of zero and one. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits to be initialised </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>qubitId</em>&nbsp;</td><td>id of qubit to set to state 'outcome' </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>value</em>&nbsp;</td><td>of qubit 'qubitId' </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00257">257</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l00015">DEBUG</a>, <a class="el" href="qubits_8c_source.html#l01887">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numChunks</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00694">test_collapseToOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00649">test_findProbabilityOfOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00759">test_measure()</a>, and <a class="el" href="runTests_8c_source.html#l00807">test_measureWithStats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00258"></a>00258 {
<a name="l00259"></a>00259         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;
<a name="l00260"></a>00260         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00261"></a>00261         <span class="keywordtype">int</span> bit;
<a name="l00262"></a>00262         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l00263"></a>00263 
<a name="l00264"></a>00264         <span class="comment">// dimension of the state vector</span>
<a name="l00265"></a>00265         chunkSize = multiQubit-&gt;<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00266"></a>00266         stateVecSize = chunkSize*multiQubit-&gt;<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>;
<a name="l00267"></a>00267         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> normFactor = 1.0/sqrt(stateVecSize/2);
<a name="l00268"></a>00268 
<a name="l00269"></a>00269         <span class="comment">// Can&apos;t use multiQubit-&gt;stateVec as a private OMP var</span>
<a name="l00270"></a>00270         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00271"></a>00271         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00272"></a>00272 
<a name="l00273"></a>00273         <span class="comment">// initialise the state to |0000..0000&gt;</span>
<a name="l00274"></a>00274 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00275"></a>00275 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00276"></a>00276 <span class="preprocessor">        default  (none) \</span>
<a name="l00277"></a>00277 <span class="preprocessor">        shared   (chunkSize, stateVecReal, stateVecImag, normFactor, qubitId, outcome) \</span>
<a name="l00278"></a>00278 <span class="preprocessor">        private  (index, bit) </span>
<a name="l00279"></a>00279 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00280"></a>00280 <span class="preprocessor"></span>        {
<a name="l00281"></a>00281 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00282"></a>00282 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00283"></a>00283 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00284"></a>00284 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {
<a name="l00285"></a>00285                         bit = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a>(qubitId, index+chunkId*chunkSize);
<a name="l00286"></a>00286                         <span class="keywordflow">if</span> (bit==outcome) {
<a name="l00287"></a>00287                                 stateVecReal[index] = normFactor;
<a name="l00288"></a>00288                                 stateVecImag[index] = 0.0;
<a name="l00289"></a>00289                         } <span class="keywordflow">else</span> {
<a name="l00290"></a>00290                                 stateVecReal[index] = 0.0;
<a name="l00291"></a>00291                                 stateVecImag[index] = 0.0;
<a name="l00292"></a>00292                         }
<a name="l00293"></a>00293                 }
<a name="l00294"></a>00294         }
<a name="l00295"></a>00295         <span class="keywordflow">if</span> (<a class="code" href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>) printf(<span class="stringliteral">&quot;COMPLETED INIT\n&quot;</span>);
<a name="l00296"></a>00296 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a43bcb279fc9717fbd06a19cdef48b9d8"></a><!-- doxytag: member="qubits.c::initStatePlus" ref="a43bcb279fc9717fbd06a19cdef48b9d8" args="(MultiQubit *multiQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initStatePlus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a> *&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialise the state vector of probability amplitudes for a set of qubits to an equal real superposition of all amplitudes: |+++. </p>
<p>..++&gt; </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits to be initialised </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00218">218</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8c_source.html#l00015">DEBUG</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numChunks</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00694">test_collapseToOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00341">test_compactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00649">test_findProbabilityOfOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00055">test_initStatePlus()</a>, <a class="el" href="runTests_8c_source.html#l00759">test_measure()</a>, <a class="el" href="runTests_8c_source.html#l00807">test_measureWithStats()</a>, and <a class="el" href="runTests_8c_source.html#l00403">test_unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00219"></a>00219 {
<a name="l00220"></a>00220         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;
<a name="l00221"></a>00221         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00222"></a>00222 
<a name="l00223"></a>00223         <span class="comment">// dimension of the state vector</span>
<a name="l00224"></a>00224         chunkSize = multiQubit-&gt;<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00225"></a>00225         stateVecSize = chunkSize*multiQubit-&gt;<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>;
<a name="l00226"></a>00226         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> normFactor = 1.0/sqrt(stateVecSize);
<a name="l00227"></a>00227 
<a name="l00228"></a>00228         <span class="comment">// Can&apos;t use multiQubit-&gt;stateVec as a private OMP var</span>
<a name="l00229"></a>00229         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00230"></a>00230         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00231"></a>00231 
<a name="l00232"></a>00232         <span class="comment">// initialise the state to |0000..0000&gt;</span>
<a name="l00233"></a>00233 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00234"></a>00234 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00235"></a>00235 <span class="preprocessor">        default  (none) \</span>
<a name="l00236"></a>00236 <span class="preprocessor">        shared   (chunkSize, stateVecReal, stateVecImag, normFactor) \</span>
<a name="l00237"></a>00237 <span class="preprocessor">        private  (index) </span>
<a name="l00238"></a>00238 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00239"></a>00239 <span class="preprocessor"></span>        {
<a name="l00240"></a>00240 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00241"></a>00241 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00242"></a>00242 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00243"></a>00243 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {
<a name="l00244"></a>00244                         stateVecReal[index] = normFactor;
<a name="l00245"></a>00245                         stateVecImag[index] = 0.0;
<a name="l00246"></a>00246                 }
<a name="l00247"></a>00247         }
<a name="l00248"></a>00248         <span class="keywordflow">if</span> (<a class="code" href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>) printf(<span class="stringliteral">&quot;COMPLETED INIT\n&quot;</span>);
<a name="l00249"></a>00249 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="acb5b2eff794339090004d29f02a70d9a"></a><!-- doxytag: member="qubits.c::initStateZero" ref="acb5b2eff794339090004d29f02a70d9a" args="(MultiQubit *multiQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initStateZero </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a> *&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialise the state vector of probability amplitudes for a set of qubits to the zero state: |000...00&gt;. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits to be initialised </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00176">176</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l00015">DEBUG</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="3sat_8c_source.html#l00101">main()</a>, <a class="el" href="runTests_8c_source.html#l00694">test_collapseToOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00649">test_findProbabilityOfOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00032">test_initStateZero()</a>, <a class="el" href="runTests_8c_source.html#l00759">test_measure()</a>, and <a class="el" href="runTests_8c_source.html#l00807">test_measureWithStats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00177"></a>00177 {
<a name="l00178"></a>00178         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l00179"></a>00179         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00180"></a>00180 
<a name="l00181"></a>00181         <span class="comment">// dimension of the state vector</span>
<a name="l00182"></a>00182         stateVecSize = multiQubit-&gt;<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00183"></a>00183 
<a name="l00184"></a>00184         <span class="comment">// Can&apos;t use multiQubit-&gt;stateVec as a private OMP var</span>
<a name="l00185"></a>00185         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00186"></a>00186         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00187"></a>00187 
<a name="l00188"></a>00188         <span class="comment">// initialise the state to |0000..0000&gt;</span>
<a name="l00189"></a>00189 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00190"></a>00190 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00191"></a>00191 <span class="preprocessor">        default  (none) \</span>
<a name="l00192"></a>00192 <span class="preprocessor">        shared   (stateVecSize, stateVecReal, stateVecImag) \</span>
<a name="l00193"></a>00193 <span class="preprocessor">        private  (index) </span>
<a name="l00194"></a>00194 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00195"></a>00195 <span class="preprocessor"></span>        {
<a name="l00196"></a>00196 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00197"></a>00197 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00198"></a>00198 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00199"></a>00199 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l00200"></a>00200                         stateVecReal[index] = 0.0;
<a name="l00201"></a>00201                         stateVecImag[index] = 0.0;
<a name="l00202"></a>00202                 }
<a name="l00203"></a>00203         }
<a name="l00204"></a>00204 
<a name="l00205"></a>00205         <span class="keywordflow">if</span> (multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>==0){
<a name="l00206"></a>00206                 <span class="comment">// zero state |0000..0000&gt; has probability 1</span>
<a name="l00207"></a>00207                 stateVecReal[0] = 1.0;
<a name="l00208"></a>00208                 stateVecImag[0] = 0.0;
<a name="l00209"></a>00209         }
<a name="l00210"></a>00210 
<a name="l00211"></a>00211         <span class="keywordflow">if</span> (<a class="code" href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>) printf(<span class="stringliteral">&quot;COMPLETED INIT\n&quot;</span>);
<a name="l00212"></a>00212 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="afc1835c6b43b6e59ce7df7b13f274fc7"></a><!-- doxytag: member="qubits.c::multiControlledPhaseGate" ref="afc1835c6b43b6e59ce7df7b13f274fc7" args="(MultiQubit multiQubit, int *controlQubits, int numControlQubits)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multiControlledPhaseGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>controlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numControlQubits</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The multiple qubit control phase gate. </p>
<p>For each state, if all input qubits are equal to one, multiply the amplitude of that state by -1. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubits</em>&nbsp;</td><td>array of input qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>numControlQubits</em>&nbsp;</td><td>number of input qubits </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01939">1939</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::numQubits</a>, <a class="el" href="qubits__env__local_8c_source.html#l00242">QuESTAssert()</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00315">test_multiControlledPhaseGate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01940"></a>01940 {
<a name="l01941"></a>01941         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l01942"></a>01942         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l01943"></a>01943         
<a name="l01944"></a>01944         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01945"></a>01945         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01946"></a>01946 
<a name="l01947"></a>01947     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(numControlQubits &gt; 0 &amp;&amp; numControlQubits &lt;= multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 4, __func__);
<a name="l01948"></a>01948     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> mask=0;
<a name="l01949"></a>01949     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;numControlQubits; i++) mask = mask | (1LL&lt;&lt;controlQubits[i]);
<a name="l01950"></a>01950     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(mask &gt;=0 &amp;&amp; mask &lt;= (1LL&lt;&lt;multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>)-1, 2, __func__);
<a name="l01951"></a>01951 
<a name="l01952"></a>01952         stateVecSize = multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01953"></a>01953         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01954"></a>01954         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01955"></a>01955 
<a name="l01956"></a>01956 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01957"></a>01957 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01958"></a>01958 <span class="preprocessor">        default  (none)                      \</span>
<a name="l01959"></a>01959 <span class="preprocessor">        shared   (stateVecSize, stateVecReal,stateVecImag, mask ) \</span>
<a name="l01960"></a>01960 <span class="preprocessor">        private  (index)</span>
<a name="l01961"></a>01961 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01962"></a>01962 <span class="preprocessor"></span>        {
<a name="l01963"></a>01963 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01964"></a>01964 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01965"></a>01965 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01966"></a>01966 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l01967"></a>01967                         <span class="keywordflow">if</span> (mask == (mask &amp; (index+chunkId*chunkSize)) ){
<a name="l01968"></a>01968                                 stateVecReal [index] = - stateVecReal [index];
<a name="l01969"></a>01969                                 stateVecImag [index] = - stateVecImag [index];
<a name="l01970"></a>01970                         }
<a name="l01971"></a>01971                 }
<a name="l01972"></a>01972         }
<a name="l01973"></a>01973 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9dbf856ebeea0cf0a3ee5aae6782f2d2"></a><!-- doxytag: member="qubits.c::multiControlledUnitaryDistributed" ref="a9dbf856ebeea0cf0a3ee5aae6782f2d2" args="(MultiQubit multiQubit, const int targetQubit, long long int mask, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multiControlledUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply a unitary operation to a single qubit in the state vector of probability amplitudes, given a subset of the state vector with upper and lower block values stored seperately. </p>
<p>Only perform the rotation where all the control qubits are 1.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>qubit to determine whether or not to perform a rotation </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot1</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot2</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01120">1120</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, and <a class="el" href="precision_8h_source.html#l00023">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00455">multiControlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01127"></a>01127 {
<a name="l01128"></a>01128 
<a name="l01129"></a>01129         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l01130"></a>01130         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01131"></a>01131         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01132"></a>01132         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01133"></a>01133         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01134"></a>01134 
<a name="l01135"></a>01135         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l01136"></a>01136         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l01137"></a>01137         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01138"></a>01138         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01139"></a>01139         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01140"></a>01140 
<a name="l01141"></a>01141 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01142"></a>01142 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01143"></a>01143 <span class="preprocessor">        default  (none) \</span>
<a name="l01144"></a>01144 <span class="preprocessor">        shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l01145"></a>01145 <span class="preprocessor">                        rot1Real,rot1Imag, rot2Real,rot2Imag, mask) \</span>
<a name="l01146"></a>01146 <span class="preprocessor">        private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span>
<a name="l01147"></a>01147 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01148"></a>01148 <span class="preprocessor"></span>        {
<a name="l01149"></a>01149 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01150"></a>01150 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01151"></a>01151 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01152"></a>01152 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01153"></a>01153                         <span class="keywordflow">if</span> (mask == (mask &amp; (thisTask+chunkId*chunkSize)) ){
<a name="l01154"></a>01154                                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l01155"></a>01155                                 stateRealUp = stateVecRealUp[thisTask];
<a name="l01156"></a>01156                                 stateImagUp = stateVecImagUp[thisTask];
<a name="l01157"></a>01157 
<a name="l01158"></a>01158                                 stateRealLo = stateVecRealLo[thisTask];
<a name="l01159"></a>01159                                 stateImagLo = stateVecImagLo[thisTask];
<a name="l01160"></a>01160 
<a name="l01161"></a>01161                 stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp 
<a name="l01162"></a>01162                     + rot2Real*stateRealLo - rot2Imag*stateImagLo;
<a name="l01163"></a>01163                 stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp 
<a name="l01164"></a>01164                     + rot2Real*stateImagLo + rot2Imag*stateRealLo;
<a name="l01165"></a>01165                         }
<a name="l01166"></a>01166                 }
<a name="l01167"></a>01167         }
<a name="l01168"></a>01168 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1309eabcba3cb97fbc3cd2e606d17766"></a><!-- doxytag: member="qubits.c::multiControlledUnitaryLocal" ref="a1309eabcba3cb97fbc3cd2e606d17766" args="(MultiQubit multiQubit, const int targetQubit, long long int mask, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multiControlledUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a control qubit. </p>
<p>Only perform the rotation for elements where the control qubit is one.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>perform rotation if this qubit is 1 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>alpha</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>beta</em>&nbsp;</td><td>rotation angle </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00840">840</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00027">ComplexMatrix2::r0c0</a>, <a class="el" href="qubits_8h_source.html#l00027">ComplexMatrix2::r0c1</a>, <a class="el" href="qubits_8h_source.html#l00028">ComplexMatrix2::r1c0</a>, <a class="el" href="qubits_8h_source.html#l00028">ComplexMatrix2::r1c1</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00140">multiControlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00842"></a>00842 {
<a name="l00843"></a>00843         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l00844"></a>00844         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l00845"></a>00845              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l00846"></a>00846 
<a name="l00847"></a>00847         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00848"></a>00848         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l00849"></a>00849         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l00850"></a>00850         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00851"></a>00851         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l00852"></a>00852 
<a name="l00853"></a>00853         <span class="comment">// set dimensions</span>
<a name="l00854"></a>00854         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l00855"></a>00855         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l00856"></a>00856 
<a name="l00857"></a>00857         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l00858"></a>00858         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00859"></a>00859         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00860"></a>00860 
<a name="l00861"></a>00861 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00862"></a>00862 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00863"></a>00863 <span class="preprocessor">        default  (none) \</span>
<a name="l00864"></a>00864 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, u, mask) \</span>
<a name="l00865"></a>00865 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span>
<a name="l00866"></a>00866 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00867"></a>00867 <span class="preprocessor"></span>        {
<a name="l00868"></a>00868 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00869"></a>00869 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00870"></a>00870 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00871"></a>00871 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00872"></a>00872 
<a name="l00873"></a>00873                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l00874"></a>00874                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l00875"></a>00875                         indexLo     = indexUp + sizeHalfBlock;
<a name="l00876"></a>00876 
<a name="l00877"></a>00877                         <span class="keywordflow">if</span> (mask == (mask &amp; (indexUp+chunkId*chunkSize)) ){
<a name="l00878"></a>00878                                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l00879"></a>00879                                 stateRealUp = stateVecReal[indexUp];
<a name="l00880"></a>00880                                 stateImagUp = stateVecImag[indexUp];
<a name="l00881"></a>00881 
<a name="l00882"></a>00882                                 stateRealLo = stateVecReal[indexLo];
<a name="l00883"></a>00883                                 stateImagLo = stateVecImag[indexLo];
<a name="l00884"></a>00884 
<a name="l00885"></a>00885 
<a name="l00886"></a>00886                                 <span class="comment">// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]</span>
<a name="l00887"></a>00887                                 stateVecReal[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp 
<a name="l00888"></a>00888                                         + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo - u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;
<a name="l00889"></a>00889                                 stateVecImag[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp 
<a name="l00890"></a>00890                                         + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;
<a name="l00891"></a>00891 
<a name="l00892"></a>00892                                 <span class="comment">// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]</span>
<a name="l00893"></a>00893                                 stateVecReal[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp  - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp 
<a name="l00894"></a>00894                                         + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo  -  u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;
<a name="l00895"></a>00895                                 stateVecImag[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp 
<a name="l00896"></a>00896                                         + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;
<a name="l00897"></a>00897                         }
<a name="l00898"></a>00898                 } 
<a name="l00899"></a>00899         }
<a name="l00900"></a>00900 
<a name="l00901"></a>00901 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af832ed00b02a0597b7fe0b714032c54a"></a><!-- doxytag: member="qubits.c::phaseGateDistributed" ref="af832ed00b02a0597b7fe0b714032c54a" args="(MultiQubit multiQubit, const int targetQubit, enum phaseGateType type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void phaseGateDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a>&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{1,0},{0,p}} where p is a phase term determined by the type argument. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>type</em>&nbsp;</td><td>the type of phase gate to apply -- one of {SIGMA_Z, S_GATE, T_GATE} </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01682">1682</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, <a class="el" href="qubits_8h_source.html#l00066">S_GATE</a>, <a class="el" href="qubits_8h_source.html#l00066">SIGMA_Z</a>, <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>, and <a class="el" href="qubits_8h_source.html#l00066">T_GATE</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00598">phaseGate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01683"></a>01683 {
<a name="l01684"></a>01684         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealLo,stateImagLo;
<a name="l01685"></a>01685         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01686"></a>01686         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01687"></a>01687 
<a name="l01688"></a>01688         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l01689"></a>01689         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01690"></a>01690         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01691"></a>01691 
<a name="l01692"></a>01692         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> recRoot2 = 1.0/sqrt(2);
<a name="l01693"></a>01693 
<a name="l01694"></a>01694 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01695"></a>01695 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01696"></a>01696 <span class="preprocessor">        default  (none) \</span>
<a name="l01697"></a>01697 <span class="preprocessor">        shared   (stateVecReal,stateVecImag, recRoot2, type) \</span>
<a name="l01698"></a>01698 <span class="preprocessor">        private  (thisTask,stateRealLo,stateImagLo) </span>
<a name="l01699"></a>01699 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01700"></a>01700 <span class="preprocessor"></span>        {
<a name="l01701"></a>01701                 <span class="keywordflow">if</span> (type==<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a>){
<a name="l01702"></a>01702 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01703"></a>01703 <span class="preprocessor"></span><span class="preprocessor">                        # pragma omp for schedule (static)</span>
<a name="l01704"></a>01704 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01705"></a>01705 <span class="preprocessor"></span>                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01706"></a>01706                                 stateVecReal[thisTask] = -stateVecReal[thisTask];
<a name="l01707"></a>01707                                 stateVecImag[thisTask] = -stateVecImag[thisTask];
<a name="l01708"></a>01708                         } 
<a name="l01709"></a>01709                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a>){
<a name="l01710"></a>01710 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01711"></a>01711 <span class="preprocessor"></span><span class="preprocessor">                        # pragma omp for schedule (static)</span>
<a name="l01712"></a>01712 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01713"></a>01713 <span class="preprocessor"></span>                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01714"></a>01714                                 stateRealLo = stateVecReal[thisTask];
<a name="l01715"></a>01715                                 stateImagLo = stateVecImag[thisTask];
<a name="l01716"></a>01716 
<a name="l01717"></a>01717                                 stateVecReal[thisTask] = -stateImagLo;
<a name="l01718"></a>01718                                 stateVecImag[thisTask] = stateRealLo;
<a name="l01719"></a>01719                         } 
<a name="l01720"></a>01720                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a>){
<a name="l01721"></a>01721 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01722"></a>01722 <span class="preprocessor"></span><span class="preprocessor">                        # pragma omp for schedule (static)</span>
<a name="l01723"></a>01723 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01724"></a>01724 <span class="preprocessor"></span>                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01725"></a>01725                                 stateRealLo = stateVecReal[thisTask];
<a name="l01726"></a>01726                                 stateImagLo = stateVecImag[thisTask];
<a name="l01727"></a>01727 
<a name="l01728"></a>01728                                 stateVecReal[thisTask] = recRoot2 * (stateRealLo - stateImagLo);
<a name="l01729"></a>01729                                 stateVecImag[thisTask] = recRoot2 * (stateRealLo + stateImagLo);
<a name="l01730"></a>01730                         } 
<a name="l01731"></a>01731                 } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Type %d is an invalid phase gate\n&quot;</span>, type);
<a name="l01732"></a>01732         }
<a name="l01733"></a>01733 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3a54566b73ac84c312d7da4f56ffbc3b"></a><!-- doxytag: member="qubits.c::phaseGateLocal" ref="a3a54566b73ac84c312d7da4f56ffbc3b" args="(MultiQubit multiQubit, const int targetQubit, enum phaseGateType type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void phaseGateLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a>&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{1,0},{0,p}} where p is a phase term determined by the type argument. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>type</em>&nbsp;</td><td>the type of phase gate to apply -- one of {SIGMA_Z, S_GATE, T_GATE} </td></tr>
  </table>
  </dd>
</dl>

<p><p>fix -- can i rewrite this to not use mod?</p>
<p>fix -- can i rewrite this to not use mod?</p>
<p>fix -- can i rewrite this to not use mod? </p>
</p>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01599">1599</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, <a class="el" href="qubits_8h_source.html#l00066">S_GATE</a>, <a class="el" href="qubits_8h_source.html#l00066">SIGMA_Z</a>, <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>, and <a class="el" href="qubits_8h_source.html#l00066">T_GATE</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00166">phaseGate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01600"></a>01600 {
<a name="l01601"></a>01601         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01602"></a>01602         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01603"></a>01603              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01604"></a>01604 
<a name="l01605"></a>01605         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealLo,stateImagLo;
<a name="l01606"></a>01606         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01607"></a>01607         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01608"></a>01608 
<a name="l01609"></a>01609         <span class="comment">// set dimensions</span>
<a name="l01610"></a>01610         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01611"></a>01611         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01612"></a>01612 
<a name="l01613"></a>01613         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l01614"></a>01614         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01615"></a>01615         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01616"></a>01616 
<a name="l01617"></a>01617         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> recRoot2 = 1.0/sqrt(2);
<a name="l01618"></a>01618 
<a name="l01619"></a>01619 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01620"></a>01620 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01621"></a>01621 <span class="preprocessor">        default  (none) \</span>
<a name="l01622"></a>01622 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock,stateVecReal,stateVecImag,recRoot2,type) \</span>
<a name="l01623"></a>01623 <span class="preprocessor">        private  (thisTask,thisBlock,indexUp,indexLo,stateRealLo,stateImagLo) </span>
<a name="l01624"></a>01624 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01625"></a>01625 <span class="preprocessor"></span>        {
<a name="l01626"></a>01626                 <span class="keywordflow">if</span> (type==<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a>){
<a name="l01627"></a>01627 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01628"></a>01628 <span class="preprocessor"></span><span class="preprocessor">                        # pragma omp for schedule (static)</span>
<a name="l01629"></a>01629 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01630"></a>01630 <span class="preprocessor"></span>                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01632"></a>01632                                 thisBlock   = thisTask / sizeHalfBlock;
<a name="l01633"></a>01633                                 indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01634"></a>01634                                 indexLo     = indexUp + sizeHalfBlock;
<a name="l01635"></a>01635 
<a name="l01636"></a>01636                                 stateVecReal[indexLo] = -stateVecReal[indexLo];
<a name="l01637"></a>01637                                 stateVecImag[indexLo] = -stateVecImag[indexLo];
<a name="l01638"></a>01638                         } 
<a name="l01639"></a>01639                 } 
<a name="l01640"></a>01640                 
<a name="l01641"></a>01641                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a>){
<a name="l01642"></a>01642 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01643"></a>01643 <span class="preprocessor"></span><span class="preprocessor">                        # pragma omp for schedule (static)</span>
<a name="l01644"></a>01644 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01645"></a>01645 <span class="preprocessor"></span>                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01647"></a>01647                                 thisBlock   = thisTask / sizeHalfBlock;
<a name="l01648"></a>01648                                 indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01649"></a>01649                                 indexLo     = indexUp + sizeHalfBlock;
<a name="l01650"></a>01650                                 stateRealLo = stateVecReal[indexLo];
<a name="l01651"></a>01651                                 stateImagLo = stateVecImag[indexLo];
<a name="l01652"></a>01652 
<a name="l01653"></a>01653                                 stateVecReal[indexLo] = -stateImagLo;
<a name="l01654"></a>01654                                 stateVecImag[indexLo] = stateRealLo;
<a name="l01655"></a>01655                         } 
<a name="l01656"></a>01656                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a>){
<a name="l01657"></a>01657 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01658"></a>01658 <span class="preprocessor"></span><span class="preprocessor">                        # pragma omp for schedule (static)</span>
<a name="l01659"></a>01659 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01660"></a>01660 <span class="preprocessor"></span>                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01662"></a>01662                                 thisBlock   = thisTask / sizeHalfBlock;
<a name="l01663"></a>01663                                 indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01664"></a>01664                                 indexLo     = indexUp + sizeHalfBlock;
<a name="l01665"></a>01665                                 stateRealLo = stateVecReal[indexLo];
<a name="l01666"></a>01666                                 stateImagLo = stateVecImag[indexLo];
<a name="l01667"></a>01667 
<a name="l01668"></a>01668                                 stateVecReal[indexLo] = recRoot2 * (stateRealLo - stateImagLo);
<a name="l01669"></a>01669                                 stateVecImag[indexLo] = recRoot2 * (stateRealLo + stateImagLo);
<a name="l01670"></a>01670                         } 
<a name="l01671"></a>01671                 } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Type %d is an invalid phase gate\n&quot;</span>, type);
<a name="l01672"></a>01672         }
<a name="l01673"></a>01673 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa5e77e0e64f3a4a3d3f5cc7382bffcd9"></a><!-- doxytag: member="qubits.c::reportMultiQubitParams" ref="aa5e77e0e64f3a4a3d3f5cc7382bffcd9" args="(MultiQubit multiQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportMultiQubitParams </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Report metainformation about a set of qubits: number of qubits, number of probability amplitudes. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment (local, multinode etc) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00153">153</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numChunks</a>, and <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::numQubits</a>.</p>

<p>Referenced by <a class="el" href="3sat_8c_source.html#l00101">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00153"></a>00153                                                   {
<a name="l00154"></a>00154         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = 1L &lt;&lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>;
<a name="l00155"></a>00155         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmpsPerRank = numAmps/multiQubit.<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>;
<a name="l00156"></a>00156         <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>==0){
<a name="l00157"></a>00157                 printf(<span class="stringliteral">&quot;QUBITS:\n&quot;</span>);
<a name="l00158"></a>00158                 printf(<span class="stringliteral">&quot;Number of qubits is %d.\n&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>);
<a name="l00159"></a>00159                 printf(<span class="stringliteral">&quot;Number of amps is %lld.\n&quot;</span>, numAmps);
<a name="l00160"></a>00160                 printf(<span class="stringliteral">&quot;Number of amps per rank is %lld.\n&quot;</span>, numAmpsPerRank);
<a name="l00161"></a>00161         }
<a name="l00162"></a>00162 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a96f4de9ce7fefc7680a44d601fc3d894"></a><!-- doxytag: member="qubits.c::reportState" ref="a96f4de9ce7fefc7680a44d601fc3d894" args="(MultiQubit multiQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Print the current state vector of probability amplitudes for a set of qubits to file. </p>
<p>File format: </p>
<div class="fragment"><pre class="fragment">
real, imag
realComponent1, imagComponent1
realComponent2, imagComponent2
...
realComponentN, imagComponentN
</pre></div><p>File naming convention:</p>
<p>For each node that the program runs on, a file 'state_rank_[node_rank].csv' is generated. If there is more than one node, ranks after the first do not include the header </p>
<div class="fragment"><pre class="fragment">
real, imag
</pre></div><p> so that files are easier to combine. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00107">107</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL_STRING_FORMAT</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00107"></a>00107                                        {
<a name="l00108"></a>00108         FILE *state;
<a name="l00109"></a>00109         <span class="keywordtype">char</span> filename[100];
<a name="l00110"></a>00110         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00111"></a>00111         sprintf(filename, <span class="stringliteral">&quot;state_rank_%d.csv&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>);
<a name="l00112"></a>00112         state = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>);
<a name="l00113"></a>00113         <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>==0) fprintf(state, <span class="stringliteral">&quot;real, imag\n&quot;</span>);
<a name="l00114"></a>00114 
<a name="l00115"></a>00115         <span class="keywordflow">for</span>(index=0; index&lt;multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>; index++){
<a name="l00116"></a>00116                 fprintf(state, <a class="code" href="precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a> <span class="stringliteral">&quot;,&quot;</span> <a class="code" href="precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a> <span class="stringliteral">&quot;\n&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[index], multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[index]);
<a name="l00117"></a>00117         }
<a name="l00118"></a>00118         fclose(state);
<a name="l00119"></a>00119 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a842d6884e063a5865a2232cba56b65ac"></a><!-- doxytag: member="qubits.c::reportStateToScreen" ref="a842d6884e063a5865a2232cba56b65ac" args="(MultiQubit multiQubit, QuESTEnv env, int reportRank)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportStateToScreen </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>reportRank</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Print the current state vector of probability amplitudes for a set of qubits to standard out. </p>
<p>For debugging purposes. Each rank should print output serially. Only print output for systems &lt;= 5 qubits </p>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00124">124</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numChunks</a>, <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL_STRING_FORMAT</a>, <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>, and <a class="el" href="qubits__env__local_8c_source.html#l00032">syncQuESTEnv()</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00020">reportTest()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00124"></a>00124                                                                              {
<a name="l00125"></a>00125         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00126"></a>00126         <span class="keywordtype">int</span> rank;
<a name="l00127"></a>00127         <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>&lt;=5){
<a name="l00128"></a>00128                 <span class="keywordflow">for</span> (rank=0; rank&lt;multiQubit.<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>; rank++){
<a name="l00129"></a>00129                         <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>==rank){
<a name="l00130"></a>00130                                 <span class="keywordflow">if</span> (reportRank) {
<a name="l00131"></a>00131                                         printf(<span class="stringliteral">&quot;Reporting state from rank %d [\n&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>);
<a name="l00132"></a>00132                                         <span class="comment">//printf(&quot;\trank, index, real, imag\n&quot;);</span>
<a name="l00133"></a>00133                                         printf(<span class="stringliteral">&quot;real, imag\n&quot;</span>);
<a name="l00134"></a>00134                                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rank==0) {
<a name="l00135"></a>00135                                         printf(<span class="stringliteral">&quot;Reporting state [\n&quot;</span>);
<a name="l00136"></a>00136                                         printf(<span class="stringliteral">&quot;real, imag\n&quot;</span>);
<a name="l00137"></a>00137                                 }
<a name="l00138"></a>00138 
<a name="l00139"></a>00139                                 <span class="keywordflow">for</span>(index=0; index&lt;multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>; index++){
<a name="l00140"></a>00140                                         printf(<a class="code" href="precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a> <span class="stringliteral">&quot;, &quot;</span> <a class="code" href="precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a> <span class="stringliteral">&quot;\n&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[index], multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[index]);
<a name="l00141"></a>00141                                 }
<a name="l00142"></a>00142                                 <span class="keywordflow">if</span> (reportRank || rank==multiQubit.<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>-1) printf(<span class="stringliteral">&quot;]\n&quot;</span>);
<a name="l00143"></a>00143                         }
<a name="l00144"></a>00144                         <a class="code" href="qubits_8h.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77" title="Guarantees that all code up to the given point has been executed on all nodes.">syncQuESTEnv</a>(env);
<a name="l00145"></a>00145                 }
<a name="l00146"></a>00146         } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Error: reportStateToScreen will not print output for systems of more than 5 qubits.\n&quot;</span>);
<a name="l00147"></a>00147 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7fadb225fc385db789e844c87fcba9e1"></a><!-- doxytag: member="qubits.c::rotateAroundAxis" ref="a7fadb225fc385db789e844c87fcba9e1" args="(MultiQubit multiQubit, const int rotQubit, REAL angle, Vector unitAxis)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotateAroundAxis </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structVector.html">Vector</a>&nbsp;</td>
          <td class="paramname"> <em>unitAxis</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit a certain angle about an axis. </p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rotQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>angle</em>&nbsp;</td><td>angle by which to rotate in radians </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>unitAxis</em>&nbsp;</td><td>unit vector pointing along the axis about which to rotate. Does not need to be normalised </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00434">434</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00101">compactUnitary()</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00033">Vector::x</a>, <a class="el" href="qubits_8h_source.html#l00033">Vector::y</a>, and <a class="el" href="qubits_8h_source.html#l00033">Vector::z</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00434"></a>00434                                                                                              {
<a name="l00435"></a>00435         <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> alpha, beta;
<a name="l00436"></a>00436         alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> = cos(angle/2.0);
<a name="l00437"></a>00437         alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> = -sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#ad4e863651be7d6b7e2b28cd7445a0ccf">z</a>;        
<a name="l00438"></a>00438         beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> = 0;
<a name="l00439"></a>00439         beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> = -sin(angle/2.0)*(unitAxis.<a class="code" href="structVector.html#aac7abe171ba4bada50ed72acba6259fc">x</a> + unitAxis.<a class="code" href="structVector.html#a375ca805d4c808a53d7c4e0c737ae3de">y</a>);
<a name="l00440"></a>00440         <a class="code" href="qubits_8h.html#a03b13dfcabd8c59b50dbdd3af44ba8b2" title="Rotate a single qubit in the state vector of probability amplitudes.">compactUnitary</a>(multiQubit, rotQubit, alpha, beta);
<a name="l00441"></a>00441 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6cc7fa705a2f2e6b486b49c5589d5df5"></a><!-- doxytag: member="qubits.c::rotateX" ref="a6cc7fa705a2f2e6b486b49c5589d5df5" args="(MultiQubit multiQubit, const int rotQubit, REAL angle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotateX </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>angle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit a certain angle about the x-axis. </p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rotQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>angle</em>&nbsp;</td><td>angle by which to rotate in radians </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00452">452</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00101">compactUnitary()</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00033">Vector::x</a>, <a class="el" href="qubits_8h_source.html#l00033">Vector::y</a>, and <a class="el" href="qubits_8h_source.html#l00033">Vector::z</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00452"></a>00452                                                                    {
<a name="l00453"></a>00453         <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> alpha, beta;
<a name="l00454"></a>00454     <a class="code" href="structVector.html">Vector</a> unitAxis = {1, 0, 0};
<a name="l00455"></a>00455         alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> = cos(angle/2.0);
<a name="l00456"></a>00456         alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> = -sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#ad4e863651be7d6b7e2b28cd7445a0ccf">z</a>;        
<a name="l00457"></a>00457         beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> = 0;
<a name="l00458"></a>00458         beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> = -sin(angle/2.0)*(unitAxis.<a class="code" href="structVector.html#aac7abe171ba4bada50ed72acba6259fc">x</a> + unitAxis.<a class="code" href="structVector.html#a375ca805d4c808a53d7c4e0c737ae3de">y</a>);
<a name="l00459"></a>00459         <a class="code" href="qubits_8h.html#a03b13dfcabd8c59b50dbdd3af44ba8b2" title="Rotate a single qubit in the state vector of probability amplitudes.">compactUnitary</a>(multiQubit, rotQubit, alpha, beta);
<a name="l00460"></a>00460 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ace0d3592d38a990e81a434c4e9681500"></a><!-- doxytag: member="qubits.c::rotateY" ref="ace0d3592d38a990e81a434c4e9681500" args="(MultiQubit multiQubit, const int rotQubit, REAL angle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotateY </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>angle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit a certain angle about the y-axis. </p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rotQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>angle</em>&nbsp;</td><td>angle by which to rotate in radians </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00471">471</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00101">compactUnitary()</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00033">Vector::x</a>, <a class="el" href="qubits_8h_source.html#l00033">Vector::y</a>, and <a class="el" href="qubits_8h_source.html#l00033">Vector::z</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00471"></a>00471                                                                    {
<a name="l00472"></a>00472         <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> alpha, beta;
<a name="l00473"></a>00473     <a class="code" href="structVector.html">Vector</a> unitAxis = {0, 1, 0};
<a name="l00474"></a>00474         alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> = cos(angle/2.0);
<a name="l00475"></a>00475         alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> = -sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#ad4e863651be7d6b7e2b28cd7445a0ccf">z</a>;        
<a name="l00476"></a>00476         beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> = 0;
<a name="l00477"></a>00477         beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> = -sin(angle/2.0)*(unitAxis.<a class="code" href="structVector.html#aac7abe171ba4bada50ed72acba6259fc">x</a> + unitAxis.<a class="code" href="structVector.html#a375ca805d4c808a53d7c4e0c737ae3de">y</a>);
<a name="l00478"></a>00478         <a class="code" href="qubits_8h.html#a03b13dfcabd8c59b50dbdd3af44ba8b2" title="Rotate a single qubit in the state vector of probability amplitudes.">compactUnitary</a>(multiQubit, rotQubit, alpha, beta);
<a name="l00479"></a>00479 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="abd621412ad30c1b034f4ce153c4afe10"></a><!-- doxytag: member="qubits.c::rotateZ" ref="abd621412ad30c1b034f4ce153c4afe10" args="(MultiQubit multiQubit, const int rotQubit, REAL angle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotateZ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>angle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit a certain angle about the z-axis. </p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rotQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>angle</em>&nbsp;</td><td>angle by which to rotate in radians </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00490">490</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00101">compactUnitary()</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00033">Vector::x</a>, <a class="el" href="qubits_8h_source.html#l00033">Vector::y</a>, and <a class="el" href="qubits_8h_source.html#l00033">Vector::z</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00490"></a>00490                                                                    {
<a name="l00491"></a>00491         <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> alpha, beta;
<a name="l00492"></a>00492     <a class="code" href="structVector.html">Vector</a> unitAxis = {0, 0, 1};
<a name="l00493"></a>00493         alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> = cos(angle/2.0);
<a name="l00494"></a>00494         alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> = -sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#ad4e863651be7d6b7e2b28cd7445a0ccf">z</a>;        
<a name="l00495"></a>00495         beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> = 0;
<a name="l00496"></a>00496         beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> = -sin(angle/2.0)*(unitAxis.<a class="code" href="structVector.html#aac7abe171ba4bada50ed72acba6259fc">x</a> + unitAxis.<a class="code" href="structVector.html#a375ca805d4c808a53d7c4e0c737ae3de">y</a>);
<a name="l00497"></a>00497         <a class="code" href="qubits_8h.html#a03b13dfcabd8c59b50dbdd3af44ba8b2" title="Rotate a single qubit in the state vector of probability amplitudes.">compactUnitary</a>(multiQubit, rotQubit, alpha, beta);
<a name="l00498"></a>00498 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="adda6c47876a7676488ed0565a19eaa65"></a><!-- doxytag: member="qubits.c::sGate" ref="adda6c47876a7676488ed0565a19eaa65" args="(MultiQubit multiQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01740">1740</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00166">phaseGate()</a>, and <a class="el" href="qubits_8h_source.html#l00066">S_GATE</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00193">test_sGate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01741"></a>01741 {
<a name="l01742"></a>01742                 <a class="code" href="qubits__env__local_8c.html#aae7a8a7f1ccbddb7f76b6c52b746bb43" title="Rotate a single qubit by {{1,0},{0,p}} where p is a phase term determined by the...">phaseGate</a>(multiQubit, targetQubit, <a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a>);
<a name="l01743"></a>01743 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2275fff50824fe47485890ff5a857785"></a><!-- doxytag: member="qubits.c::sigmaXDistributed" ref="a2275fff50824fe47485890ff5a857785" args="(MultiQubit multiQubit, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaXDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{0,1},{1,0}. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecIn</em>&nbsp;</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01237">1237</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, and <a class="el" href="precision_8h_source.html#l00023">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00501">sigmaX()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01240"></a>01240 {
<a name="l01241"></a>01241 
<a name="l01242"></a>01242         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01243"></a>01243         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01244"></a>01244 
<a name="l01245"></a>01245         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealIn=stateVecIn.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagIn=stateVecIn.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01246"></a>01246         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01247"></a>01247 
<a name="l01248"></a>01248 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01249"></a>01249 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01250"></a>01250 <span class="preprocessor">        default  (none) \</span>
<a name="l01251"></a>01251 <span class="preprocessor">        shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut) \</span>
<a name="l01252"></a>01252 <span class="preprocessor">        private  (thisTask)</span>
<a name="l01253"></a>01253 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01254"></a>01254 <span class="preprocessor"></span>        {
<a name="l01255"></a>01255 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01256"></a>01256 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01257"></a>01257 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01258"></a>01258 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01259"></a>01259                         stateVecRealOut[thisTask] = stateVecRealIn[thisTask];
<a name="l01260"></a>01260                         stateVecImagOut[thisTask] = stateVecImagIn[thisTask];
<a name="l01261"></a>01261                 }
<a name="l01262"></a>01262         }
<a name="l01263"></a>01263 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a74822fd86bb5d81766e6e8dbdcd62df1"></a><!-- doxytag: member="qubits.c::sigmaXLocal" ref="a74822fd86bb5d81766e6e8dbdcd62df1" args="(MultiQubit multiQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaXLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{0,1},{1,0}. </p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01177">1177</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00154">sigmaX()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01178"></a>01178 {
<a name="l01179"></a>01179         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01180"></a>01180         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01181"></a>01181              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01182"></a>01182 
<a name="l01183"></a>01183         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateImagUp;
<a name="l01184"></a>01184         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01185"></a>01185         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01186"></a>01186 
<a name="l01187"></a>01187         <span class="comment">// set dimensions</span>
<a name="l01188"></a>01188         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01189"></a>01189         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01190"></a>01190 
<a name="l01191"></a>01191         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l01192"></a>01192         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01193"></a>01193         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01194"></a>01194 
<a name="l01195"></a>01195 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01196"></a>01196 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01197"></a>01197 <span class="preprocessor">        default  (none) \</span>
<a name="l01198"></a>01198 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span>
<a name="l01199"></a>01199 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp) </span>
<a name="l01200"></a>01200 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01201"></a>01201 <span class="preprocessor"></span>        {
<a name="l01202"></a>01202 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01203"></a>01203 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01204"></a>01204 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01205"></a>01205 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01206"></a>01206                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l01207"></a>01207                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01208"></a>01208                         indexLo     = indexUp + sizeHalfBlock;
<a name="l01209"></a>01209 
<a name="l01210"></a>01210                         stateRealUp = stateVecReal[indexUp];
<a name="l01211"></a>01211                         stateImagUp = stateVecImag[indexUp];
<a name="l01212"></a>01212 
<a name="l01213"></a>01213                         stateVecReal[indexUp] = stateVecReal[indexLo];
<a name="l01214"></a>01214                         stateVecImag[indexUp] = stateVecImag[indexLo];
<a name="l01215"></a>01215 
<a name="l01216"></a>01216                         stateVecReal[indexLo] = stateRealUp;
<a name="l01217"></a>01217                         stateVecImag[indexLo] = stateImagUp;
<a name="l01218"></a>01218                 } 
<a name="l01219"></a>01219         }
<a name="l01220"></a>01220 
<a name="l01221"></a>01221 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af5ef5166f00c0572354b4ac53dcf40cf"></a><!-- doxytag: member="qubits.c::sigmaYDistributed" ref="af5ef5166f00c0572354b4ac53dcf40cf" args="(MultiQubit multiQubit, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut, int updateUpper)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaYDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>updateUpper</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{0,-i},{i,0}. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecIn</em>&nbsp;</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>updateUpper</em>&nbsp;</td><td>flag, 1: updating upper values, 0: updating lower values in block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01444">1444</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, and <a class="el" href="precision_8h_source.html#l00023">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00567">sigmaY()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01448"></a>01448 {
<a name="l01449"></a>01449 
<a name="l01450"></a>01450         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01451"></a>01451         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01452"></a>01452 
<a name="l01453"></a>01453         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealIn=stateVecIn.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagIn=stateVecIn.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01454"></a>01454         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01455"></a>01455 
<a name="l01456"></a>01456         <span class="keywordtype">int</span> realSign=1, imagSign=1;
<a name="l01457"></a>01457         <span class="keywordflow">if</span> (updateUpper) imagSign=-1;
<a name="l01458"></a>01458         <span class="keywordflow">else</span> realSign = -1;
<a name="l01459"></a>01459 
<a name="l01460"></a>01460 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01461"></a>01461 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01462"></a>01462 <span class="preprocessor">        default  (none) \</span>
<a name="l01463"></a>01463 <span class="preprocessor">        shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut,realSign,imagSign) \</span>
<a name="l01464"></a>01464 <span class="preprocessor">        private  (thisTask)</span>
<a name="l01465"></a>01465 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01466"></a>01466 <span class="preprocessor"></span>        {
<a name="l01467"></a>01467 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01468"></a>01468 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01469"></a>01469 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01470"></a>01470 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01471"></a>01471                         stateVecRealOut[thisTask] = realSign*stateVecImagIn[thisTask];
<a name="l01472"></a>01472                         stateVecImagOut[thisTask] = imagSign*stateVecRealIn[thisTask];
<a name="l01473"></a>01473                 }
<a name="l01474"></a>01474         }
<a name="l01475"></a>01475 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a81fbfaed65a742a7dfd622e17652245e"></a><!-- doxytag: member="qubits.c::sigmaYLocal" ref="a81fbfaed65a742a7dfd622e17652245e" args="(MultiQubit multiQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaYLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{0,-i},{i,0}. </p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01384">1384</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00160">sigmaY()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01385"></a>01385 {
<a name="l01386"></a>01386         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01387"></a>01387         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01388"></a>01388              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01389"></a>01389 
<a name="l01390"></a>01390         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateImagUp;
<a name="l01391"></a>01391         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01392"></a>01392         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01393"></a>01393 
<a name="l01394"></a>01394         <span class="comment">// set dimensions</span>
<a name="l01395"></a>01395         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01396"></a>01396         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01397"></a>01397 
<a name="l01398"></a>01398         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l01399"></a>01399         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01400"></a>01400         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01401"></a>01401 
<a name="l01402"></a>01402 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01403"></a>01403 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01404"></a>01404 <span class="preprocessor">        default  (none) \</span>
<a name="l01405"></a>01405 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span>
<a name="l01406"></a>01406 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp) </span>
<a name="l01407"></a>01407 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01408"></a>01408 <span class="preprocessor"></span>        {
<a name="l01409"></a>01409 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01410"></a>01410 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01411"></a>01411 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01412"></a>01412 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01413"></a>01413                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l01414"></a>01414                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01415"></a>01415                         indexLo     = indexUp + sizeHalfBlock;
<a name="l01416"></a>01416 
<a name="l01417"></a>01417                         stateRealUp = stateVecReal[indexUp];
<a name="l01418"></a>01418                         stateImagUp = stateVecImag[indexUp];
<a name="l01419"></a>01419 
<a name="l01420"></a>01420                         stateVecReal[indexUp] = stateVecImag[indexLo];
<a name="l01421"></a>01421                         stateVecImag[indexUp] = -stateVecReal[indexLo];
<a name="l01422"></a>01422 
<a name="l01423"></a>01423                         stateVecReal[indexLo] = -stateImagUp;
<a name="l01424"></a>01424                         stateVecImag[indexLo] = stateRealUp;
<a name="l01425"></a>01425                 } 
<a name="l01426"></a>01426         }
<a name="l01427"></a>01427 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aebaab86326779de55d335cfea3efde8f"></a><!-- doxytag: member="qubits.c::sigmaZ" ref="aebaab86326779de55d335cfea3efde8f" args="(MultiQubit multiQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaZ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{1,0},{{0,-1}} -- apply a phase of -1 to |1&gt;. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01735">1735</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00166">phaseGate()</a>, and <a class="el" href="qubits_8h_source.html#l00066">SIGMA_Z</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00136">test_sigmaZ()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01736"></a>01736 {
<a name="l01737"></a>01737                 <a class="code" href="qubits__env__local_8c.html#aae7a8a7f1ccbddb7f76b6c52b746bb43" title="Rotate a single qubit by {{1,0},{0,p}} where p is a phase term determined by the...">phaseGate</a>(multiQubit, targetQubit, <a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a>);
<a name="l01738"></a>01738 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af764ea63a2e870098f4e1ce08562942e"></a><!-- doxytag: member="qubits.c::tGate" ref="af764ea63a2e870098f4e1ce08562942e" args="(MultiQubit multiQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01745">1745</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00166">phaseGate()</a>, and <a class="el" href="qubits_8h_source.html#l00066">T_GATE</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00221">test_tGate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01746"></a>01746 {
<a name="l01747"></a>01747                 <a class="code" href="qubits__env__local_8c.html#aae7a8a7f1ccbddb7f76b6c52b746bb43" title="Rotate a single qubit by {{1,0},{0,p}} where p is a phase term determined by the...">phaseGate</a>(multiQubit, targetQubit, <a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a>);
<a name="l01748"></a>01748 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2343b7240118e89aa615e2c9140b770b"></a><!-- doxytag: member="qubits.c::unitaryDistributed" ref="a2343b7240118e89aa615e2c9140b770b" args="(MultiQubit multiQubit, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void unitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply a unitary operation to a single qubit given a subset of the state vector with upper and lower block values stored seperately. </p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>u</em>&nbsp;</td><td>unitary matrix to apply </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00706">706</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, and <a class="el" href="precision_8h_source.html#l00023">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00326">unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00711"></a>00711 {
<a name="l00712"></a>00712 
<a name="l00713"></a>00713         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00714"></a>00714         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l00715"></a>00715         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00716"></a>00716 
<a name="l00717"></a>00717         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00718"></a>00718         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00719"></a>00719         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00720"></a>00720         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00721"></a>00721         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00722"></a>00722 
<a name="l00723"></a>00723 
<a name="l00724"></a>00724 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00725"></a>00725 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00726"></a>00726 <span class="preprocessor">        default  (none) \</span>
<a name="l00727"></a>00727 <span class="preprocessor">        shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l00728"></a>00728 <span class="preprocessor">                        rot1Real, rot1Imag, rot2Real, rot2Imag) \</span>
<a name="l00729"></a>00729 <span class="preprocessor">        private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span>
<a name="l00730"></a>00730 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00731"></a>00731 <span class="preprocessor"></span>        {
<a name="l00732"></a>00732 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00733"></a>00733 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00734"></a>00734 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00735"></a>00735 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00736"></a>00736                         <span class="comment">// store current state vector values in temp variables</span>
<a name="l00737"></a>00737                         stateRealUp = stateVecRealUp[thisTask];
<a name="l00738"></a>00738                         stateImagUp = stateVecImagUp[thisTask];
<a name="l00739"></a>00739 
<a name="l00740"></a>00740                         stateRealLo = stateVecRealLo[thisTask];
<a name="l00741"></a>00741                         stateImagLo = stateVecImagLo[thisTask];
<a name="l00742"></a>00742 
<a name="l00743"></a>00743                         stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp 
<a name="l00744"></a>00744                                 + rot2Real*stateRealLo - rot2Imag*stateImagLo;
<a name="l00745"></a>00745                         stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp 
<a name="l00746"></a>00746                                 + rot2Real*stateImagLo + rot2Imag*stateRealLo;
<a name="l00747"></a>00747                 }
<a name="l00748"></a>00748         }
<a name="l00749"></a>00749 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac134fb45b0a7248c5d15e16eb7139a35"></a><!-- doxytag: member="qubits.c::unitaryLocal" ref="ac134fb45b0a7248c5d15e16eb7139a35" args="(MultiQubit multiQubit, const int targetQubit, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void unitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00577">577</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00027">ComplexMatrix2::r0c0</a>, <a class="el" href="qubits_8h_source.html#l00027">ComplexMatrix2::r0c1</a>, <a class="el" href="qubits_8h_source.html#l00028">ComplexMatrix2::r1c0</a>, <a class="el" href="qubits_8h_source.html#l00028">ComplexMatrix2::r1c1</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00110">unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00578"></a>00578 {
<a name="l00579"></a>00579         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l00580"></a>00580         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l00581"></a>00581              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l00582"></a>00582 
<a name="l00583"></a>00583         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00584"></a>00584         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l00585"></a>00585         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l00586"></a>00586 
<a name="l00587"></a>00587         <span class="comment">// set dimensions</span>
<a name="l00588"></a>00588         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l00589"></a>00589         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l00590"></a>00590 
<a name="l00591"></a>00591         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l00592"></a>00592         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00593"></a>00593         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00594"></a>00594 
<a name="l00595"></a>00595 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00596"></a>00596 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00597"></a>00597 <span class="preprocessor">        default  (none) \</span>
<a name="l00598"></a>00598 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, u) \</span>
<a name="l00599"></a>00599 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span>
<a name="l00600"></a>00600 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00601"></a>00601 <span class="preprocessor"></span>        {
<a name="l00602"></a>00602 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00603"></a>00603 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00604"></a>00604 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00605"></a>00605 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00606"></a>00606 
<a name="l00607"></a>00607                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l00608"></a>00608                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l00609"></a>00609                         indexLo     = indexUp + sizeHalfBlock;
<a name="l00610"></a>00610 
<a name="l00611"></a>00611                         <span class="comment">// store current state vector values in temp variables</span>
<a name="l00612"></a>00612                         stateRealUp = stateVecReal[indexUp];
<a name="l00613"></a>00613                         stateImagUp = stateVecImag[indexUp];
<a name="l00614"></a>00614 
<a name="l00615"></a>00615                         stateRealLo = stateVecReal[indexLo];
<a name="l00616"></a>00616                         stateImagLo = stateVecImag[indexLo];
<a name="l00617"></a>00617 
<a name="l00618"></a>00618 
<a name="l00619"></a>00619                         <span class="comment">// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]</span>
<a name="l00620"></a>00620                         stateVecReal[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp 
<a name="l00621"></a>00621                                 + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo - u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;
<a name="l00622"></a>00622                         stateVecImag[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp 
<a name="l00623"></a>00623                                 + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;
<a name="l00624"></a>00624 
<a name="l00625"></a>00625                         <span class="comment">// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]</span>
<a name="l00626"></a>00626                         stateVecReal[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp  - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp 
<a name="l00627"></a>00627                                 + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo  -  u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;
<a name="l00628"></a>00628                         stateVecImag[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp 
<a name="l00629"></a>00629                                 + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;
<a name="l00630"></a>00630 
<a name="l00631"></a>00631                 } 
<a name="l00632"></a>00632         }
<a name="l00633"></a>00633 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae2b2c14a07dd7d50ff86032a3ca101d7"></a><!-- doxytag: member="qubits.c::validateAlphaBeta" ref="ae2b2c14a07dd7d50ff86032a3ca101d7" args="(Complex alpha, Complex beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int validateAlphaBeta </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00410">410</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, and <a class="el" href="precision_8h_source.html#l00026">REAL_EPS</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00101">compactUnitary()</a>, and <a class="el" href="qubits__env__local_8c_source.html#l00119">controlledCompactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00410"></a>00410                                                   {
<a name="l00411"></a>00411         <span class="keywordflow">if</span> ( fabs(alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> 
<a name="l00412"></a>00412                 + alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00413"></a>00413                 + beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> 
<a name="l00414"></a>00414                 + beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> - 1) &gt; <a class="code" href="precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;
<a name="l00415"></a>00415         <span class="keywordflow">else</span> <span class="keywordflow">return</span> 1;
<a name="l00416"></a>00416 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae4fea133d1a8f09ff8da03038100adb2"></a><!-- doxytag: member="qubits.c::validateMatrixIsUnitary" ref="ae4fea133d1a8f09ff8da03038100adb2" args="(ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int validateMatrixIsUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00385">385</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00027">ComplexMatrix2::r0c0</a>, <a class="el" href="qubits_8h_source.html#l00027">ComplexMatrix2::r0c1</a>, <a class="el" href="qubits_8h_source.html#l00028">ComplexMatrix2::r1c0</a>, <a class="el" href="qubits_8h_source.html#l00028">ComplexMatrix2::r1c1</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, and <a class="el" href="precision_8h_source.html#l00026">REAL_EPS</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00130">controlledUnitary()</a>, <a class="el" href="qubits__env__local_8c_source.html#l00140">multiControlledUnitary()</a>, and <a class="el" href="qubits__env__local_8c_source.html#l00110">unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00385"></a>00385                                              {
<a name="l00386"></a>00386 
<a name="l00387"></a>00387         <span class="keywordflow">if</span> ( fabs(u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> 
<a name="l00388"></a>00388                 + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00389"></a>00389                 + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>
<a name="l00390"></a>00390                 + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> - 1) &gt; <a class="code" href="precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;
<a name="l00391"></a>00391     <span class="comment">// check</span>
<a name="l00392"></a>00392         <span class="keywordflow">if</span> ( fabs(u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> 
<a name="l00393"></a>00393                 + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00394"></a>00394                 + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>
<a name="l00395"></a>00395                 + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> - 1) &gt; <a class="code" href="precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;
<a name="l00396"></a>00396 
<a name="l00397"></a>00397         <span class="keywordflow">if</span> ( fabs(u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> 
<a name="l00398"></a>00398                 + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00399"></a>00399                 + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>
<a name="l00400"></a>00400                 + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>) &gt; <a class="code" href="precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;
<a name="l00401"></a>00401 
<a name="l00402"></a>00402         <span class="keywordflow">if</span> ( fabs(u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00403"></a>00403                 - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00404"></a>00404                 + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00405"></a>00405                 - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>) &gt; <a class="code" href="precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;
<a name="l00406"></a>00406 
<a name="l00407"></a>00407         <span class="keywordflow">return</span> 1;
<a name="l00408"></a>00408 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a71c14976f63cfcda70026fa20ee531fe"></a><!-- doxytag: member="qubits.c::validateUnitVector" ref="a71c14976f63cfcda70026fa20ee531fe" args="(REAL ux, REAL uy, REAL uz)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int validateUnitVector </td>
          <td>(</td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>ux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>uy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>uz</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00418">418</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="precision_8h_source.html#l00026">REAL_EPS</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00418"></a>00418                                                  {
<a name="l00419"></a>00419         <span class="keywordflow">if</span> ( fabs(sqrt(ux*ux + uy*uy + uz*uz) - 1) &gt; <a class="code" href="precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;
<a name="l00420"></a>00420         <span class="keywordflow">else</span> <span class="keywordflow">return</span> 1;
<a name="l00421"></a>00421 }
</pre></div></p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="aac1637696885c75b73a1ecf381cea713"></a><!-- doxytag: member="qubits.c::errorCodes" ref="aac1637696885c75b73a1ecf381cea713" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="qubits__internal_8h.html#aac1637696885c75b73a1ecf381cea713">errorCodes</a>[]</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
    <span class="stringliteral">&quot;Success&quot;</span>,                                              
    <span class="stringliteral">&quot;Invalid target qubit. Note qubits are zero indexed.&quot;</span>,  
    <span class="stringliteral">&quot;Invalid control qubit. Note qubits are zero indexed.&quot;</span>, 
    <span class="stringliteral">&quot;Control qubit cannot equal target qubit.&quot;</span>,             
    <span class="stringliteral">&quot;Invalid number of control qubits&quot;</span>,                     
    <span class="stringliteral">&quot;Invalid unitary matrix.&quot;</span>,                              
    <span class="stringliteral">&quot;Invalid rotation arguments.&quot;</span>,                          
    <span class="stringliteral">&quot;Invalid system size. Cannot print output for systems greater than 5 qubits.&quot;</span>, 
    <span class="stringliteral">&quot;Can&apos;t collapse to state with zero probability.&quot;</span> 
    <span class="stringliteral">&quot;Invalid number of qubits.&quot;</span> 
}
</pre></div>
<p>Definition at line <a class="el" href="qubits_8c_source.html#l00017">17</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00234">exitWithError()</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 13 Feb 2018 for Distributed QuEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
