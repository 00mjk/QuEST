<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Distributed QuEST: QuEST_env_local.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>QuEST_env_local.c File Reference</h1>
<p>An implementation of the API in qubits.h for a local (non-MPI) environment.  
<a href="#_details">More...</a></p>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;omp.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="QuEST__precision_8h_source.html">QuEST_precision.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="QuEST_8h_source.html">QuEST.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="QuEST__internal_8h_source.html">QuEST_internal.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="mt19937ar_8h_source.html">mt19937ar.h</a>&quot;</code><br/>
<code>#include &lt;time.h&gt;</code><br/>
<code>#include &lt;sys/types.h&gt;</code><br/>

<p><a href="QuEST__env__local_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#ad84a3ce68d1ca02b4e3f741ea45b6054">initQuESTEnv</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> *<a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize the QuEST environment.  <a href="#ad84a3ce68d1ca02b4e3f741ea45b6054"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77">syncQuESTEnv</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Guarantees that all code up to the given point has been executed on all nodes (if running in distributed mode).  <a href="#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#ac7e38d768a1bd79019f88cc1e6295092">syncQuESTSuccess</a> (int successCode)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs a logical AND on all successCodes held by all processes.  <a href="#ac7e38d768a1bd79019f88cc1e6295092"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#abd4bc926cd3f9b65610bb228d0c59fe0">closeQuESTEnv</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Close QuEST environment.  <a href="#abd4bc926cd3f9b65610bb228d0c59fe0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#af8a14ae79c3fb2c0b5f6255cc37bebf9">reportQuESTEnv</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Report information about the QuEST environment.  <a href="#af8a14ae79c3fb2c0b5f6255cc37bebf9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#a62da5b58d8ce84e6f4d24be1b872294e">reportNodeList</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Report a list of CPU hostnames and the rank that is running on each if running with MPI enabled and an error message otherwise.  <a href="#a62da5b58d8ce84e6f4d24be1b872294e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#a818a4c7cd7252d2b10b896b12fa431d3">calcTotalProbability</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate the probability of being in any state by taking the norm of the entire state vector.  <a href="#a818a4c7cd7252d2b10b896b12fa431d3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#a317b786f577fa6bc136ea7f0ee7330a7">getRealAmpEl</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, long long int index)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the real component of the complex probability amplitude at an index in the state vector.  <a href="#a317b786f577fa6bc136ea7f0ee7330a7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#a3615f76fd5f57008d9b74bbd10533dd0">getImagAmpEl</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, long long int index)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the imaginary component of the complex probability amplitude at an index in the state vector.  <a href="#a3615f76fd5f57008d9b74bbd10533dd0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#a03b13dfcabd8c59b50dbdd3af44ba8b2">compactUnitary</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a single-qubit unitary parameterised by two given complex scalars.  <a href="#a03b13dfcabd8c59b50dbdd3af44ba8b2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#a7a0877e33700f6bad48adb51b7b3fb67">unitary</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> <a class="el" href="README_8md.html#a5d1c311241dc8d8ffa4badf059977dc5">u</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a general single-qubit unitary (including a global phase factor).  <a href="#a7a0877e33700f6bad48adb51b7b3fb67"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#ab4812953bc457405b3aa05a4c2f64f4a">controlledCompactUnitary</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a controlled unitary (single control, single target) parameterised by two given complex scalars.  <a href="#ab4812953bc457405b3aa05a4c2f64f4a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#a8a701526263392599aa21d0d0f05d9d8">controlledUnitary</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> <a class="el" href="README_8md.html#a5d1c311241dc8d8ffa4badf059977dc5">u</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a general controlled unitary (single control, single target), which can include a global phase factor.  <a href="#a8a701526263392599aa21d0d0f05d9d8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#ae395a79690283ed81106afadd7a8cd8a">multiControlledUnitary</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, int *controlQubits, const int numControlQubits, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> <a class="el" href="README_8md.html#a5d1c311241dc8d8ffa4badf059977dc5">u</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a general multiple-control single-target unitary, which can include a global phase factor.  <a href="#ae395a79690283ed81106afadd7a8cd8a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#a86e396e06b7d527cac20ba0108872423">sigmaX</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply the single-qubit sigma-X (also known as the X, Pauli-X, NOT or bit-flip) gate.  <a href="#a86e396e06b7d527cac20ba0108872423"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#a1f54d70a42403f7e1c2e2c2007332f61">sigmaY</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply the single-qubit sigma-Y (also known as the Y or Pauli-Y) gate.  <a href="#a1f54d70a42403f7e1c2e2c2007332f61"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#aae7a8a7f1ccbddb7f76b6c52b746bb43">phaseGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, enum <a class="el" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a> type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#aa09b5dd93de6df1384b8f2c0041749ab">hadamard</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply the single-qubit Hadamard gate.  <a href="#aa09b5dd93de6df1384b8f2c0041749ab"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#a67576895bbc65463481a8ea24d9b1e22">controlledNot</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply the controlled not (single control, single target) gate, also known as the c-X, c-sigma-X, c-Pauli-X and c-bit-flip gate.  <a href="#a67576895bbc65463481a8ea24d9b1e22"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#ad315c941a51bc053d39ebfa2040fd32e">findProbabilityOfOutcome</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit, int outcome)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gives the probability of a specified qubit being measured in the given outcome (0 or 1).  <a href="#ad315c941a51bc053d39ebfa2040fd32e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#a07418ebac70fd9ae5d051d089961631d">collapseToOutcome</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit, int outcome)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Updates the state vector to be consistent with measuring the measure qubit in the given outcome (0 or 1), and returns the probability of such a measurement outcome.  <a href="#a07418ebac70fd9ae5d051d089961631d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#ad5774247d836267175c664cd0e451bcb">measure</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, int measureQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Measures a single qubit, collapsing it randomly to 0 or 1.  <a href="#ad5774247d836267175c664cd0e451bcb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#a2ac46e470c750bf93c754e06c64b0a7a">measureWithStats</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, int measureQubit, REAL *stateProb)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Measures a single qubit, collapsing it randomly to 0 or 1, and additionally gives the probability of that outcome.  <a href="#a2ac46e470c750bf93c754e06c64b0a7a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#ae5f9019826f35e8b51b1716cfe397b45">exitWithError</a> (int errorCode, const char *func)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a> (int isValid, int errorCode, const char *func)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>An implementation of the API in qubits.h for a local (non-MPI) environment. </p>

<p>Definition in file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a818a4c7cd7252d2b10b896b12fa431d3"></a><!-- doxytag: member="QuEST_env_local.c::calcTotalProbability" ref="a818a4c7cd7252d2b10b896b12fa431d3" args="(MultiQubit multiQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL calcTotalProbability </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate the probability of being in any state by taking the norm of the entire state vector. </p>
<p>Should be equal to 1.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing a set of qubits </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>total probability </dd></dl>

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00057">57</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, <a class="el" href="QuEST_8h_source.html#l00049">MultiQubit::stateVec</a>, and <a class="el" href="README_8md_source.html#l00047">y</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00057"></a>00057                                                 {
<a name="l00058"></a>00058     <span class="comment">// implemented using Kahan summation for greater accuracy at a slight floating</span>
<a name="l00059"></a>00059     <span class="comment">// point operation overhead. For more details see https://en.wikipedia.org/wiki/Kahan_summation_algorithm</span>
<a name="l00060"></a>00060     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> pTotal=0; 
<a name="l00061"></a>00061     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> <a class="code" href="README_8md.html#a003dc5701d53a819228f5417a8089139">y</a>, t, c;
<a name="l00062"></a>00062     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00063"></a>00063     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmpsPerRank = multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00064"></a>00064     c = 0.0;
<a name="l00065"></a>00065     <span class="keywordflow">for</span> (index=0; index&lt;numAmpsPerRank; index++){ 
<a name="l00066"></a>00066         <span class="comment">// Perform pTotal+=multiQubit.stateVec.real[index]*multiQubit.stateVec.real[index]; by Kahan</span>
<a name="l00067"></a>00067 
<a name="l00068"></a>00068         y = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[index]*multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[index] - c;
<a name="l00069"></a>00069         t = pTotal + y;
<a name="l00070"></a>00070         <span class="comment">// Don&apos;t change the bracketing on the following line</span>
<a name="l00071"></a>00071         c = ( t - pTotal ) - y;
<a name="l00072"></a>00072         pTotal = t;
<a name="l00073"></a>00073 
<a name="l00074"></a>00074         <span class="comment">// Perform pTotal+=multiQubit.stateVec.imag[index]*multiQubit.stateVec.imag[index]; by Kahan</span>
<a name="l00075"></a>00075 
<a name="l00076"></a>00076         y = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[index]*multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[index] - c;
<a name="l00077"></a>00077         t = pTotal + y;
<a name="l00078"></a>00078         <span class="comment">// Don&apos;t change the bracketing on the following line</span>
<a name="l00079"></a>00079         c = ( t - pTotal ) - y;
<a name="l00080"></a>00080         pTotal = t;
<a name="l00081"></a>00081 
<a name="l00082"></a>00082 
<a name="l00083"></a>00083     } 
<a name="l00084"></a>00084     <span class="keywordflow">return</span> pTotal;
<a name="l00085"></a>00085 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="abd4bc926cd3f9b65610bb228d0c59fe0"></a><!-- doxytag: member="QuEST_env_local.c::closeQuESTEnv" ref="abd4bc926cd3f9b65610bb228d0c59fe0" args="(QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void closeQuESTEnv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Close QuEST environment. </p>
<p>If something needs to be done to clean up the execution environment, such as finalizing MPI when running in distributed mode, it is handled here</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00036">36</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00036"></a>00036                                 {
<a name="l00037"></a>00037     <span class="comment">// MPI finalize goes here in MPI version. Call this function anyway for consistency</span>
<a name="l00038"></a>00038 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a07418ebac70fd9ae5d051d089961631d"></a><!-- doxytag: member="QuEST_env_local.c::collapseToOutcome" ref="a07418ebac70fd9ae5d051d089961631d" args="(MultiQubit multiQubit, const int measureQubit, int outcome)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL collapseToOutcome </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outcome</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Updates the state vector to be consistent with measuring the measure qubit in the given outcome (0 or 1), and returns the probability of such a measurement outcome. </p>
<p>This is effectively performing a measurement and forcing the outcome. This is an irreversible change to the state vector, whereby incompatible states in the state vector are given zero amplitude and the remaining states are renormalised. Exits with error if the given outcome has ~zero probability, and so cannot be collapsed into.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>outcome</em>&nbsp;</td><td>to force the measure qubit to enter </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>probability of the (forced) measurement outcome </dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>measureQubit</code> is outside [0, <code>multiQubit.numQubits</code>), or if <code>outcome</code> is not in {0, 1}, or if the probability of <code>outcome</code> is zero (within machine epsilon) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00189">189</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p>References <a class="el" href="QuEST_8c_source.html#l01790">collapseToOutcomeLocal()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00180">findProbabilityOfOutcome()</a>, <a class="el" href="QuEST_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00237">QuESTAssert()</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00028">REAL_EPS</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00190"></a>00190 {
<a name="l00191"></a>00191     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(measureQubit &gt;= 0 &amp;&amp; measureQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 2, __func__);
<a name="l00192"></a>00192     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>((outcome==0 || outcome==1), 10, __func__);
<a name="l00193"></a>00193     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateProb;
<a name="l00194"></a>00194     stateProb = <a class="code" href="QuEST_8h.html#ad315c941a51bc053d39ebfa2040fd32e" title="Gives the probability of a specified qubit being measured in the given outcome (0...">findProbabilityOfOutcome</a>(multiQubit, measureQubit, outcome);
<a name="l00195"></a>00195     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(fabs(stateProb)&gt;<a class="code" href="QuEST__precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a>, 8, __func__);
<a name="l00196"></a>00196     <a class="code" href="QuEST_8c.html#a01d9a8b7ff0e09ec399e158389783aa9" title="Update the state vector to be consistent with measuring measureQubit=0 if outcome=0...">collapseToOutcomeLocal</a>(multiQubit, measureQubit, stateProb, outcome);
<a name="l00197"></a>00197     <span class="keywordflow">return</span> stateProb;
<a name="l00198"></a>00198 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a03b13dfcabd8c59b50dbdd3af44ba8b2"></a><!-- doxytag: member="QuEST_env_local.c::compactUnitary" ref="a03b13dfcabd8c59b50dbdd3af44ba8b2" args="(MultiQubit multiQubit, const int targetQubit, Complex alpha, Complex beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compactUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply a single-qubit unitary parameterised by two given complex scalars. </p>
<p>Given valid complex numbers <img class="formulaInl" alt="$\alpha$" src="form_18.png"/> and <img class="formulaInl" alt="$\beta$" src="form_19.png"/>, applies the unitary </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ U = \begin{pmatrix} \alpha &amp; -\beta^* \\ \beta &amp; \alpha^* \end{pmatrix} \]" src="form_20.png"/>
</p>
<p> which is general up to a global phase factor. Valid <img class="formulaInl" alt="$\alpha$" src="form_18.png"/>, <img class="formulaInl" alt="$\beta$" src="form_19.png"/> satisfy <img class="formulaInl" alt="$|\alpha|^2 + |\beta|^2 = 1$" src="form_21.png"/>.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {U}; \end{tikzpicture} } \]" src="form_22.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to operate on </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>alpha</em>&nbsp;</td><td>complex unitary parameter (row 1, column 1) </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>beta</em>&nbsp;</td><td>complex unitary parameter (row 2, column 1) </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>targetQubit</code> is outside [0, <code>multiQubit.numQubits</code>), or if <code>alpha</code>, <code>beta</code> don't satisfy |<code>alpha|^2</code> + |<code>beta|^2</code> = 1. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00095">95</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p>References <a class="el" href="QuEST_8c_source.html#l00445">compactUnitaryLocal()</a>, <a class="el" href="QuEST_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00237">QuESTAssert()</a>, and <a class="el" href="QuEST_8c_source.html#l00370">validateAlphaBeta()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00096"></a>00096 {
<a name="l00097"></a>00097     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00098"></a>00098     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(<a class="code" href="QuEST_8c.html#ae2b2c14a07dd7d50ff86032a3ca101d7">validateAlphaBeta</a>(alpha, beta), 6, __func__);
<a name="l00099"></a>00099 
<a name="l00100"></a>00100     <span class="comment">// all values required to update state vector lie in this rank</span>
<a name="l00101"></a>00101     <a class="code" href="QuEST_8c.html#a9cee2d8716667a3318420a3b672f5b92">compactUnitaryLocal</a>(multiQubit, targetQubit, alpha, beta);
<a name="l00102"></a>00102 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab4812953bc457405b3aa05a4c2f64f4a"></a><!-- doxytag: member="QuEST_env_local.c::controlledCompactUnitary" ref="ab4812953bc457405b3aa05a4c2f64f4a" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, Complex alpha, Complex beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledCompactUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply a controlled unitary (single control, single target) parameterised by two given complex scalars. </p>
<p>Given valid complex numbers <img class="formulaInl" alt="$\alpha$" src="form_18.png"/> and <img class="formulaInl" alt="$\beta$" src="form_19.png"/>, applies the two-qubit unitary </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 1 \\ &amp; 1 \\ &amp; &amp; \alpha &amp; -\beta^* \\ &amp; &amp; \beta &amp; \alpha^* \end{pmatrix} \]" src="form_30.png"/>
</p>
<p> to the control and target qubits. Valid <img class="formulaInl" alt="$\alpha$" src="form_18.png"/>, <img class="formulaInl" alt="$\beta$" src="form_19.png"/> satisfy <img class="formulaInl" alt="$|\alpha|^2 + |\beta|^2 = 1$" src="form_21.png"/>. The target unitary is general up to a global phase factor.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 1); \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$U_{\alpha, \beta}$}; \end{tikzpicture} } \]" src="form_31.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>apply the target unitary if this qubit has value 1 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit on which to apply the target unitary </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>alpha</em>&nbsp;</td><td>complex unitary parameter (row 1, column 1) </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>beta</em>&nbsp;</td><td>complex unitary parameter (row 2, column 1) </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if either <code>controlQubit</code> or <code>targetQubit</code> are outside [0, <code>multiQubit.numQubits</code>) or are equal, or if <code>alpha</code>, <code>beta</code> don't satisfy |<code>alpha|^2</code> + |<code>beta|^2</code> = 1. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00113">113</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p>References <a class="el" href="QuEST_8c_source.html#l00675">controlledCompactUnitaryLocal()</a>, <a class="el" href="QuEST_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00237">QuESTAssert()</a>, and <a class="el" href="QuEST_8c_source.html#l00370">validateAlphaBeta()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00114"></a>00114 {
<a name="l00115"></a>00115     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00116"></a>00116     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(controlQubit &gt;= 0 &amp;&amp; controlQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 2, __func__);
<a name="l00117"></a>00117     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(controlQubit != targetQubit, 3, __func__);
<a name="l00118"></a>00118     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(<a class="code" href="QuEST_8c.html#ae2b2c14a07dd7d50ff86032a3ca101d7">validateAlphaBeta</a>(alpha, beta), 6, __func__);
<a name="l00119"></a>00119 
<a name="l00120"></a>00120 
<a name="l00121"></a>00121     <a class="code" href="QuEST_8c.html#afc77657651d52c47403b44b923a098a8">controlledCompactUnitaryLocal</a>(multiQubit, controlQubit, targetQubit, alpha, beta);
<a name="l00122"></a>00122 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a67576895bbc65463481a8ea24d9b1e22"></a><!-- doxytag: member="QuEST_env_local.c::controlledNot" ref="a67576895bbc65463481a8ea24d9b1e22" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledNot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply the controlled not (single control, single target) gate, also known as the c-X, c-sigma-X, c-Pauli-X and c-bit-flip gate. </p>
<p>This applies sigmaX to the target qubit if the control qubit has value 1. This effects the two-qubit unitary </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 1 \\ &amp; 1 \\\ &amp; &amp; &amp; 1 \\ &amp; &amp; 1 \end{pmatrix} \]" src="form_49.png"/>
</p>
<p> on the control and target qubits.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, -.5); \draw (-2,0) -- (2, 0); \draw (0, 0) circle (.5); \end{tikzpicture} } \]" src="form_50.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>nots the target if this qubit is 1 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to not </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if either <code>controlQubit</code> or <code>targetQubit</code> are outside [0, <code>multiQubit.numQubits</code>), or are equal. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00172">172</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p>References <a class="el" href="QuEST_8c_source.html#l01148">controlledNotLocal()</a>, <a class="el" href="QuEST_8h_source.html#l00053">MultiQubit::numQubits</a>, and <a class="el" href="QuEST__env__local_8c_source.html#l00237">QuESTAssert()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00173"></a>00173 {
<a name="l00174"></a>00174     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00175"></a>00175     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(controlQubit &gt;= 0 &amp;&amp; controlQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 2, __func__);
<a name="l00176"></a>00176     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(controlQubit != targetQubit, 3, __func__);
<a name="l00177"></a>00177     <a class="code" href="QuEST_8c.html#ad357a43e80e3baf013975b1b70942f4c">controlledNotLocal</a>(multiQubit, controlQubit, targetQubit);
<a name="l00178"></a>00178 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8a701526263392599aa21d0d0f05d9d8"></a><!-- doxytag: member="QuEST_env_local.c::controlledUnitary" ref="a8a701526263392599aa21d0d0f05d9d8" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply a general controlled unitary (single control, single target), which can include a global phase factor. </p>
<p>The given unitary is applied to the target qubit if the control qubit has value 1, effecting the two-qubit unitary </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 1 \\ &amp; 1 \\ &amp; &amp; u_{00} &amp; u_{01}\\ &amp; &amp; u_{10} &amp; u_{11} \end{pmatrix} \]" src="form_32.png"/>
</p>
<p> on the control and target qubits.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 1); \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {U}; \end{tikzpicture} } \]" src="form_33.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>apply unitary if this qubit is 1 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to operate on </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>u</em>&nbsp;</td><td>single-qubit unitary matrix to apply </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if either <code>controlQubit</code> or <code>targetQubit</code> are outside [0, <code>multiQubit.numQubits</code>) or are equal, or if <code>u</code> is not unitary. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00124">124</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p>References <a class="el" href="QuEST_8c_source.html#l00805">controlledUnitaryLocal()</a>, <a class="el" href="QuEST_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00237">QuESTAssert()</a>, and <a class="el" href="QuEST_8c_source.html#l00346">validateMatrixIsUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00125"></a>00125 {
<a name="l00126"></a>00126     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00127"></a>00127     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(controlQubit &gt;= 0 &amp;&amp; controlQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 2, __func__);
<a name="l00128"></a>00128     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(controlQubit != targetQubit, 3, __func__);
<a name="l00129"></a>00129     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(<a class="code" href="QuEST_8c.html#ae4fea133d1a8f09ff8da03038100adb2">validateMatrixIsUnitary</a>(u), 5, __func__);
<a name="l00130"></a>00130 
<a name="l00131"></a>00131     <a class="code" href="QuEST_8c.html#a8a4afcff70195a306c082b8ed8d4e09a">controlledUnitaryLocal</a>(multiQubit, controlQubit, targetQubit, u);
<a name="l00132"></a>00132 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae5f9019826f35e8b51b1716cfe397b45"></a><!-- doxytag: member="QuEST_env_local.c::exitWithError" ref="ae5f9019826f35e8b51b1716cfe397b45" args="(int errorCode, const char *func)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void exitWithError </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>errorCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>func</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00229">229</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00237">QuESTAssert()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00229"></a>00229                                                    {
<a name="l00230"></a>00230     printf(<span class="stringliteral">&quot;!!!\n&quot;</span>);
<a name="l00231"></a>00231     printf(<span class="stringliteral">&quot;QuEST Error in function %s: %s\n&quot;</span>, func, <a class="code" href="QuEST_8c.html#aac1637696885c75b73a1ecf381cea713">errorCodes</a>[errorCode]);
<a name="l00232"></a>00232     printf(<span class="stringliteral">&quot;!!!\n&quot;</span>);
<a name="l00233"></a>00233     printf(<span class="stringliteral">&quot;exiting..\n&quot;</span>);
<a name="l00234"></a>00234     exit(errorCode);
<a name="l00235"></a>00235 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad315c941a51bc053d39ebfa2040fd32e"></a><!-- doxytag: member="QuEST_env_local.c::findProbabilityOfOutcome" ref="ad315c941a51bc053d39ebfa2040fd32e" args="(MultiQubit multiQubit, const int measureQubit, int outcome)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL findProbabilityOfOutcome </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outcome</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Gives the probability of a specified qubit being measured in the given outcome (0 or 1). </p>
<p>This performs no actual measurement and does not change the state of the qubits.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to study </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>outcome</em>&nbsp;</td><td>for which to find the probability of the qubit being measured in </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>probability of qubit measureQubit being measured in the given outcome </dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>measureQubit</code> is outside [0, <code>multiQubit.numQubits</code>), or if <code>outcome</code> is not in {0, 1}. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00180">180</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p>References <a class="el" href="QuEST_8c_source.html#l01598">findProbabilityOfZeroLocal()</a>, <a class="el" href="QuEST_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00237">QuESTAssert()</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00181"></a>00181 {
<a name="l00182"></a>00182     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(measureQubit &gt;= 0 &amp;&amp; measureQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 2, __func__);
<a name="l00183"></a>00183     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateProb=0;
<a name="l00184"></a>00184     stateProb = <a class="code" href="QuEST_8c.html#a7c02cd0e1b4eac19771a0525f023249e" title="Measure the total probability of a specified qubit being in the zero state across...">findProbabilityOfZeroLocal</a>(multiQubit, measureQubit);
<a name="l00185"></a>00185     <span class="keywordflow">if</span> (outcome==1) stateProb = 1.0 - stateProb;
<a name="l00186"></a>00186     <span class="keywordflow">return</span> stateProb;
<a name="l00187"></a>00187 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3615f76fd5f57008d9b74bbd10533dd0"></a><!-- doxytag: member="QuEST_env_local.c::getImagAmpEl" ref="a3615f76fd5f57008d9b74bbd10533dd0" args="(MultiQubit multiQubit, long long int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL getImagAmpEl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>index</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the imaginary component of the complex probability amplitude at an index in the state vector. </p>
<p>For debugging purposes.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing a set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>index</em>&nbsp;</td><td>index in state vector of probability amplitudes </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>imaginary component at that index </dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>index</code> is outside [0, <img class="formulaInl" alt="$2^{N}$" src="form_16.png"/>) where <img class="formulaInl" alt="$N = $" src="form_17.png"/> <code>multiQubit.numQubits</code> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00091">91</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, and <a class="el" href="QuEST_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00091"></a>00091                                                              {
<a name="l00092"></a>00092     <span class="keywordflow">return</span> multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[index];
<a name="l00093"></a>00093 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a317b786f577fa6bc136ea7f0ee7330a7"></a><!-- doxytag: member="QuEST_env_local.c::getRealAmpEl" ref="a317b786f577fa6bc136ea7f0ee7330a7" args="(MultiQubit multiQubit, long long int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL getRealAmpEl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>index</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the real component of the complex probability amplitude at an index in the state vector. </p>
<p>For debugging purposes.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing a set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>index</em>&nbsp;</td><td>index in state vector of probability amplitudes </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>real component at that index </dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>index</code> is outside [0, <img class="formulaInl" alt="$2^{N}$" src="form_16.png"/>) where <img class="formulaInl" alt="$N = $" src="form_17.png"/> <code>multiQubit.numQubits</code> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00087">87</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, and <a class="el" href="QuEST_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00087"></a>00087                                                              {
<a name="l00088"></a>00088     <span class="keywordflow">return</span> multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[index];
<a name="l00089"></a>00089 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa09b5dd93de6df1384b8f2c0041749ab"></a><!-- doxytag: member="QuEST_env_local.c::hadamard" ref="aa09b5dd93de6df1384b8f2c0041749ab" args="(MultiQubit multiQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hadamard </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply the single-qubit Hadamard gate. </p>
<p>This takes <img class="formulaInl" alt="$|0\rangle$" src="form_43.png"/> to <img class="formulaInl" alt="$|+\rangle$" src="form_44.png"/> and <img class="formulaInl" alt="$|1\rangle$" src="form_45.png"/> to <img class="formulaInl" alt="$|-\rangle$" src="form_46.png"/>, and is equivalent to a rotation of <img class="formulaInl" alt="$\pi$" src="form_36.png"/> around the x-axis then <img class="formulaInl" alt="$\pi/2$" src="form_10.png"/> about the y-axis on the Bloch-sphere. I.e. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{1}{\sqrt{2}} \begin{pmatrix} 1 &amp; 1 \\ 1 &amp; -1 \end{pmatrix} \]" src="form_47.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {H}; \end{tikzpicture} } \]" src="form_48.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to operate on </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>targetQubit</code> is outside [0, <code>multiQubit.numQubits</code>). </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00166">166</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p>References <a class="el" href="QuEST_8c_source.html#l01340">hadamardLocal()</a>, <a class="el" href="QuEST_8h_source.html#l00053">MultiQubit::numQubits</a>, and <a class="el" href="QuEST__env__local_8c_source.html#l00237">QuESTAssert()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00167"></a>00167 {
<a name="l00168"></a>00168     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00169"></a>00169     <a class="code" href="QuEST_8c.html#aa9f0718b4dd794a3e1b143e3b153bfc5">hadamardLocal</a>(multiQubit, targetQubit);
<a name="l00170"></a>00170 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad84a3ce68d1ca02b4e3f741ea45b6054"></a><!-- doxytag: member="QuEST_env_local.c::initQuESTEnv" ref="ad84a3ce68d1ca02b4e3f741ea45b6054" args="(QuESTEnv *env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initQuESTEnv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize the QuEST environment. </p>
<p>If something needs to be done to set up the execution environment, such as initializing MPI when running in distributed mode, it is handled here</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00021">21</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00069">QuESTEnv::numRanks</a>, and <a class="el" href="QuEST_8h_source.html#l00068">QuESTEnv::rank</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00021"></a>00021                                 {
<a name="l00022"></a>00022     <span class="comment">// init MPI environment</span>
<a name="l00023"></a>00023     env-&gt;<a class="code" href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">rank</a>=0;
<a name="l00024"></a>00024     env-&gt;<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>=1;
<a name="l00025"></a>00025 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad5774247d836267175c664cd0e451bcb"></a><!-- doxytag: member="QuEST_env_local.c::measure" ref="ad5774247d836267175c664cd0e451bcb" args="(MultiQubit multiQubit, int measureQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int measure </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Measures a single qubit, collapsing it randomly to 0 or 1. </p>
<p>Outcome probabilities are weighted by the state vector, which is irreversibly changed after collapse to be consistent with the outcome.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the measurement outcome, 0 or 1 </dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>measureQubit</code> is outside [0, <code>multiQubit.numQubits</code>) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00200">200</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p>References <a class="el" href="QuEST__env__local_8c_source.html#l00206">measureWithStats()</a>, <a class="el" href="QuEST_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00237">QuESTAssert()</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00200"></a>00200                                                     {
<a name="l00201"></a>00201     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(measureQubit &gt;= 0 &amp;&amp; measureQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 2, __func__);
<a name="l00202"></a>00202     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateProb;
<a name="l00203"></a>00203     <span class="keywordflow">return</span> <a class="code" href="QuEST_8h.html#a2ac46e470c750bf93c754e06c64b0a7a" title="Measures a single qubit, collapsing it randomly to 0 or 1, and additionally gives...">measureWithStats</a>(multiQubit, measureQubit, &amp;stateProb);
<a name="l00204"></a>00204 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2ac46e470c750bf93c754e06c64b0a7a"></a><!-- doxytag: member="QuEST_env_local.c::measureWithStats" ref="a2ac46e470c750bf93c754e06c64b0a7a" args="(MultiQubit multiQubit, int measureQubit, REAL *stateProb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int measureWithStats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL *&nbsp;</td>
          <td class="paramname"> <em>stateProb</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Measures a single qubit, collapsing it randomly to 0 or 1, and additionally gives the probability of that outcome. </p>
<p>Outcome probabilities are weighted by the state vector, which is irreversibly changed after collapse to be consistent with the outcome.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateProb</em>&nbsp;</td><td>a pointer to a REAL which is set to the probability of the occurred outcome </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the measurement outcome, 0 or 1 </dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>measureQubit</code> is outside [0, <code>multiQubit.numQubits</code>) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00206">206</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p>References <a class="el" href="QuEST_8c_source.html#l01790">collapseToOutcomeLocal()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00180">findProbabilityOfOutcome()</a>, <a class="el" href="mt19937ar_8c_source.html#l00146">genrand_real1()</a>, <a class="el" href="QuEST_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00237">QuESTAssert()</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00028">REAL_EPS</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00206"></a>00206                                                                               {
<a name="l00207"></a>00207     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(measureQubit &gt;= 0 &amp;&amp; measureQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 2, __func__);
<a name="l00208"></a>00208 
<a name="l00209"></a>00209     <span class="keywordtype">int</span> outcome;
<a name="l00210"></a>00210     <span class="comment">// find probability of qubit being in state 1</span>
<a name="l00211"></a>00211     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateProbInternal = <a class="code" href="QuEST_8h.html#ad315c941a51bc053d39ebfa2040fd32e" title="Gives the probability of a specified qubit being measured in the given outcome (0...">findProbabilityOfOutcome</a>(multiQubit, measureQubit, 1);
<a name="l00212"></a>00212 
<a name="l00213"></a>00213     <span class="comment">// we can&apos;t collapse to a state that has a probability too close to zero</span>
<a name="l00214"></a>00214     <span class="keywordflow">if</span> (stateProbInternal&lt;<a class="code" href="QuEST__precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a>) outcome=0;
<a name="l00215"></a>00215     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (1-stateProbInternal&lt;<a class="code" href="QuEST__precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a>) outcome=1;
<a name="l00216"></a>00216     <span class="keywordflow">else</span> {
<a name="l00217"></a>00217         <span class="comment">// ok. both P(0) and P(1) are large enough to resolve</span>
<a name="l00218"></a>00218         <span class="comment">// generate random float on [0,1]</span>
<a name="l00219"></a>00219         <span class="keywordtype">float</span> randNum = <a class="code" href="mt19937ar_8c.html#ac94ab75771800274ed1a2bedeca86f04">genrand_real1</a>();
<a name="l00220"></a>00220         <span class="keywordflow">if</span> (randNum&lt;=stateProbInternal) outcome = 1;
<a name="l00221"></a>00221         <span class="keywordflow">else</span> outcome = 0;
<a name="l00222"></a>00222     } 
<a name="l00223"></a>00223     <span class="keywordflow">if</span> (outcome==0) stateProbInternal = 1-stateProbInternal;
<a name="l00224"></a>00224     <a class="code" href="QuEST_8c.html#a01d9a8b7ff0e09ec399e158389783aa9" title="Update the state vector to be consistent with measuring measureQubit=0 if outcome=0...">collapseToOutcomeLocal</a>(multiQubit, measureQubit, stateProbInternal, outcome);
<a name="l00225"></a>00225     *stateProb = stateProbInternal;
<a name="l00226"></a>00226     <span class="keywordflow">return</span> outcome;
<a name="l00227"></a>00227 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae395a79690283ed81106afadd7a8cd8a"></a><!-- doxytag: member="QuEST_env_local.c::multiControlledUnitary" ref="ae395a79690283ed81106afadd7a8cd8a" args="(MultiQubit multiQubit, int *controlQubits, const int numControlQubits, const int targetQubit, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multiControlledUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>controlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>numControlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply a general multiple-control single-target unitary, which can include a global phase factor. </p>
<p>Any number of control qubits can be specified, and if all have value 1, the given unitary is applied to the target qubit. This effects the many-qubit unitary </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 1 \\ &amp; 1 \\\ &amp; &amp; \ddots \\ &amp; &amp; &amp; u_{00} &amp; u_{01}\\ &amp; &amp; &amp; u_{10} &amp; u_{11} \end{pmatrix} \]" src="form_34.png"/>
</p>
<p> on the control and target qubits. The given 2x2 ComplexMatrix must be unitary, otherwise an error is thrown.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 3) {controls}; \node[draw=none] at (-3.5, 0) {target}; \node[draw=none] at (0, 6) {$\vdots$}; \draw (0, 5) -- (0, 4); \draw (-2, 4) -- (2, 4); \draw[fill=black] (0, 4) circle (.2); \draw (0, 4) -- (0, 2); \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 1); \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {U}; \end{tikzpicture} } \]" src="form_35.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubits</em>&nbsp;</td><td>applies unitary if all qubits in this array equal 1 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>numControlQubits</em>&nbsp;</td><td>number of control qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to operate on </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>u</em>&nbsp;</td><td>single-qubit unitary matrix to apply </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>numControlQubits</code> is outside [1, <code>multiQubit.numQubits</code>]), or if any qubit index (<code>targetQubit</code> or one in <code>controlQubits</code>) is outside [0, <code>multiQubit.numQubits</code>]), or if <code>controlQubits</code> contains <code>targetQubit</code>, or if <code>u</code> is not unitary. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00134">134</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p>References <a class="el" href="QuEST_8c_source.html#l00742">multiControlledUnitaryLocal()</a>, <a class="el" href="QuEST_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00237">QuESTAssert()</a>, and <a class="el" href="QuEST_8c_source.html#l00346">validateMatrixIsUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00135"></a>00135 {
<a name="l00136"></a>00136     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00137"></a>00137     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(numControlQubits &gt; 0 &amp;&amp; numControlQubits &lt;= multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 4, __func__);
<a name="l00138"></a>00138     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(<a class="code" href="QuEST_8c.html#ae4fea133d1a8f09ff8da03038100adb2">validateMatrixIsUnitary</a>(u), 5, __func__);
<a name="l00139"></a>00139 
<a name="l00140"></a>00140     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> mask=0; 
<a name="l00141"></a>00141     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;numControlQubits; i++) mask = mask | (1LL&lt;&lt;controlQubits[i]);
<a name="l00142"></a>00142     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(mask &gt;=0 &amp;&amp; mask &lt;= (1LL&lt;&lt;multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>)-1, 2, __func__);
<a name="l00143"></a>00143     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>((mask &amp; (1LL&lt;&lt;targetQubit)) != (1LL&lt;&lt;targetQubit), 3, __func__);
<a name="l00144"></a>00144 
<a name="l00145"></a>00145     <a class="code" href="QuEST_8c.html#a1309eabcba3cb97fbc3cd2e606d17766">multiControlledUnitaryLocal</a>(multiQubit, targetQubit, mask, u);
<a name="l00146"></a>00146 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aae7a8a7f1ccbddb7f76b6c52b746bb43"></a><!-- doxytag: member="QuEST_env_local.c::phaseGate" ref="aae7a8a7f1ccbddb7f76b6c52b746bb43" args="(MultiQubit multiQubit, const int targetQubit, enum phaseGateType type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void phaseGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a>&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00160">160</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l01581">sGate()</a>, <a class="el" href="QuEST_8c_source.html#l01576">sigmaZ()</a>, and <a class="el" href="QuEST_8c_source.html#l01586">tGate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00161"></a>00161 {
<a name="l00162"></a>00162     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00163"></a>00163     <a class="code" href="QuEST_8c.html#a3a54566b73ac84c312d7da4f56ffbc3b">phaseGateLocal</a>(multiQubit, targetQubit, type);
<a name="l00164"></a>00164 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3587b9d533e633ccf1abf9ad2ce45d8d"></a><!-- doxytag: member="QuEST_env_local.c::QuESTAssert" ref="a3587b9d533e633ccf1abf9ad2ce45d8d" args="(int isValid, int errorCode, const char *func)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void QuESTAssert </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>isValid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>errorCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>func</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00237">237</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00189">collapseToOutcome()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00095">compactUnitary()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00113">controlledCompactUnitary()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00172">controlledNot()</a>, <a class="el" href="QuEST_8c_source.html#l01703">controlledPhaseGate()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00124">controlledUnitary()</a>, <a class="el" href="QuEST_8c_source.html#l00046">createMultiQubit()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00180">findProbabilityOfOutcome()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00166">hadamard()</a>, <a class="el" href="QuEST_8c_source.html#l00298">initializeStateFromSingleFile()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00200">measure()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00206">measureWithStats()</a>, <a class="el" href="QuEST_8c_source.html#l01738">multiControlledPhaseGate()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00134">multiControlledUnitary()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00160">phaseGate()</a>, <a class="el" href="QuEST_8c_source.html#l00088">reportState()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00148">sigmaX()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00154">sigmaY()</a>, and <a class="el" href="QuEST__env__local_8c_source.html#l00104">unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00237"></a>00237                                                               {
<a name="l00238"></a>00238     <span class="keywordflow">if</span> (!isValid) <a class="code" href="QuEST__env__local_8c.html#ae5f9019826f35e8b51b1716cfe397b45">exitWithError</a>(errorCode, func);
<a name="l00239"></a>00239 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a62da5b58d8ce84e6f4d24be1b872294e"></a><!-- doxytag: member="QuEST_env_local.c::reportNodeList" ref="a62da5b58d8ce84e6f4d24be1b872294e" args="(QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportNodeList </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Report a list of CPU hostnames and the rank that is running on each if running with MPI enabled and an error message otherwise. </p>
<p>For debugging purposes. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00053">53</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00053"></a>00053                                  {
<a name="l00054"></a>00054     printf(<span class="stringliteral">&quot;Hostname unknown: running locally\n&quot;</span>);
<a name="l00055"></a>00055 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af8a14ae79c3fb2c0b5f6255cc37bebf9"></a><!-- doxytag: member="QuEST_env_local.c::reportQuESTEnv" ref="af8a14ae79c3fb2c0b5f6255cc37bebf9" args="(QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportQuESTEnv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Report information about the QuEST environment. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00040">40</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00069">QuESTEnv::numRanks</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00040"></a>00040                                  {
<a name="l00041"></a>00041     printf(<span class="stringliteral">&quot;EXECUTION ENVIRONMENT:\n&quot;</span>);
<a name="l00042"></a>00042     printf(<span class="stringliteral">&quot;Running locally on one node\n&quot;</span>);
<a name="l00043"></a>00043     printf(<span class="stringliteral">&quot;Number of ranks is %d\n&quot;</span>, env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>);
<a name="l00044"></a>00044 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00045"></a>00045 <span class="preprocessor"></span>    printf(<span class="stringliteral">&quot;OpenMP enabled\n&quot;</span>);
<a name="l00046"></a>00046     printf(<span class="stringliteral">&quot;Number of threads available is %d\n&quot;</span>, omp_get_max_threads());
<a name="l00047"></a>00047 <span class="preprocessor"># else</span>
<a name="l00048"></a>00048 <span class="preprocessor"></span>    printf(<span class="stringliteral">&quot;OpenMP disabled\n&quot;</span>);
<a name="l00049"></a>00049 <span class="preprocessor"># endif</span>
<a name="l00050"></a>00050 <span class="preprocessor"></span>    printf(<span class="stringliteral">&quot;Precision: size of REAL is %ld bytes\n&quot;</span>, <span class="keyword">sizeof</span>(<a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>));
<a name="l00051"></a>00051 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a86e396e06b7d527cac20ba0108872423"></a><!-- doxytag: member="QuEST_env_local.c::sigmaX" ref="a86e396e06b7d527cac20ba0108872423" args="(MultiQubit multiQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaX </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply the single-qubit sigma-X (also known as the X, Pauli-X, NOT or bit-flip) gate. </p>
<p>This is a rotation of <img class="formulaInl" alt="$\pi$" src="form_36.png"/> around the x-axis on the Bloch sphere. I.e. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 0 &amp; 1 \\ 1 &amp; 0 \end{pmatrix} \]" src="form_37.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (2, 0); \draw (0, 0) circle (.5); \draw (0, .5) -- (0, -.5); \end{tikzpicture} } \]" src="form_38.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to operate on </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>targetQubit</code> is outside [0, <code>multiQubit.numQubits</code>). </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00148">148</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00237">QuESTAssert()</a>, and <a class="el" href="QuEST_8c_source.html#l01061">sigmaXLocal()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00149"></a>00149 {
<a name="l00150"></a>00150     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00151"></a>00151     <a class="code" href="QuEST_8c.html#a74822fd86bb5d81766e6e8dbdcd62df1">sigmaXLocal</a>(multiQubit, targetQubit);
<a name="l00152"></a>00152 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1f54d70a42403f7e1c2e2c2007332f61"></a><!-- doxytag: member="QuEST_env_local.c::sigmaY" ref="a1f54d70a42403f7e1c2e2c2007332f61" args="(MultiQubit multiQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaY </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply the single-qubit sigma-Y (also known as the Y or Pauli-Y) gate. </p>
<p>This is a rotation of <img class="formulaInl" alt="$\pi$" src="form_36.png"/> around the Y-axis on the Bloch sphere. I.e. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 0 &amp; -i \\ i &amp; 0 \end{pmatrix} \]" src="form_39.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$\sigma_y$}; \end{tikzpicture} } \]" src="form_40.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to operate on </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>targetQubit</code> is outside [0, <code>multiQubit.numQubits</code>). </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00154">154</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00237">QuESTAssert()</a>, and <a class="el" href="QuEST_8c_source.html#l01248">sigmaYLocal()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00155"></a>00155 {
<a name="l00156"></a>00156     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00157"></a>00157     <a class="code" href="QuEST_8c.html#a81fbfaed65a742a7dfd622e17652245e">sigmaYLocal</a>(multiQubit, targetQubit);
<a name="l00158"></a>00158 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8d31fe2d1ad4d01e2a1f5f6b8bc15b77"></a><!-- doxytag: member="QuEST_env_local.c::syncQuESTEnv" ref="a8d31fe2d1ad4d01e2a1f5f6b8bc15b77" args="(QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void syncQuESTEnv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Guarantees that all code up to the given point has been executed on all nodes (if running in distributed mode). </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00028">28</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00028"></a>00028                                {
<a name="l00029"></a>00029     <span class="comment">// MPI Barrier goes here in MPI version. </span>
<a name="l00030"></a>00030 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac7e38d768a1bd79019f88cc1e6295092"></a><!-- doxytag: member="QuEST_env_local.c::syncQuESTSuccess" ref="ac7e38d768a1bd79019f88cc1e6295092" args="(int successCode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int syncQuESTSuccess </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>successCode</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Performs a logical AND on all successCodes held by all processes. </p>
<p>If any one process has a zero successCode all processes will return a zero success code.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>successCode</em>&nbsp;</td><td>1 if process task succeeded, 0 if process task failed </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>1 if all processes succeeded, 0 if any one process failed </dd></dl>

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00032">32</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00032"></a>00032                                      {
<a name="l00033"></a>00033     <span class="keywordflow">return</span> successCode;
<a name="l00034"></a>00034 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7a0877e33700f6bad48adb51b7b3fb67"></a><!-- doxytag: member="QuEST_env_local.c::unitary" ref="a7a0877e33700f6bad48adb51b7b3fb67" args="(MultiQubit multiQubit, const int targetQubit, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void unitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply a general single-qubit unitary (including a global phase factor). </p>
<p>The passed 2x2 ComplexMatrix must be unitary, otherwise an error is thrown.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {U}; \end{tikzpicture} } \]" src="form_22.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to operate on </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>u</em>&nbsp;</td><td>unitary matrix to apply </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>targetQubit</code> is outside [0, <code>multiQubit.numQubits</code>), or matrix <code>u</code> is not unitary. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00104">104</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00237">QuESTAssert()</a>, <a class="el" href="QuEST_8c_source.html#l00504">unitaryLocal()</a>, and <a class="el" href="QuEST_8c_source.html#l00346">validateMatrixIsUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00105"></a>00105 {
<a name="l00106"></a>00106     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00107"></a>00107     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(<a class="code" href="QuEST_8c.html#ae4fea133d1a8f09ff8da03038100adb2">validateMatrixIsUnitary</a>(u), 5, __func__);
<a name="l00108"></a>00108 
<a name="l00109"></a>00109     <span class="comment">// all values required to update state vector lie in this rank</span>
<a name="l00110"></a>00110     <a class="code" href="QuEST_8c.html#ac134fb45b0a7248c5d15e16eb7139a35">unitaryLocal</a>(multiQubit, targetQubit, u);
<a name="l00111"></a>00111 }
</pre></div></p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 2 May 2018 for Distributed QuEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
