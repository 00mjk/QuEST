# Python
from QuESTPy.QuESTFunc import *
from QuESTTest.QuESTCore import *
import os.path

def run_tests():
    ExpectFile = find_file('AddDenMattests')
    if ExpectFile is None:
        testResults.fail_test(message="Couldn't find file")
        return
    nQubits = int(ExpectFile.readline())
    
    QubitsA = argQureg(nQubits,'Z',denMat=True)
    QubitsB = argQureg(nQubits,'D',denMat=True)

    addDensityMatrix(QubitsA,0.5,QubitsB)

    Expect = ExpectFile.read_state_vec(nQubits, denMat = True)
    testResults.validate(testResults.compareStates(QubitsA, Expect), 'Add Debug-Zero States', 'Failed')

def gen_tests(nQubits):
    results = find_file('QFTtests',write=True)
    QubitsA = argQureg(nQubits,'Z', denMat=True)
    QubitsB = argQureg(nQubits,'D', denMat=True)
    results.write(f"{nQubits}\n")
    addDensityMatrix(QubitsA, 0.5, QubitsB)

    for elem in QubitsA._state_vec():
        results.write(elem)
    results.close()