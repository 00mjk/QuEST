<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Quantum Exact Simulation Toolkit: QuEST.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Quantum Exact Simulation Toolkit
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d522931ffa1371640980b621734a4381.html">Users</a></li><li class="navelem"><a class="el" href="dir_70834f0dcd10de01d2e35ab402a2238e.html">tysonjones</a></li><li class="navelem"><a class="el" href="dir_1957401ef452be7528010ba0f4832a45.html">Desktop</a></li><li class="navelem"><a class="el" href="dir_e763e4f63987bc6dd0ff21f56afcfed4.html">QuESTRestructured</a></li><li class="navelem"><a class="el" href="dir_b6ad6e9ca9478e43d4c44cdd00457d5f.html">QuEST</a></li><li class="navelem"><a class="el" href="dir_3169c7eb82da2c300108f4c2052f6e4d.html">QuEST</a></li><li class="navelem"><a class="el" href="dir_e97c460c7ba33c252ab3ba7c12a55153.html">CPU</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">QuEST.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="QuEST_8h_source.html">../QuEST.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="QuEST__precision_8h_source.html">../QuEST_precision.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mt19937ar_8h_source.html">../mt19937ar.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="CPU_2QuEST__internal_8h_source.html">QuEST_internal.h</a>&quot;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;sys/param.h&gt;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &lt;sys/time.h&gt;</code><br />
</div>
<p><a href="QuEST_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad3d8a3bd0c0b677acef144f2c2ef6d73"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#ad3d8a3bd0c0b677acef144f2c2ef6d73">_BSD_SOURCE</a></td></tr>
<tr class="separator:ad3d8a3bd0c0b677acef144f2c2ef6d73"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7a1f63ec3c42d9ad72f1f01c14a885db"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a7a1f63ec3c42d9ad72f1f01c14a885db">collapseToOutcomeDistributedRenorm</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit, const <a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> totalProbability)</td></tr>
<tr class="memdesc:a7a1f63ec3c42d9ad72f1f01c14a885db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Renormalise parts of the state vector where measureQubit=0 or 1, based on the total probability of that qubit being in state 0 or 1.  <a href="#a7a1f63ec3c42d9ad72f1f01c14a885db">More...</a><br /></td></tr>
<tr class="separator:a7a1f63ec3c42d9ad72f1f01c14a885db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78908fe8e75a21fd4f7fa7dff05d6be1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a78908fe8e75a21fd4f7fa7dff05d6be1">collapseToOutcomeDistributedSetZero</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit)</td></tr>
<tr class="memdesc:a78908fe8e75a21fd4f7fa7dff05d6be1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set all amplitudes in one chunk to 0.  <a href="#a78908fe8e75a21fd4f7fa7dff05d6be1">More...</a><br /></td></tr>
<tr class="separator:a78908fe8e75a21fd4f7fa7dff05d6be1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01d9a8b7ff0e09ec399e158389783aa9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a01d9a8b7ff0e09ec399e158389783aa9">collapseToOutcomeLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, int measureQubit, <a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> totalProbability, int outcome)</td></tr>
<tr class="memdesc:a01d9a8b7ff0e09ec399e158389783aa9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the state vector to be consistent with measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1.  <a href="#a01d9a8b7ff0e09ec399e158389783aa9">More...</a><br /></td></tr>
<tr class="separator:a01d9a8b7ff0e09ec399e158389783aa9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20ee1878a63ae6112e8845f4a8787592"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a20ee1878a63ae6112e8845f4a8787592">compactUnitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr class="memdesc:a20ee1878a63ae6112e8845f4a8787592"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta, and a subset of the state vector with upper and lower block values stored seperately.  <a href="#a20ee1878a63ae6112e8845f4a8787592">More...</a><br /></td></tr>
<tr class="separator:a20ee1878a63ae6112e8845f4a8787592"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cee2d8716667a3318420a3b672f5b92"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a9cee2d8716667a3318420a3b672f5b92">compactUnitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr class="separator:a9cee2d8716667a3318420a3b672f5b92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a793584932ae384c82e7e42db7d35d18d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a793584932ae384c82e7e42db7d35d18d">compareStates</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> mq1, <a class="el" href="structMultiQubit.html">MultiQubit</a> mq2, <a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> precision)</td></tr>
<tr class="memdesc:a793584932ae384c82e7e42db7d35d18d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return whether two given wavefunctions are equivalent within a given precision Global phase included in equivalence check.  <a href="#a793584932ae384c82e7e42db7d35d18d">More...</a><br /></td></tr>
<tr class="separator:a793584932ae384c82e7e42db7d35d18d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a717855e835e3161e08c18cdc15325d27"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a717855e835e3161e08c18cdc15325d27">controlledCompactUnitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr class="memdesc:a717855e835e3161e08c18cdc15325d27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately.  <a href="#a717855e835e3161e08c18cdc15325d27">More...</a><br /></td></tr>
<tr class="separator:a717855e835e3161e08c18cdc15325d27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc77657651d52c47403b44b923a098a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#afc77657651d52c47403b44b923a098a8">controlledCompactUnitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr class="separator:afc77657651d52c47403b44b923a098a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05875a70b539a3efb28d027823403f34"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a05875a70b539a3efb28d027823403f34">controlledNotDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecIn, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr class="memdesc:a05875a70b539a3efb28d027823403f34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by {{0,1},{1,0}.  <a href="#a05875a70b539a3efb28d027823403f34">More...</a><br /></td></tr>
<tr class="separator:a05875a70b539a3efb28d027823403f34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad357a43e80e3baf013975b1b70942f4c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#ad357a43e80e3baf013975b1b70942f4c">controlledNotLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit)</td></tr>
<tr class="separator:ad357a43e80e3baf013975b1b70942f4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11a96159191cbf1b01a1080e7f045aac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a11a96159191cbf1b01a1080e7f045aac">controlledPhaseGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int idQubit1, const int idQubit2)</td></tr>
<tr class="memdesc:a11a96159191cbf1b01a1080e7f045aac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply the (two-qubit) controlled phase gate, also known as the controlled sigmaZ gate.  <a href="#a11a96159191cbf1b01a1080e7f045aac">More...</a><br /></td></tr>
<tr class="separator:a11a96159191cbf1b01a1080e7f045aac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad41f82b41149393a642391b67b3a287e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#ad41f82b41149393a642391b67b3a287e">controlledRotateAroundAxis</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> angle, <a class="el" href="structVector.html">Vector</a> axis)</td></tr>
<tr class="memdesc:ad41f82b41149393a642391b67b3a287e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies a controlled rotation by a given angle around a given vector on the Bloch-sphere.  <a href="#ad41f82b41149393a642391b67b3a287e">More...</a><br /></td></tr>
<tr class="separator:ad41f82b41149393a642391b67b3a287e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6923ac57e67d9a21096e06f6a9012f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#ac6923ac57e67d9a21096e06f6a9012f6">controlledRotateX</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> angle)</td></tr>
<tr class="memdesc:ac6923ac57e67d9a21096e06f6a9012f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies a controlled rotation by a given angle around the X-axis of the Bloch-sphere.  <a href="#ac6923ac57e67d9a21096e06f6a9012f6">More...</a><br /></td></tr>
<tr class="separator:ac6923ac57e67d9a21096e06f6a9012f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71e90a2f7292116338c062934f9d1202"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a71e90a2f7292116338c062934f9d1202">controlledRotateY</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> angle)</td></tr>
<tr class="memdesc:a71e90a2f7292116338c062934f9d1202"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies a controlled rotation by a given angle around the Y-axis of the Bloch-sphere.  <a href="#a71e90a2f7292116338c062934f9d1202">More...</a><br /></td></tr>
<tr class="separator:a71e90a2f7292116338c062934f9d1202"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a668e5d2634b02e98bc73675ccb11d61c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a668e5d2634b02e98bc73675ccb11d61c">controlledRotateZ</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> angle)</td></tr>
<tr class="memdesc:a668e5d2634b02e98bc73675ccb11d61c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies a controlled rotation by a given angle around the Z-axis of the Bloch-sphere.  <a href="#a668e5d2634b02e98bc73675ccb11d61c">More...</a><br /></td></tr>
<tr class="separator:a668e5d2634b02e98bc73675ccb11d61c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a642093063a1f889f61a1311f6d6f2d3f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a642093063a1f889f61a1311f6d6f2d3f">controlledUnitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr class="memdesc:a642093063a1f889f61a1311f6d6f2d3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately.  <a href="#a642093063a1f889f61a1311f6d6f2d3f">More...</a><br /></td></tr>
<tr class="separator:a642093063a1f889f61a1311f6d6f2d3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a4afcff70195a306c082b8ed8d4e09a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a8a4afcff70195a306c082b8ed8d4e09a">controlledUnitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr class="separator:a8a4afcff70195a306c082b8ed8d4e09a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c02591bc64c2918503afa231d90d83f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a9c02591bc64c2918503afa231d90d83f">createMultiQubit</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> *multiQubit, int numQubits, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>)</td></tr>
<tr class="memdesc:a9c02591bc64c2918503afa231d90d83f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a <a class="el" href="structMultiQubit.html" title="Represents a system of qubits. ">MultiQubit</a> object representing a set of qubits.  <a href="#a9c02591bc64c2918503afa231d90d83f">More...</a><br /></td></tr>
<tr class="separator:a9c02591bc64c2918503afa231d90d83f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5d6acc322314d7a3d8a2eccf00d3b19"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#ae5d6acc322314d7a3d8a2eccf00d3b19">destroyMultiQubit</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>)</td></tr>
<tr class="memdesc:ae5d6acc322314d7a3d8a2eccf00d3b19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocate a <a class="el" href="structMultiQubit.html" title="Represents a system of qubits. ">MultiQubit</a> object representing a set of qubits.  <a href="#ae5d6acc322314d7a3d8a2eccf00d3b19">More...</a><br /></td></tr>
<tr class="separator:ae5d6acc322314d7a3d8a2eccf00d3b19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a100463f6ec212c76a5fad99579000505"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (const int locationOfBitFromRight, const long long int theEncodedNumber)</td></tr>
<tr class="memdesc:a100463f6ec212c76a5fad99579000505"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the value of the bit at a particular index in a number.  <a href="#a100463f6ec212c76a5fad99579000505">More...</a><br /></td></tr>
<tr class="separator:a100463f6ec212c76a5fad99579000505"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ac9bb717a889f09d307eda9f0b65957"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a9ac9bb717a889f09d307eda9f0b65957">findProbabilityOfZeroDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit)</td></tr>
<tr class="memdesc:a9ac9bb717a889f09d307eda9f0b65957"><td class="mdescLeft">&#160;</td><td class="mdescRight">Measure the probability of a specified qubit being in the zero state across all amplitudes held in this chunk.  <a href="#a9ac9bb717a889f09d307eda9f0b65957">More...</a><br /></td></tr>
<tr class="separator:a9ac9bb717a889f09d307eda9f0b65957"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c02cd0e1b4eac19771a0525f023249e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a7c02cd0e1b4eac19771a0525f023249e">findProbabilityOfZeroLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit)</td></tr>
<tr class="memdesc:a7c02cd0e1b4eac19771a0525f023249e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Measure the total probability of a specified qubit being in the zero state across all amplitudes in this chunk.  <a href="#a7c02cd0e1b4eac19771a0525f023249e">More...</a><br /></td></tr>
<tr class="separator:a7c02cd0e1b4eac19771a0525f023249e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f10aabf9f607f19093aee54630caa21"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a8f10aabf9f607f19093aee54630caa21">getEnvironmentString</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>, <a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, char str[200])</td></tr>
<tr class="separator:a8f10aabf9f607f19093aee54630caa21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac61ecf4fd9ab2ac8453c4eb5b0d34089"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#ac61ecf4fd9ab2ac8453c4eb5b0d34089">getNumAmps</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit)</td></tr>
<tr class="memdesc:ac61ecf4fd9ab2ac8453c4eb5b0d34089"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the number of probability amplitudes in a multiQubit object, given by 2^numQubits.  <a href="#ac61ecf4fd9ab2ac8453c4eb5b0d34089">More...</a><br /></td></tr>
<tr class="separator:ac61ecf4fd9ab2ac8453c4eb5b0d34089"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00e13dc88021b61a29fac9f3ab9ee850"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a00e13dc88021b61a29fac9f3ab9ee850">getNumQubits</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit)</td></tr>
<tr class="memdesc:a00e13dc88021b61a29fac9f3ab9ee850"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the number of qubits in a multiQubit object.  <a href="#a00e13dc88021b61a29fac9f3ab9ee850">More...</a><br /></td></tr>
<tr class="separator:a00e13dc88021b61a29fac9f3ab9ee850"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a799b10447d6dbdaf960a4d3eedd22014"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a799b10447d6dbdaf960a4d3eedd22014">getProbEl</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, long long int index)</td></tr>
<tr class="memdesc:a799b10447d6dbdaf960a4d3eedd22014"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the probability of the state at an index in the full state vector.  <a href="#a799b10447d6dbdaf960a4d3eedd22014">More...</a><br /></td></tr>
<tr class="separator:a799b10447d6dbdaf960a4d3eedd22014"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6a897066979fc52d977007d959ca09d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#ae6a897066979fc52d977007d959ca09d">hadamardDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut, int updateUpper)</td></tr>
<tr class="memdesc:ae6a897066979fc52d977007d959ca09d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by {{1,1},{1,-1}}/sqrt2.  <a href="#ae6a897066979fc52d977007d959ca09d">More...</a><br /></td></tr>
<tr class="separator:ae6a897066979fc52d977007d959ca09d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9f0718b4dd794a3e1b143e3b153bfc5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#aa9f0718b4dd794a3e1b143e3b153bfc5">hadamardLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr class="separator:aa9f0718b4dd794a3e1b143e3b153bfc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab76254cfde16f0808476649507a1a2fc"><td class="memItemLeft" align="right" valign="top">unsigned long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#ab76254cfde16f0808476649507a1a2fc">hashString</a> (char *str)</td></tr>
<tr class="separator:ab76254cfde16f0808476649507a1a2fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1b983b41249836ed2c2a81f77d83c40"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#ae1b983b41249836ed2c2a81f77d83c40">initClassicalState</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, long long int stateInd)</td></tr>
<tr class="memdesc:ae1b983b41249836ed2c2a81f77d83c40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise a set of <img class="formulaInl" alt="$ N $" src="form_0.png"/> qubits to the classical state with index <code>stateInd</code>.  <a href="#ae1b983b41249836ed2c2a81f77d83c40">More...</a><br /></td></tr>
<tr class="separator:ae1b983b41249836ed2c2a81f77d83c40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a433876ee9f3bcc54af346300f571fc3c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a433876ee9f3bcc54af346300f571fc3c">initializeStateFromSingleFile</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> *multiQubit, char filename[200], <a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>)</td></tr>
<tr class="memdesc:a433876ee9f3bcc54af346300f571fc3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialises the wavefunction amplitudes according to those specified in a file.  <a href="#a433876ee9f3bcc54af346300f571fc3c">More...</a><br /></td></tr>
<tr class="separator:a433876ee9f3bcc54af346300f571fc3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b737ff9b4267609ef27e6cb4c42dc68"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a4b737ff9b4267609ef27e6cb4c42dc68">initStateDebug</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit)</td></tr>
<tr class="memdesc:a4b737ff9b4267609ef27e6cb4c42dc68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the state vector of probability amplitudes to an (unphysical) state with each component of each probability amplitude a unique floating point value.  <a href="#a4b737ff9b4267609ef27e6cb4c42dc68">More...</a><br /></td></tr>
<tr class="separator:a4b737ff9b4267609ef27e6cb4c42dc68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7169fd0442cbc3418f3fac4d13363ca2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a7169fd0442cbc3418f3fac4d13363ca2">initStateOfSingleQubit</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> *multiQubit, int qubitId, int outcome)</td></tr>
<tr class="memdesc:a7169fd0442cbc3418f3fac4d13363ca2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the state vector of probability amplitudes such that one qubit is set to 'outcome' and all other qubits are in an equal superposition of zero and one.  <a href="#a7169fd0442cbc3418f3fac4d13363ca2">More...</a><br /></td></tr>
<tr class="separator:a7169fd0442cbc3418f3fac4d13363ca2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8a0082e2f695145bbfbb572e4c2e4f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#af8a0082e2f695145bbfbb572e4c2e4f1">initStatePlus</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit)</td></tr>
<tr class="memdesc:af8a0082e2f695145bbfbb572e4c2e4f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise a set of <img class="formulaInl" alt="$ N $" src="form_0.png"/> qubits to the plus state <img class="formulaInl" alt="$ {| + \rangle}^{\otimes N} = \frac{1}{\sqrt{2^N}} (| 0 \rangle + | 1 \rangle)^{\otimes N} $" src="form_2.png"/>.  <a href="#af8a0082e2f695145bbfbb572e4c2e4f1">More...</a><br /></td></tr>
<tr class="separator:af8a0082e2f695145bbfbb572e4c2e4f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ba8171c9ec5c42202b144026527e9ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a9ba8171c9ec5c42202b144026527e9ec">initStateZero</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit)</td></tr>
<tr class="memdesc:a9ba8171c9ec5c42202b144026527e9ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise a set of <img class="formulaInl" alt="$ N $" src="form_0.png"/> qubits to the classical zero state <img class="formulaInl" alt="$ {| 0 \rangle}^{\otimes N} $" src="form_1.png"/>.  <a href="#a9ba8171c9ec5c42202b144026527e9ec">More...</a><br /></td></tr>
<tr class="separator:a9ba8171c9ec5c42202b144026527e9ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc1835c6b43b6e59ce7df7b13f274fc7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#afc1835c6b43b6e59ce7df7b13f274fc7">multiControlledPhaseGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, int *controlQubits, int numControlQubits)</td></tr>
<tr class="memdesc:afc1835c6b43b6e59ce7df7b13f274fc7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply the multiple-qubit controlled phase gate, also known as the multiple-qubit controlled sigmaZ gate.  <a href="#afc1835c6b43b6e59ce7df7b13f274fc7">More...</a><br /></td></tr>
<tr class="separator:afc1835c6b43b6e59ce7df7b13f274fc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dbf856ebeea0cf0a3ee5aae6782f2d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a9dbf856ebeea0cf0a3ee5aae6782f2d2">multiControlledUnitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, long long int mask, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr class="memdesc:a9dbf856ebeea0cf0a3ee5aae6782f2d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply a unitary operation to a single qubit in the state vector of probability amplitudes, given a subset of the state vector with upper and lower block values stored seperately.  <a href="#a9dbf856ebeea0cf0a3ee5aae6782f2d2">More...</a><br /></td></tr>
<tr class="separator:a9dbf856ebeea0cf0a3ee5aae6782f2d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1309eabcba3cb97fbc3cd2e606d17766"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a1309eabcba3cb97fbc3cd2e606d17766">multiControlledUnitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, long long int mask, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr class="separator:a1309eabcba3cb97fbc3cd2e606d17766"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af832ed00b02a0597b7fe0b714032c54a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#af832ed00b02a0597b7fe0b714032c54a">phaseGateDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, enum <a class="el" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a> type)</td></tr>
<tr class="separator:af832ed00b02a0597b7fe0b714032c54a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a54566b73ac84c312d7da4f56ffbc3b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a3a54566b73ac84c312d7da4f56ffbc3b">phaseGateLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, enum <a class="el" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a> type)</td></tr>
<tr class="separator:a3a54566b73ac84c312d7da4f56ffbc3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5e77e0e64f3a4a3d3f5cc7382bffcd9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#aa5e77e0e64f3a4a3d3f5cc7382bffcd9">reportMultiQubitParams</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit)</td></tr>
<tr class="memdesc:aa5e77e0e64f3a4a3d3f5cc7382bffcd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Report metainformation about a set of qubits: number of qubits, number of probability amplitudes.  <a href="#aa5e77e0e64f3a4a3d3f5cc7382bffcd9">More...</a><br /></td></tr>
<tr class="separator:aa5e77e0e64f3a4a3d3f5cc7382bffcd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96f4de9ce7fefc7680a44d601fc3d894"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a96f4de9ce7fefc7680a44d601fc3d894">reportState</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit)</td></tr>
<tr class="memdesc:a96f4de9ce7fefc7680a44d601fc3d894"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the current state vector of probability amplitudes for a set of qubits to file.  <a href="#a96f4de9ce7fefc7680a44d601fc3d894">More...</a><br /></td></tr>
<tr class="separator:a96f4de9ce7fefc7680a44d601fc3d894"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a842d6884e063a5865a2232cba56b65ac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a842d6884e063a5865a2232cba56b65ac">reportStateToScreen</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>, int reportRank)</td></tr>
<tr class="memdesc:a842d6884e063a5865a2232cba56b65ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the current state vector of probability amplitudes for a set of qubits to standard out.  <a href="#a842d6884e063a5865a2232cba56b65ac">More...</a><br /></td></tr>
<tr class="separator:a842d6884e063a5865a2232cba56b65ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8810423457803005fecd415f4299f40d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a8810423457803005fecd415f4299f40d">rotateAroundAxis</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, <a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> angle, <a class="el" href="structVector.html">Vector</a> axis)</td></tr>
<tr class="memdesc:a8810423457803005fecd415f4299f40d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by a given angle around a given vector on the Bloch-sphere.  <a href="#a8810423457803005fecd415f4299f40d">More...</a><br /></td></tr>
<tr class="separator:a8810423457803005fecd415f4299f40d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cc7fa705a2f2e6b486b49c5589d5df5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a6cc7fa705a2f2e6b486b49c5589d5df5">rotateX</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, <a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> angle)</td></tr>
<tr class="memdesc:a6cc7fa705a2f2e6b486b49c5589d5df5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by a given angle around the X-axis of the Bloch-sphere.  <a href="#a6cc7fa705a2f2e6b486b49c5589d5df5">More...</a><br /></td></tr>
<tr class="separator:a6cc7fa705a2f2e6b486b49c5589d5df5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace0d3592d38a990e81a434c4e9681500"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#ace0d3592d38a990e81a434c4e9681500">rotateY</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, <a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> angle)</td></tr>
<tr class="memdesc:ace0d3592d38a990e81a434c4e9681500"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by a given angle around the Y-axis of the Bloch-sphere.  <a href="#ace0d3592d38a990e81a434c4e9681500">More...</a><br /></td></tr>
<tr class="separator:ace0d3592d38a990e81a434c4e9681500"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd621412ad30c1b034f4ce153c4afe10"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#abd621412ad30c1b034f4ce153c4afe10">rotateZ</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, <a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> angle)</td></tr>
<tr class="memdesc:abd621412ad30c1b034f4ce153c4afe10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by a given angle around the Z-axis of the Bloch-sphere (also known as a phase shift gate).  <a href="#abd621412ad30c1b034f4ce153c4afe10">More...</a><br /></td></tr>
<tr class="separator:abd621412ad30c1b034f4ce153c4afe10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95012dad46509b4b461974c34cfd7b3d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a95012dad46509b4b461974c34cfd7b3d">seedQuEST</a> (unsigned long int *seedArray, int numSeeds)</td></tr>
<tr class="memdesc:a95012dad46509b4b461974c34cfd7b3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">numSeeds &lt;= 64  <a href="#a95012dad46509b4b461974c34cfd7b3d">More...</a><br /></td></tr>
<tr class="separator:a95012dad46509b4b461974c34cfd7b3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0ab3ec70938712c26988a6aa51263a0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#ab0ab3ec70938712c26988a6aa51263a0">seedQuESTDefault</a> ()</td></tr>
<tr class="memdesc:ab0ab3ec70938712c26988a6aa51263a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Seed the Mersenne Twister used for random number generation in the QuEST environment with an example defualt seed.  <a href="#ab0ab3ec70938712c26988a6aa51263a0">More...</a><br /></td></tr>
<tr class="separator:ab0ab3ec70938712c26988a6aa51263a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adda6c47876a7676488ed0565a19eaa65"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#adda6c47876a7676488ed0565a19eaa65">sGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr class="memdesc:adda6c47876a7676488ed0565a19eaa65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply the single-qubit S gate.  <a href="#adda6c47876a7676488ed0565a19eaa65">More...</a><br /></td></tr>
<tr class="separator:adda6c47876a7676488ed0565a19eaa65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2275fff50824fe47485890ff5a857785"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a2275fff50824fe47485890ff5a857785">sigmaXDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecIn, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr class="memdesc:a2275fff50824fe47485890ff5a857785"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by {{0,1},{1,0}.  <a href="#a2275fff50824fe47485890ff5a857785">More...</a><br /></td></tr>
<tr class="separator:a2275fff50824fe47485890ff5a857785"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74822fd86bb5d81766e6e8dbdcd62df1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a74822fd86bb5d81766e6e8dbdcd62df1">sigmaXLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr class="separator:a74822fd86bb5d81766e6e8dbdcd62df1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5ef5166f00c0572354b4ac53dcf40cf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#af5ef5166f00c0572354b4ac53dcf40cf">sigmaYDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecIn, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut, int updateUpper)</td></tr>
<tr class="memdesc:af5ef5166f00c0572354b4ac53dcf40cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by {{0,-i},{i,0}.  <a href="#af5ef5166f00c0572354b4ac53dcf40cf">More...</a><br /></td></tr>
<tr class="separator:af5ef5166f00c0572354b4ac53dcf40cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81fbfaed65a742a7dfd622e17652245e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a81fbfaed65a742a7dfd622e17652245e">sigmaYLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr class="separator:a81fbfaed65a742a7dfd622e17652245e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebaab86326779de55d335cfea3efde8f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#aebaab86326779de55d335cfea3efde8f">sigmaZ</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr class="memdesc:aebaab86326779de55d335cfea3efde8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply the single-qubit sigma-Z (also known as the Z, Pauli-Z or phase-flip) gate.  <a href="#aebaab86326779de55d335cfea3efde8f">More...</a><br /></td></tr>
<tr class="separator:aebaab86326779de55d335cfea3efde8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af764ea63a2e870098f4e1ce08562942e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#af764ea63a2e870098f4e1ce08562942e">tGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr class="memdesc:af764ea63a2e870098f4e1ce08562942e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply the single-qubit T gate.  <a href="#af764ea63a2e870098f4e1ce08562942e">More...</a><br /></td></tr>
<tr class="separator:af764ea63a2e870098f4e1ce08562942e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2343b7240118e89aa615e2c9140b770b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a2343b7240118e89aa615e2c9140b770b">unitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr class="memdesc:a2343b7240118e89aa615e2c9140b770b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply a unitary operation to a single qubit given a subset of the state vector with upper and lower block values stored seperately.  <a href="#a2343b7240118e89aa615e2c9140b770b">More...</a><br /></td></tr>
<tr class="separator:a2343b7240118e89aa615e2c9140b770b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac134fb45b0a7248c5d15e16eb7139a35"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#ac134fb45b0a7248c5d15e16eb7139a35">unitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr class="separator:ac134fb45b0a7248c5d15e16eb7139a35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2b2c14a07dd7d50ff86032a3ca101d7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#ae2b2c14a07dd7d50ff86032a3ca101d7">validateAlphaBeta</a> (<a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr class="separator:ae2b2c14a07dd7d50ff86032a3ca101d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4fea133d1a8f09ff8da03038100adb2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#ae4fea133d1a8f09ff8da03038100adb2">validateMatrixIsUnitary</a> (<a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr class="separator:ae4fea133d1a8f09ff8da03038100adb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71c14976f63cfcda70026fa20ee531fe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#a71c14976f63cfcda70026fa20ee531fe">validateUnitVector</a> (<a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> ux, <a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> uy, <a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> uz)</td></tr>
<tr class="separator:a71c14976f63cfcda70026fa20ee531fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aac1637696885c75b73a1ecf381cea713"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST_8c.html#aac1637696885c75b73a1ecf381cea713">errorCodes</a> []</td></tr>
<tr class="separator:aac1637696885c75b73a1ecf381cea713"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ad3d8a3bd0c0b677acef144f2c2ef6d73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3d8a3bd0c0b677acef144f2c2ef6d73">&#9670;&nbsp;</a></span>_BSD_SOURCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _BSD_SOURCE</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00013">13</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a7a1f63ec3c42d9ad72f1f01c14a885db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a1f63ec3c42d9ad72f1f01c14a885db">&#9670;&nbsp;</a></span>collapseToOutcomeDistributedRenorm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> collapseToOutcomeDistributedRenorm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td>
          <td class="paramname"><em>totalProbability</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Renormalise parts of the state vector where measureQubit=0 or 1, based on the total probability of that qubit being in state 0 or 1. </p>
<p>Measure in Zero performs an irreversible change to the state vector: it updates the vector according to the event that the value 'outcome' has been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1. In the distributed version, one block (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) is spread over multiple chunks, meaning that each chunks performs only renormalisation or only setting amplitudes to 0. This function handles the renormalisation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measureQubit</td><td>qubit to measure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">totalProbability</td><td>probability of qubit measureQubit being zero </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01917">1917</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00678">collapseToOutcome()</a>, and <a class="el" href="QuEST__env__mpi_8c_source.html#l00712">measureWithStats()</a>.</p>
<div class="fragment"><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;{</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    <span class="comment">// ----- temp variables</span></div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   </div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> renorm=1/sqrt(totalProbability);</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;<span class="preprocessor">    shared    (numTasks,stateVecReal,stateVecImag) \</span></div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;<span class="preprocessor">    private   (thisTask)</span></div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    {</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;<span class="preprocessor"># pragma omp for schedule  (static)</span></div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;            stateVecReal[thisTask] = stateVecReal[thisTask]*renorm;</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;            stateVecImag[thisTask] = stateVecImag[thisTask]*renorm;</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;        }</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    }</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    <span class="keywordflow">return</span> totalProbability;</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a78908fe8e75a21fd4f7fa7dff05d6be1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78908fe8e75a21fd4f7fa7dff05d6be1">&#9670;&nbsp;</a></span>collapseToOutcomeDistributedSetZero()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void collapseToOutcomeDistributedSetZero </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>measureQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set all amplitudes in one chunk to 0. </p>
<p>Measure in Zero performs an irreversible change to the state vector: it updates the vector according to the event that a zero have been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 or 1. In the distributed version, one block (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) is spread over multiple chunks, meaning that each chunks performs only renormalisation or only setting amplitudes to 0. This function handles setting amplitudes to 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measureQubit</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01957">1957</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00678">collapseToOutcome()</a>, and <a class="el" href="QuEST__env__mpi_8c_source.html#l00712">measureWithStats()</a>.</p>
<div class="fragment"><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;{</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <span class="comment">// ----- temp variables</span></div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   </div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <span class="comment">//            find probability                                      //</span></div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;<span class="preprocessor">    shared    (numTasks,stateVecReal,stateVecImag) \</span></div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;<span class="preprocessor">    private   (thisTask)</span></div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    {</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;<span class="preprocessor"># pragma omp for schedule  (static)</span></div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;            stateVecReal[thisTask] = 0;</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;            stateVecImag[thisTask] = 0;</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;        }</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    }</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a01d9a8b7ff0e09ec399e158389783aa9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01d9a8b7ff0e09ec399e158389783aa9">&#9670;&nbsp;</a></span>collapseToOutcomeLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void collapseToOutcomeLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td>
          <td class="paramname"><em>totalProbability</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>outcome</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the state vector to be consistent with measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1. </p>
<p>Performs an irreversible change to the state vector: it updates the vector according to the event that an outcome have been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 or 1 according to the value of outcome. In the local version, one or more blocks (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) fit entirely into one chunk.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measureQubit</td><td>qubit to measure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">totalProbability</td><td>probability of qubit measureQubit being either zero or one </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">outcome</td><td>to measure the probability of and set the state to &ndash; either zero or one </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01835">1835</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00192">collapseToOutcome()</a>, and <a class="el" href="QuEST__env__local_8c_source.html#l00209">measureWithStats()</a>.</p>
<div class="fragment"><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;{</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    <span class="comment">// ----- sizes</span></div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock,                                  <span class="comment">// size of blocks</span></div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;         sizeHalfBlock;                                       <span class="comment">// size of blocks halved</span></div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    <span class="comment">// ----- indices</span></div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock,                                  <span class="comment">// current block</span></div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;         index;                                               <span class="comment">// current index for first half block</span></div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <span class="comment">// ----- measured probability</span></div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   renorm;                                            <span class="comment">// probability (returned) value</span></div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    <span class="comment">// ----- temp variables</span></div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span></div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <span class="comment">// (good for shared memory parallelism)</span></div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <span class="comment">//            dimensions                                            //</span></div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    sizeHalfBlock = 1LL &lt;&lt; (measureQubit);                       <span class="comment">// number of state vector elements to sum,</span></div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    <span class="comment">// and then the number to skip</span></div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    sizeBlock     = 2LL * sizeHalfBlock;                         <span class="comment">// size of blocks (pairs of measure and skip entries)</span></div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    renorm=1/sqrt(totalProbability);</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;<span class="preprocessor">    default (none) \</span></div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;<span class="preprocessor">    shared    (numTasks,sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag,renorm,outcome) \</span></div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;<span class="preprocessor">    private   (thisTask,thisBlock,index)</span></div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    {</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;        <span class="keywordflow">if</span> (outcome==0){</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;            <span class="comment">// measure qubit is 0</span></div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;<span class="preprocessor"># pragma omp for schedule  (static)</span></div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;            <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;                thisBlock = thisTask / sizeHalfBlock;</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;                index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;                stateVecReal[index]=stateVecReal[index]*renorm;</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;                stateVecImag[index]=stateVecImag[index]*renorm;</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;                stateVecReal[index+sizeHalfBlock]=0;</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;                stateVecImag[index+sizeHalfBlock]=0;</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;            }</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;            <span class="comment">// measure qubit is 1</span></div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;<span class="preprocessor"># pragma omp for schedule  (static)</span></div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;            <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;                thisBlock = thisTask / sizeHalfBlock;</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;                index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;                stateVecReal[index]=0;</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;                stateVecImag[index]=0;</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;                stateVecReal[index+sizeHalfBlock]=stateVecReal[index+sizeHalfBlock]*renorm;</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;                stateVecImag[index+sizeHalfBlock]=stateVecImag[index+sizeHalfBlock]*renorm;</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;            }</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;        }</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    }</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a20ee1878a63ae6112e8845f4a8787592"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20ee1878a63ae6112e8845f4a8787592">&#9670;&nbsp;</a></span>compactUnitaryDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compactUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta, and a subset of the state vector with upper and lower block values stored seperately. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot1</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot2</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecUp</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecLo</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00619">619</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00030">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00029">Complex::real</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00272">compactUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;{</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="preprocessor">            rot1Real,rot1Imag, rot2Real,rot2Imag) \</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    {</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            stateRealUp = stateVecRealUp[thisTask];</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            stateImagUp = stateVecImagUp[thisTask];</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            stateRealLo = stateVecRealLo[thisTask];</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            stateImagLo = stateVecImagLo[thisTask];</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp + rot2Real*stateRealLo + rot2Imag*stateImagLo;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp + rot2Real*stateImagLo - rot2Imag*stateRealLo;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        }</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    }</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="structComplex_html_a1151948284b21c0052f203f23ab931d9"><div class="ttname"><a href="structComplex.html#a1151948284b21c0052f203f23ab931d9">Complex::imag</a></div><div class="ttdeci">REAL imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00030">QuEST.h:30</a></div></div>
<div class="ttc" id="structComplex_html_a479ad939835457595fcca3ca55c06283"><div class="ttname"><a href="structComplex.html#a479ad939835457595fcca3ca55c06283">Complex::real</a></div><div class="ttdeci">REAL real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00029">QuEST.h:29</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9cee2d8716667a3318420a3b672f5b92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cee2d8716667a3318420a3b672f5b92">&#9670;&nbsp;</a></span>compactUnitaryLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compactUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00490">490</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00030">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, <a class="el" href="QuEST_8h_source.html#l00029">Complex::real</a>, and <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00098">compactUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;{</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">// set dimensions</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="comment">// Can&#39;t use multiQubit.stateVec as a private OMP var</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> alphaImag=alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>, alphaReal=alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> betaImag=beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>, betaReal=beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, alphaReal,alphaImag, betaReal,betaImag) \</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    {</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            stateRealLo = stateVecReal[indexLo];</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            stateImagLo = stateVecImag[indexLo];</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            stateVecReal[indexUp] = alphaReal*stateRealUp - alphaImag*stateImagUp </div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                - betaReal*stateRealLo - betaImag*stateImagLo;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            stateVecImag[indexUp] = alphaReal*stateImagUp + alphaImag*stateRealUp </div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                - betaReal*stateImagLo + betaImag*stateRealLo;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            <span class="comment">// state[indexLo] = beta  * state[indexUp] + conj(alpha) * state[indexLo]</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            stateVecReal[indexLo] = betaReal*stateRealUp - betaImag*stateImagUp </div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                + alphaReal*stateRealLo + alphaImag*stateImagLo;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            stateVecImag[indexLo] = betaReal*stateImagUp + betaImag*stateRealUp </div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                + alphaReal*stateImagLo - alphaImag*stateRealLo;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        } </div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    }</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;} </div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="structComplex_html_a1151948284b21c0052f203f23ab931d9"><div class="ttname"><a href="structComplex.html#a1151948284b21c0052f203f23ab931d9">Complex::imag</a></div><div class="ttdeci">REAL imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00030">QuEST.h:30</a></div></div>
<div class="ttc" id="structComplex_html_a479ad939835457595fcca3ca55c06283"><div class="ttname"><a href="structComplex.html#a479ad939835457595fcca3ca55c06283">Complex::real</a></div><div class="ttdeci">REAL real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00029">QuEST.h:29</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a793584932ae384c82e7e42db7d35d18d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a793584932ae384c82e7e42db7d35d18d">&#9670;&nbsp;</a></span>compareStates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int compareStates </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>mq1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>mq2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td>
          <td class="paramname"><em>precision</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return whether two given wavefunctions are equivalent within a given precision Global phase included in equivalence check. </p>
<p>For debugging purposes. </p>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00379">379</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="runTests_8c_source.html#l00717">test_collapseToOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00366">test_compactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00495">test_controlledCompactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00274">test_controlledNot()</a>, <a class="el" href="runTests_8c_source.html#l00308">test_controlledPhaseGate()</a>, <a class="el" href="runTests_8c_source.html#l00540">test_controlledUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00190">test_hadamard()</a>, <a class="el" href="runTests_8c_source.html#l00054">test_initStatePlus()</a>, <a class="el" href="runTests_8c_source.html#l00031">test_initStateZero()</a>, <a class="el" href="runTests_8c_source.html#l00782">test_measure()</a>, <a class="el" href="runTests_8c_source.html#l00833">test_measureWithStats()</a>, <a class="el" href="runTests_8c_source.html#l00340">test_multiControlledPhaseGate()</a>, <a class="el" href="runTests_8c_source.html#l00590">test_multiControlledUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00218">test_sGate()</a>, <a class="el" href="runTests_8c_source.html#l00103">test_sigmaX()</a>, <a class="el" href="runTests_8c_source.html#l00132">test_sigmaY()</a>, <a class="el" href="runTests_8c_source.html#l00161">test_sigmaZ()</a>, <a class="el" href="runTests_8c_source.html#l00246">test_tGate()</a>, and <a class="el" href="runTests_8c_source.html#l00428">test_unitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                                                                 {</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> diff;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordtype">int</span> chunkSize = mq1.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;chunkSize; i++){</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        diff = fabs(mq1.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[i] - mq2.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[i]);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="keywordflow">if</span> (diff&gt;precision) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        diff = fabs(mq1.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[i] - mq2.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[i]);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="keywordflow">if</span> (diff&gt;precision) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    }</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a717855e835e3161e08c18cdc15325d27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a717855e835e3161e08c18cdc15325d27">&#9670;&nbsp;</a></span>controlledCompactUnitaryDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledCompactUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately. </p>
<p>Only perform the rotation where the control qubit is one.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">controlQubit</td><td>qubit to determine whether or not to perform a rotation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot1</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot2</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecUp</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecLo</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00929">929</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00067">MultiQubit::chunkId</a>, <a class="el" href="QuEST_8c_source.html#l01743">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00030">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00029">Complex::real</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00354">controlledCompactUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;{</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="keywordtype">int</span> controlBit;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="preprocessor">            rot1Real,rot1Imag, rot2Real,rot2Imag) \</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit)</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    {</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            controlBit = <a class="code" href="QuEST_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            <span class="keywordflow">if</span> (controlBit){</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                stateRealUp = stateVecRealUp[thisTask];</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                stateImagUp = stateVecImagUp[thisTask];</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                stateRealLo = stateVecRealLo[thisTask];</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                stateImagLo = stateVecImagLo[thisTask];</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp + rot2Real*stateRealLo + rot2Imag*stateImagLo;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp + rot2Real*stateImagLo - rot2Imag*stateRealLo;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            }</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        }</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    }</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="structComplex_html_a1151948284b21c0052f203f23ab931d9"><div class="ttname"><a href="structComplex.html#a1151948284b21c0052f203f23ab931d9">Complex::imag</a></div><div class="ttdeci">REAL imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00030">QuEST.h:30</a></div></div>
<div class="ttc" id="structComplex_html_a479ad939835457595fcca3ca55c06283"><div class="ttname"><a href="structComplex.html#a479ad939835457595fcca3ca55c06283">Complex::real</a></div><div class="ttdeci">REAL real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00029">QuEST.h:29</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="QuEST_8c_html_a100463f6ec212c76a5fad99579000505"><div class="ttname"><a href="QuEST_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a></div><div class="ttdeci">static int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdoc">Get the value of the bit at a particular index in a number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01743">QuEST.c:1743</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afc77657651d52c47403b44b923a098a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc77657651d52c47403b44b923a098a8">&#9670;&nbsp;</a></span>controlledCompactUnitaryLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledCompactUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00720">720</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00067">MultiQubit::chunkId</a>, <a class="el" href="QuEST_8c_source.html#l01743">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00030">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, <a class="el" href="QuEST_8h_source.html#l00029">Complex::real</a>, and <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00116">controlledCompactUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;{</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keywordtype">int</span> controlBit;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="comment">// set dimensions</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="comment">// Can&#39;t use multiQubit.stateVec as a private OMP var</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> alphaImag=alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>, alphaReal=alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> betaImag=beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>, betaReal=beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, alphaReal,alphaImag, betaReal,betaImag) \</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit) </span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    {</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            controlBit = <a class="code" href="QuEST_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (controlQubit, indexUp+chunkId*chunkSize);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            <span class="keywordflow">if</span> (controlBit){</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                stateRealLo = stateVecReal[indexLo];</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                stateImagLo = stateVecImag[indexLo];</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                stateVecReal[indexUp] = alphaReal*stateRealUp - alphaImag*stateImagUp </div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                    - betaReal*stateRealLo - betaImag*stateImagLo;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                stateVecImag[indexUp] = alphaReal*stateImagUp + alphaImag*stateRealUp </div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                    - betaReal*stateImagLo + betaImag*stateRealLo;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                <span class="comment">// state[indexLo] = beta  * state[indexUp] + conj(alpha) * state[indexLo]</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                stateVecReal[indexLo] = betaReal*stateRealUp - betaImag*stateImagUp </div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                    + alphaReal*stateRealLo + alphaImag*stateImagLo;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                stateVecImag[indexLo] = betaReal*stateImagUp + betaImag*stateRealUp </div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                    + alphaReal*stateImagLo - alphaImag*stateRealLo;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            }</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        } </div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    }</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;} </div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="structComplex_html_a1151948284b21c0052f203f23ab931d9"><div class="ttname"><a href="structComplex.html#a1151948284b21c0052f203f23ab931d9">Complex::imag</a></div><div class="ttdeci">REAL imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00030">QuEST.h:30</a></div></div>
<div class="ttc" id="structComplex_html_a479ad939835457595fcca3ca55c06283"><div class="ttname"><a href="structComplex.html#a479ad939835457595fcca3ca55c06283">Complex::real</a></div><div class="ttdeci">REAL real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00029">QuEST.h:29</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="QuEST_8c_html_a100463f6ec212c76a5fad99579000505"><div class="ttname"><a href="QuEST_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a></div><div class="ttdeci">static int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdoc">Get the value of the bit at a particular index in a number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01743">QuEST.c:1743</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a05875a70b539a3efb28d027823403f34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05875a70b539a3efb28d027823403f34">&#9670;&nbsp;</a></span>controlledNotDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledNotDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by {{0,1},{1,0}. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk. Only perform the rotation for elements where controlQubit is one.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecIn</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01258">1258</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00067">MultiQubit::chunkId</a>, <a class="el" href="QuEST_8c_source.html#l01743">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00516">controlledNot()</a>.</p>
<div class="fragment"><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;{</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    <span class="keywordtype">int</span> controlBit;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealIn=stateVecIn.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagIn=stateVecIn.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="preprocessor">    shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut) \</span></div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="preprocessor">    private  (thisTask,controlBit)</span></div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    {</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;            controlBit = <a class="code" href="QuEST_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;            <span class="keywordflow">if</span> (controlBit){</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                stateVecRealOut[thisTask] = stateVecRealIn[thisTask];</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                stateVecImagOut[thisTask] = stateVecImagIn[thisTask];</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;            }</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;        }</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    }</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;} </div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="QuEST_8c_html_a100463f6ec212c76a5fad99579000505"><div class="ttname"><a href="QuEST_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a></div><div class="ttdeci">static int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdoc">Get the value of the bit at a particular index in a number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01743">QuEST.c:1743</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad357a43e80e3baf013975b1b70942f4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad357a43e80e3baf013975b1b70942f4c">&#9670;&nbsp;</a></span>controlledNotLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledNotLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01193">1193</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00067">MultiQubit::chunkId</a>, <a class="el" href="QuEST_8c_source.html#l01743">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00175">controlledNot()</a>.</p>
<div class="fragment"><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;{</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateImagUp;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="keywordtype">int</span> controlBit;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <span class="comment">// set dimensions</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="comment">// Can&#39;t use multiQubit.stateVec as a private OMP var</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,controlBit) </span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    {</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;            thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;            indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;            controlBit = <a class="code" href="QuEST_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(controlQubit, indexUp+chunkId*chunkSize);</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;            <span class="keywordflow">if</span> (controlBit){</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                stateVecReal[indexUp] = stateVecReal[indexLo];</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                stateVecImag[indexUp] = stateVecImag[indexLo];</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                stateVecReal[indexLo] = stateRealUp;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                stateVecImag[indexLo] = stateImagUp;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;            }</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        } </div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    }</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="QuEST_8c_html_a100463f6ec212c76a5fad99579000505"><div class="ttname"><a href="QuEST_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a></div><div class="ttdeci">static int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdoc">Get the value of the bit at a particular index in a number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01743">QuEST.c:1743</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a11a96159191cbf1b01a1080e7f045aac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11a96159191cbf1b01a1080e7f045aac">&#9670;&nbsp;</a></span>controlledPhaseGate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledPhaseGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>idQubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>idQubit2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply the (two-qubit) controlled phase gate, also known as the controlled sigmaZ gate. </p>
<p>For each state, if both input qubits have value one, multiply the amplitude of that state by -1. This applies the two-qubit unitary: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 1 \\ &amp; 1 \\\ &amp; &amp; 1 \\ &amp; &amp; &amp; -1 \end{pmatrix} \]" src="form_12.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {idQubit1}; \node[draw=none] at (-3.5, 0) {idQubit2}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 0); \draw (-2,0) -- (2, 0); \draw[fill=black] (0, 0) circle (.2); \end{tikzpicture} } \]" src="form_13.png"/>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idQubit1,idQubit2</td><td>qubits to operate upon </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>idQubit1</code> or <code>idQubit2</code> are outside [0, <code>multiQubit.numQubits</code>), or are equal </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01748">1748</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="runTests_8c_source.html#l00308">test_controlledPhaseGate()</a>.</p>
<div class="fragment"><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;{</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <span class="keywordtype">int</span> bit1, bit2;</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(idQubit1 &gt;= 0 &amp;&amp; idQubit1 &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>, 2, __func__);</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(idQubit2 &gt;= 0 &amp;&amp; idQubit2 &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>, 1, __func__);</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(idQubit1 != idQubit2, 3, __func__);</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    stateVecSize = multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;<span class="preprocessor"># pragma omp parallel for \</span></div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="preprocessor">    default  (none)                          \</span></div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;<span class="preprocessor">    shared   (stateVecSize, stateVecReal,stateVecImag ) \</span></div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="preprocessor">    private  (index,bit1,bit2)                 \</span></div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;<span class="preprocessor">    schedule (static)</span></div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;        bit1 = <a class="code" href="QuEST_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (idQubit1, index+chunkId*chunkSize);</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        bit2 = <a class="code" href="QuEST_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (idQubit2, index+chunkId*chunkSize);</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;        <span class="keywordflow">if</span> (bit1 &amp;&amp; bit2) {</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;            stateVecReal [index] = - stateVecReal [index];</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;            stateVecImag [index] = - stateVecImag [index];</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;        }</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    }</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__env__local_8c_html_a3587b9d533e633ccf1abf9ad2ce45d8d"><div class="ttname"><a href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a></div><div class="ttdeci">void QuESTAssert(int isValid, int errorCode, const char *func)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__local_8c_source.html#l00240">QuEST_env_local.c:240</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00062">QuEST.h:62</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="QuEST_8c_html_a100463f6ec212c76a5fad99579000505"><div class="ttname"><a href="QuEST_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a></div><div class="ttdeci">static int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdoc">Get the value of the bit at a particular index in a number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01743">QuEST.c:1743</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad41f82b41149393a642391b67b3a287e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad41f82b41149393a642391b67b3a287e">&#9670;&nbsp;</a></span>controlledRotateAroundAxis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledRotateAroundAxis </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td>
          <td class="paramname"><em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structVector.html">Vector</a>&#160;</td>
          <td class="paramname"><em>axis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies a controlled rotation by a given angle around a given vector on the Bloch-sphere. </p>
<p>The vector must not be zero (else an error is thrown), but needn't be unit magnitude.</p>
<p>For angle <img class="formulaInl" alt="$\theta$" src="form_27.png"/> and axis vector <img class="formulaInl" alt="$\vec{n}$" src="form_34.png"/>, applies <img class="formulaInl" alt="$R_{\hat{n}} = \exp \left(- i \frac{\theta}{2} \hat{n} \cdot \vec{\sigma} \right) $" src="form_35.png"/> to states where the target qubit is 1 ( <img class="formulaInl" alt="$\vec{\sigma}$" src="form_36.png"/> is the vector of Pauli matrices).</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 1); \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$R_{\hat{n}}(\theta)$}; \end{tikzpicture} } \]" src="form_40.png"/>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">controlQubit</td><td>qubit with value 1 in the rotated states </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">angle</td><td>angle by which to rotate in radians </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">axis</td><td>vector around which to rotate (can be non-unit; will be normalised) </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if either <code>controlQubit</code> or <code>targetQubit</code> are outside [0, <code>multiQubit.numQubits</code>) or are equal or if <code>axis</code> is the zero vector </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00459">459</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00472">controlledRotateX()</a>, <a class="el" href="QuEST_8c_source.html#l00478">controlledRotateY()</a>, and <a class="el" href="QuEST_8c_source.html#l00484">controlledRotateZ()</a>.</p>
<div class="fragment"><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                                                                                                                              {</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordtype">double</span> mag = sqrt(pow(axis.<a class="code" href="structVector.html#aac7abe171ba4bada50ed72acba6259fc">x</a>,2) + pow(axis.<a class="code" href="structVector.html#a375ca805d4c808a53d7c4e0c737ae3de">y</a>,2) + pow(axis.<a class="code" href="structVector.html#ad4e863651be7d6b7e2b28cd7445a0ccf">z</a>,2));</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="structVector.html">Vector</a> unitAxis = {axis.<a class="code" href="structVector.html#aac7abe171ba4bada50ed72acba6259fc">x</a>/mag, axis.<a class="code" href="structVector.html#a375ca805d4c808a53d7c4e0c737ae3de">y</a>/mag, axis.<a class="code" href="structVector.html#ad4e863651be7d6b7e2b28cd7445a0ccf">z</a>/mag};</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <a class="code" href="structComplex.html">Complex</a> alpha, beta;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> = cos(angle/2.0);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> = -sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#ad4e863651be7d6b7e2b28cd7445a0ccf">z</a>;    </div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> = sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#a375ca805d4c808a53d7c4e0c737ae3de">y</a>;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> = -sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#aac7abe171ba4bada50ed72acba6259fc">x</a>;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <a class="code" href="QuEST__env__local_8c.html#ab4812953bc457405b3aa05a4c2f64f4a">controlledCompactUnitary</a>(multiQubit, controlQubit, targetQubit, alpha, beta);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;}</div><div class="ttc" id="structVector_html_aac7abe171ba4bada50ed72acba6259fc"><div class="ttname"><a href="structVector.html#aac7abe171ba4bada50ed72acba6259fc">Vector::x</a></div><div class="ttdeci">REAL x</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00045">QuEST.h:45</a></div></div>
<div class="ttc" id="QuEST__env__local_8c_html_ab4812953bc457405b3aa05a4c2f64f4a"><div class="ttname"><a href="QuEST__env__local_8c.html#ab4812953bc457405b3aa05a4c2f64f4a">controlledCompactUnitary</a></div><div class="ttdeci">void controlledCompactUnitary(MultiQubit multiQubit, const int controlQubit, const int targetQubit, Complex alpha, Complex beta)</div><div class="ttdoc">Apply a controlled unitary (single control, single target) parameterised by two given complex scalars...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__local_8c_source.html#l00116">QuEST_env_local.c:116</a></div></div>
<div class="ttc" id="structVector_html"><div class="ttname"><a href="structVector.html">Vector</a></div><div class="ttdoc">Represents a 3-vector of real numbers. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00043">QuEST.h:43</a></div></div>
<div class="ttc" id="structComplex_html_a1151948284b21c0052f203f23ab931d9"><div class="ttname"><a href="structComplex.html#a1151948284b21c0052f203f23ab931d9">Complex::imag</a></div><div class="ttdeci">REAL imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00030">QuEST.h:30</a></div></div>
<div class="ttc" id="structComplex_html_a479ad939835457595fcca3ca55c06283"><div class="ttname"><a href="structComplex.html#a479ad939835457595fcca3ca55c06283">Complex::real</a></div><div class="ttdeci">REAL real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00029">QuEST.h:29</a></div></div>
<div class="ttc" id="structVector_html_ad4e863651be7d6b7e2b28cd7445a0ccf"><div class="ttname"><a href="structVector.html#ad4e863651be7d6b7e2b28cd7445a0ccf">Vector::z</a></div><div class="ttdeci">REAL z</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00045">QuEST.h:45</a></div></div>
<div class="ttc" id="structVector_html_a375ca805d4c808a53d7c4e0c737ae3de"><div class="ttname"><a href="structVector.html#a375ca805d4c808a53d7c4e0c737ae3de">Vector::y</a></div><div class="ttdeci">REAL y</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00045">QuEST.h:45</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00027">QuEST.h:27</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac6923ac57e67d9a21096e06f6a9012f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6923ac57e67d9a21096e06f6a9012f6">&#9670;&nbsp;</a></span>controlledRotateX()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledRotateX </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies a controlled rotation by a given angle around the X-axis of the Bloch-sphere. </p>
<p>The target qubit is rotated in states where the control qubit has value 1.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 1); \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$R_x(\theta)$}; \end{tikzpicture} } \]" src="form_37.png"/>
</p>
<p> <br />
 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">controlQubit</td><td>qubit which has value 1 in the rotated states </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tagretQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">angle</td><td>angle by which to rotate the target qubit in radians </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if either <code>controlQubit</code> or <code>targetQubit</code> are outside [0, <code>multiQubit.numQubits</code>) or are equal. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00472">472</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                                                                                                        {</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <a class="code" href="structVector.html">Vector</a> unitAxis = {1, 0, 0};</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <a class="code" href="QuEST_8c.html#ad41f82b41149393a642391b67b3a287e">controlledRotateAroundAxis</a>(multiQubit, controlQubit, targetQubit, angle, unitAxis);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;}</div><div class="ttc" id="structVector_html"><div class="ttname"><a href="structVector.html">Vector</a></div><div class="ttdoc">Represents a 3-vector of real numbers. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00043">QuEST.h:43</a></div></div>
<div class="ttc" id="QuEST_8c_html_ad41f82b41149393a642391b67b3a287e"><div class="ttname"><a href="QuEST_8c.html#ad41f82b41149393a642391b67b3a287e">controlledRotateAroundAxis</a></div><div class="ttdeci">void controlledRotateAroundAxis(MultiQubit multiQubit, const int controlQubit, const int targetQubit, REAL angle, Vector axis)</div><div class="ttdoc">Applies a controlled rotation by a given angle around a given vector on the Bloch-sphere. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l00459">QuEST.c:459</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a71e90a2f7292116338c062934f9d1202"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71e90a2f7292116338c062934f9d1202">&#9670;&nbsp;</a></span>controlledRotateY()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledRotateY </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies a controlled rotation by a given angle around the Y-axis of the Bloch-sphere. </p>
<p>The target qubit is rotated in states where the control qubit has value 1.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 1); \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$R_y(\theta)$}; \end{tikzpicture} } \]" src="form_38.png"/>
</p>
<p> <br />
 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">controlQubit</td><td>qubit which has value 1 in the rotated states </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tagretQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">angle</td><td>angle by which to rotate the target qubit in radians </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if either <code>controlQubit</code> or <code>targetQubit</code> are outside [0, <code>multiQubit.numQubits</code>) or are equal. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00478">478</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                                                                                                        {</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <a class="code" href="structVector.html">Vector</a> unitAxis = {0, 1, 0};</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="QuEST_8c.html#ad41f82b41149393a642391b67b3a287e">controlledRotateAroundAxis</a>(multiQubit, controlQubit, targetQubit, angle, unitAxis);</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;}</div><div class="ttc" id="structVector_html"><div class="ttname"><a href="structVector.html">Vector</a></div><div class="ttdoc">Represents a 3-vector of real numbers. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00043">QuEST.h:43</a></div></div>
<div class="ttc" id="QuEST_8c_html_ad41f82b41149393a642391b67b3a287e"><div class="ttname"><a href="QuEST_8c.html#ad41f82b41149393a642391b67b3a287e">controlledRotateAroundAxis</a></div><div class="ttdeci">void controlledRotateAroundAxis(MultiQubit multiQubit, const int controlQubit, const int targetQubit, REAL angle, Vector axis)</div><div class="ttdoc">Applies a controlled rotation by a given angle around a given vector on the Bloch-sphere. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l00459">QuEST.c:459</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a668e5d2634b02e98bc73675ccb11d61c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a668e5d2634b02e98bc73675ccb11d61c">&#9670;&nbsp;</a></span>controlledRotateZ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledRotateZ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies a controlled rotation by a given angle around the Z-axis of the Bloch-sphere. </p>
<p>The target qubit is rotated in states where the control qubit has value 1.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 1); \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$R_z(\theta)$}; \end{tikzpicture} } \]" src="form_39.png"/>
</p>
<p> <br />
 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">controlQubit</td><td>qubit which has value 1 in the rotated states </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tagretQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">angle</td><td>angle by which to rotate the target qubit in radians </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if either <code>controlQubit</code> or <code>targetQubit</code> are outside [0, <code>multiQubit.numQubits</code>) or are equal. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00484">484</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                                                                                                        {</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <a class="code" href="structVector.html">Vector</a> unitAxis = {0, 0, 1};</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <a class="code" href="QuEST_8c.html#ad41f82b41149393a642391b67b3a287e">controlledRotateAroundAxis</a>(multiQubit, controlQubit, targetQubit, angle, unitAxis);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;}</div><div class="ttc" id="structVector_html"><div class="ttname"><a href="structVector.html">Vector</a></div><div class="ttdoc">Represents a 3-vector of real numbers. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00043">QuEST.h:43</a></div></div>
<div class="ttc" id="QuEST_8c_html_ad41f82b41149393a642391b67b3a287e"><div class="ttname"><a href="QuEST_8c.html#ad41f82b41149393a642391b67b3a287e">controlledRotateAroundAxis</a></div><div class="ttdeci">void controlledRotateAroundAxis(MultiQubit multiQubit, const int controlQubit, const int targetQubit, REAL angle, Vector axis)</div><div class="ttdoc">Applies a controlled rotation by a given angle around a given vector on the Bloch-sphere. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l00459">QuEST.c:459</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a642093063a1f889f61a1311f6d6f2d3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a642093063a1f889f61a1311f6d6f2d3f">&#9670;&nbsp;</a></span>controlledUnitaryDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately. </p>
<p>Only perform the rotation where the control qubit is one.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">controlQubit</td><td>qubit to determine whether or not to perform a rotation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot1</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot2</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecUp</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecLo</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00992">992</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00067">MultiQubit::chunkId</a>, <a class="el" href="QuEST_8c_source.html#l01743">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00030">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00029">Complex::real</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00397">controlledUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;{</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <span class="keywordtype">int</span> controlBit;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="preprocessor">            rot1Real,rot1Imag, rot2Real,rot2Imag) \</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit)</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    {</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;            controlBit = <a class="code" href="QuEST_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            <span class="keywordflow">if</span> (controlBit){</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                stateRealUp = stateVecRealUp[thisTask];</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                stateImagUp = stateVecImagUp[thisTask];</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                stateRealLo = stateVecRealLo[thisTask];</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                stateImagLo = stateVecImagLo[thisTask];</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp </div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                    + rot2Real*stateRealLo - rot2Imag*stateImagLo;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp </div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                    + rot2Real*stateImagLo + rot2Imag*stateRealLo;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;            }</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        }</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    }</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="structComplex_html_a1151948284b21c0052f203f23ab931d9"><div class="ttname"><a href="structComplex.html#a1151948284b21c0052f203f23ab931d9">Complex::imag</a></div><div class="ttdeci">REAL imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00030">QuEST.h:30</a></div></div>
<div class="ttc" id="structComplex_html_a479ad939835457595fcca3ca55c06283"><div class="ttname"><a href="structComplex.html#a479ad939835457595fcca3ca55c06283">Complex::real</a></div><div class="ttdeci">REAL real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00029">QuEST.h:29</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="QuEST_8c_html_a100463f6ec212c76a5fad99579000505"><div class="ttname"><a href="QuEST_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a></div><div class="ttdeci">static int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdoc">Get the value of the bit at a particular index in a number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01743">QuEST.c:1743</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8a4afcff70195a306c082b8ed8d4e09a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a4afcff70195a306c082b8ed8d4e09a">&#9670;&nbsp;</a></span>controlledUnitaryLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00850">850</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00067">MultiQubit::chunkId</a>, <a class="el" href="QuEST_8c_source.html#l01743">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00030">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00037">ComplexMatrix2::r0c0</a>, <a class="el" href="QuEST_8h_source.html#l00037">ComplexMatrix2::r0c1</a>, <a class="el" href="QuEST_8h_source.html#l00038">ComplexMatrix2::r1c0</a>, <a class="el" href="QuEST_8h_source.html#l00038">ComplexMatrix2::r1c1</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, <a class="el" href="QuEST_8h_source.html#l00029">Complex::real</a>, and <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00127">controlledUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;{</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordtype">int</span> controlBit;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="comment">// set dimensions</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="comment">// Can&#39;t use multiQubit.stateVec as a private OMP var</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, u) \</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit) </span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    {</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;            controlBit = <a class="code" href="QuEST_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (controlQubit, indexUp+chunkId*chunkSize);</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            <span class="keywordflow">if</span> (controlBit){</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                stateRealLo = stateVecReal[indexLo];</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                stateImagLo = stateVecImag[indexLo];</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                <span class="comment">// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                stateVecReal[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp </div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                    + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo - u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                stateVecImag[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp </div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                    + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                <span class="comment">// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                stateVecReal[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp  - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp </div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                    + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo  -  u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                stateVecImag[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp </div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                    + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            }</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        } </div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    }</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_a763007c3070802373549ba0350f83c8a"><div class="ttname"><a href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">ComplexMatrix2::r1c1</a></div><div class="ttdeci">Complex r1c1</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00038">QuEST.h:38</a></div></div>
<div class="ttc" id="structComplex_html_a1151948284b21c0052f203f23ab931d9"><div class="ttname"><a href="structComplex.html#a1151948284b21c0052f203f23ab931d9">Complex::imag</a></div><div class="ttdeci">REAL imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00030">QuEST.h:30</a></div></div>
<div class="ttc" id="structComplex_html_a479ad939835457595fcca3ca55c06283"><div class="ttname"><a href="structComplex.html#a479ad939835457595fcca3ca55c06283">Complex::real</a></div><div class="ttdeci">REAL real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00029">QuEST.h:29</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_ae72b4458233b077a636beee1892e81ff"><div class="ttname"><a href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">ComplexMatrix2::r0c0</a></div><div class="ttdeci">Complex r0c0</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00037">QuEST.h:37</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_ab98282015ed2065e53fbc9638e2583ab"><div class="ttname"><a href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">ComplexMatrix2::r1c0</a></div><div class="ttdeci">Complex r1c0</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00038">QuEST.h:38</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="QuEST_8c_html_a100463f6ec212c76a5fad99579000505"><div class="ttname"><a href="QuEST_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a></div><div class="ttdeci">static int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdoc">Get the value of the bit at a particular index in a number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01743">QuEST.c:1743</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_a0f3932f055a8b05cef361bce25d51172"><div class="ttname"><a href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">ComplexMatrix2::r0c1</a></div><div class="ttdeci">Complex r0c1</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00037">QuEST.h:37</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9c02591bc64c2918503afa231d90d83f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c02591bc64c2918503afa231d90d83f">&#9670;&nbsp;</a></span>createMultiQubit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void createMultiQubit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a> *&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a <a class="el" href="structMultiQubit.html" title="Represents a system of qubits. ">MultiQubit</a> object representing a set of qubits. </p>
<p>Allocate space for state vector of probability amplitudes, including space for temporary values to be copied from one other chunk if running the distributed version. Define properties related to the size of the set of qubits. initStateZero should be called after this to initialise the qubits to the zero state.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>a pointer to an object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numQubits</td><td>number of qubits in the system </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td>object representing the execution environment (local, multinode etc) </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>numQubits</code> &lt;= 0 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00044">44</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="bernstein__vazirani__circuit_8c_source.html#l00011">main()</a>, <a class="el" href="runTests_8c_source.html#l00717">test_collapseToOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00366">test_compactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00495">test_controlledCompactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00274">test_controlledNot()</a>, <a class="el" href="runTests_8c_source.html#l00308">test_controlledPhaseGate()</a>, <a class="el" href="runTests_8c_source.html#l00540">test_controlledUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00672">test_findProbabilityOfOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00899">test_getImagAmpEl()</a>, <a class="el" href="runTests_8c_source.html#l00919">test_getProbEl()</a>, <a class="el" href="runTests_8c_source.html#l00879">test_getRealAmpEl()</a>, <a class="el" href="runTests_8c_source.html#l00190">test_hadamard()</a>, <a class="el" href="runTests_8c_source.html#l00078">test_initClassicalState()</a>, <a class="el" href="runTests_8c_source.html#l00054">test_initStatePlus()</a>, <a class="el" href="runTests_8c_source.html#l00031">test_initStateZero()</a>, <a class="el" href="runTests_8c_source.html#l00782">test_measure()</a>, <a class="el" href="runTests_8c_source.html#l00833">test_measureWithStats()</a>, <a class="el" href="runTests_8c_source.html#l00340">test_multiControlledPhaseGate()</a>, <a class="el" href="runTests_8c_source.html#l00590">test_multiControlledUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00218">test_sGate()</a>, <a class="el" href="runTests_8c_source.html#l00103">test_sigmaX()</a>, <a class="el" href="runTests_8c_source.html#l00132">test_sigmaY()</a>, <a class="el" href="runTests_8c_source.html#l00161">test_sigmaZ()</a>, <a class="el" href="runTests_8c_source.html#l00246">test_tGate()</a>, and <a class="el" href="runTests_8c_source.html#l00428">test_unitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(numQubits&gt;0, 9, __func__);</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = 1L &lt;&lt; numQubits;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmpsPerRank = numAmps/<a class="code" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a> = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>)));</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a> = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>)));</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1){</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a> = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>)));</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a> = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>)));</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    }</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">if</span> ( (!(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>) || !(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>))</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            &amp;&amp; numAmpsPerRank ) {</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        printf(<span class="stringliteral">&quot;Could not allocate memory!&quot;</span>);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        exit (EXIT_FAILURE);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    }</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1 &amp;&amp; (!(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>) || !(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>))</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            &amp;&amp; numAmpsPerRank ) {</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        printf(<span class="stringliteral">&quot;Could not allocate memory!&quot;</span>);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        exit (EXIT_FAILURE);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    }</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a> = numQubits;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    multiQubit-&gt;<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a> = numAmpsPerRank;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a> = <a class="code" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>.<a class="code" href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">rank</a>;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    multiQubit-&gt;<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">numChunks</a> = <a class="code" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;}</div><div class="ttc" id="runTests_8c_html_a5fd8ba97fcae3408ae6221dfc3cc1f93"><div class="ttname"><a href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a></div><div class="ttdeci">QuESTEnv env</div><div class="ttdef"><b>Definition:</b> <a href="runTests_8c_source.html#l00017">runTests.c:17</a></div></div>
<div class="ttc" id="structQuESTEnv_html_af22aacd7c9905accae28484785c193b4"><div class="ttname"><a href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">QuESTEnv::numRanks</a></div><div class="ttdeci">int numRanks</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00078">QuEST.h:78</a></div></div>
<div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__env__local_8c_html_a3587b9d533e633ccf1abf9ad2ce45d8d"><div class="ttname"><a href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a></div><div class="ttdeci">void QuESTAssert(int isValid, int errorCode, const char *func)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__local_8c_source.html#l00240">QuEST_env_local.c:240</a></div></div>
<div class="ttc" id="structMultiQubit_html_acd43f2f57991709c9e94f73662c972b2"><div class="ttname"><a href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">MultiQubit::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into – the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00069">QuEST.h:69</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00062">QuEST.h:62</a></div></div>
<div class="ttc" id="structQuESTEnv_html_aa648bb336cf8598467cb62db00b9cee8"><div class="ttname"><a href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">QuESTEnv::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00077">QuEST.h:77</a></div></div>
<div class="ttc" id="structMultiQubit_html_a76f7db4eab52d2b30f58f973ada809c5"><div class="ttname"><a href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">MultiQubit::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00056">QuEST.h:56</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5d6acc322314d7a3d8a2eccf00d3b19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5d6acc322314d7a3d8a2eccf00d3b19">&#9670;&nbsp;</a></span>destroyMultiQubit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void destroyMultiQubit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deallocate a <a class="el" href="structMultiQubit.html" title="Represents a system of qubits. ">MultiQubit</a> object representing a set of qubits. </p>
<p>Free memory allocated to state vector of probability amplitudes, including temporary vector for values copied from another chunk if running the distributed version.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object to be deallocated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td>object representing the execution environment (local, multinode etc) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00076">76</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="bernstein__vazirani__circuit_8c_source.html#l00011">main()</a>, <a class="el" href="runTests_8c_source.html#l00717">test_collapseToOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00366">test_compactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00495">test_controlledCompactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00274">test_controlledNot()</a>, <a class="el" href="runTests_8c_source.html#l00308">test_controlledPhaseGate()</a>, <a class="el" href="runTests_8c_source.html#l00540">test_controlledUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00672">test_findProbabilityOfOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00899">test_getImagAmpEl()</a>, <a class="el" href="runTests_8c_source.html#l00919">test_getProbEl()</a>, <a class="el" href="runTests_8c_source.html#l00879">test_getRealAmpEl()</a>, <a class="el" href="runTests_8c_source.html#l00190">test_hadamard()</a>, <a class="el" href="runTests_8c_source.html#l00078">test_initClassicalState()</a>, <a class="el" href="runTests_8c_source.html#l00054">test_initStatePlus()</a>, <a class="el" href="runTests_8c_source.html#l00031">test_initStateZero()</a>, <a class="el" href="runTests_8c_source.html#l00782">test_measure()</a>, <a class="el" href="runTests_8c_source.html#l00833">test_measureWithStats()</a>, <a class="el" href="runTests_8c_source.html#l00340">test_multiControlledPhaseGate()</a>, <a class="el" href="runTests_8c_source.html#l00590">test_multiControlledUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00218">test_sGate()</a>, <a class="el" href="runTests_8c_source.html#l00103">test_sigmaX()</a>, <a class="el" href="runTests_8c_source.html#l00132">test_sigmaY()</a>, <a class="el" href="runTests_8c_source.html#l00161">test_sigmaZ()</a>, <a class="el" href="runTests_8c_source.html#l00246">test_tGate()</a>, and <a class="el" href="runTests_8c_source.html#l00428">test_unitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                                                           {</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    free(multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    free(multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1){</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        free(multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        free(multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    }</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;}</div><div class="ttc" id="runTests_8c_html_a5fd8ba97fcae3408ae6221dfc3cc1f93"><div class="ttname"><a href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a></div><div class="ttdeci">QuESTEnv env</div><div class="ttdef"><b>Definition:</b> <a href="runTests_8c_source.html#l00017">runTests.c:17</a></div></div>
<div class="ttc" id="structQuESTEnv_html_af22aacd7c9905accae28484785c193b4"><div class="ttname"><a href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">QuESTEnv::numRanks</a></div><div class="ttdeci">int numRanks</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00078">QuEST.h:78</a></div></div>
<div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="structMultiQubit_html_a76f7db4eab52d2b30f58f973ada809c5"><div class="ttname"><a href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">MultiQubit::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00056">QuEST.h:56</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a100463f6ec212c76a5fad99579000505"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a100463f6ec212c76a5fad99579000505">&#9670;&nbsp;</a></span>extractBit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int extractBit </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>locationOfBitFromRight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long long int&#160;</td>
          <td class="paramname"><em>theEncodedNumber</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the value of the bit at a particular index in a number. </p>
<p>SCB edit: new definition of extractBit is much faster *** </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">locationOfBitFromRight</td><td>location of bit in theEncodedNumber </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">theEncodedNumber</td><td>number to search </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the value of the bit in theEncodedNumber </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01743">1743</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00929">controlledCompactUnitaryDistributed()</a>, <a class="el" href="QuEST_8c_source.html#l00720">controlledCompactUnitaryLocal()</a>, <a class="el" href="QuEST_8c_source.html#l01258">controlledNotDistributed()</a>, <a class="el" href="QuEST_8c_source.html#l01193">controlledNotLocal()</a>, <a class="el" href="QuEST_8c_source.html#l01748">controlledPhaseGate()</a>, <a class="el" href="QuEST_8c_source.html#l00992">controlledUnitaryDistributed()</a>, <a class="el" href="QuEST_8c_source.html#l00850">controlledUnitaryLocal()</a>, and <a class="el" href="QuEST_8c_source.html#l00264">initStateOfSingleQubit()</a>.</p>
<div class="fragment"><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;{</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    <span class="keywordflow">return</span> (theEncodedNumber &amp; ( 1LL &lt;&lt; locationOfBitFromRight )) &gt;&gt; locationOfBitFromRight;</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a9ac9bb717a889f09d307eda9f0b65957"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ac9bb717a889f09d307eda9f0b65957">&#9670;&nbsp;</a></span>findProbabilityOfZeroDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> findProbabilityOfZeroDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>measureQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Measure the probability of a specified qubit being in the zero state across all amplitudes held in this chunk. </p>
<p>Size of regions to skip is a multiple of chunkSize.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measureQubit</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>probability of qubit measureQubit being zero </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01699">1699</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00659">findProbabilityOfOutcome()</a>.</p>
<div class="fragment"><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;{</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    <span class="comment">// ----- measured probability</span></div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   totalProbability;                                  <span class="comment">// probability (returned) value</span></div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <span class="comment">// ----- temp variables</span></div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span></div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    <span class="comment">//            find probability                                      //</span></div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    <span class="comment">// initialise returned value</span></div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    totalProbability = 0.0;</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;<span class="preprocessor">    shared    (numTasks,stateVecReal,stateVecImag) \</span></div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="preprocessor">    private   (thisTask) \</span></div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;<span class="preprocessor">    reduction ( +:totalProbability )</span></div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    {</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;<span class="preprocessor"># pragma omp for schedule  (static)</span></div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;            totalProbability += stateVecReal[thisTask]*stateVecReal[thisTask]</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                + stateVecImag[thisTask]*stateVecImag[thisTask];</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        }</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    }</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <span class="keywordflow">return</span> totalProbability;</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c02cd0e1b4eac19771a0525f023249e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c02cd0e1b4eac19771a0525f023249e">&#9670;&nbsp;</a></span>findProbabilityOfZeroLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> findProbabilityOfZeroLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>measureQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Measure the total probability of a specified qubit being in the zero state across all amplitudes in this chunk. </p>
<p>Size of regions to skip is less than the size of one chunk. <br />
 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measureQubit</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>probability of qubit measureQubit being zero </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01643">1643</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00183">findProbabilityOfOutcome()</a>.</p>
<div class="fragment"><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;{</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    <span class="comment">// ----- sizes</span></div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock,                                  <span class="comment">// size of blocks</span></div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;         sizeHalfBlock;                                       <span class="comment">// size of blocks halved</span></div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    <span class="comment">// ----- indices</span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock,                                  <span class="comment">// current block</span></div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;         index;                                               <span class="comment">// current index for first half block</span></div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    <span class="comment">// ----- measured probability</span></div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   totalProbability;                                  <span class="comment">// probability (returned) value</span></div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    <span class="comment">// ----- temp variables</span></div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   </div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="comment">//            dimensions                                            //</span></div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    sizeHalfBlock = 1LL &lt;&lt; (measureQubit);                       <span class="comment">// number of state vector elements to sum,</span></div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <span class="comment">// and then the number to skip</span></div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    sizeBlock     = 2LL * sizeHalfBlock;                         <span class="comment">// size of blocks (pairs of measure and skip entries)</span></div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <span class="comment">// initialise returned value</span></div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    totalProbability = 0.0;</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;<span class="preprocessor">    shared    (numTasks,sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span></div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;<span class="preprocessor">    private   (thisTask,thisBlock,index) \</span></div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="preprocessor">    reduction ( +:totalProbability )</span></div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<span class="preprocessor"># endif </span></div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    {</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="preprocessor"># pragma omp for schedule  (static)</span></div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;            thisBlock = thisTask / sizeHalfBlock;</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;            index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;            totalProbability += stateVecReal[index]*stateVecReal[index]</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                + stateVecImag[index]*stateVecImag[index];</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;        }</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    }</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <span class="keywordflow">return</span> totalProbability;</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8f10aabf9f607f19093aee54630caa21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f10aabf9f607f19093aee54630caa21">&#9670;&nbsp;</a></span>getEnvironmentString()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getEnvironmentString </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>str</em>[200]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00145">145</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                                                             {</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordtype">int</span> numThreads=1;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    numThreads=omp_get_max_threads(); </div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    sprintf(str, <span class="stringliteral">&quot;%dqubits_CPU_%dranksx%dthreads&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>, <a class="code" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>, numThreads);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;}</div><div class="ttc" id="runTests_8c_html_a5fd8ba97fcae3408ae6221dfc3cc1f93"><div class="ttname"><a href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a></div><div class="ttdeci">QuESTEnv env</div><div class="ttdef"><b>Definition:</b> <a href="runTests_8c_source.html#l00017">runTests.c:17</a></div></div>
<div class="ttc" id="structQuESTEnv_html_af22aacd7c9905accae28484785c193b4"><div class="ttname"><a href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">QuESTEnv::numRanks</a></div><div class="ttdeci">int numRanks</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00078">QuEST.h:78</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00062">QuEST.h:62</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac61ecf4fd9ab2ac8453c4eb5b0d34089"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac61ecf4fd9ab2ac8453c4eb5b0d34089">&#9670;&nbsp;</a></span>getNumAmps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getNumAmps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the number of probability amplitudes in a multiQubit object, given by 2^numQubits. </p>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00140">140</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="runTests_8c_source.html#l00899">test_getImagAmpEl()</a>, <a class="el" href="runTests_8c_source.html#l00919">test_getProbEl()</a>, and <a class="el" href="runTests_8c_source.html#l00879">test_getRealAmpEl()</a>.</p>
<div class="fragment"><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                                     {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">return</span> multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>*multiQubit.<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">numChunks</a>;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;}</div><div class="ttc" id="structMultiQubit_html_acd43f2f57991709c9e94f73662c972b2"><div class="ttname"><a href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">MultiQubit::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into – the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00069">QuEST.h:69</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a00e13dc88021b61a29fac9f3ab9ee850"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00e13dc88021b61a29fac9f3ab9ee850">&#9670;&nbsp;</a></span>getNumQubits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getNumQubits </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the number of qubits in a multiQubit object. </p>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00136">136</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                                       {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">return</span> multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;}</div><div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00062">QuEST.h:62</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a799b10447d6dbdaf960a4d3eedd22014"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a799b10447d6dbdaf960a4d3eedd22014">&#9670;&nbsp;</a></span>getProbEl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> getProbEl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the probability of the state at an index in the full state vector. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">multiQubit</td><td>object representing a set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>index in state vector of probability amplitudes </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>realEl*realEl + imagEl*imagEl </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>index</code> is outside [0, <img class="formulaInl" alt="$2^{N}$" src="form_20.png"/>) where <img class="formulaInl" alt="$N = $" src="form_21.png"/> <code>multiQubit.numQubits</code> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01986">1986</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="tutorial__example_8c_source.html#l00004">main()</a>, <a class="el" href="runTests_8c_source.html#l00919">test_getProbEl()</a>, and <a class="el" href="runTests_8c_source.html#l00078">test_initClassicalState()</a>.</p>
<div class="fragment"><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;                                                          {</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> real;</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> imag;</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    real = <a class="code" href="QuEST__env__local_8c.html#a317b786f577fa6bc136ea7f0ee7330a7">getRealAmpEl</a>(multiQubit, index);</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    imag = <a class="code" href="QuEST__env__local_8c.html#a3615f76fd5f57008d9b74bbd10533dd0">getImagAmpEl</a>(multiQubit, index);</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    <span class="keywordflow">return</span> real*real + imag*imag;</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;}</div><div class="ttc" id="QuEST__env__local_8c_html_a3615f76fd5f57008d9b74bbd10533dd0"><div class="ttname"><a href="QuEST__env__local_8c.html#a3615f76fd5f57008d9b74bbd10533dd0">getImagAmpEl</a></div><div class="ttdeci">REAL getImagAmpEl(MultiQubit multiQubit, long long int index)</div><div class="ttdoc">Get the imaginary component of the complex probability amplitude at an index in the state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__local_8c_source.html#l00094">QuEST_env_local.c:94</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="QuEST__env__local_8c_html_a317b786f577fa6bc136ea7f0ee7330a7"><div class="ttname"><a href="QuEST__env__local_8c.html#a317b786f577fa6bc136ea7f0ee7330a7">getRealAmpEl</a></div><div class="ttdeci">REAL getRealAmpEl(MultiQubit multiQubit, long long int index)</div><div class="ttdoc">Get the real component of the complex probability amplitude at an index in the state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__local_8c_source.html#l00090">QuEST_env_local.c:90</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6a897066979fc52d977007d959ca09d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6a897066979fc52d977007d959ca09d">&#9670;&nbsp;</a></span>hadamardDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hadamardDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>updateUpper</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by {{1,1},{1,-1}}/sqrt2. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecIn</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">updateUpper</td><td>flag, 1: updating upper values, 0: updating lower values in block </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01446">1446</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00602">hadamard()</a>.</p>
<div class="fragment"><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;{</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="keywordtype">int</span> sign;</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <span class="keywordflow">if</span> (updateUpper) sign=1;</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    <span class="keywordflow">else</span> sign=-1;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> recRoot2 = 1.0/sqrt(2);</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span></div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;<span class="preprocessor">            recRoot2, sign) \</span></div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;<span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span></div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    {</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;            <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;            stateRealUp = stateVecRealUp[thisTask];</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;            stateImagUp = stateVecImagUp[thisTask];</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;            stateRealLo = stateVecRealLo[thisTask];</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;            stateImagLo = stateVecImagLo[thisTask];</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;            stateVecRealOut[thisTask] = recRoot2*(stateRealUp + sign*stateRealLo);</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;            stateVecImagOut[thisTask] = recRoot2*(stateImagUp + sign*stateImagLo);</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;        }</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    }</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa9f0718b4dd794a3e1b143e3b153bfc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9f0718b4dd794a3e1b143e3b153bfc5">&#9670;&nbsp;</a></span>hadamardLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hadamardLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01385">1385</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00169">hadamard()</a>.</p>
<div class="fragment"><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;{</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    <span class="comment">// set dimensions</span></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="comment">// Can&#39;t use multiQubit.stateVec as a private OMP var</span></div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> recRoot2 = 1.0/sqrt(2);</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;<span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, recRoot2) \</span></div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;<span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span></div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    {</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;            thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;            indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;            stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;            stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;            stateRealLo = stateVecReal[indexLo];</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;            stateImagLo = stateVecImag[indexLo];</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;            stateVecReal[indexUp] = recRoot2*(stateRealUp + stateRealLo);</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;            stateVecImag[indexUp] = recRoot2*(stateImagUp + stateImagLo);</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            stateVecReal[indexLo] = recRoot2*(stateRealUp - stateRealLo);</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;            stateVecImag[indexLo] = recRoot2*(stateImagUp - stateImagLo);</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        } </div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    }</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab76254cfde16f0808476649507a1a2fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab76254cfde16f0808476649507a1a2fc">&#9670;&nbsp;</a></span>hashString()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long int hashString </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>str</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l02026">2026</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l01994">seedQuESTDefault()</a>.</p>
<div class="fragment"><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;                                       {</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> hash = 5381;</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    <span class="keywordtype">int</span> c;</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    <span class="keywordflow">while</span> ((c = *str++))</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;        hash = ((hash &lt;&lt; 5) + hash) + c; <span class="comment">/* hash * 33 + c */</span></div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    <span class="keywordflow">return</span> hash;    </div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="ae1b983b41249836ed2c2a81f77d83c40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1b983b41249836ed2c2a81f77d83c40">&#9670;&nbsp;</a></span>initClassicalState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initClassicalState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>stateInd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise a set of <img class="formulaInl" alt="$ N $" src="form_0.png"/> qubits to the classical state with index <code>stateInd</code>. </p>
<p>Note <img class="formulaInl" alt="$ | 00 \dots 00 \rangle $" src="form_6.png"/> has <code>stateInd</code> 0, <img class="formulaInl" alt="$ | 00 \dots 01 \rangle $" src="form_7.png"/> has <code>stateInd</code> 1, <img class="formulaInl" alt="$ | 11 \dots 11 \rangle $" src="form_8.png"/> has <code>stateInd</code> <img class="formulaInl" alt="$ 2^N - 1 $" src="form_9.png"/>, etc. Subsequent calls to getProbEl will yield 0 for all indices except <code>stateInd</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>the object representing the set of qubits to be initialised </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateInd</td><td>the index (0 to the number of amplitudes, exclusive) of the state to give probability 1 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00222">222</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="runTests_8c_source.html#l00078">test_initClassicalState()</a>.</p>
<div class="fragment"><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;{</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    stateVecSize = multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">// Can&#39;t use multiQubit-&gt;stateVec as a private OMP var</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">// initialise the state to |0000..0000&gt;</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="preprocessor">    shared   (stateInd, stateVecSize, stateVecReal, stateVecImag) \</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="preprocessor">    private  (index) </span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            stateVecReal[index] = 0.0;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            stateVecImag[index] = 0.0;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        }</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    }</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="comment">// give the specified classical state prob 1</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a> == stateInd/stateVecSize){</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        stateVecReal[stateInd % stateVecSize] = 1.0;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        stateVecImag[stateInd % stateVecSize] = 0.0;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    }</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a433876ee9f3bcc54af346300f571fc3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a433876ee9f3bcc54af346300f571fc3c">&#9670;&nbsp;</a></span>initializeStateFromSingleFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initializeStateFromSingleFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a> *&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>filename</em>[200], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialises the wavefunction amplitudes according to those specified in a file. </p>
<p>For debugging purpsoses </p>
<p>fix &ndash; format needs to work for single precision values </p>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00343">343</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="runTests_8c_source.html#l00495">test_controlledCompactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00274">test_controlledNot()</a>, <a class="el" href="runTests_8c_source.html#l00308">test_controlledPhaseGate()</a>, <a class="el" href="runTests_8c_source.html#l00190">test_hadamard()</a>, <a class="el" href="runTests_8c_source.html#l00054">test_initStatePlus()</a>, <a class="el" href="runTests_8c_source.html#l00031">test_initStateZero()</a>, <a class="el" href="runTests_8c_source.html#l00340">test_multiControlledPhaseGate()</a>, <a class="el" href="runTests_8c_source.html#l00590">test_multiControlledUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00218">test_sGate()</a>, <a class="el" href="runTests_8c_source.html#l00103">test_sigmaX()</a>, <a class="el" href="runTests_8c_source.html#l00132">test_sigmaY()</a>, <a class="el" href="runTests_8c_source.html#l00161">test_sigmaZ()</a>, and <a class="el" href="runTests_8c_source.html#l00246">test_tGate()</a>.</p>
<div class="fragment"><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                                                                                            {</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> indexInChunk, totalIndex;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    chunkSize = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    stateVecSize = chunkSize*multiQubit-&gt;<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">numChunks</a>;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    FILE *fp;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordtype">char</span> line[200];</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rank=0; rank&lt;(multiQubit-&gt;<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">numChunks</a>); rank++){</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keywordflow">if</span> (rank==multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>){</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            fp = fopen(filename, <span class="stringliteral">&quot;r&quot;</span>);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(fp!=NULL, 11, __func__);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            indexInChunk = 0; totalIndex = 0;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            <span class="keywordflow">while</span> (fgets(line, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)*200, fp) != NULL &amp;&amp; totalIndex&lt;stateVecSize){</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                <span class="keywordflow">if</span> (line[0]!=<span class="charliteral">&#39;#&#39;</span>){</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                    <span class="keywordtype">int</span> chunkId = totalIndex/chunkSize;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                    <span class="keywordflow">if</span> (chunkId==multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>){</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                        sscanf(line, <span class="stringliteral">&quot;%lf, %lf&quot;</span>, &amp;(stateVecReal[indexInChunk]), </div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                                &amp;(stateVecImag[indexInChunk]));</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                        indexInChunk += 1;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                    }</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                    totalIndex += 1;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            }   </div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            fclose(fp);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        }</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <a class="code" href="QuEST__env__local_8c.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77">syncQuESTEnv</a>(<a class="code" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;}</div><div class="ttc" id="runTests_8c_html_a5fd8ba97fcae3408ae6221dfc3cc1f93"><div class="ttname"><a href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a></div><div class="ttdeci">QuESTEnv env</div><div class="ttdef"><b>Definition:</b> <a href="runTests_8c_source.html#l00017">runTests.c:17</a></div></div>
<div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__env__local_8c_html_a3587b9d533e633ccf1abf9ad2ce45d8d"><div class="ttname"><a href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a></div><div class="ttdeci">void QuESTAssert(int isValid, int errorCode, const char *func)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__local_8c_source.html#l00240">QuEST_env_local.c:240</a></div></div>
<div class="ttc" id="structMultiQubit_html_acd43f2f57991709c9e94f73662c972b2"><div class="ttname"><a href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">MultiQubit::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into – the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00069">QuEST.h:69</a></div></div>
<div class="ttc" id="QuEST__env__local_8c_html_a8d31fe2d1ad4d01e2a1f5f6b8bc15b77"><div class="ttname"><a href="QuEST__env__local_8c.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77">syncQuESTEnv</a></div><div class="ttdeci">void syncQuESTEnv(QuESTEnv env)</div><div class="ttdoc">Guarantees that all code up to the given point has been executed on all nodes (if running in distribu...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__local_8c_source.html#l00031">QuEST_env_local.c:31</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4b737ff9b4267609ef27e6cb4c42dc68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b737ff9b4267609ef27e6cb4c42dc68">&#9670;&nbsp;</a></span>initStateDebug()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initStateDebug </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise the state vector of probability amplitudes to an (unphysical) state with each component of each probability amplitude a unique floating point value. </p>
<p>For debugging processes </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits to be initialised </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00310">310</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="runTests_8c_source.html#l00366">test_compactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00495">test_controlledCompactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00274">test_controlledNot()</a>, <a class="el" href="runTests_8c_source.html#l00308">test_controlledPhaseGate()</a>, <a class="el" href="runTests_8c_source.html#l00540">test_controlledUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00899">test_getImagAmpEl()</a>, <a class="el" href="runTests_8c_source.html#l00919">test_getProbEl()</a>, <a class="el" href="runTests_8c_source.html#l00879">test_getRealAmpEl()</a>, <a class="el" href="runTests_8c_source.html#l00190">test_hadamard()</a>, <a class="el" href="runTests_8c_source.html#l00340">test_multiControlledPhaseGate()</a>, <a class="el" href="runTests_8c_source.html#l00590">test_multiControlledUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00218">test_sGate()</a>, <a class="el" href="runTests_8c_source.html#l00103">test_sigmaX()</a>, <a class="el" href="runTests_8c_source.html#l00132">test_sigmaY()</a>, <a class="el" href="runTests_8c_source.html#l00161">test_sigmaZ()</a>, <a class="el" href="runTests_8c_source.html#l00246">test_tGate()</a>, and <a class="el" href="runTests_8c_source.html#l00428">test_unitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;{</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> indexOffset;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    chunkSize = multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">// Can&#39;t use multiQubit-&gt;stateVec as a private OMP var</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        indexOffset = chunkSize * multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">// initialise the state to |0000..0000&gt;</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="preprocessor">    shared   (chunkSize, stateVecReal, stateVecImag, indexOffset) \</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="preprocessor">    private  (index) </span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            stateVecReal[index] = ((indexOffset + index)*2.0)/10.0;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            stateVecImag[index] = ((indexOffset + index)*2.0+1.0)/10.0;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    }</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7169fd0442cbc3418f3fac4d13363ca2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7169fd0442cbc3418f3fac4d13363ca2">&#9670;&nbsp;</a></span>initStateOfSingleQubit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initStateOfSingleQubit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a> *&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qubitId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>outcome</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise the state vector of probability amplitudes such that one qubit is set to 'outcome' and all other qubits are in an equal superposition of zero and one. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits to be initialised </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">qubitId</td><td>id of qubit to set to state 'outcome' </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">value</td><td>of qubit 'qubitId' </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00264">264</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="runTests_8c_source.html#l00717">test_collapseToOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00672">test_findProbabilityOfOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00782">test_measure()</a>, and <a class="el" href="runTests_8c_source.html#l00833">test_measureWithStats()</a>.</p>
<div class="fragment"><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;{</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordtype">int</span> bit;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    chunkSize = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    stateVecSize = chunkSize*multiQubit-&gt;<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">numChunks</a>;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> normFactor = 1.0/sqrt((<a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>)stateVecSize/2.0);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment">// Can&#39;t use multiQubit-&gt;stateVec as a private OMP var</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">// initialise the state to |0000..0000&gt;</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="preprocessor">    shared   (chunkSize, stateVecReal, stateVecImag, normFactor, qubitId, outcome) \</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="preprocessor">    private  (index, bit) </span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    {</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            bit = <a class="code" href="QuEST_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(qubitId, index+chunkId*chunkSize);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <span class="keywordflow">if</span> (bit==outcome) {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                stateVecReal[index] = normFactor;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                stateVecImag[index] = 0.0;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                stateVecReal[index] = 0.0;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                stateVecImag[index] = 0.0;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    }</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="structMultiQubit_html_acd43f2f57991709c9e94f73662c972b2"><div class="ttname"><a href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">MultiQubit::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into – the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00069">QuEST.h:69</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="QuEST_8c_html_a100463f6ec212c76a5fad99579000505"><div class="ttname"><a href="QuEST_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a></div><div class="ttdeci">static int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdoc">Get the value of the bit at a particular index in a number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01743">QuEST.c:1743</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af8a0082e2f695145bbfbb572e4c2e4f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8a0082e2f695145bbfbb572e4c2e4f1">&#9670;&nbsp;</a></span>initStatePlus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initStatePlus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise a set of <img class="formulaInl" alt="$ N $" src="form_0.png"/> qubits to the plus state <img class="formulaInl" alt="$ {| + \rangle}^{\otimes N} = \frac{1}{\sqrt{2^N}} (| 0 \rangle + | 1 \rangle)^{\otimes N} $" src="form_2.png"/>. </p>
<p>This is the product state of <img class="formulaInl" alt="$N$" src="form_3.png"/> qubits where every classical state is uniformly populated with real coefficient <img class="formulaInl" alt="$\frac{1}{\sqrt{2^N}}$" src="form_4.png"/>. This is equivalent to applying a Hadamard to every qubit in the zero state: <img class="formulaInl" alt="$ \hat{H}^{\otimes N} {|0\rangle}^{\otimes N} $" src="form_5.png"/></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>the object representing the set of qubits to be initialised </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00189">189</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="runTests_8c_source.html#l00717">test_collapseToOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00366">test_compactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00672">test_findProbabilityOfOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00054">test_initStatePlus()</a>, <a class="el" href="runTests_8c_source.html#l00782">test_measure()</a>, <a class="el" href="runTests_8c_source.html#l00833">test_measureWithStats()</a>, and <a class="el" href="runTests_8c_source.html#l00428">test_unitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;{</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    chunkSize = multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    stateVecSize = chunkSize*multiQubit.<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">numChunks</a>;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> normFactor = 1.0/sqrt((<a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>)stateVecSize);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// Can&#39;t use multiQubit-&gt;stateVec as a private OMP var</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">// initialise the state to |0000..0000&gt;</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="preprocessor">    shared   (chunkSize, stateVecReal, stateVecImag, normFactor) \</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor">    private  (index) </span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    {</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            stateVecReal[index] = normFactor;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            stateVecImag[index] = 0.0;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    }</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="structMultiQubit_html_acd43f2f57991709c9e94f73662c972b2"><div class="ttname"><a href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">MultiQubit::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into – the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00069">QuEST.h:69</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9ba8171c9ec5c42202b144026527e9ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ba8171c9ec5c42202b144026527e9ec">&#9670;&nbsp;</a></span>initStateZero()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initStateZero </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise a set of <img class="formulaInl" alt="$ N $" src="form_0.png"/> qubits to the classical zero state <img class="formulaInl" alt="$ {| 0 \rangle}^{\otimes N} $" src="form_1.png"/>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>the object representing the set of all qubits to initialise </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00153">153</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="bernstein__vazirani__circuit_8c_source.html#l00011">main()</a>, <a class="el" href="runTests_8c_source.html#l00717">test_collapseToOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00672">test_findProbabilityOfOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00031">test_initStateZero()</a>, <a class="el" href="runTests_8c_source.html#l00782">test_measure()</a>, and <a class="el" href="runTests_8c_source.html#l00833">test_measureWithStats()</a>.</p>
<div class="fragment"><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;{</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    stateVecSize = multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">// Can&#39;t use multiQubit-&gt;stateVec as a private OMP var</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// initialise the state to |0000..0000&gt;</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor">    shared   (stateVecSize, stateVecReal, stateVecImag) \</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="preprocessor">    private  (index) </span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            stateVecReal[index] = 0.0;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            stateVecImag[index] = 0.0;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        }</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>==0){</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="comment">// zero state |0000..0000&gt; has probability 1</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        stateVecReal[0] = 1.0;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        stateVecImag[0] = 0.0;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    }</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afc1835c6b43b6e59ce7df7b13f274fc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc1835c6b43b6e59ce7df7b13f274fc7">&#9670;&nbsp;</a></span>multiControlledPhaseGate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multiControlledPhaseGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>controlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numControlQubits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply the multiple-qubit controlled phase gate, also known as the multiple-qubit controlled sigmaZ gate. </p>
<p>For each state, if all control qubits have value one, multiply the amplitude of that state by -1. This applies the many-qubit unitary: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 1 \\ &amp; 1 \\\ &amp; &amp; \ddots \\ &amp; &amp; &amp; 1 \\ &amp; &amp; &amp; &amp; -1 \end{pmatrix} \]" src="form_10.png"/>
</p>
<p> on the control qubits.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {controls}; \node[draw=none] at (0, 6) {$\vdots$}; \draw (0, 5) -- (0, 4); \draw (-2, 4) -- (2, 4); \draw[fill=black] (0, 4) circle (.2); \draw (0, 4) -- (0, 2); \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 0); \draw (-2,0) -- (2, 0); \draw[fill=black] (0, 0) circle (.2); \end{tikzpicture} } \]" src="form_11.png"/>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">controlQubits</td><td>array of input qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numControlQubits</td><td>number of input qubits </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>numControlQubits</code> is outside [1, <code>multiQubit.numQubits</code>) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01783">1783</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="tutorial__example_8c_source.html#l00004">main()</a>, and <a class="el" href="runTests_8c_source.html#l00340">test_multiControlledPhaseGate()</a>.</p>
<div class="fragment"><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;{</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(numControlQubits &gt; 0 &amp;&amp; numControlQubits &lt;= multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>, 4, __func__);</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> mask=0;</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;numControlQubits; i++) mask = mask | (1LL&lt;&lt;controlQubits[i]);</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(mask &gt;=0 &amp;&amp; mask &lt;= (1LL&lt;&lt;multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>)-1, 2, __func__);</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    stateVecSize = multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;<span class="preprocessor">    default  (none)                          \</span></div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;<span class="preprocessor">    shared   (stateVecSize, stateVecReal,stateVecImag, mask ) \</span></div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;<span class="preprocessor">    private  (index)</span></div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    {</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;            <span class="keywordflow">if</span> (mask == (mask &amp; (index+chunkId*chunkSize)) ){</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;                stateVecReal [index] = - stateVecReal [index];</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;                stateVecImag [index] = - stateVecImag [index];</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;            }</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;        }</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    }</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__env__local_8c_html_a3587b9d533e633ccf1abf9ad2ce45d8d"><div class="ttname"><a href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a></div><div class="ttdeci">void QuESTAssert(int isValid, int errorCode, const char *func)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__local_8c_source.html#l00240">QuEST_env_local.c:240</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00062">QuEST.h:62</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9dbf856ebeea0cf0a3ee5aae6782f2d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9dbf856ebeea0cf0a3ee5aae6782f2d2">&#9670;&nbsp;</a></span>multiControlledUnitaryDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multiControlledUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply a unitary operation to a single qubit in the state vector of probability amplitudes, given a subset of the state vector with upper and lower block values stored seperately. </p>
<p>Only perform the rotation where all the control qubits are 1.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">controlQubit</td><td>qubit to determine whether or not to perform a rotation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot1</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot2</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecUp</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecLo</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01056">1056</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00067">MultiQubit::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00030">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00029">Complex::real</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00441">multiControlledUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;{</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="preprocessor">            rot1Real,rot1Imag, rot2Real,rot2Imag, mask) \</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    {</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            <span class="keywordflow">if</span> (mask == (mask &amp; (thisTask+chunkId*chunkSize)) ){</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                stateRealUp = stateVecRealUp[thisTask];</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                stateImagUp = stateVecImagUp[thisTask];</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                stateRealLo = stateVecRealLo[thisTask];</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                stateImagLo = stateVecImagLo[thisTask];</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp </div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                    + rot2Real*stateRealLo - rot2Imag*stateImagLo;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp </div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                    + rot2Real*stateImagLo + rot2Imag*stateRealLo;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            }</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        }</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    }</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="structComplex_html_a1151948284b21c0052f203f23ab931d9"><div class="ttname"><a href="structComplex.html#a1151948284b21c0052f203f23ab931d9">Complex::imag</a></div><div class="ttdeci">REAL imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00030">QuEST.h:30</a></div></div>
<div class="ttc" id="structComplex_html_a479ad939835457595fcca3ca55c06283"><div class="ttname"><a href="structComplex.html#a479ad939835457595fcca3ca55c06283">Complex::real</a></div><div class="ttdeci">REAL real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00029">QuEST.h:29</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1309eabcba3cb97fbc3cd2e606d17766"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1309eabcba3cb97fbc3cd2e606d17766">&#9670;&nbsp;</a></span>multiControlledUnitaryLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multiControlledUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00787">787</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00067">MultiQubit::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00030">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00037">ComplexMatrix2::r0c0</a>, <a class="el" href="QuEST_8h_source.html#l00037">ComplexMatrix2::r0c1</a>, <a class="el" href="QuEST_8h_source.html#l00038">ComplexMatrix2::r1c0</a>, <a class="el" href="QuEST_8h_source.html#l00038">ComplexMatrix2::r1c1</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, <a class="el" href="QuEST_8h_source.html#l00029">Complex::real</a>, and <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00137">multiControlledUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;{</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="comment">// set dimensions</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="comment">// Can&#39;t use multiQubit.stateVec as a private OMP var</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, u, mask) \</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    {</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            <span class="keywordflow">if</span> (mask == (mask &amp; (indexUp+chunkId*chunkSize)) ){</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                stateRealLo = stateVecReal[indexLo];</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                stateImagLo = stateVecImag[indexLo];</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                <span class="comment">// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                stateVecReal[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp </div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                    + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo - u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                stateVecImag[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp </div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                    + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                <span class="comment">// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                stateVecReal[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp  - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp </div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                    + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo  -  u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                stateVecImag[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp </div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                    + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            }</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        } </div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    }</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_a763007c3070802373549ba0350f83c8a"><div class="ttname"><a href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">ComplexMatrix2::r1c1</a></div><div class="ttdeci">Complex r1c1</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00038">QuEST.h:38</a></div></div>
<div class="ttc" id="structComplex_html_a1151948284b21c0052f203f23ab931d9"><div class="ttname"><a href="structComplex.html#a1151948284b21c0052f203f23ab931d9">Complex::imag</a></div><div class="ttdeci">REAL imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00030">QuEST.h:30</a></div></div>
<div class="ttc" id="structComplex_html_a479ad939835457595fcca3ca55c06283"><div class="ttname"><a href="structComplex.html#a479ad939835457595fcca3ca55c06283">Complex::real</a></div><div class="ttdeci">REAL real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00029">QuEST.h:29</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_ae72b4458233b077a636beee1892e81ff"><div class="ttname"><a href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">ComplexMatrix2::r0c0</a></div><div class="ttdeci">Complex r0c0</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00037">QuEST.h:37</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_ab98282015ed2065e53fbc9638e2583ab"><div class="ttname"><a href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">ComplexMatrix2::r1c0</a></div><div class="ttdeci">Complex r1c0</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00038">QuEST.h:38</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_a0f3932f055a8b05cef361bce25d51172"><div class="ttname"><a href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">ComplexMatrix2::r0c1</a></div><div class="ttdeci">Complex r0c1</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00037">QuEST.h:37</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af832ed00b02a0597b7fe0b714032c54a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af832ed00b02a0597b7fe0b714032c54a">&#9670;&nbsp;</a></span>phaseGateDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void phaseGateDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a>&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01568">1568</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, <a class="el" href="QuEST_8h_source.html#l00082">S_GATE</a>, <a class="el" href="QuEST_8h_source.html#l00082">SIGMA_Z</a>, <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>, and <a class="el" href="QuEST_8h_source.html#l00082">T_GATE</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00584">phaseGate()</a>.</p>
<div class="fragment"><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;{</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealLo,stateImagLo;</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    <span class="comment">// Can&#39;t use multiQubit.stateVec as a private OMP var</span></div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> recRoot2 = 1.0/sqrt(2);</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="preprocessor">    shared   (stateVecReal,stateVecImag, recRoot2, type) \</span></div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="preprocessor">    private  (thisTask,stateRealLo,stateImagLo) </span></div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    {</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;        <span class="keywordflow">if</span> (type==<a class="code" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a>){</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;            <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                stateVecReal[thisTask] = -stateVecReal[thisTask];</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                stateVecImag[thisTask] = -stateVecImag[thisTask];</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;            } </div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<a class="code" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a>){</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;            <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;                stateRealLo = stateVecReal[thisTask];</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;                stateImagLo = stateVecImag[thisTask];</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;                stateVecReal[thisTask] = -stateImagLo;</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;                stateVecImag[thisTask] = stateRealLo;</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;            } </div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<a class="code" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a>){</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;            <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                stateRealLo = stateVecReal[thisTask];</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                stateImagLo = stateVecImag[thisTask];</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                stateVecReal[thisTask] = recRoot2 * (stateRealLo - stateImagLo);</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                stateVecImag[thisTask] = recRoot2 * (stateRealLo + stateImagLo);</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;            } </div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;        } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Type %d is an invalid phase gate\n&quot;</span>, type);</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    }</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST_8h_html_a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac"><div class="ttname"><a href="QuEST_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00082">QuEST.h:82</a></div></div>
<div class="ttc" id="QuEST_8h_html_a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f"><div class="ttname"><a href="QuEST_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00082">QuEST.h:82</a></div></div>
<div class="ttc" id="QuEST_8h_html_a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab"><div class="ttname"><a href="QuEST_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00082">QuEST.h:82</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3a54566b73ac84c312d7da4f56ffbc3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a54566b73ac84c312d7da4f56ffbc3b">&#9670;&nbsp;</a></span>phaseGateLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void phaseGateLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a>&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>fix &ndash; can i rewrite this to not use mod?</p>
<p>fix &ndash; can i rewrite this to not use mod?</p>
<p>fix &ndash; can i rewrite this to not use mod? </p>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01492">1492</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, <a class="el" href="QuEST_8h_source.html#l00082">S_GATE</a>, <a class="el" href="QuEST_8h_source.html#l00082">SIGMA_Z</a>, <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>, and <a class="el" href="QuEST_8h_source.html#l00082">T_GATE</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00163">phaseGate()</a>.</p>
<div class="fragment"><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;{</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealLo,stateImagLo;</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    <span class="comment">// set dimensions</span></div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    <span class="comment">// Can&#39;t use multiQubit.stateVec as a private OMP var</span></div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> recRoot2 = 1.0/sqrt(2);</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock,stateVecReal,stateVecImag,recRoot2,type) \</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="preprocessor">    private  (thisTask,thisBlock,indexUp,indexLo,stateRealLo,stateImagLo) </span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    {</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        <span class="keywordflow">if</span> (type==<a class="code" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a>){</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;            <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                stateVecReal[indexLo] = -stateVecReal[indexLo];</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                stateVecImag[indexLo] = -stateVecImag[indexLo];</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;            } </div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        } </div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<a class="code" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a>){</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;            <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                stateRealLo = stateVecReal[indexLo];</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                stateImagLo = stateVecImag[indexLo];</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                stateVecReal[indexLo] = -stateImagLo;</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                stateVecImag[indexLo] = stateRealLo;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;            } </div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<a class="code" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a>){</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;            <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                stateRealLo = stateVecReal[indexLo];</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                stateImagLo = stateVecImag[indexLo];</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                stateVecReal[indexLo] = recRoot2 * (stateRealLo - stateImagLo);</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                stateVecImag[indexLo] = recRoot2 * (stateRealLo + stateImagLo);</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;            } </div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;        } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Type %d is an invalid phase gate\n&quot;</span>, type);</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    }</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST_8h_html_a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac"><div class="ttname"><a href="QuEST_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00082">QuEST.h:82</a></div></div>
<div class="ttc" id="QuEST_8h_html_a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f"><div class="ttname"><a href="QuEST_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00082">QuEST.h:82</a></div></div>
<div class="ttc" id="QuEST_8h_html_a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab"><div class="ttname"><a href="QuEST_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00082">QuEST.h:82</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa5e77e0e64f3a4a3d3f5cc7382bffcd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5e77e0e64f3a4a3d3f5cc7382bffcd9">&#9670;&nbsp;</a></span>reportMultiQubitParams()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportMultiQubitParams </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Report metainformation about a set of qubits: number of qubits, number of probability amplitudes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td>object representing the execution environment (local, multinode etc) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00125">125</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="tutorial__example_8c_source.html#l00004">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                                  {</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = 1L &lt;&lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmpsPerRank = numAmps/multiQubit.<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">numChunks</a>;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>==0){</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        printf(<span class="stringliteral">&quot;QUBITS:\n&quot;</span>);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        printf(<span class="stringliteral">&quot;Number of qubits is %d.\n&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        printf(<span class="stringliteral">&quot;Number of amps is %lld.\n&quot;</span>, numAmps);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        printf(<span class="stringliteral">&quot;Number of amps per rank is %lld.\n&quot;</span>, numAmpsPerRank);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    }</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div><div class="ttc" id="structMultiQubit_html_acd43f2f57991709c9e94f73662c972b2"><div class="ttname"><a href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">MultiQubit::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into – the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00069">QuEST.h:69</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00062">QuEST.h:62</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a96f4de9ce7fefc7680a44d601fc3d894"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96f4de9ce7fefc7680a44d601fc3d894">&#9670;&nbsp;</a></span>reportState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print the current state vector of probability amplitudes for a set of qubits to file. </p>
<p>File format: </p><pre class="fragment">real, imag
realComponent1, imagComponent1
realComponent2, imagComponent2
...
realComponentN, imagComponentN
</pre><p>File naming convention:</p>
<p>For each node that the program runs on, a file 'state_rank_[node_rank].csv' is generated. If there is more than one node, ranks after the first do not include the header </p><pre class="fragment">real, imag
</pre><p> so that files are easier to combine.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00086">86</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                                       {</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    FILE *state;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordtype">char</span> filename[100];</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    sprintf(filename, <span class="stringliteral">&quot;state_rank_%d.csv&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    state = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(state!=NULL, 11, __func__);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>==0) fprintf(state, <span class="stringliteral">&quot;real, imag\n&quot;</span>);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">for</span>(index=0; index&lt;multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>; index++){</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        fprintf(state, <a class="code" href="QuEST__precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a> <span class="stringliteral">&quot;,&quot;</span> <a class="code" href="QuEST__precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a> <span class="stringliteral">&quot;\n&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[index], multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[index]);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    }</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    fclose(state);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__env__local_8c_html_a3587b9d533e633ccf1abf9ad2ce45d8d"><div class="ttname"><a href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a></div><div class="ttdeci">void QuESTAssert(int isValid, int errorCode, const char *func)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__local_8c_source.html#l00240">QuEST_env_local.c:240</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_ad751ac7ddc8ec19f23fb33083c0da8da"><div class="ttname"><a href="QuEST__precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a></div><div class="ttdeci">#define REAL_STRING_FORMAT</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00027">QuEST_precision.h:27</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a842d6884e063a5865a2232cba56b65ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a842d6884e063a5865a2232cba56b65ac">&#9670;&nbsp;</a></span>reportStateToScreen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportStateToScreen </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reportRank</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print the current state vector of probability amplitudes for a set of qubits to standard out. </p>
<p>For debugging purposes. Each rank should print output serially. Only print output for systems &lt;= 5 qubits </p>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00101">101</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="runTests_8c_source.html#l00019">reportTest()</a>.</p>
<div class="fragment"><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                                                                             {</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordtype">int</span> rank;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>&lt;=5){</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">for</span> (rank=0; rank&lt;multiQubit.<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">numChunks</a>; rank++){</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>==rank){</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                <span class="keywordflow">if</span> (reportRank) {</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                    printf(<span class="stringliteral">&quot;Reporting state from rank %d [\n&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                    printf(<span class="stringliteral">&quot;real, imag\n&quot;</span>);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rank==0) {</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                    printf(<span class="stringliteral">&quot;Reporting state [\n&quot;</span>);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                    printf(<span class="stringliteral">&quot;real, imag\n&quot;</span>);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                }</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                <span class="keywordflow">for</span>(index=0; index&lt;multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>; index++){</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                    printf(<a class="code" href="QuEST__precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a> <span class="stringliteral">&quot;, &quot;</span> <a class="code" href="QuEST__precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a> <span class="stringliteral">&quot;\n&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[index], multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[index]);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                <span class="keywordflow">if</span> (reportRank || rank==multiQubit.<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">numChunks</a>-1) printf(<span class="stringliteral">&quot;]\n&quot;</span>);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <a class="code" href="QuEST__env__local_8c.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77">syncQuESTEnv</a>(<a class="code" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        }</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Error: reportStateToScreen will not print output for systems of more than 5 qubits.\n&quot;</span>);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;}</div><div class="ttc" id="runTests_8c_html_a5fd8ba97fcae3408ae6221dfc3cc1f93"><div class="ttname"><a href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a></div><div class="ttdeci">QuESTEnv env</div><div class="ttdef"><b>Definition:</b> <a href="runTests_8c_source.html#l00017">runTests.c:17</a></div></div>
<div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_ad751ac7ddc8ec19f23fb33083c0da8da"><div class="ttname"><a href="QuEST__precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a></div><div class="ttdeci">#define REAL_STRING_FORMAT</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00027">QuEST_precision.h:27</a></div></div>
<div class="ttc" id="structMultiQubit_html_acd43f2f57991709c9e94f73662c972b2"><div class="ttname"><a href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">MultiQubit::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into – the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00069">QuEST.h:69</a></div></div>
<div class="ttc" id="QuEST__env__local_8c_html_a8d31fe2d1ad4d01e2a1f5f6b8bc15b77"><div class="ttname"><a href="QuEST__env__local_8c.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77">syncQuESTEnv</a></div><div class="ttdeci">void syncQuESTEnv(QuESTEnv env)</div><div class="ttdoc">Guarantees that all code up to the given point has been executed on all nodes (if running in distribu...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__local_8c_source.html#l00031">QuEST_env_local.c:31</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00062">QuEST.h:62</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8810423457803005fecd415f4299f40d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8810423457803005fecd415f4299f40d">&#9670;&nbsp;</a></span>rotateAroundAxis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotateAroundAxis </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td>
          <td class="paramname"><em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structVector.html">Vector</a>&#160;</td>
          <td class="paramname"><em>axis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by a given angle around a given vector on the Bloch-sphere. </p>
<p>The vector must not be zero (else an error is thrown), but needn't be unit magnitude.</p>
<p>For angle <img class="formulaInl" alt="$\theta$" src="form_27.png"/> and axis vector <img class="formulaInl" alt="$\vec{n}$" src="form_34.png"/>, applies <img class="formulaInl" alt="$R_{\hat{n}} = \exp \left(- i \frac{\theta}{2} \hat{n} \cdot \vec{\sigma} \right) $" src="form_35.png"/> where <img class="formulaInl" alt="$\vec{\sigma}$" src="form_36.png"/> is the vector of Pauli matrices.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">angle</td><td>angle by which to rotate in radians </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">axis</td><td>vector around which to rotate (can be non-unit; will be normalised) </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>rotQubit</code> is outside [0, <code>multiQubit.numQubits</code>), or if <code>axis</code> is the zero vector </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00428">428</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="tutorial__example_8c_source.html#l00004">main()</a>, <a class="el" href="QuEST_8c_source.html#l00441">rotateX()</a>, <a class="el" href="QuEST_8c_source.html#l00447">rotateY()</a>, and <a class="el" href="QuEST_8c_source.html#l00453">rotateZ()</a>.</p>
<div class="fragment"><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                                                                                         {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordtype">double</span> mag = sqrt(pow(axis.<a class="code" href="structVector.html#aac7abe171ba4bada50ed72acba6259fc">x</a>,2) + pow(axis.<a class="code" href="structVector.html#a375ca805d4c808a53d7c4e0c737ae3de">y</a>,2) + pow(axis.<a class="code" href="structVector.html#ad4e863651be7d6b7e2b28cd7445a0ccf">z</a>,2));</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <a class="code" href="structVector.html">Vector</a> unitAxis = {axis.<a class="code" href="structVector.html#aac7abe171ba4bada50ed72acba6259fc">x</a>/mag, axis.<a class="code" href="structVector.html#a375ca805d4c808a53d7c4e0c737ae3de">y</a>/mag, axis.<a class="code" href="structVector.html#ad4e863651be7d6b7e2b28cd7445a0ccf">z</a>/mag};</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <a class="code" href="structComplex.html">Complex</a> alpha, beta;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> = cos(angle/2.0);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> = -sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#ad4e863651be7d6b7e2b28cd7445a0ccf">z</a>;    </div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> = sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#a375ca805d4c808a53d7c4e0c737ae3de">y</a>;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> = -sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#aac7abe171ba4bada50ed72acba6259fc">x</a>;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <a class="code" href="QuEST__env__local_8c.html#a03b13dfcabd8c59b50dbdd3af44ba8b2">compactUnitary</a>(multiQubit, rotQubit, alpha, beta);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;}</div><div class="ttc" id="QuEST__env__local_8c_html_a03b13dfcabd8c59b50dbdd3af44ba8b2"><div class="ttname"><a href="QuEST__env__local_8c.html#a03b13dfcabd8c59b50dbdd3af44ba8b2">compactUnitary</a></div><div class="ttdeci">void compactUnitary(MultiQubit multiQubit, const int targetQubit, Complex alpha, Complex beta)</div><div class="ttdoc">Apply a single-qubit unitary parameterised by two given complex scalars. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__local_8c_source.html#l00098">QuEST_env_local.c:98</a></div></div>
<div class="ttc" id="structVector_html_aac7abe171ba4bada50ed72acba6259fc"><div class="ttname"><a href="structVector.html#aac7abe171ba4bada50ed72acba6259fc">Vector::x</a></div><div class="ttdeci">REAL x</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00045">QuEST.h:45</a></div></div>
<div class="ttc" id="structVector_html"><div class="ttname"><a href="structVector.html">Vector</a></div><div class="ttdoc">Represents a 3-vector of real numbers. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00043">QuEST.h:43</a></div></div>
<div class="ttc" id="structComplex_html_a1151948284b21c0052f203f23ab931d9"><div class="ttname"><a href="structComplex.html#a1151948284b21c0052f203f23ab931d9">Complex::imag</a></div><div class="ttdeci">REAL imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00030">QuEST.h:30</a></div></div>
<div class="ttc" id="structComplex_html_a479ad939835457595fcca3ca55c06283"><div class="ttname"><a href="structComplex.html#a479ad939835457595fcca3ca55c06283">Complex::real</a></div><div class="ttdeci">REAL real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00029">QuEST.h:29</a></div></div>
<div class="ttc" id="structVector_html_ad4e863651be7d6b7e2b28cd7445a0ccf"><div class="ttname"><a href="structVector.html#ad4e863651be7d6b7e2b28cd7445a0ccf">Vector::z</a></div><div class="ttdeci">REAL z</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00045">QuEST.h:45</a></div></div>
<div class="ttc" id="structVector_html_a375ca805d4c808a53d7c4e0c737ae3de"><div class="ttname"><a href="structVector.html#a375ca805d4c808a53d7c4e0c737ae3de">Vector::y</a></div><div class="ttdeci">REAL y</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00045">QuEST.h:45</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00027">QuEST.h:27</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6cc7fa705a2f2e6b486b49c5589d5df5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cc7fa705a2f2e6b486b49c5589d5df5">&#9670;&nbsp;</a></span>rotateX()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotateX </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by a given angle around the X-axis of the Bloch-sphere. </p>
<p>For angle <img class="formulaInl" alt="$\theta$" src="form_27.png"/>, applies </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} \cos\theta/2 &amp; -i \sin \theta/2\\ -i \sin \theta/2 &amp; \cos \theta/2 \end{pmatrix} \]" src="form_28.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {rot}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$R_x(\theta)$}; \end{tikzpicture} } \]" src="form_29.png"/>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">angle</td><td>angle by which to rotate in radians </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>rotQubit</code> is outside [0, <code>multiQubit.numQubits</code>). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00441">441</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                                                                   {</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <a class="code" href="structVector.html">Vector</a> unitAxis = {1, 0, 0};</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <a class="code" href="QuEST_8c.html#a8810423457803005fecd415f4299f40d">rotateAroundAxis</a>(multiQubit, rotQubit, angle, unitAxis);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;}</div><div class="ttc" id="QuEST_8c_html_a8810423457803005fecd415f4299f40d"><div class="ttname"><a href="QuEST_8c.html#a8810423457803005fecd415f4299f40d">rotateAroundAxis</a></div><div class="ttdeci">void rotateAroundAxis(MultiQubit multiQubit, const int rotQubit, REAL angle, Vector axis)</div><div class="ttdoc">Rotate a single qubit by a given angle around a given vector on the Bloch-sphere. ...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l00428">QuEST.c:428</a></div></div>
<div class="ttc" id="structVector_html"><div class="ttname"><a href="structVector.html">Vector</a></div><div class="ttdoc">Represents a 3-vector of real numbers. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00043">QuEST.h:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ace0d3592d38a990e81a434c4e9681500"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace0d3592d38a990e81a434c4e9681500">&#9670;&nbsp;</a></span>rotateY()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotateY </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by a given angle around the Y-axis of the Bloch-sphere. </p>
<p>For angle <img class="formulaInl" alt="$\theta$" src="form_27.png"/>, applies </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} \cos\theta/2 &amp; - \sin \theta/2\\ \sin \theta/2 &amp; \cos \theta/2 \end{pmatrix} \]" src="form_30.png"/>
</p>
<p> <br />
 </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {rot}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$R_y(\theta)$}; \end{tikzpicture} } \]" src="form_31.png"/>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">angle</td><td>angle by which to rotate in radians </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>rotQubit</code> is outside [0, <code>multiQubit.numQubits</code>). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00447">447</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="testcode_8cpp_source.html#l00003">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                                                                   {</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <a class="code" href="structVector.html">Vector</a> unitAxis = {0, 1, 0};</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="QuEST_8c.html#a8810423457803005fecd415f4299f40d">rotateAroundAxis</a>(multiQubit, rotQubit, angle, unitAxis);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;}</div><div class="ttc" id="QuEST_8c_html_a8810423457803005fecd415f4299f40d"><div class="ttname"><a href="QuEST_8c.html#a8810423457803005fecd415f4299f40d">rotateAroundAxis</a></div><div class="ttdeci">void rotateAroundAxis(MultiQubit multiQubit, const int rotQubit, REAL angle, Vector axis)</div><div class="ttdoc">Rotate a single qubit by a given angle around a given vector on the Bloch-sphere. ...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l00428">QuEST.c:428</a></div></div>
<div class="ttc" id="structVector_html"><div class="ttname"><a href="structVector.html">Vector</a></div><div class="ttdoc">Represents a 3-vector of real numbers. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00043">QuEST.h:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abd621412ad30c1b034f4ce153c4afe10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd621412ad30c1b034f4ce153c4afe10">&#9670;&nbsp;</a></span>rotateZ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotateZ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by a given angle around the Z-axis of the Bloch-sphere (also known as a phase shift gate). </p>
<p>For angle <img class="formulaInl" alt="$\theta$" src="form_27.png"/>, applies </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} \exp(-i \theta/2) &amp; 0 \\ 0 &amp; \exp(i \theta/2) \end{pmatrix} \]" src="form_32.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {rot}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$R_z(\theta)$}; \end{tikzpicture} } \]" src="form_33.png"/>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">angle</td><td>angle by which to rotate in radians </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>rotQubit</code> is outside [0, <code>multiQubit.numQubits</code>). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00453">453</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                                                                   {</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <a class="code" href="structVector.html">Vector</a> unitAxis = {0, 0, 1};</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <a class="code" href="QuEST_8c.html#a8810423457803005fecd415f4299f40d">rotateAroundAxis</a>(multiQubit, rotQubit, angle, unitAxis);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;}</div><div class="ttc" id="QuEST_8c_html_a8810423457803005fecd415f4299f40d"><div class="ttname"><a href="QuEST_8c.html#a8810423457803005fecd415f4299f40d">rotateAroundAxis</a></div><div class="ttdeci">void rotateAroundAxis(MultiQubit multiQubit, const int rotQubit, REAL angle, Vector axis)</div><div class="ttdoc">Rotate a single qubit by a given angle around a given vector on the Bloch-sphere. ...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l00428">QuEST.c:428</a></div></div>
<div class="ttc" id="structVector_html"><div class="ttname"><a href="structVector.html">Vector</a></div><div class="ttdoc">Represents a 3-vector of real numbers. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00043">QuEST.h:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a95012dad46509b4b461974c34cfd7b3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95012dad46509b4b461974c34cfd7b3d">&#9670;&nbsp;</a></span>seedQuEST()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void seedQuEST </td>
          <td>(</td>
          <td class="paramtype">unsigned long int *&#160;</td>
          <td class="paramname"><em>seedArray</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numSeeds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>numSeeds &lt;= 64 </p>
<p>Seed the Mersenne Twister used for random number generation in the QuEST environment with a user defined seed. </p>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l02019">2019</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="runTests_8c_source.html#l00782">test_measure()</a>.</p>
<div class="fragment"><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;                                                          {</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    <span class="comment">// init MT random number generator with user defined list of seeds</span></div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    <span class="comment">// for the MPI version, it is ok that all procs will get the same seed as random numbers will only be </span></div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    <span class="comment">// used by the master process</span></div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    <a class="code" href="mt19937ar_8c.html#ac1283f9b1ed571332f5ffe53545ffc16">init_by_array</a>(seedArray, numSeeds); </div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;}</div><div class="ttc" id="mt19937ar_8c_html_ac1283f9b1ed571332f5ffe53545ffc16"><div class="ttname"><a href="mt19937ar_8c.html#ac1283f9b1ed571332f5ffe53545ffc16">init_by_array</a></div><div class="ttdeci">void init_by_array(unsigned long init_key[], int key_length)</div><div class="ttdef"><b>Definition:</b> <a href="mt19937ar_8c_source.html#l00080">mt19937ar.c:80</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab0ab3ec70938712c26988a6aa51263a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0ab3ec70938712c26988a6aa51263a0">&#9670;&nbsp;</a></span>seedQuESTDefault()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void seedQuESTDefault </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Seed the Mersenne Twister used for random number generation in the QuEST environment with an example defualt seed. </p>
<p>This default seeding function uses the mt19937 init_by_array function with three keys &ndash; time, pid and hostname. Subsequent calls to mt19937 genrand functions will use this seeding. For a multi process code, the same seed is given to all process, therefore this seeding is only appropriate to use for functions such as measure where all processes require the same random value.</p>
<p>For more information about the MT, see <a href="http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/MT2002/emt19937ar.html">http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/MT2002/emt19937ar.html</a> </p>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01994">1994</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00023">initQuESTEnv()</a>.</p>
<div class="fragment"><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;                       {</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    <span class="comment">// init MT random number generator with three keys -- time, pid and a hash of hostname </span></div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    <span class="comment">// for the MPI version, it is ok that all procs will get the same seed as random numbers will only be </span></div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    <span class="comment">// used by the master process</span></div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    <span class="keyword">struct </span>timeval  tv;</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    gettimeofday(&amp;tv, NULL);</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    <span class="keywordtype">double</span> time_in_mill = </div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;        (tv.tv_sec) * 1000 + (tv.tv_usec) / 1000 ; <span class="comment">// convert tv_sec &amp; tv_usec to millisecond</span></div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> pid = getpid();</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> msecs = (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> int) time_in_mill;</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    <span class="keywordtype">char</span> hostName[MAXHOSTNAMELEN+1];</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    gethostname(hostName, <span class="keyword">sizeof</span>(hostName));</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> hostNameInt = <a class="code" href="QuEST_8c.html#ab76254cfde16f0808476649507a1a2fc">hashString</a>(hostName);</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> key[3];</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    key[0] = msecs; key[1] = pid; key[2] = hostNameInt;</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    <a class="code" href="mt19937ar_8c.html#ac1283f9b1ed571332f5ffe53545ffc16">init_by_array</a>(key, 3); </div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;}</div><div class="ttc" id="mt19937ar_8c_html_ac1283f9b1ed571332f5ffe53545ffc16"><div class="ttname"><a href="mt19937ar_8c.html#ac1283f9b1ed571332f5ffe53545ffc16">init_by_array</a></div><div class="ttdeci">void init_by_array(unsigned long init_key[], int key_length)</div><div class="ttdef"><b>Definition:</b> <a href="mt19937ar_8c_source.html#l00080">mt19937ar.c:80</a></div></div>
<div class="ttc" id="QuEST_8c_html_ab76254cfde16f0808476649507a1a2fc"><div class="ttname"><a href="QuEST_8c.html#ab76254cfde16f0808476649507a1a2fc">hashString</a></div><div class="ttdeci">unsigned long int hashString(char *str)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l02026">QuEST.c:2026</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adda6c47876a7676488ed0565a19eaa65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adda6c47876a7676488ed0565a19eaa65">&#9670;&nbsp;</a></span>sGate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply the single-qubit S gate. </p>
<p>This is a rotation of <img class="formulaInl" alt="$\pi/2$" src="form_14.png"/> around the Z-axis on the Bloch sphere, or the unitary: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 1 &amp; 0 \\ 0 &amp; i \end{pmatrix} \]" src="form_15.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {S}; \end{tikzpicture} } \]" src="form_16.png"/>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to operate upon </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>targetQubit</code> is outside [0, <code>multiQubit.numQubits</code>) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01626">1626</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="runTests_8c_source.html#l00218">test_sGate()</a>.</p>
<div class="fragment"><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;{</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <a class="code" href="QuEST__env__local_8c.html#aae7a8a7f1ccbddb7f76b6c52b746bb43">phaseGate</a>(multiQubit, targetQubit, <a class="code" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a>);</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;} </div><div class="ttc" id="QuEST_8h_html_a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f"><div class="ttname"><a href="QuEST_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00082">QuEST.h:82</a></div></div>
<div class="ttc" id="QuEST__env__local_8c_html_aae7a8a7f1ccbddb7f76b6c52b746bb43"><div class="ttname"><a href="QuEST__env__local_8c.html#aae7a8a7f1ccbddb7f76b6c52b746bb43">phaseGate</a></div><div class="ttdeci">void phaseGate(MultiQubit multiQubit, const int targetQubit, enum phaseGateType type)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__local_8c_source.html#l00163">QuEST_env_local.c:163</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2275fff50824fe47485890ff5a857785"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2275fff50824fe47485890ff5a857785">&#9670;&nbsp;</a></span>sigmaXDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaXDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by {{0,1},{1,0}. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl class="section remark"><dt>Remarks</dt><dd>Qubits are zero-based and the <br />
the first qubit is the rightmost <br />
 </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecIn</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01165">1165</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00487">sigmaX()</a>.</p>
<div class="fragment"><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;{</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealIn=stateVecIn.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagIn=stateVecIn.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="preprocessor">    shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut) \</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="preprocessor">    private  (thisTask)</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    {</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;            stateVecRealOut[thisTask] = stateVecRealIn[thisTask];</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;            stateVecImagOut[thisTask] = stateVecImagIn[thisTask];</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        }</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    }</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;} </div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a74822fd86bb5d81766e6e8dbdcd62df1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74822fd86bb5d81766e6e8dbdcd62df1">&#9670;&nbsp;</a></span>sigmaXLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaXLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01106">1106</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00151">sigmaX()</a>.</p>
<div class="fragment"><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;{</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateImagUp;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="comment">// set dimensions</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <span class="comment">// Can&#39;t use multiQubit.stateVec as a private OMP var</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp) </span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    {</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;            thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;            indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;            stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            stateVecReal[indexUp] = stateVecReal[indexLo];</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;            stateVecImag[indexUp] = stateVecImag[indexLo];</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;            stateVecReal[indexLo] = stateRealUp;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;            stateVecImag[indexLo] = stateImagUp;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        } </div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    }</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af5ef5166f00c0572354b4ac53dcf40cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5ef5166f00c0572354b4ac53dcf40cf">&#9670;&nbsp;</a></span>sigmaYDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaYDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>updateUpper</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by {{0,-i},{i,0}. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl class="section remark"><dt>Remarks</dt><dd>Qubits are zero-based and the <br />
the first qubit is the rightmost <br />
 </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecIn</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">updateUpper</td><td>flag, 1: updating upper values, 0: updating lower values in block </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01352">1352</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00553">sigmaY()</a>.</p>
<div class="fragment"><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;{</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealIn=stateVecIn.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagIn=stateVecIn.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="keywordtype">int</span> realSign=1, imagSign=1;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <span class="keywordflow">if</span> (updateUpper) imagSign=-1;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    <span class="keywordflow">else</span> realSign = -1;</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="preprocessor">    shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut,realSign,imagSign) \</span></div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;<span class="preprocessor">    private  (thisTask)</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    {</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;            stateVecRealOut[thisTask] = realSign*stateVecImagIn[thisTask];</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;            stateVecImagOut[thisTask] = imagSign*stateVecRealIn[thisTask];</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;        }</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    }</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;} </div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a81fbfaed65a742a7dfd622e17652245e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81fbfaed65a742a7dfd622e17652245e">&#9670;&nbsp;</a></span>sigmaYLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaYLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01293">1293</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00157">sigmaY()</a>.</p>
<div class="fragment"><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;{</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateImagUp;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <span class="comment">// set dimensions</span></div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="comment">// Can&#39;t use multiQubit.stateVec as a private OMP var</span></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp) </span></div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    {</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;            thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;            indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;            stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;            stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;            stateVecReal[indexUp] = stateVecImag[indexLo];</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;            stateVecImag[indexUp] = -stateVecReal[indexLo];</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;            stateVecReal[indexLo] = -stateImagUp;</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            stateVecImag[indexLo] = stateRealUp;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        } </div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    }</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aebaab86326779de55d335cfea3efde8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebaab86326779de55d335cfea3efde8f">&#9670;&nbsp;</a></span>sigmaZ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaZ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply the single-qubit sigma-Z (also known as the Z, Pauli-Z or phase-flip) gate. </p>
<p>This is a rotation of <img class="formulaInl" alt="$\pi$" src="form_47.png"/> around the Z-axis (a phase shift) on the Bloch sphere. I.e. </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 1 &amp; 0 \\ 0 &amp; -1 \end{pmatrix} \]" src="form_52.png"/>
</p>
<p> <br />
 </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$\sigma_z$}; \end{tikzpicture} } \]" src="form_53.png"/>
</p>
<p> <br />
 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to operate on </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>targetQubit</code> is outside [0, <code>multiQubit.numQubits</code>). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01621">1621</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="runTests_8c_source.html#l00161">test_sigmaZ()</a>.</p>
<div class="fragment"><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;{</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <a class="code" href="QuEST__env__local_8c.html#aae7a8a7f1ccbddb7f76b6c52b746bb43">phaseGate</a>(multiQubit, targetQubit, <a class="code" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a>);</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;}</div><div class="ttc" id="QuEST_8h_html_a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac"><div class="ttname"><a href="QuEST_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00082">QuEST.h:82</a></div></div>
<div class="ttc" id="QuEST__env__local_8c_html_aae7a8a7f1ccbddb7f76b6c52b746bb43"><div class="ttname"><a href="QuEST__env__local_8c.html#aae7a8a7f1ccbddb7f76b6c52b746bb43">phaseGate</a></div><div class="ttdeci">void phaseGate(MultiQubit multiQubit, const int targetQubit, enum phaseGateType type)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__local_8c_source.html#l00163">QuEST_env_local.c:163</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af764ea63a2e870098f4e1ce08562942e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af764ea63a2e870098f4e1ce08562942e">&#9670;&nbsp;</a></span>tGate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply the single-qubit T gate. </p>
<p>This is a rotation of <img class="formulaInl" alt="$\pi/4$" src="form_17.png"/> around the Z-axis on the Bloch sphere, or the unitary: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 1 &amp; 0 \\ 0 &amp; \exp\left(i \frac{\pi}{4}\right) \end{pmatrix} \]" src="form_18.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {T}; \end{tikzpicture} } \]" src="form_19.png"/>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to operate upon </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>targetQubit</code> is outside [0, <code>multiQubit.numQubits</code>) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l01631">1631</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="runTests_8c_source.html#l00246">test_tGate()</a>.</p>
<div class="fragment"><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;{</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <a class="code" href="QuEST__env__local_8c.html#aae7a8a7f1ccbddb7f76b6c52b746bb43">phaseGate</a>(multiQubit, targetQubit, <a class="code" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a>);</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;}</div><div class="ttc" id="QuEST_8h_html_a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab"><div class="ttname"><a href="QuEST_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00082">QuEST.h:82</a></div></div>
<div class="ttc" id="QuEST__env__local_8c_html_aae7a8a7f1ccbddb7f76b6c52b746bb43"><div class="ttname"><a href="QuEST__env__local_8c.html#aae7a8a7f1ccbddb7f76b6c52b746bb43">phaseGate</a></div><div class="ttdeci">void phaseGate(MultiQubit multiQubit, const int targetQubit, enum phaseGateType type)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__local_8c_source.html#l00163">QuEST_env_local.c:163</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2343b7240118e89aa615e2c9140b770b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2343b7240118e89aa615e2c9140b770b">&#9670;&nbsp;</a></span>unitaryDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void unitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply a unitary operation to a single qubit given a subset of the state vector with upper and lower block values stored seperately. </p>
<dl class="section remark"><dt>Remarks</dt><dd>Qubits are zero-based and the first qubit is the rightmost <br />
 </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>unitary matrix to apply </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecUp</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecLo</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00675">675</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00030">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00029">Complex::real</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00312">unitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;{</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="preprocessor">            rot1Real, rot1Imag, rot2Real, rot2Imag) \</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    {</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            stateRealUp = stateVecRealUp[thisTask];</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            stateImagUp = stateVecImagUp[thisTask];</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            stateRealLo = stateVecRealLo[thisTask];</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            stateImagLo = stateVecImagLo[thisTask];</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp </div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                + rot2Real*stateRealLo - rot2Imag*stateImagLo;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;            stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp </div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                + rot2Real*stateImagLo + rot2Imag*stateRealLo;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        }</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    }</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="structComplex_html_a1151948284b21c0052f203f23ab931d9"><div class="ttname"><a href="structComplex.html#a1151948284b21c0052f203f23ab931d9">Complex::imag</a></div><div class="ttdeci">REAL imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00030">QuEST.h:30</a></div></div>
<div class="ttc" id="structComplex_html_a479ad939835457595fcca3ca55c06283"><div class="ttname"><a href="structComplex.html#a479ad939835457595fcca3ca55c06283">Complex::real</a></div><div class="ttdeci">REAL real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00029">QuEST.h:29</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac134fb45b0a7248c5d15e16eb7139a35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac134fb45b0a7248c5d15e16eb7139a35">&#9670;&nbsp;</a></span>unitaryLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void unitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00549">549</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00030">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00037">ComplexMatrix2::r0c0</a>, <a class="el" href="QuEST_8h_source.html#l00037">ComplexMatrix2::r0c1</a>, <a class="el" href="QuEST_8h_source.html#l00038">ComplexMatrix2::r1c0</a>, <a class="el" href="QuEST_8h_source.html#l00038">ComplexMatrix2::r1c1</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, <a class="el" href="QuEST_8h_source.html#l00029">Complex::real</a>, and <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00107">unitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;{</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>&gt;&gt;1;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="comment">// set dimensions</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">// Can&#39;t use multiQubit.stateVec as a private OMP var</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, u) \</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    {</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            stateRealLo = stateVecReal[indexLo];</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            stateImagLo = stateVecImag[indexLo];</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            <span class="comment">// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            stateVecReal[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp </div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo - u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            stateVecImag[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp </div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            <span class="comment">// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            stateVecReal[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp  - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp </div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo  -  u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            stateVecImag[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp </div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        } </div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    }</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;} </div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_a763007c3070802373549ba0350f83c8a"><div class="ttname"><a href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">ComplexMatrix2::r1c1</a></div><div class="ttdeci">Complex r1c1</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00038">QuEST.h:38</a></div></div>
<div class="ttc" id="structComplex_html_a1151948284b21c0052f203f23ab931d9"><div class="ttname"><a href="structComplex.html#a1151948284b21c0052f203f23ab931d9">Complex::imag</a></div><div class="ttdeci">REAL imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00030">QuEST.h:30</a></div></div>
<div class="ttc" id="structComplex_html_a479ad939835457595fcca3ca55c06283"><div class="ttname"><a href="structComplex.html#a479ad939835457595fcca3ca55c06283">Complex::real</a></div><div class="ttdeci">REAL real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00029">QuEST.h:29</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_ae72b4458233b077a636beee1892e81ff"><div class="ttname"><a href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">ComplexMatrix2::r0c0</a></div><div class="ttdeci">Complex r0c0</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00037">QuEST.h:37</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_ab98282015ed2065e53fbc9638e2583ab"><div class="ttname"><a href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">ComplexMatrix2::r1c0</a></div><div class="ttdeci">Complex r1c0</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00038">QuEST.h:38</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_a0f3932f055a8b05cef361bce25d51172"><div class="ttname"><a href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">ComplexMatrix2::r0c1</a></div><div class="ttdeci">Complex r0c1</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00037">QuEST.h:37</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae2b2c14a07dd7d50ff86032a3ca101d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2b2c14a07dd7d50ff86032a3ca101d7">&#9670;&nbsp;</a></span>validateAlphaBeta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int validateAlphaBeta </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00415">415</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00098">compactUnitary()</a>, and <a class="el" href="QuEST__env__local_8c_source.html#l00116">controlledCompactUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                                                  {</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordflow">if</span> ( fabs(alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> </div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                + alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                + beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> </div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                + beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> - 1) &gt; <a class="code" href="QuEST__precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;}</div><div class="ttc" id="structComplex_html_a1151948284b21c0052f203f23ab931d9"><div class="ttname"><a href="structComplex.html#a1151948284b21c0052f203f23ab931d9">Complex::imag</a></div><div class="ttdeci">REAL imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00030">QuEST.h:30</a></div></div>
<div class="ttc" id="structComplex_html_a479ad939835457595fcca3ca55c06283"><div class="ttname"><a href="structComplex.html#a479ad939835457595fcca3ca55c06283">Complex::real</a></div><div class="ttdeci">REAL real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00029">QuEST.h:29</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_aebb5e6716e06431296af4d1a71744dec"><div class="ttname"><a href="QuEST__precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a></div><div class="ttdeci">#define REAL_EPS</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00028">QuEST_precision.h:28</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae4fea133d1a8f09ff8da03038100adb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4fea133d1a8f09ff8da03038100adb2">&#9670;&nbsp;</a></span>validateMatrixIsUnitary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int validateMatrixIsUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&#160;</td>
          <td class="paramname"><em>u</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00391">391</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00127">controlledUnitary()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00137">multiControlledUnitary()</a>, and <a class="el" href="QuEST__env__local_8c_source.html#l00107">unitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                                             {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">if</span> ( fabs(u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> </div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> - 1) &gt; <a class="code" href="QuEST__precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">if</span> ( fabs(u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> </div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> - 1) &gt; <a class="code" href="QuEST__precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordflow">if</span> ( fabs(u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> </div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>) &gt; <a class="code" href="QuEST__precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordflow">if</span> ( fabs(u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>) &gt; <a class="code" href="QuEST__precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;}</div><div class="ttc" id="structComplexMatrix2_html_a763007c3070802373549ba0350f83c8a"><div class="ttname"><a href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">ComplexMatrix2::r1c1</a></div><div class="ttdeci">Complex r1c1</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00038">QuEST.h:38</a></div></div>
<div class="ttc" id="structComplex_html_a1151948284b21c0052f203f23ab931d9"><div class="ttname"><a href="structComplex.html#a1151948284b21c0052f203f23ab931d9">Complex::imag</a></div><div class="ttdeci">REAL imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00030">QuEST.h:30</a></div></div>
<div class="ttc" id="structComplex_html_a479ad939835457595fcca3ca55c06283"><div class="ttname"><a href="structComplex.html#a479ad939835457595fcca3ca55c06283">Complex::real</a></div><div class="ttdeci">REAL real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00029">QuEST.h:29</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_ae72b4458233b077a636beee1892e81ff"><div class="ttname"><a href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">ComplexMatrix2::r0c0</a></div><div class="ttdeci">Complex r0c0</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00037">QuEST.h:37</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_ab98282015ed2065e53fbc9638e2583ab"><div class="ttname"><a href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">ComplexMatrix2::r1c0</a></div><div class="ttdeci">Complex r1c0</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00038">QuEST.h:38</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_aebb5e6716e06431296af4d1a71744dec"><div class="ttname"><a href="QuEST__precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a></div><div class="ttdeci">#define REAL_EPS</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00028">QuEST_precision.h:28</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_a0f3932f055a8b05cef361bce25d51172"><div class="ttname"><a href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">ComplexMatrix2::r0c1</a></div><div class="ttdeci">Complex r0c1</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00037">QuEST.h:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a71c14976f63cfcda70026fa20ee531fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71c14976f63cfcda70026fa20ee531fe">&#9670;&nbsp;</a></span>validateUnitVector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int validateUnitVector </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td>
          <td class="paramname"><em>ux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td>
          <td class="paramname"><em>uy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td>
          <td class="paramname"><em>uz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00423">423</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                                                 {</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">if</span> ( fabs(sqrt(ux*ux + uy*uy + uz*uz) - 1) &gt; <a class="code" href="QuEST__precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;}</div><div class="ttc" id="QuEST__precision_8h_html_aebb5e6716e06431296af4d1a71744dec"><div class="ttname"><a href="QuEST__precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a></div><div class="ttdeci">#define REAL_EPS</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00028">QuEST_precision.h:28</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aac1637696885c75b73a1ecf381cea713"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac1637696885c75b73a1ecf381cea713">&#9670;&nbsp;</a></span>errorCodes</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* errorCodes[]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">    <span class="stringliteral">&quot;Success&quot;</span>,                                              </div><div class="line">    <span class="stringliteral">&quot;Invalid target qubit. Note qubits are zero indexed.&quot;</span>,  </div><div class="line">    <span class="stringliteral">&quot;Invalid control qubit. Note qubits are zero indexed.&quot;</span>, </div><div class="line">    <span class="stringliteral">&quot;Control qubit cannot equal target qubit.&quot;</span>,             </div><div class="line">    <span class="stringliteral">&quot;Invalid number of control qubits&quot;</span>,                     </div><div class="line">    <span class="stringliteral">&quot;Invalid unitary matrix.&quot;</span>,                              </div><div class="line">    <span class="stringliteral">&quot;Invalid rotation arguments.&quot;</span>,                          </div><div class="line">    <span class="stringliteral">&quot;Invalid system size. Cannot print output for systems greater than 5 qubits.&quot;</span>, </div><div class="line">    <span class="stringliteral">&quot;Can&#39;t collapse to state with zero probability.&quot;</span>, </div><div class="line">    <span class="stringliteral">&quot;Invalid number of qubits.&quot;</span>, </div><div class="line">    <span class="stringliteral">&quot;Invalid measurement outcome -- must be either 0 or 1.&quot;</span>, </div><div class="line">    <span class="stringliteral">&quot;Could not open file&quot;</span> </div><div class="line">}</div></div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="QuEST_8c_source.html#l00027">27</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00232">exitWithError()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Jul 14 2018 18:38:22 for Quantum Exact Simulation Toolkit by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
