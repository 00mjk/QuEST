<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Distributed QuEST: qubits.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>qubits.c File Reference</h1>
<p>The core of the QuEST Library.  
<a href="#_details">More...</a></p>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;assert.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="precision_8h_source.html">precision.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="qubits_8h_source.html">qubits.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="qubits__internal_8h_source.html">qubits_internal.h</a>&quot;</code><br/>
<code>#include &lt;omp.h&gt;</code><br/>

<p><a href="qubits_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>&nbsp;&nbsp;&nbsp;0</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (const int locationOfBitFromRight, const long long int theEncodedNumber)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the value of the bit at a particular index in a number.  <a href="#a100463f6ec212c76a5fad99579000505"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a9c02591bc64c2918503afa231d90d83f">createMultiQubit</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> *multiQubit, int numQubits, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a <a class="el" href="structMultiQubit.html" title="Represents a system of qubits.">MultiQubit</a> object representing a set of qubits.  <a href="#a9c02591bc64c2918503afa231d90d83f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#ae5d6acc322314d7a3d8a2eccf00d3b19">destroyMultiQubit</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deallocate a <a class="el" href="structMultiQubit.html" title="Represents a system of qubits.">MultiQubit</a> object representing a set of qubits.  <a href="#ae5d6acc322314d7a3d8a2eccf00d3b19"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a96f4de9ce7fefc7680a44d601fc3d894">reportState</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print the current state vector of probability amplitudes for a set of qubits to file.  <a href="#a96f4de9ce7fefc7680a44d601fc3d894"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a842d6884e063a5865a2232cba56b65ac">reportStateToScreen</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env, int reportRank)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print the current state vector of probability amplitudes for a set of qubits to standard out.  <a href="#a842d6884e063a5865a2232cba56b65ac"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#aa5e77e0e64f3a4a3d3f5cc7382bffcd9">reportMultiQubitParams</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Report metainformation about a set of qubits: number of qubits, number of probability amplitudes.  <a href="#aa5e77e0e64f3a4a3d3f5cc7382bffcd9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a8f10aabf9f607f19093aee54630caa21">getEnvironmentString</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> env, <a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, char str[200])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#acb5b2eff794339090004d29f02a70d9a">initStateZero</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> *multiQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialise a set of <img class="formulaInl" alt="$ N $" src="form_0.png"/> qubits to the classical zero state <img class="formulaInl" alt="$ {| 0 \rangle}^{\otimes N} $" src="form_1.png"/>.  <a href="#acb5b2eff794339090004d29f02a70d9a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a43bcb279fc9717fbd06a19cdef48b9d8">initStatePlus</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> *multiQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialise a set of <img class="formulaInl" alt="$ N $" src="form_0.png"/> qubits to the plus state <img class="formulaInl" alt="$ {| + \rangle}^{\otimes N} = \frac{1}{\sqrt{2^N}} (| 0 \rangle + | 1 \rangle)^{\otimes N} $" src="form_2.png"/>.  <a href="#a43bcb279fc9717fbd06a19cdef48b9d8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a7169fd0442cbc3418f3fac4d13363ca2">initStateOfSingleQubit</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> *multiQubit, int qubitId, int outcome)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialise the state vector of probability amplitudes such that one qubit is set to 'outcome' and all other qubits are in an equal superposition of zero and one.  <a href="#a7169fd0442cbc3418f3fac4d13363ca2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a03b3577a891731d505bc4b879fcca9d3">initStateDebug</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> *multiQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialise the state vector of probability amplitudes to an (unphysical) state with each component of each probability amplitude a unique floating point value.  <a href="#a03b3577a891731d505bc4b879fcca9d3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a433876ee9f3bcc54af346300f571fc3c">initializeStateFromSingleFile</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> *multiQubit, char filename[200], <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a793584932ae384c82e7e42db7d35d18d">compareStates</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> mq1, <a class="el" href="structMultiQubit.html">MultiQubit</a> mq2, REAL precision)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#ae4fea133d1a8f09ff8da03038100adb2">validateMatrixIsUnitary</a> (<a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#ae2b2c14a07dd7d50ff86032a3ca101d7">validateAlphaBeta</a> (<a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a71c14976f63cfcda70026fa20ee531fe">validateUnitVector</a> (REAL ux, REAL uy, REAL uz)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a8810423457803005fecd415f4299f40d">rotateAroundAxis</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, REAL angle, <a class="el" href="structVector.html">Vector</a> axis)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by a given angle around a given vector on the Bloch-sphere.  <a href="#a8810423457803005fecd415f4299f40d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a6cc7fa705a2f2e6b486b49c5589d5df5">rotateX</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, REAL angle)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by a given angle around the X-axis of the Bloch-sphere.  <a href="#a6cc7fa705a2f2e6b486b49c5589d5df5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#ace0d3592d38a990e81a434c4e9681500">rotateY</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, REAL angle)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by a given angle around the Y-axis of the Bloch-sphere.  <a href="#ace0d3592d38a990e81a434c4e9681500"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#abd621412ad30c1b034f4ce153c4afe10">rotateZ</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, REAL angle)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by a given angle around the Z-axis of the Bloch-sphere (also known as a phase shift gate).  <a href="#abd621412ad30c1b034f4ce153c4afe10"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#ad41f82b41149393a642391b67b3a287e">controlledRotateAroundAxis</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, REAL angle, <a class="el" href="structVector.html">Vector</a> axis)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Applies a controlled rotation by a given angle around a given vector on the Bloch-sphere.  <a href="#ad41f82b41149393a642391b67b3a287e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#ac6923ac57e67d9a21096e06f6a9012f6">controlledRotateX</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, REAL angle)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Applies a controlled rotation by a given angle around the X-axis of the Bloch-sphere.  <a href="#ac6923ac57e67d9a21096e06f6a9012f6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a71e90a2f7292116338c062934f9d1202">controlledRotateY</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, REAL angle)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Applies a controlled rotation by a given angle around the Y-axis of the Bloch-sphere.  <a href="#a71e90a2f7292116338c062934f9d1202"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a668e5d2634b02e98bc73675ccb11d61c">controlledRotateZ</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, REAL angle)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Applies a controlled rotation by a given angle around the Z-axis of the Bloch-sphere.  <a href="#a668e5d2634b02e98bc73675ccb11d61c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a9cee2d8716667a3318420a3b672f5b92">compactUnitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#ac134fb45b0a7248c5d15e16eb7139a35">unitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a20ee1878a63ae6112e8845f4a8787592">compactUnitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta, and a subset of the state vector with upper and lower block values stored seperately.  <a href="#a20ee1878a63ae6112e8845f4a8787592"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a2343b7240118e89aa615e2c9140b770b">unitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a unitary operation to a single qubit given a subset of the state vector with upper and lower block values stored seperately.  <a href="#a2343b7240118e89aa615e2c9140b770b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#afc77657651d52c47403b44b923a098a8">controlledCompactUnitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a1309eabcba3cb97fbc3cd2e606d17766">multiControlledUnitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, long long int mask, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a8a4afcff70195a306c082b8ed8d4e09a">controlledUnitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a717855e835e3161e08c18cdc15325d27">controlledCompactUnitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately.  <a href="#a717855e835e3161e08c18cdc15325d27"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a642093063a1f889f61a1311f6d6f2d3f">controlledUnitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately.  <a href="#a642093063a1f889f61a1311f6d6f2d3f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a9dbf856ebeea0cf0a3ee5aae6782f2d2">multiControlledUnitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, long long int mask, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a unitary operation to a single qubit in the state vector of probability amplitudes, given a subset of the state vector with upper and lower block values stored seperately.  <a href="#a9dbf856ebeea0cf0a3ee5aae6782f2d2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a74822fd86bb5d81766e6e8dbdcd62df1">sigmaXLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a2275fff50824fe47485890ff5a857785">sigmaXDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecIn, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{0,1},{1,0}.  <a href="#a2275fff50824fe47485890ff5a857785"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#ad357a43e80e3baf013975b1b70942f4c">controlledNotLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a05875a70b539a3efb28d027823403f34">controlledNotDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecIn, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{0,1},{1,0}.  <a href="#a05875a70b539a3efb28d027823403f34"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a81fbfaed65a742a7dfd622e17652245e">sigmaYLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#af5ef5166f00c0572354b4ac53dcf40cf">sigmaYDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecIn, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut, int updateUpper)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{0,-i},{i,0}.  <a href="#af5ef5166f00c0572354b4ac53dcf40cf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#aa9f0718b4dd794a3e1b143e3b153bfc5">hadamardLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#ae6a897066979fc52d977007d959ca09d">hadamardDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut, int updateUpper)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{1,1},{1,-1}}/sqrt2.  <a href="#ae6a897066979fc52d977007d959ca09d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a3a54566b73ac84c312d7da4f56ffbc3b">phaseGateLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, enum <a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a> type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#af832ed00b02a0597b7fe0b714032c54a">phaseGateDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, enum <a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a> type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#aebaab86326779de55d335cfea3efde8f">sigmaZ</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply the single-qubit sigma-Z (also known as the Z, Pauli-Z or phase-flip) gate.  <a href="#aebaab86326779de55d335cfea3efde8f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#adda6c47876a7676488ed0565a19eaa65">sGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply the single-qubit S gate.  <a href="#adda6c47876a7676488ed0565a19eaa65"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#af764ea63a2e870098f4e1ce08562942e">tGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply the single-qubit T gate.  <a href="#af764ea63a2e870098f4e1ce08562942e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a7c02cd0e1b4eac19771a0525f023249e">findProbabilityOfZeroLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Measure the total probability of a specified qubit being in the zero state across all amplitudes in this chunk.  <a href="#a7c02cd0e1b4eac19771a0525f023249e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a9ac9bb717a889f09d307eda9f0b65957">findProbabilityOfZeroDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Measure the probability of a specified qubit being in the zero state across all amplitudes held in this chunk.  <a href="#a9ac9bb717a889f09d307eda9f0b65957"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a11a96159191cbf1b01a1080e7f045aac">controlledPhaseGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int idQubit1, const int idQubit2)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply the (two-qubit) controlled phase gate, also known as the controlled sigmaZ gate.  <a href="#a11a96159191cbf1b01a1080e7f045aac"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#afc1835c6b43b6e59ce7df7b13f274fc7">multiControlledPhaseGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, int *controlQubits, int numControlQubits)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply the multiple-qubit controlled phase gate, also known as the multiple-qubit controlled sigmaZ gate.  <a href="#afc1835c6b43b6e59ce7df7b13f274fc7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a01d9a8b7ff0e09ec399e158389783aa9">collapseToOutcomeLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, int measureQubit, REAL totalProbability, int outcome)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update the state vector to be consistent with measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1.  <a href="#a01d9a8b7ff0e09ec399e158389783aa9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a7a1f63ec3c42d9ad72f1f01c14a885db">collapseToOutcomeDistributedRenorm</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit, const REAL totalProbability)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Renormalise parts of the state vector where measureQubit=0 or 1, based on the total probability of that qubit being in state 0 or 1.  <a href="#a7a1f63ec3c42d9ad72f1f01c14a885db"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a78908fe8e75a21fd4f7fa7dff05d6be1">collapseToOutcomeDistributedSetZero</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set all amplitudes in one chunk to 0.  <a href="#a78908fe8e75a21fd4f7fa7dff05d6be1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a799b10447d6dbdaf960a4d3eedd22014">getProbEl</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, long long int index)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the probability of the state at an index in the full state vector.  <a href="#a799b10447d6dbdaf960a4d3eedd22014"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#aac1637696885c75b73a1ecf381cea713">errorCodes</a> []</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>The core of the QuEST Library. </p>

<p>Definition in file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="ad72dbcf6d0153db1b8d8a58001feed83"></a><!-- doxytag: member="qubits.c::DEBUG" ref="ad72dbcf6d0153db1b8d8a58001feed83" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG&nbsp;&nbsp;&nbsp;0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00018">18</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00126">calcTotalProbability()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00256">exchangeStateVectors()</a>, <a class="el" href="qubits_8c_source.html#l01597">findProbabilityOfZeroLocal()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00035">initQuESTEnv()</a>, <a class="el" href="qubits_8c_source.html#l00216">initStateOfSingleQubit()</a>, <a class="el" href="qubits_8c_source.html#l00177">initStatePlus()</a>, and <a class="el" href="qubits_8c_source.html#l00139">initStateZero()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a7a1f63ec3c42d9ad72f1f01c14a885db"></a><!-- doxytag: member="qubits.c::collapseToOutcomeDistributedRenorm" ref="a7a1f63ec3c42d9ad72f1f01c14a885db" args="(MultiQubit multiQubit, const int measureQubit, const REAL totalProbability)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL collapseToOutcomeDistributedRenorm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>totalProbability</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Renormalise parts of the state vector where measureQubit=0 or 1, based on the total probability of that qubit being in state 0 or 1. </p>
<p>Measure in Zero performs an irreversible change to the state vector: it updates the vector according to the event that the value 'outcome' has been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1. In the distributed version, one block (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) is spread over multiple chunks, meaning that each chunks performs only renormalisation or only setting amplitudes to 0. This function handles the renormalisation.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>totalProbability</em>&nbsp;</td><td>probability of qubit measureQubit being zero </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01898">1898</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00694">collapseToOutcome()</a>, and <a class="el" href="qubits__env__mpi_8c_source.html#l00728">measureWithStats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01899"></a>01899 {
<a name="l01900"></a>01900         <span class="comment">// ----- temp variables</span>
<a name="l01901"></a>01901         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span>
<a name="l01902"></a>01902         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01903"></a>01903         <span class="comment">// (good for shared memory parallelism)</span>
<a name="l01904"></a>01904 
<a name="l01905"></a>01905         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> renorm=1/sqrt(totalProbability);
<a name="l01906"></a>01906         
<a name="l01907"></a>01907         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01908"></a>01908         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01909"></a>01909 
<a name="l01910"></a>01910 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01911"></a>01911 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01912"></a>01912 <span class="preprocessor">        shared    (numTasks,stateVecReal,stateVecImag) \</span>
<a name="l01913"></a>01913 <span class="preprocessor">        private   (thisTask)</span>
<a name="l01914"></a>01914 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01915"></a>01915 <span class="preprocessor"></span>        {
<a name="l01916"></a>01916 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01917"></a>01917 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule  (static)</span>
<a name="l01918"></a>01918 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01919"></a>01919 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01920"></a>01920                         <span class="comment">// summation -- simple implementation</span>
<a name="l01921"></a>01921                         stateVecReal[thisTask] = stateVecReal[thisTask]*renorm;
<a name="l01922"></a>01922                         stateVecImag[thisTask] = stateVecImag[thisTask]*renorm;
<a name="l01923"></a>01923                 }
<a name="l01924"></a>01924         }
<a name="l01925"></a>01925         <span class="keywordflow">return</span> totalProbability;
<a name="l01926"></a>01926 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a78908fe8e75a21fd4f7fa7dff05d6be1"></a><!-- doxytag: member="qubits.c::collapseToOutcomeDistributedSetZero" ref="a78908fe8e75a21fd4f7fa7dff05d6be1" args="(MultiQubit multiQubit, const int measureQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void collapseToOutcomeDistributedSetZero </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set all amplitudes in one chunk to 0. </p>
<p>Measure in Zero performs an irreversible change to the state vector: it updates the vector according to the event that a zero have been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 or 1. In the distributed version, one block (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) is spread over multiple chunks, meaning that each chunks performs only renormalisation or only setting amplitudes to 0. This function handles setting amplitudes to 0.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01940">1940</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00694">collapseToOutcome()</a>, and <a class="el" href="qubits__env__mpi_8c_source.html#l00728">measureWithStats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01941"></a>01941 {
<a name="l01942"></a>01942         <span class="comment">// ----- temp variables</span>
<a name="l01943"></a>01943         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span>
<a name="l01944"></a>01944         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01945"></a>01945         <span class="comment">// (good for shared memory parallelism)</span>
<a name="l01946"></a>01946 
<a name="l01947"></a>01947         <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01948"></a>01948         <span class="comment">//            find probability                                      //</span>
<a name="l01949"></a>01949         <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01950"></a>01950 
<a name="l01951"></a>01951         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01952"></a>01952         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01953"></a>01953 
<a name="l01954"></a>01954 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01955"></a>01955 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01956"></a>01956 <span class="preprocessor">        shared    (numTasks,stateVecReal,stateVecImag) \</span>
<a name="l01957"></a>01957 <span class="preprocessor">        private   (thisTask)</span>
<a name="l01958"></a>01958 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01959"></a>01959 <span class="preprocessor"></span>        {
<a name="l01960"></a>01960 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01961"></a>01961 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule  (static)</span>
<a name="l01962"></a>01962 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01963"></a>01963 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01964"></a>01964                         <span class="comment">// summation -- simple implementation</span>
<a name="l01965"></a>01965                         stateVecReal[thisTask] = 0;
<a name="l01966"></a>01966                         stateVecImag[thisTask] = 0;
<a name="l01967"></a>01967                 }
<a name="l01968"></a>01968         }
<a name="l01969"></a>01969 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a01d9a8b7ff0e09ec399e158389783aa9"></a><!-- doxytag: member="qubits.c::collapseToOutcomeLocal" ref="a01d9a8b7ff0e09ec399e158389783aa9" args="(MultiQubit multiQubit, int measureQubit, REAL totalProbability, int outcome)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void collapseToOutcomeLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>totalProbability</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outcome</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Update the state vector to be consistent with measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1. </p>
<p>Performs an irreversible change to the state vector: it updates the vector according to the event that an outcome have been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 or 1 according to the value of outcome. In the local version, one or more blocks (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) fit entirely into one chunk.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>totalProbability</em>&nbsp;</td><td>probability of qubit measureQubit being either zero or one </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>outcome</em>&nbsp;</td><td>to measure the probability of and set the state to -- either zero or one </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01816">1816</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00198">collapseToOutcome()</a>, and <a class="el" href="qubits__env__local_8c_source.html#l00215">measureWithStats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01817"></a>01817 {
<a name="l01818"></a>01818         <span class="comment">// ----- sizes</span>
<a name="l01819"></a>01819         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock,                                           <span class="comment">// size of blocks</span>
<a name="l01820"></a>01820         sizeHalfBlock;                                       <span class="comment">// size of blocks halved</span>
<a name="l01821"></a>01821         <span class="comment">// ----- indices</span>
<a name="l01822"></a>01822         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock,                                           <span class="comment">// current block</span>
<a name="l01823"></a>01823              index;                                               <span class="comment">// current index for first half block</span>
<a name="l01824"></a>01824         <span class="comment">// ----- measured probability</span>
<a name="l01825"></a>01825         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   renorm;                                    <span class="comment">// probability (returned) value</span>
<a name="l01826"></a>01826         <span class="comment">// ----- temp variables</span>
<a name="l01827"></a>01827         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span>
<a name="l01828"></a>01828         <span class="comment">// (good for shared memory parallelism)</span>
<a name="l01829"></a>01829         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01830"></a>01830 
<a name="l01831"></a>01831         <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01832"></a>01832         <span class="comment">//            dimensions                                            //</span>
<a name="l01833"></a>01833         <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01834"></a>01834         sizeHalfBlock = 1LL &lt;&lt; (measureQubit);                       <span class="comment">// number of state vector elements to sum,</span>
<a name="l01835"></a>01835         <span class="comment">// and then the number to skip</span>
<a name="l01836"></a>01836         sizeBlock     = 2LL * sizeHalfBlock;                           <span class="comment">// size of blocks (pairs of measure and skip entries)</span>
<a name="l01837"></a>01837         
<a name="l01838"></a>01838         renorm=1/sqrt(totalProbability);
<a name="l01839"></a>01839         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01840"></a>01840         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01841"></a>01841 
<a name="l01842"></a>01842 
<a name="l01843"></a>01843 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01844"></a>01844 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01845"></a>01845 <span class="preprocessor">        default (none) \</span>
<a name="l01846"></a>01846 <span class="preprocessor">        shared    (numTasks,sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag,renorm,outcome) \</span>
<a name="l01847"></a>01847 <span class="preprocessor">        private   (thisTask,thisBlock,index)</span>
<a name="l01848"></a>01848 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01849"></a>01849 <span class="preprocessor"></span>        {
<a name="l01850"></a>01850                 <span class="keywordflow">if</span> (outcome==0){
<a name="l01851"></a>01851                         <span class="comment">// measure qubit is 0</span>
<a name="l01852"></a>01852 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01853"></a>01853 <span class="preprocessor"></span><span class="preprocessor">                        # pragma omp for schedule  (static)</span>
<a name="l01854"></a>01854 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01855"></a>01855 <span class="preprocessor"></span>                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01856"></a>01856                                 thisBlock = thisTask / sizeHalfBlock;
<a name="l01857"></a>01857                                 index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01858"></a>01858                                 stateVecReal[index]=stateVecReal[index]*renorm;
<a name="l01859"></a>01859                                 stateVecImag[index]=stateVecImag[index]*renorm;
<a name="l01860"></a>01860 
<a name="l01861"></a>01861                                 stateVecReal[index+sizeHalfBlock]=0;
<a name="l01862"></a>01862                                 stateVecImag[index+sizeHalfBlock]=0;
<a name="l01863"></a>01863                         }
<a name="l01864"></a>01864                 } <span class="keywordflow">else</span> {
<a name="l01865"></a>01865                         <span class="comment">// measure qubit is 1</span>
<a name="l01866"></a>01866 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01867"></a>01867 <span class="preprocessor"></span><span class="preprocessor">                        # pragma omp for schedule  (static)</span>
<a name="l01868"></a>01868 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01869"></a>01869 <span class="preprocessor"></span>                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01870"></a>01870                                 thisBlock = thisTask / sizeHalfBlock;
<a name="l01871"></a>01871                                 index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01872"></a>01872                                 stateVecReal[index]=0;
<a name="l01873"></a>01873                                 stateVecImag[index]=0;
<a name="l01874"></a>01874 
<a name="l01875"></a>01875                                 stateVecReal[index+sizeHalfBlock]=stateVecReal[index+sizeHalfBlock]*renorm;
<a name="l01876"></a>01876                                 stateVecImag[index+sizeHalfBlock]=stateVecImag[index+sizeHalfBlock]*renorm;
<a name="l01877"></a>01877                         }
<a name="l01878"></a>01878                 }
<a name="l01879"></a>01879         }
<a name="l01880"></a>01880 
<a name="l01881"></a>01881 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a20ee1878a63ae6112e8845f4a8787592"></a><!-- doxytag: member="qubits.c::compactUnitaryDistributed" ref="a20ee1878a63ae6112e8845f4a8787592" args="(MultiQubit multiQubit, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compactUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta, and a subset of the state vector with upper and lower block values stored seperately. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot1</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot2</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00573">573</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="qubits_8h_source.html#l00024">Complex::real</a>, and <a class="el" href="precision_8h_source.html#l00025">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00288">compactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00578"></a>00578 {
<a name="l00579"></a>00579 
<a name="l00580"></a>00580         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00581"></a>00581         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l00582"></a>00582         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00583"></a>00583 
<a name="l00584"></a>00584         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00585"></a>00585         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00586"></a>00586         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00587"></a>00587         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00588"></a>00588         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00589"></a>00589 
<a name="l00590"></a>00590 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00591"></a>00591 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00592"></a>00592 <span class="preprocessor">        default  (none) \</span>
<a name="l00593"></a>00593 <span class="preprocessor">        shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l00594"></a>00594 <span class="preprocessor">                        rot1Real,rot1Imag, rot2Real,rot2Imag) \</span>
<a name="l00595"></a>00595 <span class="preprocessor">        private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span>
<a name="l00596"></a>00596 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00597"></a>00597 <span class="preprocessor"></span>        {
<a name="l00598"></a>00598 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00599"></a>00599 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00600"></a>00600 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00601"></a>00601 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00602"></a>00602                         <span class="comment">// store current state vector values in temp variables</span>
<a name="l00603"></a>00603                         stateRealUp = stateVecRealUp[thisTask];
<a name="l00604"></a>00604                         stateImagUp = stateVecImagUp[thisTask];
<a name="l00605"></a>00605 
<a name="l00606"></a>00606                         stateRealLo = stateVecRealLo[thisTask];
<a name="l00607"></a>00607                         stateImagLo = stateVecImagLo[thisTask];
<a name="l00608"></a>00608 
<a name="l00609"></a>00609                         <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span>
<a name="l00610"></a>00610                         stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp + rot2Real*stateRealLo + rot2Imag*stateImagLo;
<a name="l00611"></a>00611                         stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp + rot2Real*stateImagLo - rot2Imag*stateRealLo;
<a name="l00612"></a>00612                 }
<a name="l00613"></a>00613         }
<a name="l00614"></a>00614 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9cee2d8716667a3318420a3b672f5b92"></a><!-- doxytag: member="qubits.c::compactUnitaryLocal" ref="a9cee2d8716667a3318420a3b672f5b92" args="(MultiQubit multiQubit, const int targetQubit, Complex alpha, Complex beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compactUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00444">444</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00024">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00104">compactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00445"></a>00445 {
<a name="l00446"></a>00446         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l00447"></a>00447         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l00448"></a>00448              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l00449"></a>00449 
<a name="l00450"></a>00450         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00451"></a>00451         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l00452"></a>00452         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l00453"></a>00453 
<a name="l00454"></a>00454         <span class="comment">// set dimensions</span>
<a name="l00455"></a>00455         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l00456"></a>00456         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l00457"></a>00457 
<a name="l00458"></a>00458         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l00459"></a>00459         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00460"></a>00460         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00461"></a>00461         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> alphaImag=alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>, alphaReal=alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;
<a name="l00462"></a>00462         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> betaImag=beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>, betaReal=beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;
<a name="l00463"></a>00463 
<a name="l00464"></a>00464 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00465"></a>00465 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00466"></a>00466 <span class="preprocessor">        default  (none) \</span>
<a name="l00467"></a>00467 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, alphaReal,alphaImag, betaReal,betaImag) \</span>
<a name="l00468"></a>00468 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span>
<a name="l00469"></a>00469 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00470"></a>00470 <span class="preprocessor"></span>        {
<a name="l00471"></a>00471 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00472"></a>00472 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00473"></a>00473 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00474"></a>00474 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00475"></a>00475 
<a name="l00476"></a>00476                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l00477"></a>00477                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l00478"></a>00478                         indexLo     = indexUp + sizeHalfBlock;
<a name="l00479"></a>00479 
<a name="l00480"></a>00480                         <span class="comment">// store current state vector values in temp variables</span>
<a name="l00481"></a>00481                         stateRealUp = stateVecReal[indexUp];
<a name="l00482"></a>00482                         stateImagUp = stateVecImag[indexUp];
<a name="l00483"></a>00483 
<a name="l00484"></a>00484                         stateRealLo = stateVecReal[indexLo];
<a name="l00485"></a>00485                         stateImagLo = stateVecImag[indexLo];
<a name="l00486"></a>00486 
<a name="l00487"></a>00487                         <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span>
<a name="l00488"></a>00488                         stateVecReal[indexUp] = alphaReal*stateRealUp - alphaImag*stateImagUp 
<a name="l00489"></a>00489                                 - betaReal*stateRealLo - betaImag*stateImagLo;
<a name="l00490"></a>00490                         stateVecImag[indexUp] = alphaReal*stateImagUp + alphaImag*stateRealUp 
<a name="l00491"></a>00491                                 - betaReal*stateImagLo + betaImag*stateRealLo;
<a name="l00492"></a>00492 
<a name="l00493"></a>00493                         <span class="comment">// state[indexLo] = beta  * state[indexUp] + conj(alpha) * state[indexLo]</span>
<a name="l00494"></a>00494                         stateVecReal[indexLo] = betaReal*stateRealUp - betaImag*stateImagUp 
<a name="l00495"></a>00495                                 + alphaReal*stateRealLo + alphaImag*stateImagLo;
<a name="l00496"></a>00496                         stateVecImag[indexLo] = betaReal*stateImagUp + betaImag*stateRealUp 
<a name="l00497"></a>00497                                 + alphaReal*stateImagLo - alphaImag*stateRealLo;
<a name="l00498"></a>00498                 } 
<a name="l00499"></a>00499         }
<a name="l00500"></a>00500 
<a name="l00501"></a>00501 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a793584932ae384c82e7e42db7d35d18d"></a><!-- doxytag: member="qubits.c::compareStates" ref="a793584932ae384c82e7e42db7d35d18d" args="(MultiQubit mq1, MultiQubit mq2, REAL precision)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int compareStates </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>mq1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>mq2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>precision</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00330">330</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00330"></a>00330                                                                  {
<a name="l00331"></a>00331         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> diff;
<a name="l00332"></a>00332         <span class="keywordtype">int</span> chunkSize = mq1.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00333"></a>00333         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;chunkSize; i++){
<a name="l00334"></a>00334                 diff = mq1.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[i] - mq2.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[i];
<a name="l00335"></a>00335                 <span class="keywordflow">if</span> (diff&lt;0) diff *= -1;
<a name="l00336"></a>00336                 <span class="keywordflow">if</span> (diff&gt;precision) <span class="keywordflow">return</span> 0;
<a name="l00337"></a>00337                 diff = mq1.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[i] - mq2.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[i];
<a name="l00338"></a>00338                 <span class="keywordflow">if</span> (diff&lt;0) diff *= -1;
<a name="l00339"></a>00339                 <span class="keywordflow">if</span> (diff&gt;precision) <span class="keywordflow">return</span> 0;
<a name="l00340"></a>00340         }
<a name="l00341"></a>00341         <span class="keywordflow">return</span> 1;
<a name="l00342"></a>00342 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a717855e835e3161e08c18cdc15325d27"></a><!-- doxytag: member="qubits.c::controlledCompactUnitaryDistributed" ref="a717855e835e3161e08c18cdc15325d27" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledCompactUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately. </p>
<p>Only perform the rotation where the control qubit is one.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>qubit to determine whether or not to perform a rotation </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot1</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot2</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00883">883</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01724">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="qubits_8h_source.html#l00024">Complex::real</a>, and <a class="el" href="precision_8h_source.html#l00025">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00370">controlledCompactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00888"></a>00888 {
<a name="l00889"></a>00889 
<a name="l00890"></a>00890         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00891"></a>00891         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l00892"></a>00892         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00893"></a>00893         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00894"></a>00894         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l00895"></a>00895 
<a name="l00896"></a>00896         <span class="keywordtype">int</span> controlBit;
<a name="l00897"></a>00897 
<a name="l00898"></a>00898     <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00899"></a>00899         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00900"></a>00900         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00901"></a>00901         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00902"></a>00902         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00903"></a>00903 
<a name="l00904"></a>00904 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00905"></a>00905 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00906"></a>00906 <span class="preprocessor">        default  (none) \</span>
<a name="l00907"></a>00907 <span class="preprocessor">        shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l00908"></a>00908 <span class="preprocessor">                        rot1Real,rot1Imag, rot2Real,rot2Imag) \</span>
<a name="l00909"></a>00909 <span class="preprocessor">        private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit)</span>
<a name="l00910"></a>00910 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00911"></a>00911 <span class="preprocessor"></span>        {
<a name="l00912"></a>00912 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00913"></a>00913 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00914"></a>00914 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00915"></a>00915 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00916"></a>00916                         controlBit = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);
<a name="l00917"></a>00917                         <span class="keywordflow">if</span> (controlBit){
<a name="l00918"></a>00918                                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l00919"></a>00919                                 stateRealUp = stateVecRealUp[thisTask];
<a name="l00920"></a>00920                                 stateImagUp = stateVecImagUp[thisTask];
<a name="l00921"></a>00921 
<a name="l00922"></a>00922                                 stateRealLo = stateVecRealLo[thisTask];
<a name="l00923"></a>00923                                 stateImagLo = stateVecImagLo[thisTask];
<a name="l00924"></a>00924 
<a name="l00925"></a>00925                                 <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span>
<a name="l00926"></a>00926                                 stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp + rot2Real*stateRealLo + rot2Imag*stateImagLo;
<a name="l00927"></a>00927                                 stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp + rot2Real*stateImagLo - rot2Imag*stateRealLo;
<a name="l00928"></a>00928                         }
<a name="l00929"></a>00929                 }
<a name="l00930"></a>00930         }
<a name="l00931"></a>00931 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="afc77657651d52c47403b44b923a098a8"></a><!-- doxytag: member="qubits.c::controlledCompactUnitaryLocal" ref="afc77657651d52c47403b44b923a098a8" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, Complex alpha, Complex beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledCompactUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00674">674</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01724">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00024">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00122">controlledCompactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00676"></a>00676 {
<a name="l00677"></a>00677         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l00678"></a>00678         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l00679"></a>00679              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l00680"></a>00680 
<a name="l00681"></a>00681         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00682"></a>00682         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l00683"></a>00683         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l00684"></a>00684         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00685"></a>00685         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l00686"></a>00686 
<a name="l00687"></a>00687         <span class="keywordtype">int</span> controlBit;
<a name="l00688"></a>00688 
<a name="l00689"></a>00689     <span class="comment">// set dimensions</span>
<a name="l00690"></a>00690         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l00691"></a>00691         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l00692"></a>00692 
<a name="l00693"></a>00693         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l00694"></a>00694         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00695"></a>00695         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00696"></a>00696         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> alphaImag=alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>, alphaReal=alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;
<a name="l00697"></a>00697         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> betaImag=beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>, betaReal=beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;
<a name="l00698"></a>00698 
<a name="l00699"></a>00699 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00700"></a>00700 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00701"></a>00701 <span class="preprocessor">        default  (none) \</span>
<a name="l00702"></a>00702 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, alphaReal,alphaImag, betaReal,betaImag) \</span>
<a name="l00703"></a>00703 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit) </span>
<a name="l00704"></a>00704 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00705"></a>00705 <span class="preprocessor"></span>        {
<a name="l00706"></a>00706 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00707"></a>00707 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00708"></a>00708 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00709"></a>00709 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00710"></a>00710 
<a name="l00711"></a>00711                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l00712"></a>00712                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l00713"></a>00713                         indexLo     = indexUp + sizeHalfBlock;
<a name="l00714"></a>00714 
<a name="l00715"></a>00715                         controlBit = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, indexUp+chunkId*chunkSize);
<a name="l00716"></a>00716                         <span class="keywordflow">if</span> (controlBit){
<a name="l00717"></a>00717                                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l00718"></a>00718                                 stateRealUp = stateVecReal[indexUp];
<a name="l00719"></a>00719                                 stateImagUp = stateVecImag[indexUp];
<a name="l00720"></a>00720 
<a name="l00721"></a>00721                                 stateRealLo = stateVecReal[indexLo];
<a name="l00722"></a>00722                                 stateImagLo = stateVecImag[indexLo];
<a name="l00723"></a>00723 
<a name="l00724"></a>00724                                 <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span>
<a name="l00725"></a>00725                                 stateVecReal[indexUp] = alphaReal*stateRealUp - alphaImag*stateImagUp 
<a name="l00726"></a>00726                                         - betaReal*stateRealLo - betaImag*stateImagLo;
<a name="l00727"></a>00727                                 stateVecImag[indexUp] = alphaReal*stateImagUp + alphaImag*stateRealUp 
<a name="l00728"></a>00728                                         - betaReal*stateImagLo + betaImag*stateRealLo;
<a name="l00729"></a>00729 
<a name="l00730"></a>00730                                 <span class="comment">// state[indexLo] = beta  * state[indexUp] + conj(alpha) * state[indexLo]</span>
<a name="l00731"></a>00731                                 stateVecReal[indexLo] = betaReal*stateRealUp - betaImag*stateImagUp 
<a name="l00732"></a>00732                                         + alphaReal*stateRealLo + alphaImag*stateImagLo;
<a name="l00733"></a>00733                                 stateVecImag[indexLo] = betaReal*stateImagUp + betaImag*stateRealUp 
<a name="l00734"></a>00734                                         + alphaReal*stateImagLo - alphaImag*stateRealLo;
<a name="l00735"></a>00735                         }
<a name="l00736"></a>00736                 } 
<a name="l00737"></a>00737         }
<a name="l00738"></a>00738 
<a name="l00739"></a>00739 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a05875a70b539a3efb28d027823403f34"></a><!-- doxytag: member="qubits.c::controlledNotDistributed" ref="a05875a70b539a3efb28d027823403f34" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledNotDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{0,1},{1,0}. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk. Only perform the rotation for elements where controlQubit is one.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecIn</em>&nbsp;</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01212">1212</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01724">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, and <a class="el" href="precision_8h_source.html#l00025">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00532">controlledNot()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01215"></a>01215 {
<a name="l01216"></a>01216 
<a name="l01217"></a>01217         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01218"></a>01218         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01219"></a>01219         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01220"></a>01220         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01221"></a>01221 
<a name="l01222"></a>01222         <span class="keywordtype">int</span> controlBit;
<a name="l01223"></a>01223 
<a name="l01224"></a>01224         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealIn=stateVecIn.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagIn=stateVecIn.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01225"></a>01225         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01226"></a>01226 
<a name="l01227"></a>01227 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01228"></a>01228 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01229"></a>01229 <span class="preprocessor">        default  (none) \</span>
<a name="l01230"></a>01230 <span class="preprocessor">        shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut) \</span>
<a name="l01231"></a>01231 <span class="preprocessor">        private  (thisTask,controlBit)</span>
<a name="l01232"></a>01232 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01233"></a>01233 <span class="preprocessor"></span>        {
<a name="l01234"></a>01234 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01235"></a>01235 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01236"></a>01236 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01237"></a>01237 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01238"></a>01238                         controlBit = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);
<a name="l01239"></a>01239                         <span class="keywordflow">if</span> (controlBit){
<a name="l01240"></a>01240                                 stateVecRealOut[thisTask] = stateVecRealIn[thisTask];
<a name="l01241"></a>01241                                 stateVecImagOut[thisTask] = stateVecImagIn[thisTask];
<a name="l01242"></a>01242                         }
<a name="l01243"></a>01243                 }
<a name="l01244"></a>01244         }
<a name="l01245"></a>01245 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad357a43e80e3baf013975b1b70942f4c"></a><!-- doxytag: member="qubits.c::controlledNotLocal" ref="ad357a43e80e3baf013975b1b70942f4c" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledNotLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01147">1147</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01724">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00181">controlledNot()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01148"></a>01148 {
<a name="l01149"></a>01149         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01150"></a>01150         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01151"></a>01151              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01152"></a>01152 
<a name="l01153"></a>01153         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateImagUp;
<a name="l01154"></a>01154         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01155"></a>01155         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01156"></a>01156         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01157"></a>01157         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01158"></a>01158 
<a name="l01159"></a>01159         <span class="keywordtype">int</span> controlBit;
<a name="l01160"></a>01160 
<a name="l01161"></a>01161         <span class="comment">// set dimensions</span>
<a name="l01162"></a>01162         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01163"></a>01163         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01164"></a>01164 
<a name="l01165"></a>01165 
<a name="l01166"></a>01166         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l01167"></a>01167         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01168"></a>01168         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01169"></a>01169 
<a name="l01170"></a>01170 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01171"></a>01171 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01172"></a>01172 <span class="preprocessor">        default  (none) \</span>
<a name="l01173"></a>01173 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span>
<a name="l01174"></a>01174 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,controlBit) </span>
<a name="l01175"></a>01175 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01176"></a>01176 <span class="preprocessor"></span>        {
<a name="l01177"></a>01177 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01178"></a>01178 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01179"></a>01179 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01180"></a>01180 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01181"></a>01181                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l01182"></a>01182                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01183"></a>01183                         indexLo     = indexUp + sizeHalfBlock;
<a name="l01184"></a>01184 
<a name="l01185"></a>01185                         controlBit = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a>(controlQubit, indexUp+chunkId*chunkSize);
<a name="l01186"></a>01186                         <span class="keywordflow">if</span> (controlBit){
<a name="l01187"></a>01187                                 stateRealUp = stateVecReal[indexUp];
<a name="l01188"></a>01188                                 stateImagUp = stateVecImag[indexUp];
<a name="l01189"></a>01189 
<a name="l01190"></a>01190                                 stateVecReal[indexUp] = stateVecReal[indexLo];
<a name="l01191"></a>01191                                 stateVecImag[indexUp] = stateVecImag[indexLo];
<a name="l01192"></a>01192 
<a name="l01193"></a>01193                                 stateVecReal[indexLo] = stateRealUp;
<a name="l01194"></a>01194                                 stateVecImag[indexLo] = stateImagUp;
<a name="l01195"></a>01195                         }
<a name="l01196"></a>01196                 } 
<a name="l01197"></a>01197         }
<a name="l01198"></a>01198 
<a name="l01199"></a>01199 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a11a96159191cbf1b01a1080e7f045aac"></a><!-- doxytag: member="qubits.c::controlledPhaseGate" ref="a11a96159191cbf1b01a1080e7f045aac" args="(MultiQubit multiQubit, const int idQubit1, const int idQubit2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledPhaseGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>idQubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>idQubit2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply the (two-qubit) controlled phase gate, also known as the controlled sigmaZ gate. </p>
<p>For each state, if both input qubits have value one, multiply the amplitude of that state by -1. This applies the two-qubit unitary: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 1 \\ &amp; 1 \\\ &amp; &amp; 1 \\ &amp; &amp; &amp; -1 \end{pmatrix} \]" src="form_8.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {idQubit1}; \node[draw=none] at (-3.5, 0) {idQubit2}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 0); \draw (-2,0) -- (2, 0); \draw[fill=black] (0, 0) circle (.2); \end{tikzpicture} } \]" src="form_9.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>idQubit1,idQubit2</em>&nbsp;</td><td>qubits to operate upon </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>idQubit1</code> or <code>idQubit2</code> are outside [0, <code>multiQubit.numQubits</code>), or are equal </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01729">1729</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01724">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="qubits__env__local_8c_source.html#l00246">QuESTAssert()</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01730"></a>01730 {
<a name="l01731"></a>01731         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l01732"></a>01732         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l01733"></a>01733         <span class="keywordtype">int</span> bit1, bit2;
<a name="l01734"></a>01734 
<a name="l01735"></a>01735         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01736"></a>01736         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01737"></a>01737 
<a name="l01738"></a>01738     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(idQubit1 &gt;= 0 &amp;&amp; idQubit1 &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 2, __func__);
<a name="l01739"></a>01739     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(idQubit2 &gt;= 0 &amp;&amp; idQubit2 &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l01740"></a>01740     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(idQubit1 != idQubit2, 3, __func__);
<a name="l01741"></a>01741 
<a name="l01742"></a>01742         <span class="comment">// dimension of the state vector</span>
<a name="l01743"></a>01743         stateVecSize = multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01744"></a>01744         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01745"></a>01745         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01746"></a>01746 
<a name="l01747"></a>01747 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01748"></a>01748 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel for \</span>
<a name="l01749"></a>01749 <span class="preprocessor">        default  (none)                      \</span>
<a name="l01750"></a>01750 <span class="preprocessor">        shared   (stateVecSize, stateVecReal,stateVecImag ) \</span>
<a name="l01751"></a>01751 <span class="preprocessor">        private  (index,bit1,bit2)                     \</span>
<a name="l01752"></a>01752 <span class="preprocessor">        schedule (static)</span>
<a name="l01753"></a>01753 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01754"></a>01754 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l01755"></a>01755                 bit1 = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (idQubit1, index+chunkId*chunkSize);
<a name="l01756"></a>01756                 bit2 = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (idQubit2, index+chunkId*chunkSize);
<a name="l01757"></a>01757                 <span class="keywordflow">if</span> (bit1 &amp;&amp; bit2) {
<a name="l01758"></a>01758                         stateVecReal [index] = - stateVecReal [index];
<a name="l01759"></a>01759                         stateVecImag [index] = - stateVecImag [index];
<a name="l01760"></a>01760                 }
<a name="l01761"></a>01761         }
<a name="l01762"></a>01762 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad41f82b41149393a642391b67b3a287e"></a><!-- doxytag: member="qubits.c::controlledRotateAroundAxis" ref="ad41f82b41149393a642391b67b3a287e" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, REAL angle, Vector axis)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledRotateAroundAxis </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structVector.html">Vector</a>&nbsp;</td>
          <td class="paramname"> <em>axis</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Applies a controlled rotation by a given angle around a given vector on the Bloch-sphere. </p>
<p>The vector must not be zero (else an error is thrown), but needn't be unit magnitude.</p>
<p>For angle <img class="formulaInl" alt="$\theta$" src="form_23.png"/> and axis vector <img class="formulaInl" alt="$\vec{n}$" src="form_52.png"/>, applies <img class="formulaInl" alt="$R_{\hat{n}} = \exp \left(- i \frac{\theta}{2} \hat{n} \cdot \vec{\sigma} \right) $" src="form_55.png"/> to states where the target qubit is 1 (<img class="formulaInl" alt="$\vec{\sigma}$" src="form_54.png"/> is the vector of Pauli matrices).</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 1); \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$R_{\hat{n}}(\theta)$}; \end{tikzpicture} } \]" src="form_59.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>qubit with value 1 in the rotated states </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>angle</em>&nbsp;</td><td>angle by which to rotate in radians </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>axis</em>&nbsp;</td><td>vector around which to rotate (can be non-unit; will be normalised) </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if either <code>controlQubit</code> or <code>targetQubit</code> are outside [0, <code>multiQubit.numQubits</code>) or are equal or if <code>axis</code> is the zero vector </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00413">413</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00122">controlledCompactUnitary()</a>, <a class="el" href="qubits_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00024">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00040">Vector::x</a>, <a class="el" href="qubits_8h_source.html#l00040">Vector::y</a>, and <a class="el" href="qubits_8h_source.html#l00040">Vector::z</a>.</p>

<p>Referenced by <a class="el" href="qubits_8c_source.html#l00426">controlledRotateX()</a>, <a class="el" href="qubits_8c_source.html#l00432">controlledRotateY()</a>, and <a class="el" href="qubits_8c_source.html#l00438">controlledRotateZ()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00413"></a>00413                                                                                                                               {
<a name="l00414"></a>00414         
<a name="l00415"></a>00415         <span class="keywordtype">double</span> mag = sqrt(pow(axis.<a class="code" href="structVector.html#aac7abe171ba4bada50ed72acba6259fc">x</a>,2) + pow(axis.<a class="code" href="structVector.html#a375ca805d4c808a53d7c4e0c737ae3de">y</a>,2) + pow(axis.<a class="code" href="structVector.html#ad4e863651be7d6b7e2b28cd7445a0ccf">z</a>,2));
<a name="l00416"></a>00416         <a class="code" href="structVector.html" title="Represents a 3-vector of real numbers.">Vector</a> unitAxis = {axis.<a class="code" href="structVector.html#aac7abe171ba4bada50ed72acba6259fc">x</a>/mag, axis.<a class="code" href="structVector.html#a375ca805d4c808a53d7c4e0c737ae3de">y</a>/mag, axis.<a class="code" href="structVector.html#ad4e863651be7d6b7e2b28cd7445a0ccf">z</a>/mag};
<a name="l00417"></a>00417         
<a name="l00418"></a>00418         <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> alpha, beta;
<a name="l00419"></a>00419         alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> = cos(angle/2.0);
<a name="l00420"></a>00420         alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> = -sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#ad4e863651be7d6b7e2b28cd7445a0ccf">z</a>;        
<a name="l00421"></a>00421         beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> = sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#a375ca805d4c808a53d7c4e0c737ae3de">y</a>;
<a name="l00422"></a>00422         beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> = -sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#aac7abe171ba4bada50ed72acba6259fc">x</a>;
<a name="l00423"></a>00423         <a class="code" href="qubits_8h.html#ab4812953bc457405b3aa05a4c2f64f4a" title="Apply a controlled unitary (single control, single target) parameterised by two given...">controlledCompactUnitary</a>(multiQubit, controlQubit, targetQubit, alpha, beta);
<a name="l00424"></a>00424 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac6923ac57e67d9a21096e06f6a9012f6"></a><!-- doxytag: member="qubits.c::controlledRotateX" ref="ac6923ac57e67d9a21096e06f6a9012f6" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, REAL angle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledRotateX </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>angle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Applies a controlled rotation by a given angle around the X-axis of the Bloch-sphere. </p>
<p>The target qubit is rotated in states where the control qubit has value 1.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 1); \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$R_x(\theta)$}; \end{tikzpicture} } \]" src="form_56.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>qubit which has value 1 in the rotated states </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>tagretQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>angle</em>&nbsp;</td><td>angle by which to rotate the target qubit in radians </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if either <code>controlQubit</code> or <code>targetQubit</code> are outside [0, <code>multiQubit.numQubits</code>) or are equal. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00426">426</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8c_source.html#l00413">controlledRotateAroundAxis()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00426"></a>00426                                                                                                         {
<a name="l00427"></a>00427 
<a name="l00428"></a>00428         <a class="code" href="structVector.html" title="Represents a 3-vector of real numbers.">Vector</a> unitAxis = {1, 0, 0};
<a name="l00429"></a>00429         <a class="code" href="qubits_8c.html#ad41f82b41149393a642391b67b3a287e" title="Applies a controlled rotation by a given angle around a given vector on the Bloch-sphere...">controlledRotateAroundAxis</a>(multiQubit, controlQubit, targetQubit, angle, unitAxis);
<a name="l00430"></a>00430 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a71e90a2f7292116338c062934f9d1202"></a><!-- doxytag: member="qubits.c::controlledRotateY" ref="a71e90a2f7292116338c062934f9d1202" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, REAL angle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledRotateY </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>angle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Applies a controlled rotation by a given angle around the Y-axis of the Bloch-sphere. </p>
<p>The target qubit is rotated in states where the control qubit has value 1.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 1); \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$R_y(\theta)$}; \end{tikzpicture} } \]" src="form_57.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>qubit which has value 1 in the rotated states </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>tagretQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>angle</em>&nbsp;</td><td>angle by which to rotate the target qubit in radians </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if either <code>controlQubit</code> or <code>targetQubit</code> are outside [0, <code>multiQubit.numQubits</code>) or are equal. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00432">432</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8c_source.html#l00413">controlledRotateAroundAxis()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00432"></a>00432                                                                                                         {
<a name="l00433"></a>00433 
<a name="l00434"></a>00434         <a class="code" href="structVector.html" title="Represents a 3-vector of real numbers.">Vector</a> unitAxis = {0, 1, 0};
<a name="l00435"></a>00435         <a class="code" href="qubits_8c.html#ad41f82b41149393a642391b67b3a287e" title="Applies a controlled rotation by a given angle around a given vector on the Bloch-sphere...">controlledRotateAroundAxis</a>(multiQubit, controlQubit, targetQubit, angle, unitAxis);
<a name="l00436"></a>00436 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a668e5d2634b02e98bc73675ccb11d61c"></a><!-- doxytag: member="qubits.c::controlledRotateZ" ref="a668e5d2634b02e98bc73675ccb11d61c" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, REAL angle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledRotateZ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>angle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Applies a controlled rotation by a given angle around the Z-axis of the Bloch-sphere. </p>
<p>The target qubit is rotated in states where the control qubit has value 1.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 1); \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$R_z(\theta)$}; \end{tikzpicture} } \]" src="form_58.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>qubit which has value 1 in the rotated states </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>tagretQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>angle</em>&nbsp;</td><td>angle by which to rotate the target qubit in radians </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if either <code>controlQubit</code> or <code>targetQubit</code> are outside [0, <code>multiQubit.numQubits</code>) or are equal. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00438">438</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8c_source.html#l00413">controlledRotateAroundAxis()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00438"></a>00438                                                                                                         {
<a name="l00439"></a>00439 
<a name="l00440"></a>00440         <a class="code" href="structVector.html" title="Represents a 3-vector of real numbers.">Vector</a> unitAxis = {0, 0, 1};
<a name="l00441"></a>00441         <a class="code" href="qubits_8c.html#ad41f82b41149393a642391b67b3a287e" title="Applies a controlled rotation by a given angle around a given vector on the Bloch-sphere...">controlledRotateAroundAxis</a>(multiQubit, controlQubit, targetQubit, angle, unitAxis);
<a name="l00442"></a>00442 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a642093063a1f889f61a1311f6d6f2d3f"></a><!-- doxytag: member="qubits.c::controlledUnitaryDistributed" ref="a642093063a1f889f61a1311f6d6f2d3f" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately. </p>
<p>Only perform the rotation where the control qubit is one.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>qubit to determine whether or not to perform a rotation </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot1</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot2</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00946">946</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01724">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="qubits_8h_source.html#l00024">Complex::real</a>, and <a class="el" href="precision_8h_source.html#l00025">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00413">controlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00951"></a>00951 {
<a name="l00952"></a>00952 
<a name="l00953"></a>00953         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00954"></a>00954         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l00955"></a>00955         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00956"></a>00956         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00957"></a>00957         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l00958"></a>00958 
<a name="l00959"></a>00959         <span class="keywordtype">int</span> controlBit;
<a name="l00960"></a>00960 
<a name="l00961"></a>00961         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00962"></a>00962         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00963"></a>00963         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00964"></a>00964         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00965"></a>00965         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00966"></a>00966 
<a name="l00967"></a>00967 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00968"></a>00968 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00969"></a>00969 <span class="preprocessor">        default  (none) \</span>
<a name="l00970"></a>00970 <span class="preprocessor">        shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l00971"></a>00971 <span class="preprocessor">                        rot1Real,rot1Imag, rot2Real,rot2Imag) \</span>
<a name="l00972"></a>00972 <span class="preprocessor">        private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit)</span>
<a name="l00973"></a>00973 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00974"></a>00974 <span class="preprocessor"></span>        {
<a name="l00975"></a>00975 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00976"></a>00976 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00977"></a>00977 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00978"></a>00978 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00979"></a>00979                         controlBit = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);
<a name="l00980"></a>00980                         <span class="keywordflow">if</span> (controlBit){
<a name="l00981"></a>00981                                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l00982"></a>00982                                 stateRealUp = stateVecRealUp[thisTask];
<a name="l00983"></a>00983                                 stateImagUp = stateVecImagUp[thisTask];
<a name="l00984"></a>00984 
<a name="l00985"></a>00985                                 stateRealLo = stateVecRealLo[thisTask];
<a name="l00986"></a>00986                                 stateImagLo = stateVecImagLo[thisTask];
<a name="l00987"></a>00987 
<a name="l00988"></a>00988                 stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp 
<a name="l00989"></a>00989                     + rot2Real*stateRealLo - rot2Imag*stateImagLo;
<a name="l00990"></a>00990                 stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp 
<a name="l00991"></a>00991                     + rot2Real*stateImagLo + rot2Imag*stateRealLo;
<a name="l00992"></a>00992                         }
<a name="l00993"></a>00993                 }
<a name="l00994"></a>00994         }
<a name="l00995"></a>00995 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8a4afcff70195a306c082b8ed8d4e09a"></a><!-- doxytag: member="qubits.c::controlledUnitaryLocal" ref="a8a4afcff70195a306c082b8ed8d4e09a" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00804">804</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01724">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00032">ComplexMatrix2::r0c0</a>, <a class="el" href="qubits_8h_source.html#l00032">ComplexMatrix2::r0c1</a>, <a class="el" href="qubits_8h_source.html#l00033">ComplexMatrix2::r1c0</a>, <a class="el" href="qubits_8h_source.html#l00033">ComplexMatrix2::r1c1</a>, <a class="el" href="qubits_8h_source.html#l00024">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00133">controlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00806"></a>00806 {
<a name="l00807"></a>00807         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l00808"></a>00808         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l00809"></a>00809              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l00810"></a>00810 
<a name="l00811"></a>00811         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00812"></a>00812         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l00813"></a>00813         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l00814"></a>00814         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00815"></a>00815         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l00816"></a>00816 
<a name="l00817"></a>00817         <span class="keywordtype">int</span> controlBit;
<a name="l00818"></a>00818 
<a name="l00819"></a>00819     <span class="comment">// set dimensions</span>
<a name="l00820"></a>00820         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l00821"></a>00821         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l00822"></a>00822 
<a name="l00823"></a>00823         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l00824"></a>00824         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00825"></a>00825         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00826"></a>00826 
<a name="l00827"></a>00827 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00828"></a>00828 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00829"></a>00829 <span class="preprocessor">        default  (none) \</span>
<a name="l00830"></a>00830 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, u) \</span>
<a name="l00831"></a>00831 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit) </span>
<a name="l00832"></a>00832 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00833"></a>00833 <span class="preprocessor"></span>        {
<a name="l00834"></a>00834 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00835"></a>00835 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00836"></a>00836 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00837"></a>00837 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00838"></a>00838 
<a name="l00839"></a>00839                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l00840"></a>00840                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l00841"></a>00841                         indexLo     = indexUp + sizeHalfBlock;
<a name="l00842"></a>00842 
<a name="l00843"></a>00843                         controlBit = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, indexUp+chunkId*chunkSize);
<a name="l00844"></a>00844                         <span class="keywordflow">if</span> (controlBit){
<a name="l00845"></a>00845                                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l00846"></a>00846                                 stateRealUp = stateVecReal[indexUp];
<a name="l00847"></a>00847                                 stateImagUp = stateVecImag[indexUp];
<a name="l00848"></a>00848 
<a name="l00849"></a>00849                                 stateRealLo = stateVecReal[indexLo];
<a name="l00850"></a>00850                                 stateImagLo = stateVecImag[indexLo];
<a name="l00851"></a>00851 
<a name="l00852"></a>00852 
<a name="l00853"></a>00853                                 <span class="comment">// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]</span>
<a name="l00854"></a>00854                                 stateVecReal[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp 
<a name="l00855"></a>00855                                         + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo - u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;
<a name="l00856"></a>00856                                 stateVecImag[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp 
<a name="l00857"></a>00857                                         + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;
<a name="l00858"></a>00858 
<a name="l00859"></a>00859                                 <span class="comment">// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]</span>
<a name="l00860"></a>00860                                 stateVecReal[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp  - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp 
<a name="l00861"></a>00861                                         + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo  -  u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;
<a name="l00862"></a>00862                                 stateVecImag[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp 
<a name="l00863"></a>00863                                         + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;
<a name="l00864"></a>00864                         }
<a name="l00865"></a>00865                 } 
<a name="l00866"></a>00866         }
<a name="l00867"></a>00867 
<a name="l00868"></a>00868 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9c02591bc64c2918503afa231d90d83f"></a><!-- doxytag: member="qubits.c::createMultiQubit" ref="a9c02591bc64c2918503afa231d90d83f" args="(MultiQubit *multiQubit, int numQubits, QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void createMultiQubit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a> *&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create a <a class="el" href="structMultiQubit.html" title="Represents a system of qubits.">MultiQubit</a> object representing a set of qubits. </p>
<p>Allocate space for state vector of probability amplitudes, including space for temporary values to be copied from one other chunk if running the distributed version. Define properties related to the size of the set of qubits. initStateZero should be called after this to initialise the qubits to the zero state.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>a pointer to an object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>numQubits</em>&nbsp;</td><td>number of qubits in the system </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment (local, multinode etc) </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>numQubits</code> &lt;= 0 </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00039">39</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00060">MultiQubit::numChunks</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00069">QuESTEnv::numRanks</a>, <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::pairStateVec</a>, <a class="el" href="qubits__env__local_8c_source.html#l00246">QuESTAssert()</a>, <a class="el" href="qubits_8h_source.html#l00068">QuESTEnv::rank</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00040"></a>00040 {
<a name="l00041"></a>00041     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(numQubits&gt;0, 9, __func__);
<a name="l00042"></a>00042         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = 1L &lt;&lt; numQubits;
<a name="l00043"></a>00043         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmpsPerRank = numAmps/env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>;
<a name="l00044"></a>00044 
<a name="l00045"></a>00045         multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a> = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>)));
<a name="l00046"></a>00046         multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a> = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>)));
<a name="l00047"></a>00047         <span class="keywordflow">if</span> (env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1){
<a name="l00048"></a>00048                 multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a> = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>)));
<a name="l00049"></a>00049                 multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a> = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>)));
<a name="l00050"></a>00050         }
<a name="l00051"></a>00051 
<a name="l00052"></a>00052         <span class="keywordflow">if</span> ( (!(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>) || !(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>))
<a name="l00053"></a>00053                  &amp;&amp; numAmpsPerRank ) {
<a name="l00054"></a>00054                 printf(<span class="stringliteral">&quot;Could not allocate memory!&quot;</span>);
<a name="l00055"></a>00055                 exit (EXIT_FAILURE);
<a name="l00056"></a>00056         }
<a name="l00057"></a>00057 
<a name="l00058"></a>00058         <span class="keywordflow">if</span> ( env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1 &amp;&amp; (!(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>) || !(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>))
<a name="l00059"></a>00059                  &amp;&amp; numAmpsPerRank ) {
<a name="l00060"></a>00060                 printf(<span class="stringliteral">&quot;Could not allocate memory!&quot;</span>);
<a name="l00061"></a>00061                 exit (EXIT_FAILURE);
<a name="l00062"></a>00062         }
<a name="l00063"></a>00063 
<a name="l00064"></a>00064         multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a> = numQubits;
<a name="l00065"></a>00065         multiQubit-&gt;<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a> = numAmpsPerRank;
<a name="l00066"></a>00066         multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a> = env.<a class="code" href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">rank</a>;
<a name="l00067"></a>00067         multiQubit-&gt;<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a> = env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>;
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae5d6acc322314d7a3d8a2eccf00d3b19"></a><!-- doxytag: member="qubits.c::destroyMultiQubit" ref="ae5d6acc322314d7a3d8a2eccf00d3b19" args="(MultiQubit multiQubit, QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void destroyMultiQubit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deallocate a <a class="el" href="structMultiQubit.html" title="Represents a system of qubits.">MultiQubit</a> object representing a set of qubits. </p>
<p>Free memory allocated to state vector of probability amplitudes, including temporary vector for values copied from another chunk if running the distributed version.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object to be deallocated </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment (local, multinode etc) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00071">71</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00069">QuESTEnv::numRanks</a>, <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::pairStateVec</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00071"></a>00071                                                            {
<a name="l00072"></a>00072         free(multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>);
<a name="l00073"></a>00073         free(multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>);
<a name="l00074"></a>00074         <span class="keywordflow">if</span> (env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1){
<a name="l00075"></a>00075                 free(multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>);
<a name="l00076"></a>00076                 free(multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>);
<a name="l00077"></a>00077         }
<a name="l00078"></a>00078 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a100463f6ec212c76a5fad99579000505"></a><!-- doxytag: member="qubits.c::extractBit" ref="a100463f6ec212c76a5fad99579000505" args="(const int locationOfBitFromRight, const long long int theEncodedNumber)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int extractBit </td>
          <td>(</td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>locationOfBitFromRight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long long int&nbsp;</td>
          <td class="paramname"> <em>theEncodedNumber</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the value of the bit at a particular index in a number. </p>
<p>SCB edit: new definition of extractBit is much faster *** </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>locationOfBitFromRight</em>&nbsp;</td><td>location of bit in theEncodedNumber </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>theEncodedNumber</em>&nbsp;</td><td>number to search </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the value of the bit in theEncodedNumber </dd></dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01724">1724</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>Referenced by <a class="el" href="qubits_8c_source.html#l00883">controlledCompactUnitaryDistributed()</a>, <a class="el" href="qubits_8c_source.html#l00674">controlledCompactUnitaryLocal()</a>, <a class="el" href="qubits_8c_source.html#l01212">controlledNotDistributed()</a>, <a class="el" href="qubits_8c_source.html#l01147">controlledNotLocal()</a>, <a class="el" href="qubits_8c_source.html#l01729">controlledPhaseGate()</a>, <a class="el" href="qubits_8c_source.html#l00946">controlledUnitaryDistributed()</a>, <a class="el" href="qubits_8c_source.html#l00804">controlledUnitaryLocal()</a>, and <a class="el" href="qubits_8c_source.html#l00216">initStateOfSingleQubit()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01725"></a>01725 {
<a name="l01726"></a>01726         <span class="keywordflow">return</span> (theEncodedNumber &amp; ( 1LL &lt;&lt; locationOfBitFromRight )) &gt;&gt; locationOfBitFromRight;
<a name="l01727"></a>01727 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9ac9bb717a889f09d307eda9f0b65957"></a><!-- doxytag: member="qubits.c::findProbabilityOfZeroDistributed" ref="a9ac9bb717a889f09d307eda9f0b65957" args="(MultiQubit multiQubit, const int measureQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL findProbabilityOfZeroDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Measure the probability of a specified qubit being in the zero state across all amplitudes held in this chunk. </p>
<p>Size of regions to skip is a multiple of chunkSize.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>probability of qubit measureQubit being zero </dd></dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01669">1669</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00675">findProbabilityOfOutcome()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01671"></a>01671 {
<a name="l01672"></a>01672         <span class="comment">// ----- measured probability</span>
<a name="l01673"></a>01673         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   totalProbability;                                    <span class="comment">// probability (returned) value</span>
<a name="l01674"></a>01674         <span class="comment">// ----- temp variables</span>
<a name="l01675"></a>01675         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span>
<a name="l01676"></a>01676         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01677"></a>01677 
<a name="l01678"></a>01678         <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01679"></a>01679         <span class="comment">//            find probability                                      //</span>
<a name="l01680"></a>01680         <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01681"></a>01681 
<a name="l01682"></a>01682         <span class="comment">// initialise returned value</span>
<a name="l01683"></a>01683         totalProbability = 0.0;
<a name="l01684"></a>01684 
<a name="l01685"></a>01685         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01686"></a>01686         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01687"></a>01687 
<a name="l01688"></a>01688 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01689"></a>01689 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01690"></a>01690 <span class="preprocessor">        shared    (numTasks,stateVecReal,stateVecImag) \</span>
<a name="l01691"></a>01691 <span class="preprocessor">        private   (thisTask) \</span>
<a name="l01692"></a>01692 <span class="preprocessor">        reduction ( +:totalProbability )</span>
<a name="l01693"></a>01693 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01694"></a>01694 <span class="preprocessor"></span>        {
<a name="l01695"></a>01695 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01696"></a>01696 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule  (static)</span>
<a name="l01697"></a>01697 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01698"></a>01698 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01699"></a>01699                         <span class="comment">// summation -- simple implementation</span>
<a name="l01700"></a>01700                         totalProbability += stateVecReal[thisTask]*stateVecReal[thisTask]
<a name="l01701"></a>01701                                 + stateVecImag[thisTask]*stateVecImag[thisTask];
<a name="l01702"></a>01702 
<a name="l01703"></a>01703                         <span class="comment">/*</span>
<a name="l01704"></a>01704 <span class="comment">                        // summation -- kahan correction</span>
<a name="l01705"></a>01705 <span class="comment">                        y = stateVecReal[thisTask]*stateVecReal[thisTask]</span>
<a name="l01706"></a>01706 <span class="comment">                        + stateVecImag[thisTask]*stateVecImag[thisTask] - c;</span>
<a name="l01707"></a>01707 <span class="comment">                        t = totalProbability + y;</span>
<a name="l01708"></a>01708 <span class="comment">                        c = (t - totalProbability) - y;</span>
<a name="l01709"></a>01709 <span class="comment">                        totalProbability = t;</span>
<a name="l01710"></a>01710 <span class="comment">                        */</span>
<a name="l01711"></a>01711 
<a name="l01712"></a>01712                 }
<a name="l01713"></a>01713         }
<a name="l01714"></a>01714 
<a name="l01715"></a>01715         <span class="keywordflow">return</span> totalProbability;
<a name="l01716"></a>01716 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7c02cd0e1b4eac19771a0525f023249e"></a><!-- doxytag: member="qubits.c::findProbabilityOfZeroLocal" ref="a7c02cd0e1b4eac19771a0525f023249e" args="(MultiQubit multiQubit, const int measureQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL findProbabilityOfZeroLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Measure the total probability of a specified qubit being in the zero state across all amplitudes in this chunk. </p>
<p>Size of regions to skip is less than the size of one chunk.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>probability of qubit measureQubit being zero </dd></dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01597">1597</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8c_source.html#l00018">DEBUG</a>, <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00189">findProbabilityOfOutcome()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01599"></a>01599 {
<a name="l01600"></a>01600         <span class="comment">// ----- sizes</span>
<a name="l01601"></a>01601         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock,                                           <span class="comment">// size of blocks</span>
<a name="l01602"></a>01602         sizeHalfBlock;                                       <span class="comment">// size of blocks halved</span>
<a name="l01603"></a>01603         <span class="comment">// ----- indices</span>
<a name="l01604"></a>01604         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock,                                           <span class="comment">// current block</span>
<a name="l01605"></a>01605              index;                                               <span class="comment">// current index for first half block</span>
<a name="l01606"></a>01606         <span class="comment">// ----- measured probability</span>
<a name="l01607"></a>01607         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   totalProbability;                                    <span class="comment">// probability (returned) value</span>
<a name="l01608"></a>01608         <span class="comment">// ----- temp variables</span>
<a name="l01609"></a>01609         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span>
<a name="l01610"></a>01610         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01611"></a>01611 
<a name="l01612"></a>01612         <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01613"></a>01613         <span class="comment">//            dimensions                                            //</span>
<a name="l01614"></a>01614         <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01615"></a>01615         sizeHalfBlock = 1LL &lt;&lt; (measureQubit);                       <span class="comment">// number of state vector elements to sum,</span>
<a name="l01616"></a>01616         <span class="comment">// and then the number to skip</span>
<a name="l01617"></a>01617         sizeBlock     = 2LL * sizeHalfBlock;                           <span class="comment">// size of blocks (pairs of measure and skip entries)</span>
<a name="l01618"></a>01618 
<a name="l01619"></a>01619         <span class="comment">// initialise returned value</span>
<a name="l01620"></a>01620         totalProbability = 0.0;
<a name="l01621"></a>01621 
<a name="l01622"></a>01622         <span class="comment">// initialise correction for kahan summation</span>
<a name="l01623"></a>01623         <span class="keywordflow">if</span> (<a class="code" href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>) printf(<span class="stringliteral">&quot;sizeHalfBlock=%Ld sizeBlock=%Ld numTasks=%Ld\n&quot;</span>,sizeHalfBlock,sizeBlock,numTasks);
<a name="l01624"></a>01624 
<a name="l01625"></a>01625         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01626"></a>01626         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01627"></a>01627 
<a name="l01628"></a>01628 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01629"></a>01629 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01630"></a>01630 <span class="preprocessor">        shared    (numTasks,sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span>
<a name="l01631"></a>01631 <span class="preprocessor">        private   (thisTask,thisBlock,index) \</span>
<a name="l01632"></a>01632 <span class="preprocessor">        reduction ( +:totalProbability )</span>
<a name="l01633"></a>01633 <span class="preprocessor"></span><span class="preprocessor"># endif </span>
<a name="l01634"></a>01634 <span class="preprocessor"></span>        {
<a name="l01635"></a>01635 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01636"></a>01636 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule  (static)</span>
<a name="l01637"></a>01637 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01638"></a>01638 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01639"></a>01639                         thisBlock = thisTask / sizeHalfBlock;
<a name="l01640"></a>01640                         index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01641"></a>01641 
<a name="l01642"></a>01642                         <span class="keywordflow">if</span> (index&lt;0){ printf(<span class="stringliteral">&quot;ABORTING as index=%Ld with thisBlock = %Ld  thisTask=%Ld \n&quot;</span>, index,thisBlock,thisTask); exit(1);}
<a name="l01643"></a>01643 
<a name="l01644"></a>01644                         <span class="comment">// summation -- simple implementation</span>
<a name="l01645"></a>01645                         totalProbability += stateVecReal[index]*stateVecReal[index]
<a name="l01646"></a>01646                                 + stateVecImag[index]*stateVecImag[index];
<a name="l01647"></a>01647 
<a name="l01648"></a>01648                         <span class="comment">/*</span>
<a name="l01649"></a>01649 <span class="comment">                        // summation -- kahan correction</span>
<a name="l01650"></a>01650 <span class="comment">                        y = stateVecReal[index]*stateVecReal[index]</span>
<a name="l01651"></a>01651 <span class="comment">                        + stateVecImag[index]*stateVecImag[index] - c;</span>
<a name="l01652"></a>01652 <span class="comment">                        t = totalProbability + y;</span>
<a name="l01653"></a>01653 <span class="comment">                        c = (t - totalProbability) - y;</span>
<a name="l01654"></a>01654 <span class="comment">                        totalProbability = t;</span>
<a name="l01655"></a>01655 <span class="comment">                        */</span>
<a name="l01656"></a>01656 
<a name="l01657"></a>01657                 }
<a name="l01658"></a>01658         }
<a name="l01659"></a>01659         <span class="keywordflow">return</span> totalProbability;
<a name="l01660"></a>01660 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8f10aabf9f607f19093aee54630caa21"></a><!-- doxytag: member="qubits.c::getEnvironmentString" ref="a8f10aabf9f607f19093aee54630caa21" args="(QuESTEnv env, MultiQubit multiQubit, char str[200])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getEnvironmentString </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>str</em>[200]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00131">131</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numQubits</a>, and <a class="el" href="qubits_8h_source.html#l00069">QuESTEnv::numRanks</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00131"></a>00131                                                                              {
<a name="l00132"></a>00132         <span class="keywordtype">int</span> numThreads=1;
<a name="l00133"></a>00133 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00134"></a>00134 <span class="preprocessor"></span>        numThreads=omp_get_max_threads(); 
<a name="l00135"></a>00135 <span class="preprocessor"># endif</span>
<a name="l00136"></a>00136 <span class="preprocessor"></span>        sprintf(str, <span class="stringliteral">&quot;%dqubits_CPU_%dranksx%dthreads&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>, numThreads);
<a name="l00137"></a>00137 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a799b10447d6dbdaf960a4d3eedd22014"></a><!-- doxytag: member="qubits.c::getProbEl" ref="a799b10447d6dbdaf960a4d3eedd22014" args="(MultiQubit multiQubit, long long int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL getProbEl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>index</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the probability of the state at an index in the full state vector. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing a set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>index</em>&nbsp;</td><td>index in state vector of probability amplitudes </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>realEl*realEl + imagEl*imagEl </dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>index</code> is outside [0, <img class="formulaInl" alt="$2^{N}$" src="form_16.png"/>) where <img class="formulaInl" alt="$N = $" src="form_17.png"/> <code>multiQubit.numQubits</code> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01971">1971</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00100">getImagAmpEl()</a>, <a class="el" href="qubits__env__local_8c_source.html#l00096">getRealAmpEl()</a>, and <a class="el" href="precision_8h_source.html#l00025">REAL</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01971"></a>01971                                                           {
<a name="l01972"></a>01972         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> real;
<a name="l01973"></a>01973         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> imag;
<a name="l01974"></a>01974         real = <a class="code" href="qubits_8h.html#a317b786f577fa6bc136ea7f0ee7330a7" title="Get the real component of the complex probability amplitude at an index in the state...">getRealAmpEl</a>(multiQubit, index);
<a name="l01975"></a>01975         imag = <a class="code" href="qubits_8h.html#a3615f76fd5f57008d9b74bbd10533dd0" title="Get the imaginary component of the complex probability amplitude at an index in the...">getImagAmpEl</a>(multiQubit, index);
<a name="l01976"></a>01976         <span class="keywordflow">return</span> real*real + imag*imag;
<a name="l01977"></a>01977 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae6a897066979fc52d977007d959ca09d"></a><!-- doxytag: member="qubits.c::hadamardDistributed" ref="ae6a897066979fc52d977007d959ca09d" args="(MultiQubit multiQubit, const int targetQubit, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut, int updateUpper)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hadamardDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>updateUpper</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{1,1},{1,-1}}/sqrt2. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecIn</em>&nbsp;</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>updateUpper</em>&nbsp;</td><td>flag, 1: updating upper values, 0: updating lower values in block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01400">1400</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, and <a class="el" href="precision_8h_source.html#l00025">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00618">hadamard()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01405"></a>01405 {
<a name="l01406"></a>01406 
<a name="l01407"></a>01407         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l01408"></a>01408         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01409"></a>01409         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01410"></a>01410 
<a name="l01411"></a>01411         <span class="keywordtype">int</span> sign;
<a name="l01412"></a>01412         <span class="keywordflow">if</span> (updateUpper) sign=1;
<a name="l01413"></a>01413         <span class="keywordflow">else</span> sign=-1;
<a name="l01414"></a>01414 
<a name="l01415"></a>01415         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> recRoot2 = 1.0/sqrt(2);
<a name="l01416"></a>01416 
<a name="l01417"></a>01417         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01418"></a>01418         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01419"></a>01419         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01420"></a>01420 
<a name="l01421"></a>01421 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01422"></a>01422 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01423"></a>01423 <span class="preprocessor">        default  (none) \</span>
<a name="l01424"></a>01424 <span class="preprocessor">        shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l01425"></a>01425 <span class="preprocessor">                        recRoot2, sign) \</span>
<a name="l01426"></a>01426 <span class="preprocessor">        private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span>
<a name="l01427"></a>01427 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01428"></a>01428 <span class="preprocessor"></span>        {
<a name="l01429"></a>01429 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01430"></a>01430 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01431"></a>01431 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01432"></a>01432 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01433"></a>01433                         <span class="comment">// store current state vector values in temp variables</span>
<a name="l01434"></a>01434                         stateRealUp = stateVecRealUp[thisTask];
<a name="l01435"></a>01435                         stateImagUp = stateVecImagUp[thisTask];
<a name="l01436"></a>01436 
<a name="l01437"></a>01437                         stateRealLo = stateVecRealLo[thisTask];
<a name="l01438"></a>01438                         stateImagLo = stateVecImagLo[thisTask];
<a name="l01439"></a>01439 
<a name="l01440"></a>01440                         stateVecRealOut[thisTask] = recRoot2*(stateRealUp + sign*stateRealLo);
<a name="l01441"></a>01441                         stateVecImagOut[thisTask] = recRoot2*(stateImagUp + sign*stateImagLo);
<a name="l01442"></a>01442                 }
<a name="l01443"></a>01443         }
<a name="l01444"></a>01444 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa9f0718b4dd794a3e1b143e3b153bfc5"></a><!-- doxytag: member="qubits.c::hadamardLocal" ref="aa9f0718b4dd794a3e1b143e3b153bfc5" args="(MultiQubit multiQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hadamardLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01339">1339</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00175">hadamard()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01340"></a>01340 {
<a name="l01341"></a>01341         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01342"></a>01342         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01343"></a>01343              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01344"></a>01344 
<a name="l01345"></a>01345         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l01346"></a>01346         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01347"></a>01347         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01348"></a>01348 
<a name="l01349"></a>01349         <span class="comment">// set dimensions</span>
<a name="l01350"></a>01350         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01351"></a>01351         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01352"></a>01352 
<a name="l01353"></a>01353         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l01354"></a>01354         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01355"></a>01355         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01356"></a>01356 
<a name="l01357"></a>01357         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> recRoot2 = 1.0/sqrt(2);
<a name="l01358"></a>01358 
<a name="l01359"></a>01359 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01360"></a>01360 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01361"></a>01361 <span class="preprocessor">        default  (none) \</span>
<a name="l01362"></a>01362 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, recRoot2) \</span>
<a name="l01363"></a>01363 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span>
<a name="l01364"></a>01364 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01365"></a>01365 <span class="preprocessor"></span>        {
<a name="l01366"></a>01366 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01367"></a>01367 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01368"></a>01368 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01369"></a>01369 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01370"></a>01370                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l01371"></a>01371                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01372"></a>01372                         indexLo     = indexUp + sizeHalfBlock;
<a name="l01373"></a>01373 
<a name="l01374"></a>01374                         stateRealUp = stateVecReal[indexUp];
<a name="l01375"></a>01375                         stateImagUp = stateVecImag[indexUp];
<a name="l01376"></a>01376 
<a name="l01377"></a>01377                         stateRealLo = stateVecReal[indexLo];
<a name="l01378"></a>01378                         stateImagLo = stateVecImag[indexLo];
<a name="l01379"></a>01379 
<a name="l01380"></a>01380                         stateVecReal[indexUp] = recRoot2*(stateRealUp + stateRealLo);
<a name="l01381"></a>01381                         stateVecImag[indexUp] = recRoot2*(stateImagUp + stateImagLo);
<a name="l01382"></a>01382 
<a name="l01383"></a>01383                         stateVecReal[indexLo] = recRoot2*(stateRealUp - stateRealLo);
<a name="l01384"></a>01384                         stateVecImag[indexLo] = recRoot2*(stateImagUp - stateImagLo);
<a name="l01385"></a>01385                 } 
<a name="l01386"></a>01386         }
<a name="l01387"></a>01387 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a433876ee9f3bcc54af346300f571fc3c"></a><!-- doxytag: member="qubits.c::initializeStateFromSingleFile" ref="a433876ee9f3bcc54af346300f571fc3c" args="(MultiQubit *multiQubit, char filename[200], QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initializeStateFromSingleFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a> *&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>filename</em>[200], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>fix -- format needs to work for single precision values </p>
</p>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00295">295</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00060">MultiQubit::numChunks</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>, and <a class="el" href="qubits__env__local_8c_source.html#l00035">syncQuESTEnv()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00295"></a>00295                                                                                             {
<a name="l00296"></a>00296         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;
<a name="l00297"></a>00297         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> indexInChunk, totalIndex;
<a name="l00298"></a>00298 
<a name="l00299"></a>00299         chunkSize = multiQubit-&gt;<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00300"></a>00300         stateVecSize = chunkSize*multiQubit-&gt;<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>;
<a name="l00301"></a>00301 
<a name="l00302"></a>00302         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00303"></a>00303         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00304"></a>00304         
<a name="l00305"></a>00305         FILE *fp;
<a name="l00306"></a>00306         <span class="keywordtype">char</span> line[200];
<a name="l00307"></a>00307 
<a name="l00308"></a>00308         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rank=0; rank&lt;(multiQubit-&gt;<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>); rank++){
<a name="l00309"></a>00309                 <span class="keywordflow">if</span> (rank==multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>){
<a name="l00310"></a>00310                         fp = fopen(filename, <span class="stringliteral">&quot;r&quot;</span>);
<a name="l00311"></a>00311                         indexInChunk = 0; totalIndex = 0;
<a name="l00312"></a>00312                         <span class="keywordflow">while</span> (fgets(line, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)*200, fp) != NULL &amp;&amp; totalIndex&lt;stateVecSize){
<a name="l00313"></a>00313                                 <span class="keywordflow">if</span> (line[0]!=<span class="charliteral">&apos;#&apos;</span>){
<a name="l00314"></a>00314                                         <span class="keywordtype">int</span> chunkId = totalIndex/chunkSize;
<a name="l00315"></a>00315                                         <span class="keywordflow">if</span> (chunkId==multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>){
<a name="l00317"></a>00317                                                 sscanf(line, <span class="stringliteral">&quot;%lf, %lf&quot;</span>, &amp;(stateVecReal[indexInChunk]), 
<a name="l00318"></a>00318                                                                 &amp;(stateVecImag[indexInChunk]));
<a name="l00319"></a>00319                                                 indexInChunk += 1;
<a name="l00320"></a>00320                                         }
<a name="l00321"></a>00321                                         totalIndex += 1;
<a name="l00322"></a>00322                                 }
<a name="l00323"></a>00323                         }       
<a name="l00324"></a>00324                         fclose(fp);
<a name="l00325"></a>00325                 }
<a name="l00326"></a>00326                 <a class="code" href="qubits_8h.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77" title="Guarantees that all code up to the given point has been executed on all nodes (if...">syncQuESTEnv</a>(env);
<a name="l00327"></a>00327         }
<a name="l00328"></a>00328 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a03b3577a891731d505bc4b879fcca9d3"></a><!-- doxytag: member="qubits.c::initStateDebug" ref="a03b3577a891731d505bc4b879fcca9d3" args="(MultiQubit *multiQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initStateDebug </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a> *&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialise the state vector of probability amplitudes to an (unphysical) state with each component of each probability amplitude a unique floating point value. </p>
<p>For debugging processes </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits to be initialised </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00263">263</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00264"></a>00264 {
<a name="l00265"></a>00265         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize;
<a name="l00266"></a>00266         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00267"></a>00267 
<a name="l00268"></a>00268         <span class="comment">// dimension of the state vector</span>
<a name="l00269"></a>00269         chunkSize = multiQubit-&gt;<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00270"></a>00270 
<a name="l00271"></a>00271         <span class="comment">// Can&apos;t use multiQubit-&gt;stateVec as a private OMP var</span>
<a name="l00272"></a>00272         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00273"></a>00273         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00274"></a>00274 
<a name="l00275"></a>00275         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> chunkOffset = (2.0*chunkSize*multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>)/10.0;
<a name="l00276"></a>00276 
<a name="l00277"></a>00277         <span class="comment">// initialise the state to |0000..0000&gt;</span>
<a name="l00278"></a>00278 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00279"></a>00279 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00280"></a>00280 <span class="preprocessor">        default  (none) \</span>
<a name="l00281"></a>00281 <span class="preprocessor">        shared   (chunkSize, stateVecReal, stateVecImag, chunkOffset) \</span>
<a name="l00282"></a>00282 <span class="preprocessor">        private  (index) </span>
<a name="l00283"></a>00283 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00284"></a>00284 <span class="preprocessor"></span>        {
<a name="l00285"></a>00285 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00286"></a>00286 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00287"></a>00287 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00288"></a>00288 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {
<a name="l00289"></a>00289                         stateVecReal[index] = chunkOffset + (index*2.0)/10.0;
<a name="l00290"></a>00290                         stateVecImag[index] = chunkOffset + (index*2.0+1.0)/10.0;
<a name="l00291"></a>00291                 }
<a name="l00292"></a>00292         }
<a name="l00293"></a>00293 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7169fd0442cbc3418f3fac4d13363ca2"></a><!-- doxytag: member="qubits.c::initStateOfSingleQubit" ref="a7169fd0442cbc3418f3fac4d13363ca2" args="(MultiQubit *multiQubit, int qubitId, int outcome)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initStateOfSingleQubit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a> *&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>qubitId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outcome</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialise the state vector of probability amplitudes such that one qubit is set to 'outcome' and all other qubits are in an equal superposition of zero and one. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits to be initialised </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>qubitId</em>&nbsp;</td><td>id of qubit to set to state 'outcome' </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>value</em>&nbsp;</td><td>of qubit 'qubitId' </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00216">216</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l00018">DEBUG</a>, <a class="el" href="qubits_8c_source.html#l01724">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00060">MultiQubit::numChunks</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00217"></a>00217 {
<a name="l00218"></a>00218         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;
<a name="l00219"></a>00219         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00220"></a>00220         <span class="keywordtype">int</span> bit;
<a name="l00221"></a>00221         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l00222"></a>00222 
<a name="l00223"></a>00223         <span class="comment">// dimension of the state vector</span>
<a name="l00224"></a>00224         chunkSize = multiQubit-&gt;<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00225"></a>00225         stateVecSize = chunkSize*multiQubit-&gt;<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>;
<a name="l00226"></a>00226         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> normFactor = 1.0/sqrt((<a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>)stateVecSize/2.0);
<a name="l00227"></a>00227 
<a name="l00228"></a>00228         <span class="comment">// Can&apos;t use multiQubit-&gt;stateVec as a private OMP var</span>
<a name="l00229"></a>00229         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00230"></a>00230         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00231"></a>00231 
<a name="l00232"></a>00232         <span class="comment">// initialise the state to |0000..0000&gt;</span>
<a name="l00233"></a>00233 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00234"></a>00234 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00235"></a>00235 <span class="preprocessor">        default  (none) \</span>
<a name="l00236"></a>00236 <span class="preprocessor">        shared   (chunkSize, stateVecReal, stateVecImag, normFactor, qubitId, outcome) \</span>
<a name="l00237"></a>00237 <span class="preprocessor">        private  (index, bit) </span>
<a name="l00238"></a>00238 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00239"></a>00239 <span class="preprocessor"></span>        {
<a name="l00240"></a>00240 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00241"></a>00241 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00242"></a>00242 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00243"></a>00243 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {
<a name="l00244"></a>00244                         bit = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a>(qubitId, index+chunkId*chunkSize);
<a name="l00245"></a>00245                         <span class="keywordflow">if</span> (bit==outcome) {
<a name="l00246"></a>00246                                 stateVecReal[index] = normFactor;
<a name="l00247"></a>00247                                 stateVecImag[index] = 0.0;
<a name="l00248"></a>00248                         } <span class="keywordflow">else</span> {
<a name="l00249"></a>00249                                 stateVecReal[index] = 0.0;
<a name="l00250"></a>00250                                 stateVecImag[index] = 0.0;
<a name="l00251"></a>00251                         }
<a name="l00252"></a>00252                 }
<a name="l00253"></a>00253         }
<a name="l00254"></a>00254         <span class="keywordflow">if</span> (<a class="code" href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>) printf(<span class="stringliteral">&quot;COMPLETED INIT\n&quot;</span>);
<a name="l00255"></a>00255 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a43bcb279fc9717fbd06a19cdef48b9d8"></a><!-- doxytag: member="qubits.c::initStatePlus" ref="a43bcb279fc9717fbd06a19cdef48b9d8" args="(MultiQubit *multiQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initStatePlus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a> *&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialise a set of <img class="formulaInl" alt="$ N $" src="form_0.png"/> qubits to the plus state <img class="formulaInl" alt="$ {| + \rangle}^{\otimes N} = \frac{1}{\sqrt{2^N}} (| 0 \rangle + | 1 \rangle)^{\otimes N} $" src="form_2.png"/>. </p>
<p>This is the product state of <img class="formulaInl" alt="$N$" src="form_3.png"/> qubits where every classical state is uniformly populated with real coefficient <img class="formulaInl" alt="$\frac{1}{\sqrt{2^N}}$" src="form_4.png"/>. This is equivalent to applying a Hadamard to every qubit in the zero state: <img class="formulaInl" alt="$ \hat{H}^{\otimes N} {|0\rangle}^{\otimes N} $" src="form_5.png"/></p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>a pointer to the object representing the set of qubits to be initialised </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00177">177</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8c_source.html#l00018">DEBUG</a>, <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00060">MultiQubit::numChunks</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00178"></a>00178 {
<a name="l00179"></a>00179         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;
<a name="l00180"></a>00180         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00181"></a>00181 
<a name="l00182"></a>00182         <span class="comment">// dimension of the state vector</span>
<a name="l00183"></a>00183         chunkSize = multiQubit-&gt;<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00184"></a>00184         stateVecSize = chunkSize*multiQubit-&gt;<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>;
<a name="l00185"></a>00185         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> normFactor = 1.0/sqrt((<a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>)stateVecSize);
<a name="l00186"></a>00186 
<a name="l00187"></a>00187         <span class="comment">// Can&apos;t use multiQubit-&gt;stateVec as a private OMP var</span>
<a name="l00188"></a>00188         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00189"></a>00189         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00190"></a>00190 
<a name="l00191"></a>00191         <span class="comment">// initialise the state to |0000..0000&gt;</span>
<a name="l00192"></a>00192 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00193"></a>00193 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00194"></a>00194 <span class="preprocessor">        default  (none) \</span>
<a name="l00195"></a>00195 <span class="preprocessor">        shared   (chunkSize, stateVecReal, stateVecImag, normFactor) \</span>
<a name="l00196"></a>00196 <span class="preprocessor">        private  (index) </span>
<a name="l00197"></a>00197 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00198"></a>00198 <span class="preprocessor"></span>        {
<a name="l00199"></a>00199 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00200"></a>00200 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00201"></a>00201 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00202"></a>00202 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {
<a name="l00203"></a>00203                         stateVecReal[index] = normFactor;
<a name="l00204"></a>00204                         stateVecImag[index] = 0.0;
<a name="l00205"></a>00205                 }
<a name="l00206"></a>00206         }
<a name="l00207"></a>00207         <span class="keywordflow">if</span> (<a class="code" href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>) printf(<span class="stringliteral">&quot;COMPLETED INIT\n&quot;</span>);
<a name="l00208"></a>00208 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="acb5b2eff794339090004d29f02a70d9a"></a><!-- doxytag: member="qubits.c::initStateZero" ref="acb5b2eff794339090004d29f02a70d9a" args="(MultiQubit *multiQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initStateZero </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a> *&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialise a set of <img class="formulaInl" alt="$ N $" src="form_0.png"/> qubits to the classical zero state <img class="formulaInl" alt="$ {| 0 \rangle}^{\otimes N} $" src="form_1.png"/>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>a pointer to the object representing the set of all qubits to initialise </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00139">139</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l00018">DEBUG</a>, <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00140"></a>00140 {
<a name="l00141"></a>00141         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l00142"></a>00142         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00143"></a>00143 
<a name="l00144"></a>00144         <span class="comment">// dimension of the state vector</span>
<a name="l00145"></a>00145         stateVecSize = multiQubit-&gt;<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00146"></a>00146 
<a name="l00147"></a>00147         <span class="comment">// Can&apos;t use multiQubit-&gt;stateVec as a private OMP var</span>
<a name="l00148"></a>00148         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00149"></a>00149         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00150"></a>00150 
<a name="l00151"></a>00151         <span class="comment">// initialise the state to |0000..0000&gt;</span>
<a name="l00152"></a>00152 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00153"></a>00153 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00154"></a>00154 <span class="preprocessor">        default  (none) \</span>
<a name="l00155"></a>00155 <span class="preprocessor">        shared   (stateVecSize, stateVecReal, stateVecImag) \</span>
<a name="l00156"></a>00156 <span class="preprocessor">        private  (index) </span>
<a name="l00157"></a>00157 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00158"></a>00158 <span class="preprocessor"></span>        {
<a name="l00159"></a>00159 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00160"></a>00160 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00161"></a>00161 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00162"></a>00162 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l00163"></a>00163                         stateVecReal[index] = 0.0;
<a name="l00164"></a>00164                         stateVecImag[index] = 0.0;
<a name="l00165"></a>00165                 }
<a name="l00166"></a>00166         }
<a name="l00167"></a>00167 
<a name="l00168"></a>00168         <span class="keywordflow">if</span> (multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>==0){
<a name="l00169"></a>00169                 <span class="comment">// zero state |0000..0000&gt; has probability 1</span>
<a name="l00170"></a>00170                 stateVecReal[0] = 1.0;
<a name="l00171"></a>00171                 stateVecImag[0] = 0.0;
<a name="l00172"></a>00172         }
<a name="l00173"></a>00173 
<a name="l00174"></a>00174         <span class="keywordflow">if</span> (<a class="code" href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>) printf(<span class="stringliteral">&quot;COMPLETED INIT\n&quot;</span>);
<a name="l00175"></a>00175 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="afc1835c6b43b6e59ce7df7b13f274fc7"></a><!-- doxytag: member="qubits.c::multiControlledPhaseGate" ref="afc1835c6b43b6e59ce7df7b13f274fc7" args="(MultiQubit multiQubit, int *controlQubits, int numControlQubits)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multiControlledPhaseGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>controlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numControlQubits</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply the multiple-qubit controlled phase gate, also known as the multiple-qubit controlled sigmaZ gate. </p>
<p>For each state, if all control qubits have value one, multiply the amplitude of that state by -1. This applies the many-qubit unitary: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 1 \\ &amp; 1 \\\ &amp; &amp; \ddots \\ &amp; &amp; &amp; 1 \\ &amp; &amp; &amp; &amp; -1 \end{pmatrix} \]" src="form_6.png"/>
</p>
<p> on the control qubits.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {controls}; \node[draw=none] at (0, 6) {$\vdots$}; \draw (0, 5) -- (0, 4); \draw (-2, 4) -- (2, 4); \draw[fill=black] (0, 4) circle (.2); \draw (0, 4) -- (0, 2); \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 0); \draw (-2,0) -- (2, 0); \draw[fill=black] (0, 0) circle (.2); \end{tikzpicture} } \]" src="form_7.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubits</em>&nbsp;</td><td>array of input qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>numControlQubits</em>&nbsp;</td><td>number of input qubits </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>numControlQubits</code> is outside [1, <code>multiQubit.numQubits</code>) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01764">1764</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="qubits__env__local_8c_source.html#l00246">QuESTAssert()</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01765"></a>01765 {
<a name="l01766"></a>01766         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l01767"></a>01767         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l01768"></a>01768         
<a name="l01769"></a>01769         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01770"></a>01770         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01771"></a>01771 
<a name="l01772"></a>01772     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(numControlQubits &gt; 0 &amp;&amp; numControlQubits &lt;= multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 4, __func__);
<a name="l01773"></a>01773     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> mask=0;
<a name="l01774"></a>01774     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;numControlQubits; i++) mask = mask | (1LL&lt;&lt;controlQubits[i]);
<a name="l01775"></a>01775     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(mask &gt;=0 &amp;&amp; mask &lt;= (1LL&lt;&lt;multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>)-1, 2, __func__);
<a name="l01776"></a>01776 
<a name="l01777"></a>01777         stateVecSize = multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01778"></a>01778         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01779"></a>01779         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01780"></a>01780 
<a name="l01781"></a>01781 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01782"></a>01782 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01783"></a>01783 <span class="preprocessor">        default  (none)                      \</span>
<a name="l01784"></a>01784 <span class="preprocessor">        shared   (stateVecSize, stateVecReal,stateVecImag, mask ) \</span>
<a name="l01785"></a>01785 <span class="preprocessor">        private  (index)</span>
<a name="l01786"></a>01786 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01787"></a>01787 <span class="preprocessor"></span>        {
<a name="l01788"></a>01788 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01789"></a>01789 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01790"></a>01790 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01791"></a>01791 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l01792"></a>01792                         <span class="keywordflow">if</span> (mask == (mask &amp; (index+chunkId*chunkSize)) ){
<a name="l01793"></a>01793                                 stateVecReal [index] = - stateVecReal [index];
<a name="l01794"></a>01794                                 stateVecImag [index] = - stateVecImag [index];
<a name="l01795"></a>01795                         }
<a name="l01796"></a>01796                 }
<a name="l01797"></a>01797         }
<a name="l01798"></a>01798 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9dbf856ebeea0cf0a3ee5aae6782f2d2"></a><!-- doxytag: member="qubits.c::multiControlledUnitaryDistributed" ref="a9dbf856ebeea0cf0a3ee5aae6782f2d2" args="(MultiQubit multiQubit, const int targetQubit, long long int mask, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multiControlledUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply a unitary operation to a single qubit in the state vector of probability amplitudes, given a subset of the state vector with upper and lower block values stored seperately. </p>
<p>Only perform the rotation where all the control qubits are 1.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>qubit to determine whether or not to perform a rotation </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot1</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot2</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01010">1010</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="qubits_8h_source.html#l00024">Complex::real</a>, and <a class="el" href="precision_8h_source.html#l00025">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00457">multiControlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01017"></a>01017 {
<a name="l01018"></a>01018 
<a name="l01019"></a>01019         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l01020"></a>01020         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01021"></a>01021         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01022"></a>01022         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01023"></a>01023         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01024"></a>01024 
<a name="l01025"></a>01025         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l01026"></a>01026         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l01027"></a>01027         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01028"></a>01028         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01029"></a>01029         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01030"></a>01030 
<a name="l01031"></a>01031 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01032"></a>01032 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01033"></a>01033 <span class="preprocessor">        default  (none) \</span>
<a name="l01034"></a>01034 <span class="preprocessor">        shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l01035"></a>01035 <span class="preprocessor">                        rot1Real,rot1Imag, rot2Real,rot2Imag, mask) \</span>
<a name="l01036"></a>01036 <span class="preprocessor">        private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span>
<a name="l01037"></a>01037 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01038"></a>01038 <span class="preprocessor"></span>        {
<a name="l01039"></a>01039 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01040"></a>01040 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01041"></a>01041 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01042"></a>01042 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01043"></a>01043                         <span class="keywordflow">if</span> (mask == (mask &amp; (thisTask+chunkId*chunkSize)) ){
<a name="l01044"></a>01044                                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l01045"></a>01045                                 stateRealUp = stateVecRealUp[thisTask];
<a name="l01046"></a>01046                                 stateImagUp = stateVecImagUp[thisTask];
<a name="l01047"></a>01047 
<a name="l01048"></a>01048                                 stateRealLo = stateVecRealLo[thisTask];
<a name="l01049"></a>01049                                 stateImagLo = stateVecImagLo[thisTask];
<a name="l01050"></a>01050 
<a name="l01051"></a>01051                 stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp 
<a name="l01052"></a>01052                     + rot2Real*stateRealLo - rot2Imag*stateImagLo;
<a name="l01053"></a>01053                 stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp 
<a name="l01054"></a>01054                     + rot2Real*stateImagLo + rot2Imag*stateRealLo;
<a name="l01055"></a>01055                         }
<a name="l01056"></a>01056                 }
<a name="l01057"></a>01057         }
<a name="l01058"></a>01058 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1309eabcba3cb97fbc3cd2e606d17766"></a><!-- doxytag: member="qubits.c::multiControlledUnitaryLocal" ref="a1309eabcba3cb97fbc3cd2e606d17766" args="(MultiQubit multiQubit, const int targetQubit, long long int mask, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multiControlledUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00741">741</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00032">ComplexMatrix2::r0c0</a>, <a class="el" href="qubits_8h_source.html#l00032">ComplexMatrix2::r0c1</a>, <a class="el" href="qubits_8h_source.html#l00033">ComplexMatrix2::r1c0</a>, <a class="el" href="qubits_8h_source.html#l00033">ComplexMatrix2::r1c1</a>, <a class="el" href="qubits_8h_source.html#l00024">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00143">multiControlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00743"></a>00743 {
<a name="l00744"></a>00744         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l00745"></a>00745         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l00746"></a>00746              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l00747"></a>00747 
<a name="l00748"></a>00748         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00749"></a>00749         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l00750"></a>00750         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l00751"></a>00751         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00752"></a>00752         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l00753"></a>00753 
<a name="l00754"></a>00754         <span class="comment">// set dimensions</span>
<a name="l00755"></a>00755         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l00756"></a>00756         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l00757"></a>00757 
<a name="l00758"></a>00758         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l00759"></a>00759         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00760"></a>00760         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00761"></a>00761 
<a name="l00762"></a>00762 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00763"></a>00763 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00764"></a>00764 <span class="preprocessor">        default  (none) \</span>
<a name="l00765"></a>00765 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, u, mask) \</span>
<a name="l00766"></a>00766 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span>
<a name="l00767"></a>00767 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00768"></a>00768 <span class="preprocessor"></span>        {
<a name="l00769"></a>00769 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00770"></a>00770 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00771"></a>00771 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00772"></a>00772 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00773"></a>00773 
<a name="l00774"></a>00774                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l00775"></a>00775                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l00776"></a>00776                         indexLo     = indexUp + sizeHalfBlock;
<a name="l00777"></a>00777 
<a name="l00778"></a>00778                         <span class="keywordflow">if</span> (mask == (mask &amp; (indexUp+chunkId*chunkSize)) ){
<a name="l00779"></a>00779                                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l00780"></a>00780                                 stateRealUp = stateVecReal[indexUp];
<a name="l00781"></a>00781                                 stateImagUp = stateVecImag[indexUp];
<a name="l00782"></a>00782 
<a name="l00783"></a>00783                                 stateRealLo = stateVecReal[indexLo];
<a name="l00784"></a>00784                                 stateImagLo = stateVecImag[indexLo];
<a name="l00785"></a>00785 
<a name="l00786"></a>00786 
<a name="l00787"></a>00787                                 <span class="comment">// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]</span>
<a name="l00788"></a>00788                                 stateVecReal[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp 
<a name="l00789"></a>00789                                         + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo - u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;
<a name="l00790"></a>00790                                 stateVecImag[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp 
<a name="l00791"></a>00791                                         + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;
<a name="l00792"></a>00792 
<a name="l00793"></a>00793                                 <span class="comment">// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]</span>
<a name="l00794"></a>00794                                 stateVecReal[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp  - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp 
<a name="l00795"></a>00795                                         + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo  -  u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;
<a name="l00796"></a>00796                                 stateVecImag[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp 
<a name="l00797"></a>00797                                         + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;
<a name="l00798"></a>00798                         }
<a name="l00799"></a>00799                 } 
<a name="l00800"></a>00800         }
<a name="l00801"></a>00801 
<a name="l00802"></a>00802 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af832ed00b02a0597b7fe0b714032c54a"></a><!-- doxytag: member="qubits.c::phaseGateDistributed" ref="af832ed00b02a0597b7fe0b714032c54a" args="(MultiQubit multiQubit, const int targetQubit, enum phaseGateType type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void phaseGateDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a>&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01522">1522</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, <a class="el" href="qubits_8h_source.html#l00073">S_GATE</a>, <a class="el" href="qubits_8h_source.html#l00073">SIGMA_Z</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>, and <a class="el" href="qubits_8h_source.html#l00073">T_GATE</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00600">phaseGate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01523"></a>01523 {
<a name="l01524"></a>01524         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealLo,stateImagLo;
<a name="l01525"></a>01525         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01526"></a>01526         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01527"></a>01527 
<a name="l01528"></a>01528         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l01529"></a>01529         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01530"></a>01530         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01531"></a>01531 
<a name="l01532"></a>01532         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> recRoot2 = 1.0/sqrt(2);
<a name="l01533"></a>01533 
<a name="l01534"></a>01534 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01535"></a>01535 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01536"></a>01536 <span class="preprocessor">        default  (none) \</span>
<a name="l01537"></a>01537 <span class="preprocessor">        shared   (stateVecReal,stateVecImag, recRoot2, type) \</span>
<a name="l01538"></a>01538 <span class="preprocessor">        private  (thisTask,stateRealLo,stateImagLo) </span>
<a name="l01539"></a>01539 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01540"></a>01540 <span class="preprocessor"></span>        {
<a name="l01541"></a>01541                 <span class="keywordflow">if</span> (type==<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a>){
<a name="l01542"></a>01542 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01543"></a>01543 <span class="preprocessor"></span><span class="preprocessor">                        # pragma omp for schedule (static)</span>
<a name="l01544"></a>01544 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01545"></a>01545 <span class="preprocessor"></span>                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01546"></a>01546                                 stateVecReal[thisTask] = -stateVecReal[thisTask];
<a name="l01547"></a>01547                                 stateVecImag[thisTask] = -stateVecImag[thisTask];
<a name="l01548"></a>01548                         } 
<a name="l01549"></a>01549                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a>){
<a name="l01550"></a>01550 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01551"></a>01551 <span class="preprocessor"></span><span class="preprocessor">                        # pragma omp for schedule (static)</span>
<a name="l01552"></a>01552 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01553"></a>01553 <span class="preprocessor"></span>                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01554"></a>01554                                 stateRealLo = stateVecReal[thisTask];
<a name="l01555"></a>01555                                 stateImagLo = stateVecImag[thisTask];
<a name="l01556"></a>01556 
<a name="l01557"></a>01557                                 stateVecReal[thisTask] = -stateImagLo;
<a name="l01558"></a>01558                                 stateVecImag[thisTask] = stateRealLo;
<a name="l01559"></a>01559                         } 
<a name="l01560"></a>01560                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a>){
<a name="l01561"></a>01561 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01562"></a>01562 <span class="preprocessor"></span><span class="preprocessor">                        # pragma omp for schedule (static)</span>
<a name="l01563"></a>01563 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01564"></a>01564 <span class="preprocessor"></span>                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01565"></a>01565                                 stateRealLo = stateVecReal[thisTask];
<a name="l01566"></a>01566                                 stateImagLo = stateVecImag[thisTask];
<a name="l01567"></a>01567 
<a name="l01568"></a>01568                                 stateVecReal[thisTask] = recRoot2 * (stateRealLo - stateImagLo);
<a name="l01569"></a>01569                                 stateVecImag[thisTask] = recRoot2 * (stateRealLo + stateImagLo);
<a name="l01570"></a>01570                         } 
<a name="l01571"></a>01571                 } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Type %d is an invalid phase gate\n&quot;</span>, type);
<a name="l01572"></a>01572         }
<a name="l01573"></a>01573 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3a54566b73ac84c312d7da4f56ffbc3b"></a><!-- doxytag: member="qubits.c::phaseGateLocal" ref="a3a54566b73ac84c312d7da4f56ffbc3b" args="(MultiQubit multiQubit, const int targetQubit, enum phaseGateType type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void phaseGateLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a>&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>fix -- can i rewrite this to not use mod?</p>
<p>fix -- can i rewrite this to not use mod?</p>
<p>fix -- can i rewrite this to not use mod? </p>
</p>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01446">1446</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, <a class="el" href="qubits_8h_source.html#l00073">S_GATE</a>, <a class="el" href="qubits_8h_source.html#l00073">SIGMA_Z</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>, and <a class="el" href="qubits_8h_source.html#l00073">T_GATE</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00169">phaseGate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01447"></a>01447 {
<a name="l01448"></a>01448         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01449"></a>01449         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01450"></a>01450              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01451"></a>01451 
<a name="l01452"></a>01452         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealLo,stateImagLo;
<a name="l01453"></a>01453         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01454"></a>01454         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01455"></a>01455 
<a name="l01456"></a>01456         <span class="comment">// set dimensions</span>
<a name="l01457"></a>01457         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01458"></a>01458         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01459"></a>01459 
<a name="l01460"></a>01460         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l01461"></a>01461         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01462"></a>01462         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01463"></a>01463 
<a name="l01464"></a>01464         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> recRoot2 = 1.0/sqrt(2);
<a name="l01465"></a>01465 
<a name="l01466"></a>01466 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01467"></a>01467 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01468"></a>01468 <span class="preprocessor">        default  (none) \</span>
<a name="l01469"></a>01469 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock,stateVecReal,stateVecImag,recRoot2,type) \</span>
<a name="l01470"></a>01470 <span class="preprocessor">        private  (thisTask,thisBlock,indexUp,indexLo,stateRealLo,stateImagLo) </span>
<a name="l01471"></a>01471 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01472"></a>01472 <span class="preprocessor"></span>        {
<a name="l01473"></a>01473                 <span class="keywordflow">if</span> (type==<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a>){
<a name="l01474"></a>01474 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01475"></a>01475 <span class="preprocessor"></span><span class="preprocessor">                        # pragma omp for schedule (static)</span>
<a name="l01476"></a>01476 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01477"></a>01477 <span class="preprocessor"></span>                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01479"></a>01479                                 thisBlock   = thisTask / sizeHalfBlock;
<a name="l01480"></a>01480                                 indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01481"></a>01481                                 indexLo     = indexUp + sizeHalfBlock;
<a name="l01482"></a>01482 
<a name="l01483"></a>01483                                 stateVecReal[indexLo] = -stateVecReal[indexLo];
<a name="l01484"></a>01484                                 stateVecImag[indexLo] = -stateVecImag[indexLo];
<a name="l01485"></a>01485                         } 
<a name="l01486"></a>01486                 } 
<a name="l01487"></a>01487                 
<a name="l01488"></a>01488                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a>){
<a name="l01489"></a>01489 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01490"></a>01490 <span class="preprocessor"></span><span class="preprocessor">                        # pragma omp for schedule (static)</span>
<a name="l01491"></a>01491 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01492"></a>01492 <span class="preprocessor"></span>                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01494"></a>01494                                 thisBlock   = thisTask / sizeHalfBlock;
<a name="l01495"></a>01495                                 indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01496"></a>01496                                 indexLo     = indexUp + sizeHalfBlock;
<a name="l01497"></a>01497                                 stateRealLo = stateVecReal[indexLo];
<a name="l01498"></a>01498                                 stateImagLo = stateVecImag[indexLo];
<a name="l01499"></a>01499 
<a name="l01500"></a>01500                                 stateVecReal[indexLo] = -stateImagLo;
<a name="l01501"></a>01501                                 stateVecImag[indexLo] = stateRealLo;
<a name="l01502"></a>01502                         } 
<a name="l01503"></a>01503                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a>){
<a name="l01504"></a>01504 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01505"></a>01505 <span class="preprocessor"></span><span class="preprocessor">                        # pragma omp for schedule (static)</span>
<a name="l01506"></a>01506 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01507"></a>01507 <span class="preprocessor"></span>                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01509"></a>01509                                 thisBlock   = thisTask / sizeHalfBlock;
<a name="l01510"></a>01510                                 indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01511"></a>01511                                 indexLo     = indexUp + sizeHalfBlock;
<a name="l01512"></a>01512                                 stateRealLo = stateVecReal[indexLo];
<a name="l01513"></a>01513                                 stateImagLo = stateVecImag[indexLo];
<a name="l01514"></a>01514 
<a name="l01515"></a>01515                                 stateVecReal[indexLo] = recRoot2 * (stateRealLo - stateImagLo);
<a name="l01516"></a>01516                                 stateVecImag[indexLo] = recRoot2 * (stateRealLo + stateImagLo);
<a name="l01517"></a>01517                         } 
<a name="l01518"></a>01518                 } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Type %d is an invalid phase gate\n&quot;</span>, type);
<a name="l01519"></a>01519         }
<a name="l01520"></a>01520 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa5e77e0e64f3a4a3d3f5cc7382bffcd9"></a><!-- doxytag: member="qubits.c::reportMultiQubitParams" ref="aa5e77e0e64f3a4a3d3f5cc7382bffcd9" args="(MultiQubit multiQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportMultiQubitParams </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Report metainformation about a set of qubits: number of qubits, number of probability amplitudes. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment (local, multinode etc) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00120">120</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00060">MultiQubit::numChunks</a>, and <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numQubits</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00120"></a>00120                                                   {
<a name="l00121"></a>00121         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = 1L &lt;&lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>;
<a name="l00122"></a>00122         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmpsPerRank = numAmps/multiQubit.<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>;
<a name="l00123"></a>00123         <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>==0){
<a name="l00124"></a>00124                 printf(<span class="stringliteral">&quot;QUBITS:\n&quot;</span>);
<a name="l00125"></a>00125                 printf(<span class="stringliteral">&quot;Number of qubits is %d.\n&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>);
<a name="l00126"></a>00126                 printf(<span class="stringliteral">&quot;Number of amps is %lld.\n&quot;</span>, numAmps);
<a name="l00127"></a>00127                 printf(<span class="stringliteral">&quot;Number of amps per rank is %lld.\n&quot;</span>, numAmpsPerRank);
<a name="l00128"></a>00128         }
<a name="l00129"></a>00129 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a96f4de9ce7fefc7680a44d601fc3d894"></a><!-- doxytag: member="qubits.c::reportState" ref="a96f4de9ce7fefc7680a44d601fc3d894" args="(MultiQubit multiQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Print the current state vector of probability amplitudes for a set of qubits to file. </p>
<p>File format: </p>
<div class="fragment"><pre class="fragment">
real, imag
realComponent1, imagComponent1
realComponent2, imagComponent2
...
realComponentN, imagComponentN
</pre></div><p>File naming convention:</p>
<p>For each node that the program runs on, a file 'state_rank_[node_rank].csv' is generated. If there is more than one node, ranks after the first do not include the header </p>
<div class="fragment"><pre class="fragment">
real, imag
</pre></div><p> so that files are easier to combine.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00081">81</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00027">REAL_STRING_FORMAT</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00081"></a>00081                                        {
<a name="l00082"></a>00082         FILE *state;
<a name="l00083"></a>00083         <span class="keywordtype">char</span> filename[100];
<a name="l00084"></a>00084         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00085"></a>00085         sprintf(filename, <span class="stringliteral">&quot;state_rank_%d.csv&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>);
<a name="l00086"></a>00086         state = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>);
<a name="l00087"></a>00087         <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>==0) fprintf(state, <span class="stringliteral">&quot;real, imag\n&quot;</span>);
<a name="l00088"></a>00088 
<a name="l00089"></a>00089         <span class="keywordflow">for</span>(index=0; index&lt;multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>; index++){
<a name="l00090"></a>00090                 fprintf(state, <a class="code" href="precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a> <span class="stringliteral">&quot;,&quot;</span> <a class="code" href="precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a> <span class="stringliteral">&quot;\n&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[index], multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[index]);
<a name="l00091"></a>00091         }
<a name="l00092"></a>00092         fclose(state);
<a name="l00093"></a>00093 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a842d6884e063a5865a2232cba56b65ac"></a><!-- doxytag: member="qubits.c::reportStateToScreen" ref="a842d6884e063a5865a2232cba56b65ac" args="(MultiQubit multiQubit, QuESTEnv env, int reportRank)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportStateToScreen </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>reportRank</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Print the current state vector of probability amplitudes for a set of qubits to standard out. </p>
<p>For debugging purposes. Each rank should print output serially. Only print output for systems &lt;= 5 qubits </p>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00095">95</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00060">MultiQubit::numChunks</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00027">REAL_STRING_FORMAT</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>, and <a class="el" href="qubits__env__local_8c_source.html#l00035">syncQuESTEnv()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00095"></a>00095                                                                              {
<a name="l00096"></a>00096         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00097"></a>00097         <span class="keywordtype">int</span> rank;
<a name="l00098"></a>00098         <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>&lt;=5){
<a name="l00099"></a>00099                 <span class="keywordflow">for</span> (rank=0; rank&lt;multiQubit.<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>; rank++){
<a name="l00100"></a>00100                         <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>==rank){
<a name="l00101"></a>00101                                 <span class="keywordflow">if</span> (reportRank) {
<a name="l00102"></a>00102                                         printf(<span class="stringliteral">&quot;Reporting state from rank %d [\n&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>);
<a name="l00103"></a>00103                                         <span class="comment">//printf(&quot;\trank, index, real, imag\n&quot;);</span>
<a name="l00104"></a>00104                                         printf(<span class="stringliteral">&quot;real, imag\n&quot;</span>);
<a name="l00105"></a>00105                                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rank==0) {
<a name="l00106"></a>00106                                         printf(<span class="stringliteral">&quot;Reporting state [\n&quot;</span>);
<a name="l00107"></a>00107                                         printf(<span class="stringliteral">&quot;real, imag\n&quot;</span>);
<a name="l00108"></a>00108                                 }
<a name="l00109"></a>00109 
<a name="l00110"></a>00110                                 <span class="keywordflow">for</span>(index=0; index&lt;multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>; index++){
<a name="l00111"></a>00111                                         printf(<a class="code" href="precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a> <span class="stringliteral">&quot;, &quot;</span> <a class="code" href="precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a> <span class="stringliteral">&quot;\n&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[index], multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[index]);
<a name="l00112"></a>00112                                 }
<a name="l00113"></a>00113                                 <span class="keywordflow">if</span> (reportRank || rank==multiQubit.<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>-1) printf(<span class="stringliteral">&quot;]\n&quot;</span>);
<a name="l00114"></a>00114                         }
<a name="l00115"></a>00115                         <a class="code" href="qubits_8h.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77" title="Guarantees that all code up to the given point has been executed on all nodes (if...">syncQuESTEnv</a>(env);
<a name="l00116"></a>00116                 }
<a name="l00117"></a>00117         } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Error: reportStateToScreen will not print output for systems of more than 5 qubits.\n&quot;</span>);
<a name="l00118"></a>00118 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8810423457803005fecd415f4299f40d"></a><!-- doxytag: member="qubits.c::rotateAroundAxis" ref="a8810423457803005fecd415f4299f40d" args="(MultiQubit multiQubit, const int rotQubit, REAL angle, Vector axis)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotateAroundAxis </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structVector.html">Vector</a>&nbsp;</td>
          <td class="paramname"> <em>axis</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by a given angle around a given vector on the Bloch-sphere. </p>
<p>The vector must not be zero (else an error is thrown), but needn't be unit magnitude.</p>
<p>For angle <img class="formulaInl" alt="$\theta$" src="form_23.png"/> and axis vector <img class="formulaInl" alt="$\vec{n}$" src="form_52.png"/>, applies <img class="formulaInl" alt="$R_{\hat{n}} = \exp \left(- i \frac{\theta}{2} \hat{n} \cdot \vec{\sigma} \right) $" src="form_55.png"/> where <img class="formulaInl" alt="$\vec{\sigma}$" src="form_54.png"/> is the vector of Pauli matrices.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rotQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>angle</em>&nbsp;</td><td>angle by which to rotate in radians </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>axis</em>&nbsp;</td><td>vector around which to rotate (can be non-unit; will be normalised) </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>rotQubit</code> is outside [0, <code>multiQubit.numQubits</code>), or if <code>axis</code> is the zero vector </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00382">382</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00104">compactUnitary()</a>, <a class="el" href="qubits_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00024">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00040">Vector::x</a>, <a class="el" href="qubits_8h_source.html#l00040">Vector::y</a>, and <a class="el" href="qubits_8h_source.html#l00040">Vector::z</a>.</p>

<p>Referenced by <a class="el" href="qubits_8c_source.html#l00395">rotateX()</a>, <a class="el" href="qubits_8c_source.html#l00401">rotateY()</a>, and <a class="el" href="qubits_8c_source.html#l00407">rotateZ()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00382"></a>00382                                                                                          {
<a name="l00383"></a>00383         
<a name="l00384"></a>00384         <span class="keywordtype">double</span> mag = sqrt(pow(axis.<a class="code" href="structVector.html#aac7abe171ba4bada50ed72acba6259fc">x</a>,2) + pow(axis.<a class="code" href="structVector.html#a375ca805d4c808a53d7c4e0c737ae3de">y</a>,2) + pow(axis.<a class="code" href="structVector.html#ad4e863651be7d6b7e2b28cd7445a0ccf">z</a>,2));
<a name="l00385"></a>00385         <a class="code" href="structVector.html" title="Represents a 3-vector of real numbers.">Vector</a> unitAxis = {axis.<a class="code" href="structVector.html#aac7abe171ba4bada50ed72acba6259fc">x</a>/mag, axis.<a class="code" href="structVector.html#a375ca805d4c808a53d7c4e0c737ae3de">y</a>/mag, axis.<a class="code" href="structVector.html#ad4e863651be7d6b7e2b28cd7445a0ccf">z</a>/mag};
<a name="l00386"></a>00386         
<a name="l00387"></a>00387         <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> alpha, beta;
<a name="l00388"></a>00388         alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> = cos(angle/2.0);
<a name="l00389"></a>00389         alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> = -sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#ad4e863651be7d6b7e2b28cd7445a0ccf">z</a>;        
<a name="l00390"></a>00390         beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> = sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#a375ca805d4c808a53d7c4e0c737ae3de">y</a>;
<a name="l00391"></a>00391         beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> = -sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#aac7abe171ba4bada50ed72acba6259fc">x</a>;
<a name="l00392"></a>00392         <a class="code" href="qubits_8h.html#a03b13dfcabd8c59b50dbdd3af44ba8b2" title="Apply a single-qubit unitary parameterised by two given complex scalars.">compactUnitary</a>(multiQubit, rotQubit, alpha, beta);
<a name="l00393"></a>00393 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6cc7fa705a2f2e6b486b49c5589d5df5"></a><!-- doxytag: member="qubits.c::rotateX" ref="a6cc7fa705a2f2e6b486b49c5589d5df5" args="(MultiQubit multiQubit, const int rotQubit, REAL angle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotateX </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>angle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by a given angle around the X-axis of the Bloch-sphere. </p>
<p>For angle <img class="formulaInl" alt="$\theta$" src="form_23.png"/>, applies </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} \cos\theta/2 &amp; -i \sin \theta/2\\ -i \sin \theta/2 &amp; \cos \theta/2 \end{pmatrix} \]" src="form_24.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {rot}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$R_x(\theta)$}; \end{tikzpicture} } \]" src="form_25.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rotQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>angle</em>&nbsp;</td><td>angle by which to rotate in radians </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>rotQubit</code> is outside [0, <code>multiQubit.numQubits</code>). </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00395">395</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8c_source.html#l00382">rotateAroundAxis()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00395"></a>00395                                                                    {
<a name="l00396"></a>00396 
<a name="l00397"></a>00397         <a class="code" href="structVector.html" title="Represents a 3-vector of real numbers.">Vector</a> unitAxis = {1, 0, 0};
<a name="l00398"></a>00398         <a class="code" href="qubits_8c.html#a8810423457803005fecd415f4299f40d" title="Rotate a single qubit by a given angle around a given vector on the Bloch-sphere...">rotateAroundAxis</a>(multiQubit, rotQubit, angle, unitAxis);
<a name="l00399"></a>00399 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ace0d3592d38a990e81a434c4e9681500"></a><!-- doxytag: member="qubits.c::rotateY" ref="ace0d3592d38a990e81a434c4e9681500" args="(MultiQubit multiQubit, const int rotQubit, REAL angle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotateY </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>angle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by a given angle around the Y-axis of the Bloch-sphere. </p>
<p>For angle <img class="formulaInl" alt="$\theta$" src="form_23.png"/>, applies </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} \cos\theta/2 &amp; - \sin \theta/2\\ \sin \theta/2 &amp; \cos \theta/2 \end{pmatrix} \]" src="form_51.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {rot}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$R_y(\theta)$}; \end{tikzpicture} } \]" src="form_27.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rotQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>angle</em>&nbsp;</td><td>angle by which to rotate in radians </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>rotQubit</code> is outside [0, <code>multiQubit.numQubits</code>). </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00401">401</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8c_source.html#l00382">rotateAroundAxis()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00401"></a>00401                                                                    {
<a name="l00402"></a>00402         
<a name="l00403"></a>00403         <a class="code" href="structVector.html" title="Represents a 3-vector of real numbers.">Vector</a> unitAxis = {0, 1, 0};
<a name="l00404"></a>00404         <a class="code" href="qubits_8c.html#a8810423457803005fecd415f4299f40d" title="Rotate a single qubit by a given angle around a given vector on the Bloch-sphere...">rotateAroundAxis</a>(multiQubit, rotQubit, angle, unitAxis);
<a name="l00405"></a>00405 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="abd621412ad30c1b034f4ce153c4afe10"></a><!-- doxytag: member="qubits.c::rotateZ" ref="abd621412ad30c1b034f4ce153c4afe10" args="(MultiQubit multiQubit, const int rotQubit, REAL angle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotateZ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>angle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by a given angle around the Z-axis of the Bloch-sphere (also known as a phase shift gate). </p>
<p>For angle <img class="formulaInl" alt="$\theta$" src="form_23.png"/>, applies </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} \exp(-i \theta/2) &amp; 0 \\ 0 &amp; \exp(i \theta/2) \end{pmatrix} \]" src="form_28.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {rot}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$R_z(\theta)$}; \end{tikzpicture} } \]" src="form_29.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rotQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>angle</em>&nbsp;</td><td>angle by which to rotate in radians </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>rotQubit</code> is outside [0, <code>multiQubit.numQubits</code>). </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00407">407</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8c_source.html#l00382">rotateAroundAxis()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00407"></a>00407                                                                    {
<a name="l00408"></a>00408         
<a name="l00409"></a>00409         <a class="code" href="structVector.html" title="Represents a 3-vector of real numbers.">Vector</a> unitAxis = {0, 0, 1};
<a name="l00410"></a>00410         <a class="code" href="qubits_8c.html#a8810423457803005fecd415f4299f40d" title="Rotate a single qubit by a given angle around a given vector on the Bloch-sphere...">rotateAroundAxis</a>(multiQubit, rotQubit, angle, unitAxis);
<a name="l00411"></a>00411 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="adda6c47876a7676488ed0565a19eaa65"></a><!-- doxytag: member="qubits.c::sGate" ref="adda6c47876a7676488ed0565a19eaa65" args="(MultiQubit multiQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply the single-qubit S gate. </p>
<p>This is a rotation of <img class="formulaInl" alt="$\pi/2$" src="form_10.png"/> around the Z-axis on the Bloch sphere, or the unitary: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 1 &amp; 0 \\ 0 &amp; i \end{pmatrix} \]" src="form_11.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {S}; \end{tikzpicture} } \]" src="form_12.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to operate upon </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>targetQubit</code> is outside [0, <code>multiQubit.numQubits</code>) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01580">1580</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00169">phaseGate()</a>, and <a class="el" href="qubits_8h_source.html#l00073">S_GATE</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01581"></a>01581 {
<a name="l01582"></a>01582                 <a class="code" href="qubits__env__local_8c.html#aae7a8a7f1ccbddb7f76b6c52b746bb43">phaseGate</a>(multiQubit, targetQubit, <a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a>);
<a name="l01583"></a>01583 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2275fff50824fe47485890ff5a857785"></a><!-- doxytag: member="qubits.c::sigmaXDistributed" ref="a2275fff50824fe47485890ff5a857785" args="(MultiQubit multiQubit, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaXDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{0,1},{1,0}. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecIn</em>&nbsp;</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01119">1119</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, and <a class="el" href="precision_8h_source.html#l00025">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00503">sigmaX()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01122"></a>01122 {
<a name="l01123"></a>01123 
<a name="l01124"></a>01124         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01125"></a>01125         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01126"></a>01126 
<a name="l01127"></a>01127         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealIn=stateVecIn.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagIn=stateVecIn.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01128"></a>01128         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01129"></a>01129 
<a name="l01130"></a>01130 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01131"></a>01131 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01132"></a>01132 <span class="preprocessor">        default  (none) \</span>
<a name="l01133"></a>01133 <span class="preprocessor">        shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut) \</span>
<a name="l01134"></a>01134 <span class="preprocessor">        private  (thisTask)</span>
<a name="l01135"></a>01135 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01136"></a>01136 <span class="preprocessor"></span>        {
<a name="l01137"></a>01137 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01138"></a>01138 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01139"></a>01139 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01140"></a>01140 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01141"></a>01141                         stateVecRealOut[thisTask] = stateVecRealIn[thisTask];
<a name="l01142"></a>01142                         stateVecImagOut[thisTask] = stateVecImagIn[thisTask];
<a name="l01143"></a>01143                 }
<a name="l01144"></a>01144         }
<a name="l01145"></a>01145 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a74822fd86bb5d81766e6e8dbdcd62df1"></a><!-- doxytag: member="qubits.c::sigmaXLocal" ref="a74822fd86bb5d81766e6e8dbdcd62df1" args="(MultiQubit multiQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaXLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01060">1060</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00157">sigmaX()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01061"></a>01061 {
<a name="l01062"></a>01062         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01063"></a>01063         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01064"></a>01064              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01065"></a>01065 
<a name="l01066"></a>01066         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateImagUp;
<a name="l01067"></a>01067         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01068"></a>01068         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01069"></a>01069 
<a name="l01070"></a>01070         <span class="comment">// set dimensions</span>
<a name="l01071"></a>01071         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01072"></a>01072         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01073"></a>01073 
<a name="l01074"></a>01074         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l01075"></a>01075         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01076"></a>01076         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01077"></a>01077 
<a name="l01078"></a>01078 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01079"></a>01079 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01080"></a>01080 <span class="preprocessor">        default  (none) \</span>
<a name="l01081"></a>01081 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span>
<a name="l01082"></a>01082 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp) </span>
<a name="l01083"></a>01083 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01084"></a>01084 <span class="preprocessor"></span>        {
<a name="l01085"></a>01085 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01086"></a>01086 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01087"></a>01087 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01088"></a>01088 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01089"></a>01089                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l01090"></a>01090                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01091"></a>01091                         indexLo     = indexUp + sizeHalfBlock;
<a name="l01092"></a>01092 
<a name="l01093"></a>01093                         stateRealUp = stateVecReal[indexUp];
<a name="l01094"></a>01094                         stateImagUp = stateVecImag[indexUp];
<a name="l01095"></a>01095 
<a name="l01096"></a>01096                         stateVecReal[indexUp] = stateVecReal[indexLo];
<a name="l01097"></a>01097                         stateVecImag[indexUp] = stateVecImag[indexLo];
<a name="l01098"></a>01098 
<a name="l01099"></a>01099                         stateVecReal[indexLo] = stateRealUp;
<a name="l01100"></a>01100                         stateVecImag[indexLo] = stateImagUp;
<a name="l01101"></a>01101                 } 
<a name="l01102"></a>01102         }
<a name="l01103"></a>01103 
<a name="l01104"></a>01104 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af5ef5166f00c0572354b4ac53dcf40cf"></a><!-- doxytag: member="qubits.c::sigmaYDistributed" ref="af5ef5166f00c0572354b4ac53dcf40cf" args="(MultiQubit multiQubit, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut, int updateUpper)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaYDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>updateUpper</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{0,-i},{i,0}. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecIn</em>&nbsp;</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>updateUpper</em>&nbsp;</td><td>flag, 1: updating upper values, 0: updating lower values in block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01306">1306</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, and <a class="el" href="precision_8h_source.html#l00025">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00569">sigmaY()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01310"></a>01310 {
<a name="l01311"></a>01311 
<a name="l01312"></a>01312         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01313"></a>01313         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01314"></a>01314 
<a name="l01315"></a>01315         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealIn=stateVecIn.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagIn=stateVecIn.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01316"></a>01316         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01317"></a>01317 
<a name="l01318"></a>01318         <span class="keywordtype">int</span> realSign=1, imagSign=1;
<a name="l01319"></a>01319         <span class="keywordflow">if</span> (updateUpper) imagSign=-1;
<a name="l01320"></a>01320         <span class="keywordflow">else</span> realSign = -1;
<a name="l01321"></a>01321 
<a name="l01322"></a>01322 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01323"></a>01323 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01324"></a>01324 <span class="preprocessor">        default  (none) \</span>
<a name="l01325"></a>01325 <span class="preprocessor">        shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut,realSign,imagSign) \</span>
<a name="l01326"></a>01326 <span class="preprocessor">        private  (thisTask)</span>
<a name="l01327"></a>01327 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01328"></a>01328 <span class="preprocessor"></span>        {
<a name="l01329"></a>01329 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01330"></a>01330 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01331"></a>01331 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01332"></a>01332 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01333"></a>01333                         stateVecRealOut[thisTask] = realSign*stateVecImagIn[thisTask];
<a name="l01334"></a>01334                         stateVecImagOut[thisTask] = imagSign*stateVecRealIn[thisTask];
<a name="l01335"></a>01335                 }
<a name="l01336"></a>01336         }
<a name="l01337"></a>01337 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a81fbfaed65a742a7dfd622e17652245e"></a><!-- doxytag: member="qubits.c::sigmaYLocal" ref="a81fbfaed65a742a7dfd622e17652245e" args="(MultiQubit multiQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaYLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01247">1247</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00163">sigmaY()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01248"></a>01248 {
<a name="l01249"></a>01249         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01250"></a>01250         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01251"></a>01251              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01252"></a>01252 
<a name="l01253"></a>01253         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateImagUp;
<a name="l01254"></a>01254         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01255"></a>01255         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01256"></a>01256 
<a name="l01257"></a>01257         <span class="comment">// set dimensions</span>
<a name="l01258"></a>01258         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01259"></a>01259         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01260"></a>01260 
<a name="l01261"></a>01261         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l01262"></a>01262         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01263"></a>01263         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01264"></a>01264 
<a name="l01265"></a>01265 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01266"></a>01266 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01267"></a>01267 <span class="preprocessor">        default  (none) \</span>
<a name="l01268"></a>01268 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span>
<a name="l01269"></a>01269 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp) </span>
<a name="l01270"></a>01270 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01271"></a>01271 <span class="preprocessor"></span>        {
<a name="l01272"></a>01272 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01273"></a>01273 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01274"></a>01274 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01275"></a>01275 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01276"></a>01276                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l01277"></a>01277                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01278"></a>01278                         indexLo     = indexUp + sizeHalfBlock;
<a name="l01279"></a>01279 
<a name="l01280"></a>01280                         stateRealUp = stateVecReal[indexUp];
<a name="l01281"></a>01281                         stateImagUp = stateVecImag[indexUp];
<a name="l01282"></a>01282 
<a name="l01283"></a>01283                         stateVecReal[indexUp] = stateVecImag[indexLo];
<a name="l01284"></a>01284                         stateVecImag[indexUp] = -stateVecReal[indexLo];
<a name="l01285"></a>01285 
<a name="l01286"></a>01286                         stateVecReal[indexLo] = -stateImagUp;
<a name="l01287"></a>01287                         stateVecImag[indexLo] = stateRealUp;
<a name="l01288"></a>01288                 } 
<a name="l01289"></a>01289         }
<a name="l01290"></a>01290 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aebaab86326779de55d335cfea3efde8f"></a><!-- doxytag: member="qubits.c::sigmaZ" ref="aebaab86326779de55d335cfea3efde8f" args="(MultiQubit multiQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaZ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply the single-qubit sigma-Z (also known as the Z, Pauli-Z or phase-flip) gate. </p>
<p>This is a rotation of <img class="formulaInl" alt="$\pi$" src="form_36.png"/> around the Z-axis (a phase shift) on the Bloch sphere. I.e. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 1 &amp; 0 \\ 0 &amp; -1 \end{pmatrix} \]" src="form_41.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$\sigma_z$}; \end{tikzpicture} } \]" src="form_42.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to operate on </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>targetQubit</code> is outside [0, <code>multiQubit.numQubits</code>). </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01575">1575</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00169">phaseGate()</a>, and <a class="el" href="qubits_8h_source.html#l00073">SIGMA_Z</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01576"></a>01576 {
<a name="l01577"></a>01577                 <a class="code" href="qubits__env__local_8c.html#aae7a8a7f1ccbddb7f76b6c52b746bb43">phaseGate</a>(multiQubit, targetQubit, <a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a>);
<a name="l01578"></a>01578 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af764ea63a2e870098f4e1ce08562942e"></a><!-- doxytag: member="qubits.c::tGate" ref="af764ea63a2e870098f4e1ce08562942e" args="(MultiQubit multiQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply the single-qubit T gate. </p>
<p>This is a rotation of <img class="formulaInl" alt="$\pi/4$" src="form_13.png"/> around the Z-axis on the Bloch sphere, or the unitary: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 1 &amp; 0 \\ 0 &amp; \exp\left(i \frac{\pi}{4}\right) \end{pmatrix} \]" src="form_14.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {T}; \end{tikzpicture} } \]" src="form_15.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to operate upon </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>targetQubit</code> is outside [0, <code>multiQubit.numQubits</code>) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01585">1585</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00169">phaseGate()</a>, and <a class="el" href="qubits_8h_source.html#l00073">T_GATE</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01586"></a>01586 {
<a name="l01587"></a>01587                 <a class="code" href="qubits__env__local_8c.html#aae7a8a7f1ccbddb7f76b6c52b746bb43">phaseGate</a>(multiQubit, targetQubit, <a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a>);
<a name="l01588"></a>01588 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2343b7240118e89aa615e2c9140b770b"></a><!-- doxytag: member="qubits.c::unitaryDistributed" ref="a2343b7240118e89aa615e2c9140b770b" args="(MultiQubit multiQubit, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void unitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply a unitary operation to a single qubit given a subset of the state vector with upper and lower block values stored seperately. </p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>u</em>&nbsp;</td><td>unitary matrix to apply </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00629">629</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="qubits_8h_source.html#l00024">Complex::real</a>, and <a class="el" href="precision_8h_source.html#l00025">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00328">unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00634"></a>00634 {
<a name="l00635"></a>00635 
<a name="l00636"></a>00636         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00637"></a>00637         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l00638"></a>00638         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00639"></a>00639 
<a name="l00640"></a>00640         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00641"></a>00641         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00642"></a>00642         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00643"></a>00643         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00644"></a>00644         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00645"></a>00645 
<a name="l00646"></a>00646 
<a name="l00647"></a>00647 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00648"></a>00648 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00649"></a>00649 <span class="preprocessor">        default  (none) \</span>
<a name="l00650"></a>00650 <span class="preprocessor">        shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l00651"></a>00651 <span class="preprocessor">                        rot1Real, rot1Imag, rot2Real, rot2Imag) \</span>
<a name="l00652"></a>00652 <span class="preprocessor">        private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span>
<a name="l00653"></a>00653 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00654"></a>00654 <span class="preprocessor"></span>        {
<a name="l00655"></a>00655 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00656"></a>00656 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00657"></a>00657 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00658"></a>00658 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00659"></a>00659                         <span class="comment">// store current state vector values in temp variables</span>
<a name="l00660"></a>00660                         stateRealUp = stateVecRealUp[thisTask];
<a name="l00661"></a>00661                         stateImagUp = stateVecImagUp[thisTask];
<a name="l00662"></a>00662 
<a name="l00663"></a>00663                         stateRealLo = stateVecRealLo[thisTask];
<a name="l00664"></a>00664                         stateImagLo = stateVecImagLo[thisTask];
<a name="l00665"></a>00665 
<a name="l00666"></a>00666                         stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp 
<a name="l00667"></a>00667                                 + rot2Real*stateRealLo - rot2Imag*stateImagLo;
<a name="l00668"></a>00668                         stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp 
<a name="l00669"></a>00669                                 + rot2Real*stateImagLo + rot2Imag*stateRealLo;
<a name="l00670"></a>00670                 }
<a name="l00671"></a>00671         }
<a name="l00672"></a>00672 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac134fb45b0a7248c5d15e16eb7139a35"></a><!-- doxytag: member="qubits.c::unitaryLocal" ref="ac134fb45b0a7248c5d15e16eb7139a35" args="(MultiQubit multiQubit, const int targetQubit, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void unitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00503">503</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00032">ComplexMatrix2::r0c0</a>, <a class="el" href="qubits_8h_source.html#l00032">ComplexMatrix2::r0c1</a>, <a class="el" href="qubits_8h_source.html#l00033">ComplexMatrix2::r1c0</a>, <a class="el" href="qubits_8h_source.html#l00033">ComplexMatrix2::r1c1</a>, <a class="el" href="qubits_8h_source.html#l00024">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00113">unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00504"></a>00504 {
<a name="l00505"></a>00505         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l00506"></a>00506         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l00507"></a>00507              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l00508"></a>00508 
<a name="l00509"></a>00509         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00510"></a>00510         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l00511"></a>00511         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l00512"></a>00512 
<a name="l00513"></a>00513         <span class="comment">// set dimensions</span>
<a name="l00514"></a>00514         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l00515"></a>00515         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l00516"></a>00516 
<a name="l00517"></a>00517         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l00518"></a>00518         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00519"></a>00519         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00520"></a>00520 
<a name="l00521"></a>00521 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00522"></a>00522 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00523"></a>00523 <span class="preprocessor">        default  (none) \</span>
<a name="l00524"></a>00524 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, u) \</span>
<a name="l00525"></a>00525 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span>
<a name="l00526"></a>00526 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00527"></a>00527 <span class="preprocessor"></span>        {
<a name="l00528"></a>00528 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00529"></a>00529 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00530"></a>00530 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00531"></a>00531 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00532"></a>00532 
<a name="l00533"></a>00533                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l00534"></a>00534                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l00535"></a>00535                         indexLo     = indexUp + sizeHalfBlock;
<a name="l00536"></a>00536 
<a name="l00537"></a>00537                         <span class="comment">// store current state vector values in temp variables</span>
<a name="l00538"></a>00538                         stateRealUp = stateVecReal[indexUp];
<a name="l00539"></a>00539                         stateImagUp = stateVecImag[indexUp];
<a name="l00540"></a>00540 
<a name="l00541"></a>00541                         stateRealLo = stateVecReal[indexLo];
<a name="l00542"></a>00542                         stateImagLo = stateVecImag[indexLo];
<a name="l00543"></a>00543 
<a name="l00544"></a>00544 
<a name="l00545"></a>00545                         <span class="comment">// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]</span>
<a name="l00546"></a>00546                         stateVecReal[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp 
<a name="l00547"></a>00547                                 + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo - u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;
<a name="l00548"></a>00548                         stateVecImag[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp 
<a name="l00549"></a>00549                                 + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;
<a name="l00550"></a>00550 
<a name="l00551"></a>00551                         <span class="comment">// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]</span>
<a name="l00552"></a>00552                         stateVecReal[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp  - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp 
<a name="l00553"></a>00553                                 + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo  -  u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;
<a name="l00554"></a>00554                         stateVecImag[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp 
<a name="l00555"></a>00555                                 + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;
<a name="l00556"></a>00556 
<a name="l00557"></a>00557                 } 
<a name="l00558"></a>00558         }
<a name="l00559"></a>00559 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae2b2c14a07dd7d50ff86032a3ca101d7"></a><!-- doxytag: member="qubits.c::validateAlphaBeta" ref="ae2b2c14a07dd7d50ff86032a3ca101d7" args="(Complex alpha, Complex beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int validateAlphaBeta </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00369">369</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00024">Complex::real</a>, and <a class="el" href="precision_8h_source.html#l00028">REAL_EPS</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00104">compactUnitary()</a>, and <a class="el" href="qubits__env__local_8c_source.html#l00122">controlledCompactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00369"></a>00369                                                   {
<a name="l00370"></a>00370         <span class="keywordflow">if</span> ( fabs(alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> 
<a name="l00371"></a>00371                 + alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00372"></a>00372                 + beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> 
<a name="l00373"></a>00373                 + beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> - 1) &gt; <a class="code" href="precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;
<a name="l00374"></a>00374         <span class="keywordflow">else</span> <span class="keywordflow">return</span> 1;
<a name="l00375"></a>00375 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae4fea133d1a8f09ff8da03038100adb2"></a><!-- doxytag: member="qubits.c::validateMatrixIsUnitary" ref="ae4fea133d1a8f09ff8da03038100adb2" args="(ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int validateMatrixIsUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00344">344</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00032">ComplexMatrix2::r0c0</a>, <a class="el" href="qubits_8h_source.html#l00032">ComplexMatrix2::r0c1</a>, <a class="el" href="qubits_8h_source.html#l00033">ComplexMatrix2::r1c0</a>, <a class="el" href="qubits_8h_source.html#l00033">ComplexMatrix2::r1c1</a>, <a class="el" href="qubits_8h_source.html#l00024">Complex::real</a>, and <a class="el" href="precision_8h_source.html#l00028">REAL_EPS</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00133">controlledUnitary()</a>, <a class="el" href="qubits__env__local_8c_source.html#l00143">multiControlledUnitary()</a>, and <a class="el" href="qubits__env__local_8c_source.html#l00113">unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00344"></a>00344                                              {
<a name="l00345"></a>00345 
<a name="l00346"></a>00346         <span class="keywordflow">if</span> ( fabs(u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> 
<a name="l00347"></a>00347                 + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00348"></a>00348                 + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>
<a name="l00349"></a>00349                 + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> - 1) &gt; <a class="code" href="precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;
<a name="l00350"></a>00350     <span class="comment">// check</span>
<a name="l00351"></a>00351         <span class="keywordflow">if</span> ( fabs(u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> 
<a name="l00352"></a>00352                 + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00353"></a>00353                 + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>
<a name="l00354"></a>00354                 + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> - 1) &gt; <a class="code" href="precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;
<a name="l00355"></a>00355 
<a name="l00356"></a>00356         <span class="keywordflow">if</span> ( fabs(u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> 
<a name="l00357"></a>00357                 + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00358"></a>00358                 + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>
<a name="l00359"></a>00359                 + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>) &gt; <a class="code" href="precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;
<a name="l00360"></a>00360 
<a name="l00361"></a>00361         <span class="keywordflow">if</span> ( fabs(u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00362"></a>00362                 - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00363"></a>00363                 + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00364"></a>00364                 - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>) &gt; <a class="code" href="precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;
<a name="l00365"></a>00365 
<a name="l00366"></a>00366         <span class="keywordflow">return</span> 1;
<a name="l00367"></a>00367 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a71c14976f63cfcda70026fa20ee531fe"></a><!-- doxytag: member="qubits.c::validateUnitVector" ref="a71c14976f63cfcda70026fa20ee531fe" args="(REAL ux, REAL uy, REAL uz)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int validateUnitVector </td>
          <td>(</td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>ux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>uy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>uz</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00377">377</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="precision_8h_source.html#l00028">REAL_EPS</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00377"></a>00377                                                  {
<a name="l00378"></a>00378         <span class="keywordflow">if</span> ( fabs(sqrt(ux*ux + uy*uy + uz*uz) - 1) &gt; <a class="code" href="precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;
<a name="l00379"></a>00379         <span class="keywordflow">else</span> <span class="keywordflow">return</span> 1;
<a name="l00380"></a>00380 }
</pre></div></p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="aac1637696885c75b73a1ecf381cea713"></a><!-- doxytag: member="qubits.c::errorCodes" ref="aac1637696885c75b73a1ecf381cea713" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="qubits__internal_8h.html#aac1637696885c75b73a1ecf381cea713">errorCodes</a>[]</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
    <span class="stringliteral">&quot;Success&quot;</span>,                                              
    <span class="stringliteral">&quot;Invalid target qubit. Note qubits are zero indexed.&quot;</span>,  
    <span class="stringliteral">&quot;Invalid control qubit. Note qubits are zero indexed.&quot;</span>, 
    <span class="stringliteral">&quot;Control qubit cannot equal target qubit.&quot;</span>,             
    <span class="stringliteral">&quot;Invalid number of control qubits&quot;</span>,                     
    <span class="stringliteral">&quot;Invalid unitary matrix.&quot;</span>,                              
    <span class="stringliteral">&quot;Invalid rotation arguments.&quot;</span>,                          
    <span class="stringliteral">&quot;Invalid system size. Cannot print output for systems greater than 5 qubits.&quot;</span>, 
    <span class="stringliteral">&quot;Can&apos;t collapse to state with zero probability.&quot;</span>, 
    <span class="stringliteral">&quot;Invalid number of qubits.&quot;</span>, 
    <span class="stringliteral">&quot;Invalid measurement outcome -- must be either 0 or 1.&quot;</span> 
}
</pre></div>
<p>Definition at line <a class="el" href="qubits_8c_source.html#l00020">20</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00238">exitWithError()</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 28 Mar 2018 for Distributed QuEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
