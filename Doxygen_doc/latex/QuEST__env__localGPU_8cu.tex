\hypertarget{QuEST__env__localGPU_8cu}{}\subsection{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu File Reference}
\label{QuEST__env__localGPU_8cu}\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}


An implementation of the A\+PI in qubits.\+h for a local (non-\/\+M\+PI) environment.  


{\ttfamily \#include \char`\"{}../\+Qu\+E\+S\+T.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}../\+Qu\+E\+S\+T\+\_\+precision.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}../mt19937ar.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Qu\+E\+S\+T\+\_\+internal.\+h\char`\"{}}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
\subsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{QuEST__env__localGPU_8cu_ad72dbcf6d0153db1b8d8a58001feed83}{D\+E\+B\+UG}}~0
\item 
\#define \mbox{\hyperlink{QuEST__env__localGPU_8cu_aa57d77a0903e334e963c66ddc5ed3f53}{R\+E\+D\+U\+C\+E\+\_\+\+S\+H\+A\+R\+E\+D\+\_\+\+S\+I\+ZE}}~512
\end{DoxyCompactItemize}
\subsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} \mbox{\hyperlink{QuEST__env__localGPU_8cu_a818a4c7cd7252d2b10b896b12fa431d3}{calc\+Total\+Probability}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit)
\begin{DoxyCompactList}\small\item\em Calculate the probability of being in any state by taking the norm of the entire state vector. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_abd4bc926cd3f9b65610bb228d0c59fe0}{close\+Qu\+E\+S\+T\+Env}} (\mbox{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}} \mbox{\hyperlink{runTests_8c_a5fd8ba97fcae3408ae6221dfc3cc1f93}{env}})
\begin{DoxyCompactList}\small\item\em Close Qu\+E\+ST environment. \end{DoxyCompactList}\item 
\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} \mbox{\hyperlink{QuEST__env__localGPU_8cu_a07418ebac70fd9ae5d051d089961631d}{collapse\+To\+Outcome}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int measure\+Qubit, int outcome)
\begin{DoxyCompactList}\small\item\em Updates the state vector to be consistent with measuring the measure qubit in the given outcome (0 or 1), and returns the probability of such a measurement outcome. \end{DoxyCompactList}\item 
\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{QuEST__env__localGPU_8cu_ab9c5c19b3bd2ac5d1ac4506fa21c1c84}{collapse\+To\+Outcome\+Kernel}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, int measure\+Qubit, \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} total\+Probability, int outcome)
\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a03b13dfcabd8c59b50dbdd3af44ba8b2}{compact\+Unitary}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int target\+Qubit, \mbox{\hyperlink{structComplex}{Complex}} alpha, \mbox{\hyperlink{structComplex}{Complex}} beta)
\begin{DoxyCompactList}\small\item\em Apply a single-\/qubit unitary parameterised by two given complex scalars. \end{DoxyCompactList}\item 
\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{QuEST__env__localGPU_8cu_aec6ec83ed63a7848ddb8f16c88846d25}{compact\+Unitary\+Kernel}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int rot\+Qubit, \mbox{\hyperlink{structComplex}{Complex}} alpha, \mbox{\hyperlink{structComplex}{Complex}} beta)
\item 
int \mbox{\hyperlink{QuEST__env__localGPU_8cu_a793584932ae384c82e7e42db7d35d18d}{compare\+States}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} mq1, \mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} mq2, \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} precision)
\begin{DoxyCompactList}\small\item\em Return whether two given wavefunctions are equivalent within a given precision Global phase included in equivalence check. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_ab4812953bc457405b3aa05a4c2f64f4a}{controlled\+Compact\+Unitary}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int control\+Qubit, const int target\+Qubit, \mbox{\hyperlink{structComplex}{Complex}} alpha, \mbox{\hyperlink{structComplex}{Complex}} beta)
\begin{DoxyCompactList}\small\item\em Apply a controlled unitary (single control, single target) parameterised by two given complex scalars. \end{DoxyCompactList}\item 
\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{QuEST__env__localGPU_8cu_ac9af28ce6412c545805c6275ad7636d5}{controlled\+Compact\+Unitary\+Kernel}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int control\+Qubit, const int target\+Qubit, \mbox{\hyperlink{structComplex}{Complex}} alpha, \mbox{\hyperlink{structComplex}{Complex}} beta)
\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a67576895bbc65463481a8ea24d9b1e22}{controlled\+Not}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int control\+Qubit, const int target\+Qubit)
\begin{DoxyCompactList}\small\item\em Apply the controlled not (single control, single target) gate, also known as the c-\/X, c-\/sigma-\/X, c-\/\+Pauli-\/X and c-\/bit-\/flip gate. \end{DoxyCompactList}\item 
\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a625723cfbffdde3b3b312f8573d530a3}{controlled\+Not\+Kernel}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int control\+Qubit, const int target\+Qubit)
\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a11a96159191cbf1b01a1080e7f045aac}{controlled\+Phase\+Gate}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int id\+Qubit1, const int id\+Qubit2)
\begin{DoxyCompactList}\small\item\em Apply the (two-\/qubit) controlled phase gate, also known as the controlled sigmaZ gate. \end{DoxyCompactList}\item 
\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a67313a10fc0760b39a5ce9ef1d505830}{controlled\+Phase\+Gate\+Kernel}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int id\+Qubit1, const int id\+Qubit2)
\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a8a701526263392599aa21d0d0f05d9d8}{controlled\+Unitary}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int control\+Qubit, const int target\+Qubit, \mbox{\hyperlink{structComplexMatrix2}{Complex\+Matrix2}} u)
\begin{DoxyCompactList}\small\item\em Apply a general controlled unitary (single control, single target), which can include a global phase factor. \end{DoxyCompactList}\item 
\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a8e75679cf6d66e11507ee227ab584473}{controlled\+Unitary\+Kernel}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int control\+Qubit, const int target\+Qubit, \mbox{\hyperlink{structComplexMatrix2}{Complex\+Matrix2}} u)
\item 
\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a250e9d66ad94ed2682e76a3c7502c8e1}{copy\+Shared\+Reduce\+Block}} (\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$array\+In, \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$reduced\+Array, int length)
\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a0d255fec1e375244d4cb980fac92621d}{copy\+State\+From\+G\+PU}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit)
\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a5b8880e65a521b4f6445af21b68d88ef}{copy\+State\+To\+G\+PU}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit)
\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a9c02591bc64c2918503afa231d90d83f}{create\+Multi\+Qubit}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} $\ast$multi\+Qubit, int num\+Qubits, \mbox{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}} \mbox{\hyperlink{runTests_8c_a5fd8ba97fcae3408ae6221dfc3cc1f93}{env}})
\begin{DoxyCompactList}\small\item\em Create a \mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} object representing a set of qubits. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_ae5d6acc322314d7a3d8a2eccf00d3b19}{destroy\+Multi\+Qubit}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, \mbox{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}} \mbox{\hyperlink{runTests_8c_a5fd8ba97fcae3408ae6221dfc3cc1f93}{env}})
\begin{DoxyCompactList}\small\item\em Deallocate a \mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} object representing a set of qubits. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_ae5f9019826f35e8b51b1716cfe397b45}{exit\+With\+Error}} (int error\+Code, const char $\ast$func)
\item 
static \+\_\+\+\_\+device\+\_\+\+\_\+ int \mbox{\hyperlink{QuEST__env__localGPU_8cu_a6ffa51987d8ad8f6c0fc07fd3492277f}{extract\+Bit}} (int location\+Of\+Bit\+From\+Right, long long int the\+Encoded\+Number)
\item 
\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} \mbox{\hyperlink{QuEST__env__localGPU_8cu_ad315c941a51bc053d39ebfa2040fd32e}{find\+Probability\+Of\+Outcome}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int measure\+Qubit, int outcome)
\begin{DoxyCompactList}\small\item\em Gives the probability of a specified qubit being measured in the given outcome (0 or 1). \end{DoxyCompactList}\item 
\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} \mbox{\hyperlink{QuEST__env__localGPU_8cu_a2e4cedb70bd181d250b3abb945cc108e}{find\+Probability\+Of\+Zero}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int measure\+Qubit)
\begin{DoxyCompactList}\small\item\em Measure the probability of a specified qubit being in the zero state. \end{DoxyCompactList}\item 
\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{QuEST__env__localGPU_8cu_aa9d9643aec790baf66e6322e591ebfd6}{find\+Probability\+Of\+Zero\+Kernel}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int measure\+Qubit, \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$reduced\+Array)
\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a8f10aabf9f607f19093aee54630caa21}{get\+Environment\+String}} (\mbox{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}} \mbox{\hyperlink{runTests_8c_a5fd8ba97fcae3408ae6221dfc3cc1f93}{env}}, \mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, char str\mbox{[}200\mbox{]})
\item 
\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3615f76fd5f57008d9b74bbd10533dd0}{get\+Imag\+Amp\+El}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, long long int index)
\begin{DoxyCompactList}\small\item\em Get the imaginary component of the complex probability amplitude at an index in the state vector. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{QuEST__env__localGPU_8cu_a112c74b3365bda6697813d9931b55377}{get\+Num\+Reduction\+Levels}} (long long int num\+Values\+To\+Reduce, int num\+Reduced\+Per\+Level)
\item 
\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} \mbox{\hyperlink{QuEST__env__localGPU_8cu_a317b786f577fa6bc136ea7f0ee7330a7}{get\+Real\+Amp\+El}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, long long int index)
\begin{DoxyCompactList}\small\item\em Get the real component of the complex probability amplitude at an index in the state vector. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{QuEST__env__localGPU_8cu_a0aabd5ed69a74e5bc0b46a17af45c886}{G\+P\+U\+Exists}} (void)
\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_aa09b5dd93de6df1384b8f2c0041749ab}{hadamard}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int target\+Qubit)
\begin{DoxyCompactList}\small\item\em Apply the single-\/qubit Hadamard gate. \end{DoxyCompactList}\item 
\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{QuEST__env__localGPU_8cu_aca19ea42f8ff8d21871394db3a7a2a2a}{hadamard\+Kernel}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int target\+Qubit)
\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_ae1b983b41249836ed2c2a81f77d83c40}{init\+Classical\+State}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, long long int state\+Ind)
\begin{DoxyCompactList}\small\item\em Initialise a set of $ N $ qubits to the classical state with index {\ttfamily state\+Ind}. \end{DoxyCompactList}\item 
void \+\_\+\+\_\+global\+\_\+\+\_\+ \mbox{\hyperlink{QuEST__env__localGPU_8cu_a5ffdb83d58185c1caf2ef0675d9c4ad6}{init\+Classical\+State\+Kernel}} (long long int state\+Vec\+Size, \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$state\+Vec\+Real, \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$state\+Vec\+Imag, long long int state\+Ind)
\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a433876ee9f3bcc54af346300f571fc3c}{initialize\+State\+From\+Single\+File}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} $\ast$multi\+Qubit, char filename\mbox{[}200\mbox{]}, \mbox{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}} \mbox{\hyperlink{runTests_8c_a5fd8ba97fcae3408ae6221dfc3cc1f93}{env}})
\begin{DoxyCompactList}\small\item\em Initialises the wavefunction amplitudes according to those specified in a file. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_ad84a3ce68d1ca02b4e3f741ea45b6054}{init\+Qu\+E\+S\+T\+Env}} (\mbox{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}} $\ast$\mbox{\hyperlink{runTests_8c_a5fd8ba97fcae3408ae6221dfc3cc1f93}{env}})
\begin{DoxyCompactList}\small\item\em Initialize the Qu\+E\+ST environment. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a4b737ff9b4267609ef27e6cb4c42dc68}{init\+State\+Debug}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit)
\begin{DoxyCompactList}\small\item\em Initialise the state vector of probability amplitudes to an (unphysical) state with each component of each probability amplitude a unique floating point value. \end{DoxyCompactList}\item 
void \+\_\+\+\_\+global\+\_\+\+\_\+ \mbox{\hyperlink{QuEST__env__localGPU_8cu_a2f83bb3e7c5408d3a19161e9f0be6e35}{init\+State\+Debug\+Kernel}} (long long int state\+Vec\+Size, \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$state\+Vec\+Real, \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$state\+Vec\+Imag)
\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a7169fd0442cbc3418f3fac4d13363ca2}{init\+State\+Of\+Single\+Qubit}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} $\ast$multi\+Qubit, int qubit\+Id, int outcome)
\begin{DoxyCompactList}\small\item\em Initialise the state vector of probability amplitudes such that one qubit is set to \textquotesingle{}outcome\textquotesingle{} and all other qubits are in an equal superposition of zero and one. \end{DoxyCompactList}\item 
void \+\_\+\+\_\+global\+\_\+\+\_\+ \mbox{\hyperlink{QuEST__env__localGPU_8cu_a1eb51dd82f1cbbef94d3cb7d2ca73e28}{init\+State\+Of\+Single\+Qubit\+Kernel}} (long long int state\+Vec\+Size, \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$state\+Vec\+Real, \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$state\+Vec\+Imag, int qubit\+Id, int outcome)
\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_af8a0082e2f695145bbfbb572e4c2e4f1}{init\+State\+Plus}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit)
\begin{DoxyCompactList}\small\item\em Initialise a set of $ N $ qubits to the plus state $ {| + \rangle}^{\otimes N} = \frac{1}{\sqrt{2^N}} (| 0 \rangle + | 1 \rangle)^{\otimes N} $. \end{DoxyCompactList}\item 
void \+\_\+\+\_\+global\+\_\+\+\_\+ \mbox{\hyperlink{QuEST__env__localGPU_8cu_abddc47ea8fe014ed09dc82542bcbfe6f}{init\+State\+Plus\+Kernel}} (long long int state\+Vec\+Size, \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$state\+Vec\+Real, \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$state\+Vec\+Imag)
\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a9ba8171c9ec5c42202b144026527e9ec}{init\+State\+Zero}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit)
\begin{DoxyCompactList}\small\item\em Initialise a set of $ N $ qubits to the classical zero state $ {| 0 \rangle}^{\otimes N} $. \end{DoxyCompactList}\item 
void \+\_\+\+\_\+global\+\_\+\+\_\+ \mbox{\hyperlink{QuEST__env__localGPU_8cu_aa6b649062c49c37ac93aac0d6be6eedd}{init\+State\+Zero\+Kernel}} (long long int state\+Vec\+Size, \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$state\+Vec\+Real, \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$state\+Vec\+Imag)
\item 
\+\_\+\+\_\+device\+\_\+\+\_\+ \+\_\+\+\_\+host\+\_\+\+\_\+ unsigned int \mbox{\hyperlink{QuEST__env__localGPU_8cu_a8ce1e311ea72b862a8757dc71082fbf3}{log2\+Int}} (unsigned int x)
\item 
int \mbox{\hyperlink{QuEST__env__localGPU_8cu_ad5774247d836267175c664cd0e451bcb}{measure}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, int measure\+Qubit)
\begin{DoxyCompactList}\small\item\em Measures a single qubit, collapsing it randomly to 0 or 1. \end{DoxyCompactList}\item 
\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} \mbox{\hyperlink{QuEST__env__localGPU_8cu_a21094de735f3cb48488a184cfa4d8d41}{measure\+In\+Zero}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int measure\+Qubit)
\begin{DoxyCompactList}\small\item\em Update the state vector to be consistent with measuring measure\+Qubit=0. \end{DoxyCompactList}\item 
\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a8f87a4777c69c875fece83d4b5eb29ba}{measure\+In\+Zero\+Kernel}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, int measure\+Qubit, \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} total\+Probability)
\item 
int \mbox{\hyperlink{QuEST__env__localGPU_8cu_a2ac46e470c750bf93c754e06c64b0a7a}{measure\+With\+Stats}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, int measure\+Qubit, \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$state\+Prob)
\begin{DoxyCompactList}\small\item\em Measures a single qubit, collapsing it randomly to 0 or 1, and additionally gives the probability of that outcome. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_afc1835c6b43b6e59ce7df7b13f274fc7}{multi\+Controlled\+Phase\+Gate}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, int $\ast$control\+Qubits, int num\+Control\+Qubits)
\begin{DoxyCompactList}\small\item\em Apply the multiple-\/qubit controlled phase gate, also known as the multiple-\/qubit controlled sigmaZ gate. \end{DoxyCompactList}\item 
\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a31833a4edc084f5bcdbf10ee6845064a}{multi\+Controlled\+Phase\+Gate\+Kernel}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, long long int mask)
\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_aa29551d2d5c883891faa75a4741dc71a}{multi\+Controlled\+Unitary}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, int $\ast$control\+Qubits, int num\+Control\+Qubits, const int target\+Qubit, \mbox{\hyperlink{structComplexMatrix2}{Complex\+Matrix2}} u)
\begin{DoxyCompactList}\small\item\em Apply a general multiple-\/control single-\/target unitary, which can include a global phase factor. \end{DoxyCompactList}\item 
\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{QuEST__env__localGPU_8cu_af76f428eec6053839eb228152a51b5e3}{multi\+Controlled\+Unitary\+Kernel}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, long long int mask, const int target\+Qubit, \mbox{\hyperlink{structComplexMatrix2}{Complex\+Matrix2}} u)
\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_aae7a8a7f1ccbddb7f76b6c52b746bb43}{phase\+Gate}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int target\+Qubit, enum \mbox{\hyperlink{QuEST_8h_a5739021c733cecc49647956b2f7338ea}{phase\+Gate\+Type}} type)
\item 
\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{QuEST__env__localGPU_8cu_aaf4f43971c469524f45d3bbc6d5f1167}{phase\+Gate\+Kernel}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int target\+Qubit, enum \mbox{\hyperlink{QuEST_8h_a5739021c733cecc49647956b2f7338ea}{phase\+Gate\+Type}} type)
\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{Qu\+E\+S\+T\+Assert}} (int is\+Valid, int error\+Code, const char $\ast$func)
\item 
\+\_\+\+\_\+device\+\_\+\+\_\+ void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a4c740fa3ae25c71c1736790c674bdc98}{reduce\+Block}} (\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$array\+In, \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$reduced\+Array, int length)
\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_af8a14ae79c3fb2c0b5f6255cc37bebf9}{report\+Qu\+E\+S\+T\+Env}} (\mbox{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}} \mbox{\hyperlink{runTests_8c_a5fd8ba97fcae3408ae6221dfc3cc1f93}{env}})
\begin{DoxyCompactList}\small\item\em Report information about the Qu\+E\+ST environment. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a842d6884e063a5865a2232cba56b65ac}{report\+State\+To\+Screen}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, \mbox{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}} \mbox{\hyperlink{runTests_8c_a5fd8ba97fcae3408ae6221dfc3cc1f93}{env}}, int report\+Rank)
\begin{DoxyCompactList}\small\item\em Print the current state vector of probability amplitudes for a set of qubits to standard out. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a86e396e06b7d527cac20ba0108872423}{sigmaX}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int target\+Qubit)
\begin{DoxyCompactList}\small\item\em Apply the single-\/qubit sigma-\/X (also known as the X, Pauli-\/X, N\+OT or bit-\/flip) gate. \end{DoxyCompactList}\item 
\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{QuEST__env__localGPU_8cu_ad43da9e3fa8837956a5ea17f2259d65e}{sigma\+X\+Kernel}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int target\+Qubit)
\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a1f54d70a42403f7e1c2e2c2007332f61}{sigmaY}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int target\+Qubit)
\begin{DoxyCompactList}\small\item\em Apply the single-\/qubit sigma-\/Y (also known as the Y or Pauli-\/Y) gate. \end{DoxyCompactList}\item 
\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{QuEST__env__localGPU_8cu_ac4766903f6ff9c70f6c957aa3d0a5c5f}{sigma\+Y\+Kernel}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int target\+Qubit)
\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_aac328dfe6dd7cceec36a83d989b180b6}{swap\+Double}} (\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$$\ast$a, \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$$\ast$b)
\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a8d31fe2d1ad4d01e2a1f5f6b8bc15b77}{sync\+Qu\+E\+S\+T\+Env}} (\mbox{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}} \mbox{\hyperlink{runTests_8c_a5fd8ba97fcae3408ae6221dfc3cc1f93}{env}})
\begin{DoxyCompactList}\small\item\em Guarantees that all code up to the given point has been executed on all nodes (if running in distributed mode) \end{DoxyCompactList}\item 
int \mbox{\hyperlink{QuEST__env__localGPU_8cu_ac7e38d768a1bd79019f88cc1e6295092}{sync\+Qu\+E\+S\+T\+Success}} (int success\+Code)
\begin{DoxyCompactList}\small\item\em Performs a logical A\+ND on all success\+Codes held by all processes. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a7a0877e33700f6bad48adb51b7b3fb67}{unitary}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int target\+Qubit, \mbox{\hyperlink{structComplexMatrix2}{Complex\+Matrix2}} u)
\begin{DoxyCompactList}\small\item\em Apply a general single-\/qubit unitary (including a global phase factor). \end{DoxyCompactList}\item 
\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{QuEST__env__localGPU_8cu_a266ad950d573d78d37df09828d63de17}{unitary\+Kernel}} (\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} multi\+Qubit, const int target\+Qubit, \mbox{\hyperlink{structComplexMatrix2}{Complex\+Matrix2}} u)
\end{DoxyCompactItemize}


\subsubsection{Detailed Description}
An implementation of the A\+PI in qubits.\+h for a local (non-\/\+M\+PI) environment. 



\subsubsection{Macro Definition Documentation}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_ad72dbcf6d0153db1b8d8a58001feed83}\label{QuEST__env__localGPU_8cu_ad72dbcf6d0153db1b8d8a58001feed83}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!D\+E\+B\+UG@{D\+E\+B\+UG}}
\index{D\+E\+B\+UG@{D\+E\+B\+UG}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{D\+E\+B\+UG}{DEBUG}}
{\footnotesize\ttfamily \#define D\+E\+B\+UG~0}



Definition at line 17 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



Referenced by copy\+State\+From\+G\+P\+U(), and copy\+State\+To\+G\+P\+U().

\mbox{\Hypertarget{QuEST__env__localGPU_8cu_aa57d77a0903e334e963c66ddc5ed3f53}\label{QuEST__env__localGPU_8cu_aa57d77a0903e334e963c66ddc5ed3f53}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!R\+E\+D\+U\+C\+E\+\_\+\+S\+H\+A\+R\+E\+D\+\_\+\+S\+I\+ZE@{R\+E\+D\+U\+C\+E\+\_\+\+S\+H\+A\+R\+E\+D\+\_\+\+S\+I\+ZE}}
\index{R\+E\+D\+U\+C\+E\+\_\+\+S\+H\+A\+R\+E\+D\+\_\+\+S\+I\+ZE@{R\+E\+D\+U\+C\+E\+\_\+\+S\+H\+A\+R\+E\+D\+\_\+\+S\+I\+ZE}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{R\+E\+D\+U\+C\+E\+\_\+\+S\+H\+A\+R\+E\+D\+\_\+\+S\+I\+ZE}{REDUCE\_SHARED\_SIZE}}
{\footnotesize\ttfamily \#define R\+E\+D\+U\+C\+E\+\_\+\+S\+H\+A\+R\+E\+D\+\_\+\+S\+I\+ZE~512}



Definition at line 16 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



Referenced by create\+Multi\+Qubit(), and find\+Probability\+Of\+Zero().



\subsubsection{Function Documentation}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a818a4c7cd7252d2b10b896b12fa431d3}\label{QuEST__env__localGPU_8cu_a818a4c7cd7252d2b10b896b12fa431d3}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!calc\+Total\+Probability@{calc\+Total\+Probability}}
\index{calc\+Total\+Probability@{calc\+Total\+Probability}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{calc\+Total\+Probability()}{calcTotalProbability()}}
{\footnotesize\ttfamily \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} calc\+Total\+Probability (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit }\end{DoxyParamCaption})}



Calculate the probability of being in any state by taking the norm of the entire state vector. 

Should be equal to 1.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em multi\+Qubit} & object representing a set of qubits \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
total probability 
\end{DoxyReturn}


Definition at line 394 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References copy\+State\+From\+G\+P\+U(), Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Complex\+Array\+::real, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
394                                                 \{
395     \textcolor{comment}{/* IJB - implemented using Kahan summation for greater accuracy at a slight floating}
396 \textcolor{comment}{       point operation overhead. For more details see https://en.wikipedia.org/wiki/
      Kahan\_summation\_algorithm */}
397     \textcolor{comment}{/* Don't change the bracketing in this routine! */}
398     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} pTotal=0;
399     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} y, t, c;
400     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
401     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numAmpsPerRank = multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}};
402 
403     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a0d255fec1e375244d4cb980fac92621d}{copyStateFromGPU}}(multiQubit);
404 
405     c = 0.0;
406     \textcolor{keywordflow}{for} (index=0; index<numAmpsPerRank; index++)\{
407         \textcolor{comment}{/* Perform pTotal+=multiQubit.stateVec.real[index]*multiQubit.stateVec.real[index]; by Kahan */}
408         \textcolor{comment}{// pTotal+=multiQubit.stateVec.real[index]*multiQubit.stateVec.real[index];}
409 
410         y = multiQubit.\mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}}[index]*multiQubit.\mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.
      \mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}}[index] - c;
411         t = pTotal + y;
412         c = ( t - pTotal ) - y;
413         pTotal = t;
414 
415         \textcolor{comment}{/* Perform pTotal+=multiQubit.stateVec.imag[index]*multiQubit.stateVec.imag[index]; by Kahan */}
416         \textcolor{comment}{//pTotal+=multiQubit.stateVec.imag[index]*multiQubit.stateVec.imag[index];}
417 
418 
419         y = multiQubit.\mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}}[index]*multiQubit.\mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.
      \mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}}[index] - c;
420         t = pTotal + y;
421         c = ( t - pTotal ) - y;
422         pTotal = t;
423 
424 
425     \}
426     \textcolor{keywordflow}{return} pTotal;
427 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_abd4bc926cd3f9b65610bb228d0c59fe0}\label{QuEST__env__localGPU_8cu_abd4bc926cd3f9b65610bb228d0c59fe0}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!close\+Qu\+E\+S\+T\+Env@{close\+Qu\+E\+S\+T\+Env}}
\index{close\+Qu\+E\+S\+T\+Env@{close\+Qu\+E\+S\+T\+Env}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{close\+Qu\+E\+S\+T\+Env()}{closeQuESTEnv()}}
{\footnotesize\ttfamily void close\+Qu\+E\+S\+T\+Env (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}}}]{env }\end{DoxyParamCaption})}



Close Qu\+E\+ST environment. 

If something needs to be done to clean up the execution environment, such as finalizing M\+PI when running in distributed mode, it is handled here


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em env} & object representing the execution environment. A single instance is used for each program \\
\hline
\end{DoxyParams}


Definition at line 125 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.


\begin{DoxyCode}
125                                 \{
126     \textcolor{comment}{// MPI finalize goes here in MPI version. Call this function anyway for consistency}
127 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a07418ebac70fd9ae5d051d089961631d}\label{QuEST__env__localGPU_8cu_a07418ebac70fd9ae5d051d089961631d}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!collapse\+To\+Outcome@{collapse\+To\+Outcome}}
\index{collapse\+To\+Outcome@{collapse\+To\+Outcome}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{collapse\+To\+Outcome()}{collapseToOutcome()}}
{\footnotesize\ttfamily \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} collapse\+To\+Outcome (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{measure\+Qubit,  }\item[{int}]{outcome }\end{DoxyParamCaption})}



Updates the state vector to be consistent with measuring the measure qubit in the given outcome (0 or 1), and returns the probability of such a measurement outcome. 

This is effectively performing a measurement and forcing the outcome. This is an irreversible change to the state vector, whereby incompatible states in the state vector are given zero amplitude and the remaining states are renormalised. Exits with error if the given outcome has $\sim$zero probability, and so cannot be collapsed into.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em measure\+Qubit} & qubit to measure \\
\hline
\mbox{\tt in}  & {\em outcome} & to force the measure qubit to enter \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
probability of the (forced) measurement outcome 
\end{DoxyReturn}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily measure\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}), or if {\ttfamily outcome} is not in \{0, 1\}, or if the probability of {\ttfamily outcome} is zero (within machine epsilon) \\
\hline
\end{DoxyExceptions}


Definition at line 1326 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References collapse\+To\+Outcome\+Local(), find\+Probability\+Of\+Outcome(), Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Multi\+Qubit\+::num\+Qubits, Qu\+E\+S\+T\+Assert(), R\+E\+AL, and R\+E\+A\+L\+\_\+\+E\+PS.


\begin{DoxyCode}
1327 \{        
1328     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(measureQubit >= 0 && measureQubit < multiQubit.
      \mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}}, 2, \_\_func\_\_);
1329     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}((outcome==0 || outcome==1), 10, \_\_func\_\_);
1330     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} stateProb;
1331     stateProb = \mbox{\hyperlink{QuEST__env__localGPU_8cu_ad315c941a51bc053d39ebfa2040fd32e}{findProbabilityOfOutcome}}(multiQubit, measureQubit, outcome);
1332     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(fabs(stateProb)>\mbox{\hyperlink{QuEST__precision_8h_aebb5e6716e06431296af4d1a71744dec}{REAL\_EPS}}, 8, \_\_func\_\_);
1333 
1334     \textcolor{keywordtype}{int} threadsPerCUDABlock, CUDABlocks;
1335     threadsPerCUDABlock = 128;
1336     CUDABlocks = ceil((\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})(multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1)/threadsPerCUDABlock);
1337     \textcolor{keywordflow}{if} (stateProb!=0) collapseToOutcomeKernel<<<CUDABlocks, threadsPerCUDABlock>>>(multiQubit, measureQubit
      , stateProb, outcome);
1338     \textcolor{keywordflow}{return} stateProb;
1339 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_ab9c5c19b3bd2ac5d1ac4506fa21c1c84}\label{QuEST__env__localGPU_8cu_ab9c5c19b3bd2ac5d1ac4506fa21c1c84}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!collapse\+To\+Outcome\+Kernel@{collapse\+To\+Outcome\+Kernel}}
\index{collapse\+To\+Outcome\+Kernel@{collapse\+To\+Outcome\+Kernel}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{collapse\+To\+Outcome\+Kernel()}{collapseToOutcomeKernel()}}
{\footnotesize\ttfamily \+\_\+\+\_\+global\+\_\+\+\_\+ void collapse\+To\+Outcome\+Kernel (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{int}]{measure\+Qubit,  }\item[{\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}}}]{total\+Probability,  }\item[{int}]{outcome }\end{DoxyParamCaption})}

fix -- this should report an error 

Definition at line 1265 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::device\+State\+Vec, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Multi\+Qubit\+::num\+Qubits, Complex\+Array\+::real, and R\+E\+AL.


\begin{DoxyCode}
1266 \{
1267     \textcolor{comment}{// ----- sizes}
1268     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} sizeBlock,                                           \textcolor{comment}{// size of blocks}
1269          sizeHalfBlock;                                       \textcolor{comment}{// size of blocks halved}
1270     \textcolor{comment}{// ----- indices}
1271     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisBlock,                                           \textcolor{comment}{// current block}
1272          index;                                               \textcolor{comment}{// current index for first half block}
1273     \textcolor{comment}{// ----- measured probability}
1274     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}}   renorm;                                    \textcolor{comment}{// probability (returned) value}
1275     \textcolor{comment}{// ----- temp variables}
1276     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisTask;                                   \textcolor{comment}{// task based approach for expose loop with
       small granularity}
1277     \textcolor{comment}{// (good for shared memory parallelism)}
1278     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numTasks=multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1;
1279 
1280     \textcolor{comment}{// ---------------------------------------------------------------- //}
1281     \textcolor{comment}{//            tests                                                 //}
1282     \textcolor{comment}{// ---------------------------------------------------------------- //}
1283 
1285     \textcolor{keywordflow}{if} (!(measureQubit >= 0 && measureQubit < multiQubit.\mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}})) \textcolor{keywordflow}{return};
1286     \textcolor{keywordflow}{if} (!(totalProbability != 0)) \textcolor{keywordflow}{return};
1287     \textcolor{comment}{// ---------------------------------------------------------------- //}
1288     \textcolor{comment}{//            dimensions                                            //}
1289     \textcolor{comment}{// ---------------------------------------------------------------- //}
1290     sizeHalfBlock = 1LL << (measureQubit);                       \textcolor{comment}{// number of state vector elements to sum,}
1291     \textcolor{comment}{// and then the number to skip}
1292     sizeBlock     = 2LL * sizeHalfBlock;                           \textcolor{comment}{// size of blocks (pairs of measure and
       skip entries)}
1293 
1294     \textcolor{comment}{// ---------------------------------------------------------------- //}
1295     \textcolor{comment}{//            find probability                                      //}
1296     \textcolor{comment}{// ---------------------------------------------------------------- //}
1297 
1298     \textcolor{comment}{//}
1299     \textcolor{comment}{// --- task-based shared-memory parallel implementation}
1300     \textcolor{comment}{//}
1301     renorm=1/sqrt(totalProbability);
1302     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecReal = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}};
1303     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecImag = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}};
1304 
1305     thisTask = blockIdx.x*blockDim.x + threadIdx.x;
1306     \textcolor{keywordflow}{if} (thisTask>=numTasks) \textcolor{keywordflow}{return};
1307     thisBlock = thisTask / sizeHalfBlock;
1308     index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
1309 
1310     \textcolor{keywordflow}{if} (outcome==0)\{
1311         stateVecReal[index]=stateVecReal[index]*renorm;
1312         stateVecImag[index]=stateVecImag[index]*renorm;
1313 
1314         stateVecReal[index+sizeHalfBlock]=0;
1315         stateVecImag[index+sizeHalfBlock]=0;
1316     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (outcome==1)\{
1317         stateVecReal[index]=0;
1318         stateVecImag[index]=0;
1319 
1320         stateVecReal[index+sizeHalfBlock]=stateVecReal[index+sizeHalfBlock]*renorm;
1321         stateVecImag[index+sizeHalfBlock]=stateVecImag[index+sizeHalfBlock]*renorm;
1322     \}
1323 
1324 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a03b13dfcabd8c59b50dbdd3af44ba8b2}\label{QuEST__env__localGPU_8cu_a03b13dfcabd8c59b50dbdd3af44ba8b2}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!compact\+Unitary@{compact\+Unitary}}
\index{compact\+Unitary@{compact\+Unitary}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{compact\+Unitary()}{compactUnitary()}}
{\footnotesize\ttfamily void compact\+Unitary (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{target\+Qubit,  }\item[{\mbox{\hyperlink{structComplex}{Complex}}}]{alpha,  }\item[{\mbox{\hyperlink{structComplex}{Complex}}}]{beta }\end{DoxyParamCaption})}



Apply a single-\/qubit unitary parameterised by two given complex scalars. 

Given valid complex numbers $\alpha$ and $\beta$, applies the unitary \[ U = \begin{pmatrix} \alpha & -\beta^* \\ \beta & \alpha^* \end{pmatrix} \] which is general up to a global phase factor. ~\newline
Valid $\alpha$, $\beta$ satisfy $|\alpha|^2 + |\beta|^2 = 1$.

\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {U}; \end{tikzpicture} } \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em target\+Qubit} & qubit to operate on \\
\hline
\mbox{\tt in}  & {\em alpha} & complex unitary parameter (row 1, column 1) \\
\hline
\mbox{\tt in}  & {\em beta} & complex unitary parameter (row 2, column 1) \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily target\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}), or if {\ttfamily alpha}, {\ttfamily beta} don\textquotesingle{}t satisfy $\vert${\ttfamily alpha$\vert$$^\wedge$2} + $\vert${\ttfamily beta$\vert$$^\wedge$2} = 1. \\
\hline
\end{DoxyExceptions}


Definition at line 485 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References compact\+Unitary\+Local(), Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Multi\+Qubit\+::num\+Qubits, Qu\+E\+S\+T\+Assert(), R\+E\+AL, and validate\+Alpha\+Beta().


\begin{DoxyCode}
486 \{
487     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(targetQubit >= 0 && targetQubit < multiQubit.
      \mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}}, 1, \_\_func\_\_);
488     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(\mbox{\hyperlink{QuEST_8c_ae2b2c14a07dd7d50ff86032a3ca101d7}{validateAlphaBeta}}(alpha, beta), 6, \_\_func\_\_);
489     \textcolor{keywordtype}{int} threadsPerCUDABlock, CUDABlocks;
490     threadsPerCUDABlock = 128;
491     CUDABlocks = ceil((\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})(multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1)/threadsPerCUDABlock);
492     compactUnitaryKernel<<<CUDABlocks, threadsPerCUDABlock>>>(multiQubit, targetQubit, alpha, beta);
493 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_aec6ec83ed63a7848ddb8f16c88846d25}\label{QuEST__env__localGPU_8cu_aec6ec83ed63a7848ddb8f16c88846d25}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!compact\+Unitary\+Kernel@{compact\+Unitary\+Kernel}}
\index{compact\+Unitary\+Kernel@{compact\+Unitary\+Kernel}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{compact\+Unitary\+Kernel()}{compactUnitaryKernel()}}
{\footnotesize\ttfamily \+\_\+\+\_\+global\+\_\+\+\_\+ void compact\+Unitary\+Kernel (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{rot\+Qubit,  }\item[{\mbox{\hyperlink{structComplex}{Complex}}}]{alpha,  }\item[{\mbox{\hyperlink{structComplex}{Complex}}}]{beta }\end{DoxyParamCaption})}

fix -- no necessary for G\+PU version 

Definition at line 430 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::device\+State\+Vec, Complex\+Array\+::imag, Complex\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Complex\+Array\+::real, R\+E\+AL, and Complex\+::real.


\begin{DoxyCode}
430                                                                                                            
        \{
431     \textcolor{comment}{// ----- sizes}
432     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} sizeBlock,                                           \textcolor{comment}{// size of blocks}
433          sizeHalfBlock;                                       \textcolor{comment}{// size of blocks halved}
434     \textcolor{comment}{// ----- indices}
435     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisBlock,                                           \textcolor{comment}{// current block}
436          indexUp,indexLo;                                     \textcolor{comment}{// current index and corresponding index in
       lower half block}
437 
438     \textcolor{comment}{// ----- temp variables}
439     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}}   stateRealUp,stateRealLo,                             \textcolor{comment}{// storage for previous state values}
440            stateImagUp,stateImagLo;                             \textcolor{comment}{// (used in updates)}
441     \textcolor{comment}{// ----- temp variables}
442     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisTask;                                   \textcolor{comment}{// task based approach for expose loop with
       small granularity}
443     \textcolor{keyword}{const} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numTasks=multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1;
444 
445     sizeHalfBlock = 1LL << rotQubit;                               \textcolor{comment}{// size of blocks halved}
446     sizeBlock     = 2LL * sizeHalfBlock;                           \textcolor{comment}{// size of blocks}
447 
448     \textcolor{comment}{// ---------------------------------------------------------------- //}
449     \textcolor{comment}{//            rotate                                                //}
450     \textcolor{comment}{// ---------------------------------------------------------------- //}
451 
453     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecReal = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}};
454     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecImag = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}};
455     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} alphaImag=alpha.\mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}, alphaReal=alpha.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}};
456     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} betaImag=beta.\mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}, betaReal=beta.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}};
457 
458     thisTask = blockIdx.x*blockDim.x + threadIdx.x;
459     \textcolor{keywordflow}{if} (thisTask>=numTasks) \textcolor{keywordflow}{return};
460 
461     thisBlock   = thisTask / sizeHalfBlock;
462     indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
463     indexLo     = indexUp + sizeHalfBlock;
464 
465     \textcolor{comment}{// store current state vector values in temp variables}
466     stateRealUp = stateVecReal[indexUp];
467     stateImagUp = stateVecImag[indexUp];
468 
469     stateRealLo = stateVecReal[indexLo];
470     stateImagLo = stateVecImag[indexLo];
471 
472     \textcolor{comment}{// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]}
473     stateVecReal[indexUp] = alphaReal*stateRealUp - alphaImag*stateImagUp 
474         - betaReal*stateRealLo - betaImag*stateImagLo;
475     stateVecImag[indexUp] = alphaReal*stateImagUp + alphaImag*stateRealUp 
476         - betaReal*stateImagLo + betaImag*stateRealLo;
477 
478     \textcolor{comment}{// state[indexLo] = beta  * state[indexUp] + conj(alpha) * state[indexLo]}
479     stateVecReal[indexLo] = betaReal*stateRealUp - betaImag*stateImagUp 
480         + alphaReal*stateRealLo + alphaImag*stateImagLo;
481     stateVecImag[indexLo] = betaReal*stateImagUp + betaImag*stateRealUp 
482         + alphaReal*stateImagLo - alphaImag*stateRealLo;
483 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a793584932ae384c82e7e42db7d35d18d}\label{QuEST__env__localGPU_8cu_a793584932ae384c82e7e42db7d35d18d}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!compare\+States@{compare\+States}}
\index{compare\+States@{compare\+States}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{compare\+States()}{compareStates()}}
{\footnotesize\ttfamily int compare\+States (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{mq1,  }\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{mq2,  }\item[{\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}}}]{precision }\end{DoxyParamCaption})}



Return whether two given wavefunctions are equivalent within a given precision Global phase included in equivalence check. 

For debugging purposes. 

Definition at line 375 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References copy\+State\+From\+G\+P\+U(), Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Complex\+Array\+::real, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
375                                                                  \{
376     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} diff;
377     \textcolor{keywordtype}{int} chunkSize = mq1.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}};
378 
379     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a0d255fec1e375244d4cb980fac92621d}{copyStateFromGPU}}(mq1);
380     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a0d255fec1e375244d4cb980fac92621d}{copyStateFromGPU}}(mq2);
381 
382     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0; i<chunkSize; i++)\{
383         diff = mq1.\mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}}[i] - mq2.\mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}}[i];
384         \textcolor{keywordflow}{if} (diff<0) diff *= -1;
385         \textcolor{keywordflow}{if} (diff>precision) \textcolor{keywordflow}{return} 0;
386         diff = mq1.\mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}}[i] - mq2.\mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}}[i];
387         \textcolor{keywordflow}{if} (diff<0) diff *= -1;
388         \textcolor{keywordflow}{if} (diff>precision) \textcolor{keywordflow}{return} 0;
389     \}
390     \textcolor{keywordflow}{return} 1;
391 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_ab4812953bc457405b3aa05a4c2f64f4a}\label{QuEST__env__localGPU_8cu_ab4812953bc457405b3aa05a4c2f64f4a}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!controlled\+Compact\+Unitary@{controlled\+Compact\+Unitary}}
\index{controlled\+Compact\+Unitary@{controlled\+Compact\+Unitary}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{controlled\+Compact\+Unitary()}{controlledCompactUnitary()}}
{\footnotesize\ttfamily void controlled\+Compact\+Unitary (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{control\+Qubit,  }\item[{const int}]{target\+Qubit,  }\item[{\mbox{\hyperlink{structComplex}{Complex}}}]{alpha,  }\item[{\mbox{\hyperlink{structComplex}{Complex}}}]{beta }\end{DoxyParamCaption})}



Apply a controlled unitary (single control, single target) parameterised by two given complex scalars. 

Given valid complex numbers $\alpha$ and $\beta$, applies the two-\/qubit unitary \[ \begin{pmatrix} 1 \\ & 1 \\ & & \alpha & -\beta^* \\ & & \beta & \alpha^* \end{pmatrix} \] to the control and target qubits. Valid $\alpha$, $\beta$ satisfy $|\alpha|^2 + |\beta|^2 = 1$. The target unitary is general up to a global phase factor. ~\newline
 \[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 1); \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$U_{\alpha, \beta}$}; \end{tikzpicture} } \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em control\+Qubit} & apply the target unitary if this qubit has value 1 \\
\hline
\mbox{\tt in}  & {\em target\+Qubit} & qubit on which to apply the target unitary \\
\hline
\mbox{\tt in}  & {\em alpha} & complex unitary parameter (row 1, column 1) \\
\hline
\mbox{\tt in}  & {\em beta} & complex unitary parameter (row 2, column 1) \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if either {\ttfamily control\+Qubit} or {\ttfamily target\+Qubit} are outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}) or are equal, or if {\ttfamily alpha}, {\ttfamily beta} don\textquotesingle{}t satisfy $\vert${\ttfamily alpha$\vert$$^\wedge$2} + $\vert${\ttfamily beta$\vert$$^\wedge$2} = 1. \\
\hline
\end{DoxyExceptions}


Definition at line 554 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References controlled\+Compact\+Unitary\+Local(), Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Multi\+Qubit\+::num\+Qubits, Qu\+E\+S\+T\+Assert(), R\+E\+AL, and validate\+Alpha\+Beta().


\begin{DoxyCode}
555 \{
556     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(targetQubit >= 0 && targetQubit < multiQubit.
      \mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}}, 1, \_\_func\_\_);
557     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(controlQubit >= 0 && controlQubit < multiQubit.
      \mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}}, 2, \_\_func\_\_);
558     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(controlQubit != targetQubit, 3, \_\_func\_\_);
559     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(\mbox{\hyperlink{QuEST_8c_ae2b2c14a07dd7d50ff86032a3ca101d7}{validateAlphaBeta}}(alpha, beta), 6, \_\_func\_\_);
560 
561     \textcolor{keywordtype}{int} threadsPerCUDABlock, CUDABlocks;
562     threadsPerCUDABlock = 128;
563     CUDABlocks = ceil((\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})(multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1)/threadsPerCUDABlock);
564     controlledCompactUnitaryKernel<<<CUDABlocks, threadsPerCUDABlock>>>(multiQubit, controlQubit, 
      targetQubit, alpha, beta);
565 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_ac9af28ce6412c545805c6275ad7636d5}\label{QuEST__env__localGPU_8cu_ac9af28ce6412c545805c6275ad7636d5}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!controlled\+Compact\+Unitary\+Kernel@{controlled\+Compact\+Unitary\+Kernel}}
\index{controlled\+Compact\+Unitary\+Kernel@{controlled\+Compact\+Unitary\+Kernel}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{controlled\+Compact\+Unitary\+Kernel()}{controlledCompactUnitaryKernel()}}
{\footnotesize\ttfamily \+\_\+\+\_\+global\+\_\+\+\_\+ void controlled\+Compact\+Unitary\+Kernel (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{control\+Qubit,  }\item[{const int}]{target\+Qubit,  }\item[{\mbox{\hyperlink{structComplex}{Complex}}}]{alpha,  }\item[{\mbox{\hyperlink{structComplex}{Complex}}}]{beta }\end{DoxyParamCaption})}

fix -- no necessary for G\+PU version 

Definition at line 495 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::device\+State\+Vec, extract\+Bit(), Complex\+Array\+::imag, Complex\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Complex\+Array\+::real, R\+E\+AL, and Complex\+::real.


\begin{DoxyCode}
495                                                                                                            
                                             \{
496     \textcolor{comment}{// ----- sizes}
497     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} sizeBlock,                                           \textcolor{comment}{// size of blocks}
498          sizeHalfBlock;                                       \textcolor{comment}{// size of blocks halved}
499     \textcolor{comment}{// ----- indices}
500     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisBlock,                                           \textcolor{comment}{// current block}
501          indexUp,indexLo;                                     \textcolor{comment}{// current index and corresponding index in
       lower half block}
502 
503     \textcolor{comment}{// ----- temp variables}
504     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}}   stateRealUp,stateRealLo,                             \textcolor{comment}{// storage for previous state values}
505            stateImagUp,stateImagLo;                             \textcolor{comment}{// (used in updates)}
506     \textcolor{comment}{// ----- temp variables}
507     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisTask;                                   \textcolor{comment}{// task based approach for expose loop with
       small granularity}
508     \textcolor{keyword}{const} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numTasks=multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1;
509     \textcolor{keywordtype}{int} controlBit;
510 
511     sizeHalfBlock = 1LL << targetQubit;                               \textcolor{comment}{// size of blocks halved}
512     sizeBlock     = 2LL * sizeHalfBlock;                           \textcolor{comment}{// size of blocks}
513 
514     \textcolor{comment}{// ---------------------------------------------------------------- //}
515     \textcolor{comment}{//            rotate                                                //}
516     \textcolor{comment}{// ---------------------------------------------------------------- //}
517 
519     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecReal = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}};
520     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecImag = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}};
521     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} alphaImag=alpha.\mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}, alphaReal=alpha.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}};
522     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} betaImag=beta.\mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}, betaReal=beta.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}};
523 
524     thisTask = blockIdx.x*blockDim.x + threadIdx.x;
525     \textcolor{keywordflow}{if} (thisTask>=numTasks) \textcolor{keywordflow}{return};
526 
527     thisBlock   = thisTask / sizeHalfBlock;
528     indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
529     indexLo     = indexUp + sizeHalfBlock;
530 
531     controlBit = \mbox{\hyperlink{QuEST__env__localGPU_8cu_a6ffa51987d8ad8f6c0fc07fd3492277f}{extractBit}}(controlQubit, indexUp);
532     \textcolor{keywordflow}{if} (controlBit)\{
533         \textcolor{comment}{// store current state vector values in temp variables}
534         stateRealUp = stateVecReal[indexUp];
535         stateImagUp = stateVecImag[indexUp];
536 
537         stateRealLo = stateVecReal[indexLo];
538         stateImagLo = stateVecImag[indexLo];
539 
540         \textcolor{comment}{// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]}
541         stateVecReal[indexUp] = alphaReal*stateRealUp - alphaImag*stateImagUp 
542             - betaReal*stateRealLo - betaImag*stateImagLo;
543         stateVecImag[indexUp] = alphaReal*stateImagUp + alphaImag*stateRealUp 
544             - betaReal*stateImagLo + betaImag*stateRealLo;
545 
546         \textcolor{comment}{// state[indexLo] = beta  * state[indexUp] + conj(alpha) * state[indexLo]}
547         stateVecReal[indexLo] = betaReal*stateRealUp - betaImag*stateImagUp 
548             + alphaReal*stateRealLo + alphaImag*stateImagLo;
549         stateVecImag[indexLo] = betaReal*stateImagUp + betaImag*stateRealUp 
550             + alphaReal*stateImagLo - alphaImag*stateRealLo;
551     \}
552 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a67576895bbc65463481a8ea24d9b1e22}\label{QuEST__env__localGPU_8cu_a67576895bbc65463481a8ea24d9b1e22}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!controlled\+Not@{controlled\+Not}}
\index{controlled\+Not@{controlled\+Not}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{controlled\+Not()}{controlledNot()}}
{\footnotesize\ttfamily void controlled\+Not (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{control\+Qubit,  }\item[{const int}]{target\+Qubit }\end{DoxyParamCaption})}



Apply the controlled not (single control, single target) gate, also known as the c-\/X, c-\/sigma-\/X, c-\/\+Pauli-\/X and c-\/bit-\/flip gate. 

This applies sigmaX to the target qubit if the control qubit has value 1. This effects the two-\/qubit unitary \[ \begin{pmatrix} 1 \\ & 1 \\\ & & & 1 \\ & & 1 \end{pmatrix} \] on the control and target qubits.

\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, -.5); \draw (-2,0) -- (2, 0); \draw (0, 0) circle (.5); \end{tikzpicture} } \] ~\newline
 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em control\+Qubit} & nots the target if this qubit is 1 \\
\hline
\mbox{\tt in}  & {\em target\+Qubit} & qubit to not \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if either {\ttfamily control\+Qubit} or {\ttfamily target\+Qubit} are outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}), or are equal. \\
\hline
\end{DoxyExceptions}


Definition at line 1104 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References controlled\+Not\+Local(), Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Multi\+Qubit\+::num\+Qubits, Qu\+E\+S\+T\+Assert(), and R\+E\+AL.


\begin{DoxyCode}
1105 \{
1106     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(targetQubit >= 0 && targetQubit < multiQubit.
      \mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}}, 1, \_\_func\_\_);
1107     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(controlQubit >= 0 && controlQubit < multiQubit.
      \mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}}, 2, \_\_func\_\_);
1108     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(controlQubit != targetQubit, 3, \_\_func\_\_);
1109 
1110     \textcolor{keywordtype}{int} threadsPerCUDABlock, CUDABlocks;
1111     threadsPerCUDABlock = 128;
1112     CUDABlocks = ceil((\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})(multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}})/threadsPerCUDABlock);
1113     controlledNotKernel<<<CUDABlocks, threadsPerCUDABlock>>>(multiQubit, controlQubit, targetQubit);
1114 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a625723cfbffdde3b3b312f8573d530a3}\label{QuEST__env__localGPU_8cu_a625723cfbffdde3b3b312f8573d530a3}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!controlled\+Not\+Kernel@{controlled\+Not\+Kernel}}
\index{controlled\+Not\+Kernel@{controlled\+Not\+Kernel}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{controlled\+Not\+Kernel()}{controlledNotKernel()}}
{\footnotesize\ttfamily \+\_\+\+\_\+global\+\_\+\+\_\+ void controlled\+Not\+Kernel (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{control\+Qubit,  }\item[{const int}]{target\+Qubit }\end{DoxyParamCaption})}



Definition at line 1065 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::device\+State\+Vec, extract\+Bit(), Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Complex\+Array\+::real, and R\+E\+AL.


\begin{DoxyCode}
1066 \{
1067     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
1068     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} sizeBlock,                                           \textcolor{comment}{// size of blocks}
1069          sizeHalfBlock;                                       \textcolor{comment}{// size of blocks halved}
1070     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} stateVecSize;
1071     \textcolor{keywordtype}{int} controlBit;
1072 
1073     \textcolor{comment}{// ----- temp variables}
1074     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}}   stateRealUp,                             \textcolor{comment}{// storage for previous state values}
1075            stateImagUp;                             \textcolor{comment}{// (used in updates)}
1076     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisBlock,                                           \textcolor{comment}{// current block}
1077          indexUp,indexLo;                                     \textcolor{comment}{// current index and corresponding index in
       lower half block}
1078     sizeHalfBlock = 1LL << targetQubit;                               \textcolor{comment}{// size of blocks halved}
1079     sizeBlock     = 2LL * sizeHalfBlock;                           \textcolor{comment}{// size of blocks}
1080 
1081     stateVecSize = multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}};
1082     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecReal = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}};
1083     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecImag = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}};
1084 
1085     index = blockIdx.x*blockDim.x + threadIdx.x;
1086     \textcolor{keywordflow}{if} (index>=(stateVecSize>>1)) \textcolor{keywordflow}{return};
1087     thisBlock   = index / sizeHalfBlock;
1088     indexUp     = thisBlock*sizeBlock + index%sizeHalfBlock;
1089     indexLo     = indexUp + sizeHalfBlock;
1090 
1091     controlBit = \mbox{\hyperlink{QuEST__env__localGPU_8cu_a6ffa51987d8ad8f6c0fc07fd3492277f}{extractBit}}(controlQubit, indexUp);
1092     \textcolor{keywordflow}{if} (controlBit)\{
1093         stateRealUp = stateVecReal[indexUp];
1094         stateImagUp = stateVecImag[indexUp];
1095 
1096         stateVecReal[indexUp] = stateVecReal[indexLo];
1097         stateVecImag[indexUp] = stateVecImag[indexLo];
1098 
1099         stateVecReal[indexLo] = stateRealUp;
1100         stateVecImag[indexLo] = stateImagUp;
1101     \}
1102 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a11a96159191cbf1b01a1080e7f045aac}\label{QuEST__env__localGPU_8cu_a11a96159191cbf1b01a1080e7f045aac}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!controlled\+Phase\+Gate@{controlled\+Phase\+Gate}}
\index{controlled\+Phase\+Gate@{controlled\+Phase\+Gate}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{controlled\+Phase\+Gate()}{controlledPhaseGate()}}
{\footnotesize\ttfamily void controlled\+Phase\+Gate (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{id\+Qubit1,  }\item[{const int}]{id\+Qubit2 }\end{DoxyParamCaption})}



Apply the (two-\/qubit) controlled phase gate, also known as the controlled sigmaZ gate. 

For each state, if both input qubits have value one, multiply the amplitude of that state by -\/1. This applies the two-\/qubit unitary\+: \[ \begin{pmatrix} 1 \\ & 1 \\\ & & 1 \\ & & & -1 \end{pmatrix} \]

\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {idQubit1}; \node[draw=none] at (-3.5, 0) {idQubit2}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 0); \draw (-2,0) -- (2, 0); \draw[fill=black] (0, 0) circle (.2); \end{tikzpicture} } \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em id\+Qubit1,id\+Qubit2} & qubits to operate upon \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily id\+Qubit1} or {\ttfamily id\+Qubit2} are outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}), or are equal \\
\hline
\end{DoxyExceptions}


Definition at line 963 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::chunk\+Id, extract\+Bit(), Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Multi\+Qubit\+::num\+Qubits, Qu\+E\+S\+T\+Assert(), Complex\+Array\+::real, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
964 \{
965     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(idQubit1 >= 0 && idQubit1 < multiQubit.\mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}}, 2, \_\_func\_\_);
966     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(idQubit2 >= 0 && idQubit2 < multiQubit.\mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}}, 1, \_\_func\_\_);
967     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(idQubit1 != idQubit2, 3, \_\_func\_\_);
968 
969     \textcolor{keywordtype}{int} threadsPerCUDABlock, CUDABlocks;
970     threadsPerCUDABlock = 128;
971     CUDABlocks = ceil((\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})(multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}})/threadsPerCUDABlock);
972     controlledPhaseGateKernel<<<CUDABlocks, threadsPerCUDABlock>>>(multiQubit, idQubit1, idQubit2);
973 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a67313a10fc0760b39a5ce9ef1d505830}\label{QuEST__env__localGPU_8cu_a67313a10fc0760b39a5ce9ef1d505830}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!controlled\+Phase\+Gate\+Kernel@{controlled\+Phase\+Gate\+Kernel}}
\index{controlled\+Phase\+Gate\+Kernel@{controlled\+Phase\+Gate\+Kernel}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{controlled\+Phase\+Gate\+Kernel()}{controlledPhaseGateKernel()}}
{\footnotesize\ttfamily \+\_\+\+\_\+global\+\_\+\+\_\+ void controlled\+Phase\+Gate\+Kernel (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{id\+Qubit1,  }\item[{const int}]{id\+Qubit2 }\end{DoxyParamCaption})}



Definition at line 942 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::device\+State\+Vec, extract\+Bit(), Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Complex\+Array\+::real, and R\+E\+AL.


\begin{DoxyCode}
943 \{
944     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
945     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} stateVecSize;
946     \textcolor{keywordtype}{int} bit1, bit2;
947 
948     stateVecSize = multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}};
949     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecReal = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}};
950     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecImag = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}};
951 
952     index = blockIdx.x*blockDim.x + threadIdx.x;
953     \textcolor{keywordflow}{if} (index>=stateVecSize) \textcolor{keywordflow}{return};
954 
955     bit1 = \mbox{\hyperlink{QuEST__env__localGPU_8cu_a6ffa51987d8ad8f6c0fc07fd3492277f}{extractBit}} (idQubit1, index);
956     bit2 = \mbox{\hyperlink{QuEST__env__localGPU_8cu_a6ffa51987d8ad8f6c0fc07fd3492277f}{extractBit}} (idQubit2, index);
957     \textcolor{keywordflow}{if} (bit1 && bit2) \{
958         stateVecReal [index] = - stateVecReal [index];
959         stateVecImag [index] = - stateVecImag [index];
960     \}
961 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a8a701526263392599aa21d0d0f05d9d8}\label{QuEST__env__localGPU_8cu_a8a701526263392599aa21d0d0f05d9d8}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!controlled\+Unitary@{controlled\+Unitary}}
\index{controlled\+Unitary@{controlled\+Unitary}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{controlled\+Unitary()}{controlledUnitary()}}
{\footnotesize\ttfamily void controlled\+Unitary (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{control\+Qubit,  }\item[{const int}]{target\+Qubit,  }\item[{\mbox{\hyperlink{structComplexMatrix2}{Complex\+Matrix2}}}]{u }\end{DoxyParamCaption})}



Apply a general controlled unitary (single control, single target), which can include a global phase factor. 

The given unitary is applied to the target qubit if the control qubit has value 1, effecting the two-\/qubit unitary \[ \begin{pmatrix} 1 \\ & 1 \\ & & u_{00} & u_{01}\\ & & u_{10} & u_{11} \end{pmatrix} \] on the control and target qubits.

\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 1); \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {U}; \end{tikzpicture} } \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em control\+Qubit} & apply unitary if this qubit is 1 \\
\hline
\mbox{\tt in}  & {\em target\+Qubit} & qubit to operate on \\
\hline
\mbox{\tt in}  & {\em u} & single-\/qubit unitary matrix to apply \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if either {\ttfamily control\+Qubit} or {\ttfamily target\+Qubit} are outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}) or are equal, or if {\ttfamily u} is not unitary. \\
\hline
\end{DoxyExceptions}


Definition at line 688 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References controlled\+Unitary\+Local(), Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Multi\+Qubit\+::num\+Qubits, Qu\+E\+S\+T\+Assert(), R\+E\+AL, and validate\+Matrix\+Is\+Unitary().


\begin{DoxyCode}
689 \{
690     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(targetQubit >= 0 && targetQubit < multiQubit.
      \mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}}, 1, \_\_func\_\_);
691     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(controlQubit >= 0 && controlQubit < multiQubit.
      \mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}}, 2, \_\_func\_\_);
692     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(controlQubit != targetQubit, 3, \_\_func\_\_);
693     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(\mbox{\hyperlink{QuEST_8c_ae4fea133d1a8f09ff8da03038100adb2}{validateMatrixIsUnitary}}(u), 5, \_\_func\_\_);
694 
695     \textcolor{keywordtype}{int} threadsPerCUDABlock, CUDABlocks;
696     threadsPerCUDABlock = 128;
697     CUDABlocks = ceil((\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})(multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1)/threadsPerCUDABlock);
698     controlledUnitaryKernel<<<CUDABlocks, threadsPerCUDABlock>>>(multiQubit, controlQubit, targetQubit, u);
699 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a8e75679cf6d66e11507ee227ab584473}\label{QuEST__env__localGPU_8cu_a8e75679cf6d66e11507ee227ab584473}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!controlled\+Unitary\+Kernel@{controlled\+Unitary\+Kernel}}
\index{controlled\+Unitary\+Kernel@{controlled\+Unitary\+Kernel}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{controlled\+Unitary\+Kernel()}{controlledUnitaryKernel()}}
{\footnotesize\ttfamily \+\_\+\+\_\+global\+\_\+\+\_\+ void controlled\+Unitary\+Kernel (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{control\+Qubit,  }\item[{const int}]{target\+Qubit,  }\item[{\mbox{\hyperlink{structComplexMatrix2}{Complex\+Matrix2}}}]{u }\end{DoxyParamCaption})}

fix -- no necessary for G\+PU version 

Definition at line 630 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::device\+State\+Vec, extract\+Bit(), Complex\+Array\+::imag, Complex\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Complex\+Matrix2\+::r0c0, Complex\+Matrix2\+::r0c1, Complex\+Matrix2\+::r1c0, Complex\+Matrix2\+::r1c1, Complex\+Array\+::real, R\+E\+AL, and Complex\+::real.


\begin{DoxyCode}
630                                                                                                            
                          \{
631     \textcolor{comment}{// ----- sizes}
632     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} sizeBlock,                                           \textcolor{comment}{// size of blocks}
633          sizeHalfBlock;                                       \textcolor{comment}{// size of blocks halved}
634     \textcolor{comment}{// ----- indices}
635     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisBlock,                                           \textcolor{comment}{// current block}
636          indexUp,indexLo;                                     \textcolor{comment}{// current index and corresponding index in
       lower half block}
637 
638     \textcolor{comment}{// ----- temp variables}
639     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}}   stateRealUp,stateRealLo,                             \textcolor{comment}{// storage for previous state values}
640            stateImagUp,stateImagLo;                             \textcolor{comment}{// (used in updates)}
641     \textcolor{comment}{// ----- temp variables}
642     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisTask;                                   \textcolor{comment}{// task based approach for expose loop with
       small granularity}
643     \textcolor{keyword}{const} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numTasks=multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1;
644 
645     \textcolor{keywordtype}{int} controlBit;
646 
647     sizeHalfBlock = 1LL << targetQubit;                               \textcolor{comment}{// size of blocks halved}
648     sizeBlock     = 2LL * sizeHalfBlock;                           \textcolor{comment}{// size of blocks}
649 
650     \textcolor{comment}{// ---------------------------------------------------------------- //}
651     \textcolor{comment}{//            rotate                                                //}
652     \textcolor{comment}{// ---------------------------------------------------------------- //}
653 
655     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecReal = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}};
656     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecImag = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}};
657 
658     thisTask = blockIdx.x*blockDim.x + threadIdx.x;
659     \textcolor{keywordflow}{if} (thisTask>=numTasks) \textcolor{keywordflow}{return};
660 
661     thisBlock   = thisTask / sizeHalfBlock;
662     indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
663     indexLo     = indexUp + sizeHalfBlock;
664 
665     \textcolor{comment}{// store current state vector values in temp variables}
666     stateRealUp = stateVecReal[indexUp];
667     stateImagUp = stateVecImag[indexUp];
668 
669     stateRealLo = stateVecReal[indexLo];
670     stateImagLo = stateVecImag[indexLo];
671 
672     controlBit = \mbox{\hyperlink{QuEST__env__localGPU_8cu_a6ffa51987d8ad8f6c0fc07fd3492277f}{extractBit}}(controlQubit, indexUp);
673     \textcolor{keywordflow}{if} (controlBit)\{
674         \textcolor{comment}{// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]}
675         stateVecReal[indexUp] = u.\mbox{\hyperlink{structComplexMatrix2_ae72b4458233b077a636beee1892e81ff}{r0c0}}.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}}*stateRealUp - u.\mbox{\hyperlink{structComplexMatrix2_ae72b4458233b077a636beee1892e81ff}{r0c0}}.
      \mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}*stateImagUp 
676             + u.\mbox{\hyperlink{structComplexMatrix2_a0f3932f055a8b05cef361bce25d51172}{r0c1}}.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}}*stateRealLo - u.\mbox{\hyperlink{structComplexMatrix2_a0f3932f055a8b05cef361bce25d51172}{r0c1}}.\mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}*stateImagLo;
677         stateVecImag[indexUp] = u.\mbox{\hyperlink{structComplexMatrix2_ae72b4458233b077a636beee1892e81ff}{r0c0}}.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}}*stateImagUp + u.\mbox{\hyperlink{structComplexMatrix2_ae72b4458233b077a636beee1892e81ff}{r0c0}}.
      \mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}*stateRealUp 
678             + u.\mbox{\hyperlink{structComplexMatrix2_a0f3932f055a8b05cef361bce25d51172}{r0c1}}.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}}*stateImagLo + u.\mbox{\hyperlink{structComplexMatrix2_a0f3932f055a8b05cef361bce25d51172}{r0c1}}.\mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}*stateRealLo;
679 
680         \textcolor{comment}{// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]}
681         stateVecReal[indexLo] = u.\mbox{\hyperlink{structComplexMatrix2_ab98282015ed2065e53fbc9638e2583ab}{r1c0}}.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}}*stateRealUp  - u.\mbox{\hyperlink{structComplexMatrix2_ab98282015ed2065e53fbc9638e2583ab}{r1c0}}.
      \mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}*stateImagUp 
682             + u.\mbox{\hyperlink{structComplexMatrix2_a763007c3070802373549ba0350f83c8a}{r1c1}}.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}}*stateRealLo  -  u.\mbox{\hyperlink{structComplexMatrix2_a763007c3070802373549ba0350f83c8a}{r1c1}}.\mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}*stateImagLo;
683         stateVecImag[indexLo] = u.\mbox{\hyperlink{structComplexMatrix2_ab98282015ed2065e53fbc9638e2583ab}{r1c0}}.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}}*stateImagUp + u.\mbox{\hyperlink{structComplexMatrix2_ab98282015ed2065e53fbc9638e2583ab}{r1c0}}.
      \mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}*stateRealUp 
684             + u.\mbox{\hyperlink{structComplexMatrix2_a763007c3070802373549ba0350f83c8a}{r1c1}}.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}}*stateImagLo + u.\mbox{\hyperlink{structComplexMatrix2_a763007c3070802373549ba0350f83c8a}{r1c1}}.\mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}*stateRealLo;
685     \}
686 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a250e9d66ad94ed2682e76a3c7502c8e1}\label{QuEST__env__localGPU_8cu_a250e9d66ad94ed2682e76a3c7502c8e1}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!copy\+Shared\+Reduce\+Block@{copy\+Shared\+Reduce\+Block}}
\index{copy\+Shared\+Reduce\+Block@{copy\+Shared\+Reduce\+Block}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{copy\+Shared\+Reduce\+Block()}{copySharedReduceBlock()}}
{\footnotesize\ttfamily \+\_\+\+\_\+global\+\_\+\+\_\+ void copy\+Shared\+Reduce\+Block (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$}]{array\+In,  }\item[{\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$}]{reduced\+Array,  }\item[{int}]{length }\end{DoxyParamCaption})}



Definition at line 1142 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References R\+E\+AL, and reduce\+Block().



Referenced by find\+Probability\+Of\+Zero().


\begin{DoxyCode}
1142                                                                                    \{
1143     \textcolor{keyword}{extern} \_\_shared\_\_ \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} tempReductionArray[];
1144     \textcolor{keywordtype}{int} blockOffset = blockIdx.x*length;
1145     tempReductionArray[threadIdx.x*2] = arrayIn[blockOffset + threadIdx.x*2];
1146     tempReductionArray[threadIdx.x*2+1] = arrayIn[blockOffset + threadIdx.x*2+1];
1147     \_\_syncthreads();
1148     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a4c740fa3ae25c71c1736790c674bdc98}{reduceBlock}}(tempReductionArray, reducedArray, length);
1149 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a0d255fec1e375244d4cb980fac92621d}\label{QuEST__env__localGPU_8cu_a0d255fec1e375244d4cb980fac92621d}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!copy\+State\+From\+G\+PU@{copy\+State\+From\+G\+PU}}
\index{copy\+State\+From\+G\+PU@{copy\+State\+From\+G\+PU}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{copy\+State\+From\+G\+P\+U()}{copyStateFromGPU()}}
{\footnotesize\ttfamily void copy\+State\+From\+G\+PU (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit }\end{DoxyParamCaption})}



Definition at line 159 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References D\+E\+B\+UG, Multi\+Qubit\+::device\+State\+Vec, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Complex\+Array\+::real, and Multi\+Qubit\+::state\+Vec.



Referenced by calc\+Total\+Probability(), compare\+States(), and report\+State\+To\+Screen().


\begin{DoxyCode}
160 \{
161     cudaDeviceSynchronize();
162     \textcolor{keywordflow}{if} (\mbox{\hyperlink{QuEST__env__localGPU_8cu_ad72dbcf6d0153db1b8d8a58001feed83}{DEBUG}}) printf(\textcolor{stringliteral}{"Copying data from GPU\(\backslash\)n"});
163     cudaMemcpy(multiQubit.\mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}}, multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.
      \mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}}, 
164             multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}*\textcolor{keyword}{sizeof}(*(multiQubit.
      \mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}})), cudaMemcpyDeviceToHost);
165     cudaMemcpy(multiQubit.\mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}}, multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.
      \mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}}, 
166             multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}*\textcolor{keyword}{sizeof}(*(multiQubit.
      \mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}})), cudaMemcpyDeviceToHost);
167     \textcolor{keywordflow}{if} (\mbox{\hyperlink{QuEST__env__localGPU_8cu_ad72dbcf6d0153db1b8d8a58001feed83}{DEBUG}}) printf(\textcolor{stringliteral}{"Finished copying data from GPU\(\backslash\)n"});
168 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a5b8880e65a521b4f6445af21b68d88ef}\label{QuEST__env__localGPU_8cu_a5b8880e65a521b4f6445af21b68d88ef}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!copy\+State\+To\+G\+PU@{copy\+State\+To\+G\+PU}}
\index{copy\+State\+To\+G\+PU@{copy\+State\+To\+G\+PU}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{copy\+State\+To\+G\+P\+U()}{copyStateToGPU()}}
{\footnotesize\ttfamily void copy\+State\+To\+G\+PU (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit }\end{DoxyParamCaption})}



Definition at line 145 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References D\+E\+B\+UG, Multi\+Qubit\+::device\+State\+Vec, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Complex\+Array\+::real, and Multi\+Qubit\+::state\+Vec.



Referenced by initialize\+State\+From\+Single\+File().


\begin{DoxyCode}
146 \{
147     \textcolor{keywordflow}{if} (\mbox{\hyperlink{QuEST__env__localGPU_8cu_ad72dbcf6d0153db1b8d8a58001feed83}{DEBUG}}) printf(\textcolor{stringliteral}{"Copying data to GPU\(\backslash\)n"});
148     cudaMemcpy(multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}}, multiQubit.
      \mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}}, 
149             multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}*\textcolor{keyword}{sizeof}(*(multiQubit.
      \mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}})), cudaMemcpyHostToDevice);
150         cudaMemcpy(multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}}, multiQubit.
      \mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}}, 
151                     multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}*\textcolor{keyword}{sizeof}(*(multiQubit.
      \mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}})), cudaMemcpyHostToDevice);
152         cudaMemcpy(multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}}, multiQubit.
      \mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}}, 
153                     multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}*\textcolor{keyword}{sizeof}(*(multiQubit.
      \mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}})), cudaMemcpyHostToDevice);
154     cudaMemcpy(multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}}, multiQubit.
      \mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}}, 
155             multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}*\textcolor{keyword}{sizeof}(*(multiQubit.
      \mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}})), cudaMemcpyHostToDevice);
156     \textcolor{keywordflow}{if} (\mbox{\hyperlink{QuEST__env__localGPU_8cu_ad72dbcf6d0153db1b8d8a58001feed83}{DEBUG}}) printf(\textcolor{stringliteral}{"Finished copying data to GPU\(\backslash\)n"});
157 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a9c02591bc64c2918503afa231d90d83f}\label{QuEST__env__localGPU_8cu_a9c02591bc64c2918503afa231d90d83f}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!create\+Multi\+Qubit@{create\+Multi\+Qubit}}
\index{create\+Multi\+Qubit@{create\+Multi\+Qubit}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{create\+Multi\+Qubit()}{createMultiQubit()}}
{\footnotesize\ttfamily void create\+Multi\+Qubit (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} $\ast$}]{multi\+Qubit,  }\item[{int}]{num\+Qubits,  }\item[{\mbox{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}}}]{env }\end{DoxyParamCaption})}



Create a \mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} object representing a set of qubits. 

Allocate space for state vector of probability amplitudes, including space for temporary values to be copied from one other chunk if running the distributed version. Define properties related to the size of the set of qubits. init\+State\+Zero should be called after this to initialise the qubits to the zero state.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & a pointer to an object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em num\+Qubits} & number of qubits in the system \\
\hline
\mbox{\tt in}  & {\em env} & object representing the execution environment (local, multinode etc) \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily num\+Qubits} $<$= 0 \\
\hline
\end{DoxyExceptions}


Definition at line 28 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::chunk\+Id, Multi\+Qubit\+::device\+State\+Vec, env, Multi\+Qubit\+::first\+Level\+Reduction, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Multi\+Qubit\+::num\+Chunks, Multi\+Qubit\+::num\+Qubits, Qu\+E\+S\+T\+Env\+::num\+Ranks, Multi\+Qubit\+::pair\+State\+Vec, Qu\+E\+S\+T\+Assert(), Qu\+E\+S\+T\+Env\+::rank, Complex\+Array\+::real, R\+E\+AL, R\+E\+D\+U\+C\+E\+\_\+\+S\+H\+A\+R\+E\+D\+\_\+\+S\+I\+ZE, Multi\+Qubit\+::second\+Level\+Reduction, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
29 \{
30     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(numQubits>0, 9, \_\_func\_\_);
31     \textcolor{comment}{// Allocate CPU memory}
32     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numAmps = 1L << numQubits;
33     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numAmpsPerRank = numAmps/\mbox{\hyperlink{runTests_8c_a5fd8ba97fcae3408ae6221dfc3cc1f93}{env}}.\mbox{\hyperlink{structQuESTEnv_af22aacd7c9905accae28484785c193b4}{numRanks}};
34 
35     multiQubit->\mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}} = (\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}}*) malloc(numAmpsPerRank * \textcolor{keyword}{sizeof}(multiQubit->
      \mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}}));
36     multiQubit->\mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}} = (\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}}*) malloc(numAmpsPerRank * \textcolor{keyword}{sizeof}(multiQubit->
      \mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}}));
37     \textcolor{keywordflow}{if} (\mbox{\hyperlink{runTests_8c_a5fd8ba97fcae3408ae6221dfc3cc1f93}{env}}.\mbox{\hyperlink{structQuESTEnv_af22aacd7c9905accae28484785c193b4}{numRanks}}>1)\{
38         multiQubit->\mbox{\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}} = (\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}}*) malloc(numAmpsPerRank * \textcolor{keyword}{sizeof}(
      multiQubit->\mbox{\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}}));
39         multiQubit->\mbox{\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}} = (\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}}*) malloc(numAmpsPerRank * \textcolor{keyword}{sizeof}(
      multiQubit->\mbox{\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}}));
40     \}
41 
42     \textcolor{keywordflow}{if} ( (!(multiQubit->\mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}}) || !(multiQubit->\mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.
      \mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}}))
43             && numAmpsPerRank ) \{
44         printf(\textcolor{stringliteral}{"Could not allocate memory!\(\backslash\)n"});
45         exit (EXIT\_FAILURE);
46     \}
47 
48     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{runTests_8c_a5fd8ba97fcae3408ae6221dfc3cc1f93}{env}}.\mbox{\hyperlink{structQuESTEnv_af22aacd7c9905accae28484785c193b4}{numRanks}}>1 && (!(multiQubit->\mbox{\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}}.
      \mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}}) || !(multiQubit->\mbox{\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}}))
49             && numAmpsPerRank ) \{
50         printf(\textcolor{stringliteral}{"Could not allocate memory!\(\backslash\)n"});
51         exit (EXIT\_FAILURE);
52     \}
53 
54     multiQubit->\mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}} = numQubits;
55     multiQubit->\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}} = numAmpsPerRank;
56     multiQubit->\mbox{\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId}} = \mbox{\hyperlink{runTests_8c_a5fd8ba97fcae3408ae6221dfc3cc1f93}{env}}.\mbox{\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank}};
57     multiQubit->\mbox{\hyperlink{structMultiQubit_acd43f2f57991709c9e94f73662c972b2}{numChunks}} = \mbox{\hyperlink{runTests_8c_a5fd8ba97fcae3408ae6221dfc3cc1f93}{env}}.\mbox{\hyperlink{structQuESTEnv_af22aacd7c9905accae28484785c193b4}{numRanks}};
58 
59     \textcolor{comment}{// Allocate GPU memory}
60     cudaMalloc(&(multiQubit->\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}}), multiQubit->
      \mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}*\textcolor{keyword}{sizeof}(*(multiQubit->\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.
      \mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}})));
61     cudaMalloc(&(multiQubit->\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}}), multiQubit->
      \mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}*\textcolor{keyword}{sizeof}(*(multiQubit->\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.
      \mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}})));
62     cudaMalloc(&(multiQubit->\mbox{\hyperlink{structMultiQubit_a4e0088b41adab0a40b7a31e528ed42b5}{firstLevelReduction}}), ceil(multiQubit->
      \mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}/(\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})\mbox{\hyperlink{QuEST__env__localGPU_8cu_aa57d77a0903e334e963c66ddc5ed3f53}{REDUCE\_SHARED\_SIZE}})*\textcolor{keyword}{sizeof}(
      \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}}));
63     cudaMalloc(&(multiQubit->\mbox{\hyperlink{structMultiQubit_a3e859cefa146ec7b30464ab3d897930b}{secondLevelReduction}}), ceil(multiQubit->
      \mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}/(\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})(\mbox{\hyperlink{QuEST__env__localGPU_8cu_aa57d77a0903e334e963c66ddc5ed3f53}{REDUCE\_SHARED\_SIZE}}*
      \mbox{\hyperlink{QuEST__env__localGPU_8cu_aa57d77a0903e334e963c66ddc5ed3f53}{REDUCE\_SHARED\_SIZE}}))*
64             \textcolor{keyword}{sizeof}(\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}}));
65 
66     \textcolor{keywordflow}{if} (!(multiQubit->\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}}) || !(multiQubit->
      \mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}}))\{
67         printf(\textcolor{stringliteral}{"Could not allocate memory on GPU!\(\backslash\)n"});
68         exit (EXIT\_FAILURE);
69     \}
70 
71 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_ae5d6acc322314d7a3d8a2eccf00d3b19}\label{QuEST__env__localGPU_8cu_ae5d6acc322314d7a3d8a2eccf00d3b19}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!destroy\+Multi\+Qubit@{destroy\+Multi\+Qubit}}
\index{destroy\+Multi\+Qubit@{destroy\+Multi\+Qubit}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{destroy\+Multi\+Qubit()}{destroyMultiQubit()}}
{\footnotesize\ttfamily void destroy\+Multi\+Qubit (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{\mbox{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}}}]{env }\end{DoxyParamCaption})}



Deallocate a \mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} object representing a set of qubits. 

Free memory allocated to state vector of probability amplitudes, including temporary vector for values copied from another chunk if running the distributed version.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object to be deallocated \\
\hline
\mbox{\tt in}  & {\em env} & object representing the execution environment (local, multinode etc) \\
\hline
\end{DoxyParams}


Definition at line 73 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::device\+State\+Vec, env, Complex\+Array\+::imag, Qu\+E\+S\+T\+Env\+::num\+Ranks, Multi\+Qubit\+::pair\+State\+Vec, Complex\+Array\+::real, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
74 \{
75     \textcolor{comment}{// Free CPU memory}
76     free(multiQubit.\mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}});
77     free(multiQubit.\mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}});
78     \textcolor{keywordflow}{if} (\mbox{\hyperlink{runTests_8c_a5fd8ba97fcae3408ae6221dfc3cc1f93}{env}}.\mbox{\hyperlink{structQuESTEnv_af22aacd7c9905accae28484785c193b4}{numRanks}}>1)\{
79         free(multiQubit.\mbox{\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}});
80         free(multiQubit.\mbox{\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}});
81     \}
82 
83     \textcolor{comment}{// Free GPU memory}
84     cudaFree(multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}});
85     cudaFree(multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}});
86 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_ae5f9019826f35e8b51b1716cfe397b45}\label{QuEST__env__localGPU_8cu_ae5f9019826f35e8b51b1716cfe397b45}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!exit\+With\+Error@{exit\+With\+Error}}
\index{exit\+With\+Error@{exit\+With\+Error}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{exit\+With\+Error()}{exitWithError()}}
{\footnotesize\ttfamily void exit\+With\+Error (\begin{DoxyParamCaption}\item[{int}]{error\+Code,  }\item[{const char $\ast$}]{func }\end{DoxyParamCaption})}



Definition at line 1434 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References error\+Codes.



Referenced by Qu\+E\+S\+T\+Assert().


\begin{DoxyCode}
1434                                                    \{
1435     printf(\textcolor{stringliteral}{"!!!\(\backslash\)n"});
1436     printf(\textcolor{stringliteral}{"QuEST Error in function %s: %s\(\backslash\)n"}, func, \mbox{\hyperlink{QuEST_8c_aac1637696885c75b73a1ecf381cea713}{errorCodes}}[errorCode]);
1437     printf(\textcolor{stringliteral}{"!!!\(\backslash\)n"});
1438     printf(\textcolor{stringliteral}{"exiting..\(\backslash\)n"});
1439     exit(errorCode);
1440 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a6ffa51987d8ad8f6c0fc07fd3492277f}\label{QuEST__env__localGPU_8cu_a6ffa51987d8ad8f6c0fc07fd3492277f}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!extract\+Bit@{extract\+Bit}}
\index{extract\+Bit@{extract\+Bit}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{extract\+Bit()}{extractBit()}}
{\footnotesize\ttfamily static \+\_\+\+\_\+device\+\_\+\+\_\+ int extract\+Bit (\begin{DoxyParamCaption}\item[{int}]{location\+Of\+Bit\+From\+Right,  }\item[{long long int}]{the\+Encoded\+Number }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 19 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



Referenced by controlled\+Compact\+Unitary\+Kernel(), controlled\+Not\+Kernel(), controlled\+Phase\+Gate\+Kernel(), controlled\+Unitary\+Kernel(), and init\+State\+Of\+Single\+Qubit\+Kernel().


\begin{DoxyCode}
20 \{
21     \textcolor{keywordflow}{return} (theEncodedNumber & ( 1LL << locationOfBitFromRight )) >> locationOfBitFromRight;
22 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_ad315c941a51bc053d39ebfa2040fd32e}\label{QuEST__env__localGPU_8cu_ad315c941a51bc053d39ebfa2040fd32e}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!find\+Probability\+Of\+Outcome@{find\+Probability\+Of\+Outcome}}
\index{find\+Probability\+Of\+Outcome@{find\+Probability\+Of\+Outcome}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{find\+Probability\+Of\+Outcome()}{findProbabilityOfOutcome()}}
{\footnotesize\ttfamily \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} find\+Probability\+Of\+Outcome (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{measure\+Qubit,  }\item[{int}]{outcome }\end{DoxyParamCaption})}



Gives the probability of a specified qubit being measured in the given outcome (0 or 1). 

This performs no actual measurement and does not change the state of the qubits.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em measure\+Qubit} & qubit to study \\
\hline
\mbox{\tt in}  & {\em outcome} & for which to find the probability of the qubit being measured in \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
probability of qubit measure\+Qubit being measured in the given outcome 
\end{DoxyReturn}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily measure\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}), or if {\ttfamily outcome} is not in \{0, 1\}. \\
\hline
\end{DoxyExceptions}


Definition at line 1256 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References find\+Probability\+Of\+Zero(), find\+Probability\+Of\+Zero\+Local(), Multi\+Qubit\+::num\+Qubits, Qu\+E\+S\+T\+Assert(), and R\+E\+AL.



Referenced by collapse\+To\+Outcome(), and measure\+With\+Stats().


\begin{DoxyCode}
1257 \{
1258     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(measureQubit >= 0 && measureQubit < multiQubit.
      \mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}}, 1, \_\_func\_\_);
1259     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} stateProb=0;
1260     stateProb = \mbox{\hyperlink{QuEST__env__localGPU_8cu_a2e4cedb70bd181d250b3abb945cc108e}{findProbabilityOfZero}}(multiQubit, measureQubit);
1261     \textcolor{keywordflow}{if} (outcome==1) stateProb = 1.0 - stateProb;
1262     \textcolor{keywordflow}{return} stateProb;
1263 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a2e4cedb70bd181d250b3abb945cc108e}\label{QuEST__env__localGPU_8cu_a2e4cedb70bd181d250b3abb945cc108e}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!find\+Probability\+Of\+Zero@{find\+Probability\+Of\+Zero}}
\index{find\+Probability\+Of\+Zero@{find\+Probability\+Of\+Zero}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{find\+Probability\+Of\+Zero()}{findProbabilityOfZero()}}
{\footnotesize\ttfamily \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} find\+Probability\+Of\+Zero (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{measure\+Qubit }\end{DoxyParamCaption})}



Measure the probability of a specified qubit being in the zero state. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em measure\+Qubit} & qubit to measure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
probability of qubit measure\+Qubit being zero 
\end{DoxyReturn}


Definition at line 1217 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References copy\+Shared\+Reduce\+Block(), Multi\+Qubit\+::first\+Level\+Reduction, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, R\+E\+AL, R\+E\+D\+U\+C\+E\+\_\+\+S\+H\+A\+R\+E\+D\+\_\+\+S\+I\+ZE, Multi\+Qubit\+::second\+Level\+Reduction, and swap\+Double().



Referenced by find\+Probability\+Of\+Outcome(), and measure\+In\+Zero().


\begin{DoxyCode}
1219 \{
1220     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numValuesToReduce = multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1;
1221     \textcolor{keywordtype}{int} valuesPerCUDABlock, numCUDABlocks, sharedMemSize;
1222     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} stateProb=0;
1223     \textcolor{keywordtype}{int} firstTime=1;
1224     \textcolor{keywordtype}{int} maxReducedPerLevel = \mbox{\hyperlink{QuEST__env__localGPU_8cu_aa57d77a0903e334e963c66ddc5ed3f53}{REDUCE\_SHARED\_SIZE}};
1225 
1226     \textcolor{keywordflow}{while}(numValuesToReduce>1)\{ 
1227         \textcolor{keywordflow}{if} (numValuesToReduce<maxReducedPerLevel)\{
1228             \textcolor{comment}{// Need less than one CUDA block to reduce values}
1229             valuesPerCUDABlock = numValuesToReduce;
1230             numCUDABlocks = 1;
1231         \} \textcolor{keywordflow}{else} \{
1232             \textcolor{comment}{// Use full CUDA blocks, with block size constrained by shared mem usage}
1233             valuesPerCUDABlock = maxReducedPerLevel;
1234             numCUDABlocks = ceil((\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})numValuesToReduce/valuesPerCUDABlock);
1235         \}
1236         sharedMemSize = valuesPerCUDABlock*\textcolor{keyword}{sizeof}(\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}});
1237 
1238         \textcolor{keywordflow}{if} (firstTime)\{
1239             findProbabilityOfZeroKernel<<<numCUDABlocks, valuesPerCUDABlock, sharedMemSize>>>(
1240                     multiQubit, measureQubit, multiQubit.\mbox{\hyperlink{structMultiQubit_a4e0088b41adab0a40b7a31e528ed42b5}{firstLevelReduction}});
1241             firstTime=0;
1242         \} \textcolor{keywordflow}{else} \{
1243             cudaDeviceSynchronize();    
1244             \mbox{\hyperlink{QuEST__env__localGPU_8cu_a250e9d66ad94ed2682e76a3c7502c8e1}{copySharedReduceBlock}}<<<numCUDABlocks, valuesPerCUDABlock/2, sharedMemSize
      >>>(
1245                     multiQubit.\mbox{\hyperlink{structMultiQubit_a4e0088b41adab0a40b7a31e528ed42b5}{firstLevelReduction}}, 
1246                     multiQubit.\mbox{\hyperlink{structMultiQubit_a3e859cefa146ec7b30464ab3d897930b}{secondLevelReduction}}, valuesPerCUDABlock); 
1247             cudaDeviceSynchronize();    
1248             \mbox{\hyperlink{QuEST__env__localGPU_8cu_aac328dfe6dd7cceec36a83d989b180b6}{swapDouble}}(&(multiQubit.\mbox{\hyperlink{structMultiQubit_a4e0088b41adab0a40b7a31e528ed42b5}{firstLevelReduction}}), &(multiQubit.
      \mbox{\hyperlink{structMultiQubit_a3e859cefa146ec7b30464ab3d897930b}{secondLevelReduction}}));
1249         \}
1250         numValuesToReduce = numValuesToReduce/maxReducedPerLevel;
1251     \}
1252     cudaMemcpy(&stateProb, multiQubit.\mbox{\hyperlink{structMultiQubit_a4e0088b41adab0a40b7a31e528ed42b5}{firstLevelReduction}}, \textcolor{keyword}{sizeof}(
      \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}}), cudaMemcpyDeviceToHost);
1253     \textcolor{keywordflow}{return} stateProb;
1254 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_aa9d9643aec790baf66e6322e591ebfd6}\label{QuEST__env__localGPU_8cu_aa9d9643aec790baf66e6322e591ebfd6}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!find\+Probability\+Of\+Zero\+Kernel@{find\+Probability\+Of\+Zero\+Kernel}}
\index{find\+Probability\+Of\+Zero\+Kernel@{find\+Probability\+Of\+Zero\+Kernel}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{find\+Probability\+Of\+Zero\+Kernel()}{findProbabilityOfZeroKernel()}}
{\footnotesize\ttfamily \+\_\+\+\_\+global\+\_\+\+\_\+ void find\+Probability\+Of\+Zero\+Kernel (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{measure\+Qubit,  }\item[{\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$}]{reduced\+Array }\end{DoxyParamCaption})}



Definition at line 1151 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::device\+State\+Vec, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Complex\+Array\+::real, R\+E\+AL, and reduce\+Block().


\begin{DoxyCode}
1153 \{
1154     \textcolor{comment}{// ----- sizes}
1155     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} sizeBlock,                                           \textcolor{comment}{// size of blocks}
1156          sizeHalfBlock;                                       \textcolor{comment}{// size of blocks halved}
1157     \textcolor{comment}{// ----- indices}
1158     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisBlock,                                           \textcolor{comment}{// current block}
1159          index;                                               \textcolor{comment}{// current index for first half block}
1160     \textcolor{comment}{// ----- temp variables}
1161     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisTask;                                   \textcolor{comment}{// task based approach for expose loop with
       small granularity}
1162     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numTasks=multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1;
1163     \textcolor{comment}{// (good for shared memory parallelism)}
1164 
1165     \textcolor{keyword}{extern} \_\_shared\_\_ \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} tempReductionArray[];
1166 
1167     \textcolor{comment}{// ---------------------------------------------------------------- //}
1168     \textcolor{comment}{//            dimensions                                            //}
1169     \textcolor{comment}{// ---------------------------------------------------------------- //}
1170     sizeHalfBlock = 1LL << (measureQubit);                       \textcolor{comment}{// number of state vector elements to sum,}
1171     \textcolor{comment}{// and then the number to skip}
1172     sizeBlock     = 2LL * sizeHalfBlock;                           \textcolor{comment}{// size of blocks (pairs of measure and
       skip entries)}
1173 
1174     \textcolor{comment}{// ---------------------------------------------------------------- //}
1175     \textcolor{comment}{//            find probability                                      //}
1176     \textcolor{comment}{// ---------------------------------------------------------------- //}
1177 
1178     \textcolor{comment}{//}
1179     \textcolor{comment}{// --- task-based shared-memory parallel implementation}
1180     \textcolor{comment}{//}
1181 
1182     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecReal = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}};
1183     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecImag = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}};
1184 
1185     thisTask = blockIdx.x*blockDim.x + threadIdx.x;
1186     \textcolor{keywordflow}{if} (thisTask>=numTasks) \textcolor{keywordflow}{return};
1187 
1188     thisBlock = thisTask / sizeHalfBlock;
1189     index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
1190     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} realVal, imagVal;
1191     realVal = stateVecReal[index];
1192     imagVal = stateVecImag[index];      
1193     tempReductionArray[threadIdx.x] = realVal*realVal + imagVal*imagVal;
1194     \_\_syncthreads();
1195 
1196     \textcolor{keywordflow}{if} (threadIdx.x<blockDim.x/2)\{
1197         \mbox{\hyperlink{QuEST__env__localGPU_8cu_a4c740fa3ae25c71c1736790c674bdc98}{reduceBlock}}(tempReductionArray, reducedArray, blockDim.x);
1198     \}
1199 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a8f10aabf9f607f19093aee54630caa21}\label{QuEST__env__localGPU_8cu_a8f10aabf9f607f19093aee54630caa21}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!get\+Environment\+String@{get\+Environment\+String}}
\index{get\+Environment\+String@{get\+Environment\+String}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{get\+Environment\+String()}{getEnvironmentString()}}
{\footnotesize\ttfamily void get\+Environment\+String (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}}}]{env,  }\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{char}]{str\mbox{[}200\mbox{]} }\end{DoxyParamCaption})}



Definition at line 141 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References env, Multi\+Qubit\+::num\+Qubits, and Qu\+E\+S\+T\+Env\+::num\+Ranks.


\begin{DoxyCode}
141                                                                              \{
142     sprintf(str, \textcolor{stringliteral}{"%dqubits\_GPU\_noMpi\_noOMP"}, multiQubit.\mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}});    
143 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a3615f76fd5f57008d9b74bbd10533dd0}\label{QuEST__env__localGPU_8cu_a3615f76fd5f57008d9b74bbd10533dd0}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!get\+Imag\+Amp\+El@{get\+Imag\+Amp\+El}}
\index{get\+Imag\+Amp\+El@{get\+Imag\+Amp\+El}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{get\+Imag\+Amp\+El()}{getImagAmpEl()}}
{\footnotesize\ttfamily \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} get\+Imag\+Amp\+El (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{long long int}]{index }\end{DoxyParamCaption})}



Get the imaginary component of the complex probability amplitude at an index in the state vector. 

For debugging purposes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em multi\+Qubit} & object representing a set of qubits \\
\hline
\mbox{\tt in}  & {\em index} & index in state vector of probability amplitudes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
imaginary component at that index 
\end{DoxyReturn}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily index} is outside \mbox{[}0, $2^{N}$) where $N = $ {\ttfamily multi\+Qubit.\+num\+Qubits} \\
\hline
\end{DoxyExceptions}


Definition at line 206 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::device\+State\+Vec, Complex\+Array\+::imag, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
206                                                              \{
207     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} el=0;
208     cudaMemcpy(&el, &(multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}}[index]), 
209             \textcolor{keyword}{sizeof}(*(multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}})), cudaMemcpyDeviceToHost);
210     \textcolor{keywordflow}{return} el;
211 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a112c74b3365bda6697813d9931b55377}\label{QuEST__env__localGPU_8cu_a112c74b3365bda6697813d9931b55377}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!get\+Num\+Reduction\+Levels@{get\+Num\+Reduction\+Levels}}
\index{get\+Num\+Reduction\+Levels@{get\+Num\+Reduction\+Levels}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{get\+Num\+Reduction\+Levels()}{getNumReductionLevels()}}
{\footnotesize\ttfamily int get\+Num\+Reduction\+Levels (\begin{DoxyParamCaption}\item[{long long int}]{num\+Values\+To\+Reduce,  }\item[{int}]{num\+Reduced\+Per\+Level }\end{DoxyParamCaption})}



Definition at line 1201 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.


\begin{DoxyCode}
1201                                                                                   \{
1202     \textcolor{keywordtype}{int} levels=0;
1203     \textcolor{keywordflow}{while} (numValuesToReduce)\{
1204         numValuesToReduce = numValuesToReduce/numReducedPerLevel;
1205         levels++;
1206     \}
1207     \textcolor{keywordflow}{return} levels;
1208 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a317b786f577fa6bc136ea7f0ee7330a7}\label{QuEST__env__localGPU_8cu_a317b786f577fa6bc136ea7f0ee7330a7}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!get\+Real\+Amp\+El@{get\+Real\+Amp\+El}}
\index{get\+Real\+Amp\+El@{get\+Real\+Amp\+El}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{get\+Real\+Amp\+El()}{getRealAmpEl()}}
{\footnotesize\ttfamily \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} get\+Real\+Amp\+El (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{long long int}]{index }\end{DoxyParamCaption})}



Get the real component of the complex probability amplitude at an index in the state vector. 

For debugging purposes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em multi\+Qubit} & object representing a set of qubits \\
\hline
\mbox{\tt in}  & {\em index} & index in state vector of probability amplitudes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
real component at that index 
\end{DoxyReturn}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily index} is outside \mbox{[}0, $2^{N}$) where $N = $ {\ttfamily multi\+Qubit.\+num\+Qubits} \\
\hline
\end{DoxyExceptions}


Definition at line 199 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::device\+State\+Vec, Complex\+Array\+::real, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
199                                                              \{
200     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} el=0;
201     cudaMemcpy(&el, &(multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}}[index]), 
202             \textcolor{keyword}{sizeof}(*(multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}})), cudaMemcpyDeviceToHost);
203     \textcolor{keywordflow}{return} el;
204 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a0aabd5ed69a74e5bc0b46a17af45c886}\label{QuEST__env__localGPU_8cu_a0aabd5ed69a74e5bc0b46a17af45c886}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!G\+P\+U\+Exists@{G\+P\+U\+Exists}}
\index{G\+P\+U\+Exists@{G\+P\+U\+Exists}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{G\+P\+U\+Exists()}{GPUExists()}}
{\footnotesize\ttfamily int G\+P\+U\+Exists (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Definition at line 88 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



Referenced by init\+Qu\+E\+S\+T\+Env().


\begin{DoxyCode}
88                    \{
89     \textcolor{keywordtype}{int} deviceCount, device;
90     \textcolor{keywordtype}{int} gpuDeviceCount = 0;
91     \textcolor{keyword}{struct }cudaDeviceProp properties;
92     cudaError\_t cudaResultCode = cudaGetDeviceCount(&deviceCount);
93     \textcolor{keywordflow}{if} (cudaResultCode != cudaSuccess) deviceCount = 0;
94     \textcolor{comment}{/* machines with no GPUs can still report one emulation device */}
95     \textcolor{keywordflow}{for} (device = 0; device < deviceCount; ++device) \{
96         cudaGetDeviceProperties(&properties, device);
97         \textcolor{keywordflow}{if} (properties.major != 9999) \{ \textcolor{comment}{/* 9999 means emulation only */}
98             ++gpuDeviceCount;
99         \}
100     \}
101     \textcolor{keywordflow}{if} (gpuDeviceCount) \textcolor{keywordflow}{return} 1;
102     \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} 0;
103 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_aa09b5dd93de6df1384b8f2c0041749ab}\label{QuEST__env__localGPU_8cu_aa09b5dd93de6df1384b8f2c0041749ab}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!hadamard@{hadamard}}
\index{hadamard@{hadamard}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{hadamard()}{hadamard()}}
{\footnotesize\ttfamily void hadamard (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{target\+Qubit }\end{DoxyParamCaption})}



Apply the single-\/qubit Hadamard gate. 

This takes $|0\rangle$ to $|+\rangle$ and $|1\rangle$ to $|-\rangle$, and is equivalent to a rotation of $\pi$ around the x-\/axis then $\pi/2$ about the y-\/axis on the Bloch-\/sphere. I.\+e. \[ \frac{1}{\sqrt{2}} \begin{pmatrix} 1 & 1 \\ 1 & -1 \end{pmatrix} \] ~\newline
 \[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {H}; \end{tikzpicture} } \] ~\newline
 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em target\+Qubit} & qubit to operate on \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily target\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}). \\
\hline
\end{DoxyExceptions}


Definition at line 1056 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References hadamard\+Local(), Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Multi\+Qubit\+::num\+Qubits, Qu\+E\+S\+T\+Assert(), and R\+E\+AL.


\begin{DoxyCode}
1057 \{
1058     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(targetQubit >= 0 && targetQubit < multiQubit.
      \mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}}, 1, \_\_func\_\_);
1059     \textcolor{keywordtype}{int} threadsPerCUDABlock, CUDABlocks;
1060     threadsPerCUDABlock = 128;
1061     CUDABlocks = ceil((\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})(multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1)/threadsPerCUDABlock);
1062     hadamardKernel<<<CUDABlocks, threadsPerCUDABlock>>>(multiQubit, targetQubit);
1063 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_aca19ea42f8ff8d21871394db3a7a2a2a}\label{QuEST__env__localGPU_8cu_aca19ea42f8ff8d21871394db3a7a2a2a}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!hadamard\+Kernel@{hadamard\+Kernel}}
\index{hadamard\+Kernel@{hadamard\+Kernel}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{hadamard\+Kernel()}{hadamardKernel()}}
{\footnotesize\ttfamily \+\_\+\+\_\+global\+\_\+\+\_\+ void hadamard\+Kernel (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{target\+Qubit }\end{DoxyParamCaption})}

fix -- no necessary for G\+PU version 

Definition at line 1007 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::device\+State\+Vec, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Complex\+Array\+::real, and R\+E\+AL.


\begin{DoxyCode}
1007                                                                              \{
1008     \textcolor{comment}{// ----- sizes}
1009     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} sizeBlock,                                           \textcolor{comment}{// size of blocks}
1010          sizeHalfBlock;                                       \textcolor{comment}{// size of blocks halved}
1011     \textcolor{comment}{// ----- indices}
1012     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisBlock,                                           \textcolor{comment}{// current block}
1013          indexUp,indexLo;                                     \textcolor{comment}{// current index and corresponding index in
       lower half block}
1014 
1015     \textcolor{comment}{// ----- temp variables}
1016     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}}   stateRealUp,stateRealLo,                             \textcolor{comment}{// storage for previous state values}
1017            stateImagUp,stateImagLo;                             \textcolor{comment}{// (used in updates)}
1018     \textcolor{comment}{// ----- temp variables}
1019     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisTask;                                   \textcolor{comment}{// task based approach for expose loop with
       small granularity}
1020     \textcolor{keyword}{const} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numTasks=multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1;
1021 
1022     sizeHalfBlock = 1LL << targetQubit;                               \textcolor{comment}{// size of blocks halved}
1023     sizeBlock     = 2LL * sizeHalfBlock;                           \textcolor{comment}{// size of blocks}
1024 
1025     \textcolor{comment}{// ---------------------------------------------------------------- //}
1026     \textcolor{comment}{//            rotate                                                //}
1027     \textcolor{comment}{// ---------------------------------------------------------------- //}
1028 
1030     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecReal = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}};
1031     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecImag = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}};
1032 
1033     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} recRoot2 = 1.0/sqrt(2.0);
1034 
1035     thisTask = blockIdx.x*blockDim.x + threadIdx.x;
1036     \textcolor{keywordflow}{if} (thisTask>=numTasks) \textcolor{keywordflow}{return};
1037 
1038     thisBlock   = thisTask / sizeHalfBlock;
1039     indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
1040     indexLo     = indexUp + sizeHalfBlock;
1041 
1042     \textcolor{comment}{// store current state vector values in temp variables}
1043     stateRealUp = stateVecReal[indexUp];
1044     stateImagUp = stateVecImag[indexUp];
1045 
1046     stateRealLo = stateVecReal[indexLo];
1047     stateImagLo = stateVecImag[indexLo];
1048 
1049     stateVecReal[indexUp] = recRoot2*(stateRealUp + stateRealLo);
1050     stateVecImag[indexUp] = recRoot2*(stateImagUp + stateImagLo);
1051 
1052     stateVecReal[indexLo] = recRoot2*(stateRealUp - stateRealLo);
1053     stateVecImag[indexLo] = recRoot2*(stateImagUp - stateImagLo);
1054 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_ae1b983b41249836ed2c2a81f77d83c40}\label{QuEST__env__localGPU_8cu_ae1b983b41249836ed2c2a81f77d83c40}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!init\+Classical\+State@{init\+Classical\+State}}
\index{init\+Classical\+State@{init\+Classical\+State}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{init\+Classical\+State()}{initClassicalState()}}
{\footnotesize\ttfamily void init\+Classical\+State (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{long long int}]{state\+Ind }\end{DoxyParamCaption})}



Initialise a set of $ N $ qubits to the classical state with index {\ttfamily state\+Ind}. 

Note $ | 00 \dots 00 \rangle $ has {\ttfamily state\+Ind} 0, $ | 00 \dots 01 \rangle $ has {\ttfamily state\+Ind} 1, $ | 11 \dots 11 \rangle $ has {\ttfamily state\+Ind} $ 2^N - 1 $, etc. Subsequent calls to get\+Prob\+El will yield 0 for all indices except {\ttfamily state\+Ind}.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & the object representing the set of qubits to be initialised \\
\hline
\mbox{\tt in}  & {\em state\+Ind} & the index (0 to the number of amplitudes, exclusive) of the state to give probability 1 \\
\hline
\end{DoxyParams}


Definition at line 278 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::chunk\+Id, Multi\+Qubit\+::device\+State\+Vec, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Complex\+Array\+::real, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
279 \{
280     \textcolor{keywordtype}{int} threadsPerCUDABlock, CUDABlocks;
281     threadsPerCUDABlock = 128;
282     CUDABlocks = ceil((\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})(multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}})/threadsPerCUDABlock);
283     initClassicalStateKernel<<<CUDABlocks, threadsPerCUDABlock>>>(
284         multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}, 
285         multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}}, 
286         multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}}, stateInd);
287 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a5ffdb83d58185c1caf2ef0675d9c4ad6}\label{QuEST__env__localGPU_8cu_a5ffdb83d58185c1caf2ef0675d9c4ad6}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!init\+Classical\+State\+Kernel@{init\+Classical\+State\+Kernel}}
\index{init\+Classical\+State\+Kernel@{init\+Classical\+State\+Kernel}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{init\+Classical\+State\+Kernel()}{initClassicalStateKernel()}}
{\footnotesize\ttfamily void \+\_\+\+\_\+global\+\_\+\+\_\+ init\+Classical\+State\+Kernel (\begin{DoxyParamCaption}\item[{long long int}]{state\+Vec\+Size,  }\item[{\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$}]{state\+Vec\+Real,  }\item[{\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$}]{state\+Vec\+Imag,  }\item[{long long int}]{state\+Ind }\end{DoxyParamCaption})}



Definition at line 263 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.


\begin{DoxyCode}
263                                                                                                            
                               \{
264     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
265 
266     \textcolor{comment}{// initialise the state to |stateInd>}
267     index = blockIdx.x*blockDim.x + threadIdx.x;
268     \textcolor{keywordflow}{if} (index>=stateVecSize) \textcolor{keywordflow}{return};
269     stateVecReal[index] = 0.0;
270     stateVecImag[index] = 0.0;
271 
272     \textcolor{keywordflow}{if} (index==stateInd)\{
273         \textcolor{comment}{// classical state has probability 1}
274         stateVecReal[stateInd] = 1.0;
275         stateVecImag[stateInd] = 0.0;
276     \}
277 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a433876ee9f3bcc54af346300f571fc3c}\label{QuEST__env__localGPU_8cu_a433876ee9f3bcc54af346300f571fc3c}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!initialize\+State\+From\+Single\+File@{initialize\+State\+From\+Single\+File}}
\index{initialize\+State\+From\+Single\+File@{initialize\+State\+From\+Single\+File}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{initialize\+State\+From\+Single\+File()}{initializeStateFromSingleFile()}}
{\footnotesize\ttfamily void initialize\+State\+From\+Single\+File (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} $\ast$}]{multi\+Qubit,  }\item[{char}]{filename\mbox{[}200\mbox{]},  }\item[{\mbox{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}}}]{env }\end{DoxyParamCaption})}



Initialises the wavefunction amplitudes according to those specified in a file. 

For debugging purpsoses fix -- format needs to work for single precision values 

Definition at line 336 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::chunk\+Id, copy\+State\+To\+G\+P\+U(), env, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Multi\+Qubit\+::num\+Chunks, Qu\+E\+S\+T\+Assert(), Complex\+Array\+::real, R\+E\+AL, Multi\+Qubit\+::state\+Vec, and sync\+Qu\+E\+S\+T\+Env().


\begin{DoxyCode}
336                                                                                             \{
337     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} chunkSize, stateVecSize;
338     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} indexInChunk, totalIndex;
339 
340     chunkSize = multiQubit->\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}};
341     stateVecSize = chunkSize*multiQubit->\mbox{\hyperlink{structMultiQubit_acd43f2f57991709c9e94f73662c972b2}{numChunks}};
342 
343     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecReal = multiQubit->\mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}};
344     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecImag = multiQubit->\mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}};
345 
346     FILE *fp;
347     \textcolor{keywordtype}{char} line[200];
348 
349     fp = fopen(filename, \textcolor{stringliteral}{"r"});
350     indexInChunk = 0; totalIndex = 0;
351     \textcolor{keywordflow}{while} (fgets(line, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char})*200, fp) != NULL && totalIndex<stateVecSize)\{
352         \textcolor{keywordflow}{if} (line[0]!=\textcolor{charliteral}{'#'})\{
353             \textcolor{keywordtype}{int} chunkId = totalIndex/chunkSize;
354             \textcolor{keywordflow}{if} (chunkId==multiQubit->\mbox{\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId}})\{
355 \textcolor{preprocessor}{                                # if QuEST\_PREC==1}
356                     sscanf(line, \textcolor{stringliteral}{"%f, %f"}, &(stateVecReal[indexInChunk]),
357                             &(stateVecImag[indexInChunk]));
358 \textcolor{preprocessor}{                # elif QuEST\_PREC==2}
359                     sscanf(line, \textcolor{stringliteral}{"%lf, %lf"}, &(stateVecReal[indexInChunk]),
360                             &(stateVecImag[indexInChunk]));
361 \textcolor{preprocessor}{                # elif QuEST\_PREC==4}
362                     sscanf(line, \textcolor{stringliteral}{"%lf, %lf"}, &(stateVecReal[indexInChunk]),
363                             &(stateVecImag[indexInChunk]));
364 \textcolor{preprocessor}{                # endif}
365                 indexInChunk += 1;
366             \}
367             totalIndex += 1;
368         \}
369     \}
370     fclose(fp);
371 
372     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a5b8880e65a521b4f6445af21b68d88ef}{copyStateToGPU}}(*multiQubit);
373 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_ad84a3ce68d1ca02b4e3f741ea45b6054}\label{QuEST__env__localGPU_8cu_ad84a3ce68d1ca02b4e3f741ea45b6054}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!init\+Qu\+E\+S\+T\+Env@{init\+Qu\+E\+S\+T\+Env}}
\index{init\+Qu\+E\+S\+T\+Env@{init\+Qu\+E\+S\+T\+Env}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{init\+Qu\+E\+S\+T\+Env()}{initQuESTEnv()}}
{\footnotesize\ttfamily void init\+Qu\+E\+S\+T\+Env (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}} $\ast$}]{env }\end{DoxyParamCaption})}



Initialize the Qu\+E\+ST environment. 

If something needs to be done to set up the execution environment, such as initializing M\+PI when running in distributed mode, it is handled here


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em env} & object representing the execution environment. A single instance is used for each program \\
\hline
\end{DoxyParams}


Definition at line 105 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References env, G\+P\+U\+Exists(), Qu\+E\+S\+T\+Env\+::num\+Ranks, Qu\+E\+S\+T\+Env\+::rank, and seed\+Qu\+E\+S\+T\+Default().


\begin{DoxyCode}
105                                 \{
106     \textcolor{comment}{// init MPI environment}
107     \textcolor{keywordflow}{if} (!\mbox{\hyperlink{QuEST__env__localGPU_8cu_a0aabd5ed69a74e5bc0b46a17af45c886}{GPUExists}}())\{
108         printf(\textcolor{stringliteral}{"Trying to run GPU code with no GPU available\(\backslash\)n"});
109         exit(EXIT\_FAILURE);
110     \}
111     \mbox{\hyperlink{runTests_8c_a5fd8ba97fcae3408ae6221dfc3cc1f93}{env}}->\mbox{\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank}}=0;
112     \mbox{\hyperlink{runTests_8c_a5fd8ba97fcae3408ae6221dfc3cc1f93}{env}}->\mbox{\hyperlink{structQuESTEnv_af22aacd7c9905accae28484785c193b4}{numRanks}}=1;
113         
114         \mbox{\hyperlink{QuEST_8c_ab0ab3ec70938712c26988a6aa51263a0}{seedQuESTDefault}}();
115 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a4b737ff9b4267609ef27e6cb4c42dc68}\label{QuEST__env__localGPU_8cu_a4b737ff9b4267609ef27e6cb4c42dc68}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!init\+State\+Debug@{init\+State\+Debug}}
\index{init\+State\+Debug@{init\+State\+Debug}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{init\+State\+Debug()}{initStateDebug()}}
{\footnotesize\ttfamily void init\+State\+Debug (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit }\end{DoxyParamCaption})}



Initialise the state vector of probability amplitudes to an (unphysical) state with each component of each probability amplitude a unique floating point value. 

For debugging processes 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits to be initialised \\
\hline
\end{DoxyParams}


Definition at line 299 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::chunk\+Id, Multi\+Qubit\+::device\+State\+Vec, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Complex\+Array\+::real, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
300 \{
301     \textcolor{keywordtype}{int} threadsPerCUDABlock, CUDABlocks;
302     threadsPerCUDABlock = 128;
303     CUDABlocks = ceil((\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})(multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}})/threadsPerCUDABlock);
304     initStateDebugKernel<<<CUDABlocks, threadsPerCUDABlock>>>(
305         multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}},
306         multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}}, 
307         multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}});
308 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a2f83bb3e7c5408d3a19161e9f0be6e35}\label{QuEST__env__localGPU_8cu_a2f83bb3e7c5408d3a19161e9f0be6e35}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!init\+State\+Debug\+Kernel@{init\+State\+Debug\+Kernel}}
\index{init\+State\+Debug\+Kernel@{init\+State\+Debug\+Kernel}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{init\+State\+Debug\+Kernel()}{initStateDebugKernel()}}
{\footnotesize\ttfamily void \+\_\+\+\_\+global\+\_\+\+\_\+ init\+State\+Debug\+Kernel (\begin{DoxyParamCaption}\item[{long long int}]{state\+Vec\+Size,  }\item[{\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$}]{state\+Vec\+Real,  }\item[{\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$}]{state\+Vec\+Imag }\end{DoxyParamCaption})}



Definition at line 289 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.


\begin{DoxyCode}
289                                                                                                         \{
290     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
291 
292     index = blockIdx.x*blockDim.x + threadIdx.x;
293     \textcolor{keywordflow}{if} (index>=stateVecSize) \textcolor{keywordflow}{return};
294 
295     stateVecReal[index] = (index*2.0)/10.0;
296     stateVecImag[index] = (index*2.0+1.0)/10.0;
297 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a7169fd0442cbc3418f3fac4d13363ca2}\label{QuEST__env__localGPU_8cu_a7169fd0442cbc3418f3fac4d13363ca2}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!init\+State\+Of\+Single\+Qubit@{init\+State\+Of\+Single\+Qubit}}
\index{init\+State\+Of\+Single\+Qubit@{init\+State\+Of\+Single\+Qubit}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{init\+State\+Of\+Single\+Qubit()}{initStateOfSingleQubit()}}
{\footnotesize\ttfamily void init\+State\+Of\+Single\+Qubit (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}} $\ast$}]{multi\+Qubit,  }\item[{int}]{qubit\+Id,  }\item[{int}]{outcome }\end{DoxyParamCaption})}



Initialise the state vector of probability amplitudes such that one qubit is set to \textquotesingle{}outcome\textquotesingle{} and all other qubits are in an equal superposition of zero and one. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits to be initialised \\
\hline
\mbox{\tt in}  & {\em qubit\+Id} & id of qubit to set to state \textquotesingle{}outcome\textquotesingle{} \\
\hline
\mbox{\tt in}  & {\em value} & of qubit \textquotesingle{}qubit\+Id\textquotesingle{} \\
\hline
\end{DoxyParams}


Definition at line 328 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::chunk\+Id, Multi\+Qubit\+::device\+State\+Vec, extract\+Bit(), Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Multi\+Qubit\+::num\+Chunks, Complex\+Array\+::real, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
329 \{
330     \textcolor{keywordtype}{int} threadsPerCUDABlock, CUDABlocks;
331     threadsPerCUDABlock = 128;
332     CUDABlocks = ceil((\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})(multiQubit->\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}})/threadsPerCUDABlock);
333     initStateOfSingleQubitKernel<<<CUDABlocks, threadsPerCUDABlock>>>(multiQubit->
      \mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}, multiQubit->\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}}, multiQubit->
      \mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}}, qubitId, outcome);
334 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a1eb51dd82f1cbbef94d3cb7d2ca73e28}\label{QuEST__env__localGPU_8cu_a1eb51dd82f1cbbef94d3cb7d2ca73e28}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!init\+State\+Of\+Single\+Qubit\+Kernel@{init\+State\+Of\+Single\+Qubit\+Kernel}}
\index{init\+State\+Of\+Single\+Qubit\+Kernel@{init\+State\+Of\+Single\+Qubit\+Kernel}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{init\+State\+Of\+Single\+Qubit\+Kernel()}{initStateOfSingleQubitKernel()}}
{\footnotesize\ttfamily void \+\_\+\+\_\+global\+\_\+\+\_\+ init\+State\+Of\+Single\+Qubit\+Kernel (\begin{DoxyParamCaption}\item[{long long int}]{state\+Vec\+Size,  }\item[{\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$}]{state\+Vec\+Real,  }\item[{\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$}]{state\+Vec\+Imag,  }\item[{int}]{qubit\+Id,  }\item[{int}]{outcome }\end{DoxyParamCaption})}



Definition at line 310 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References extract\+Bit(), and R\+E\+AL.


\begin{DoxyCode}
310                                                                                                            
                                     \{
311     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
312     \textcolor{keywordtype}{int} bit;
313 
314     index = blockIdx.x*blockDim.x + threadIdx.x;
315     \textcolor{keywordflow}{if} (index>=stateVecSize) \textcolor{keywordflow}{return};
316 
317     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} normFactor = 1.0/sqrt((\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})stateVecSize/2);
318     bit = \mbox{\hyperlink{QuEST__env__localGPU_8cu_a6ffa51987d8ad8f6c0fc07fd3492277f}{extractBit}}(qubitId, index);
319     \textcolor{keywordflow}{if} (bit==outcome) \{
320         stateVecReal[index] = normFactor;
321         stateVecImag[index] = 0.0;
322     \} \textcolor{keywordflow}{else} \{
323         stateVecReal[index] = 0.0;
324         stateVecImag[index] = 0.0;
325     \}
326 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_af8a0082e2f695145bbfbb572e4c2e4f1}\label{QuEST__env__localGPU_8cu_af8a0082e2f695145bbfbb572e4c2e4f1}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!init\+State\+Plus@{init\+State\+Plus}}
\index{init\+State\+Plus@{init\+State\+Plus}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{init\+State\+Plus()}{initStatePlus()}}
{\footnotesize\ttfamily void init\+State\+Plus (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit }\end{DoxyParamCaption})}



Initialise a set of $ N $ qubits to the plus state $ {| + \rangle}^{\otimes N} = \frac{1}{\sqrt{2^N}} (| 0 \rangle + | 1 \rangle)^{\otimes N} $. 

This is the product state of $N$ qubits where every classical state is uniformly populated with real coefficient $\frac{1}{\sqrt{2^N}}$. This is equivalent to applying a Hadamard to every qubit in the zero state\+: $ \hat{H}^{\otimes N} {|0\rangle}^{\otimes N} $


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & the object representing the set of qubits to be initialised \\
\hline
\end{DoxyParams}


Definition at line 251 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::device\+State\+Vec, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Multi\+Qubit\+::num\+Chunks, Complex\+Array\+::real, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
252 \{
253     \textcolor{keywordtype}{int} threadsPerCUDABlock, CUDABlocks;
254     threadsPerCUDABlock = 128;
255     CUDABlocks = ceil((\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})(multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}})/threadsPerCUDABlock);
256     initStatePlusKernel<<<CUDABlocks, threadsPerCUDABlock>>>(
257         multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}, 
258         multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}}, 
259         multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}});
260 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_abddc47ea8fe014ed09dc82542bcbfe6f}\label{QuEST__env__localGPU_8cu_abddc47ea8fe014ed09dc82542bcbfe6f}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!init\+State\+Plus\+Kernel@{init\+State\+Plus\+Kernel}}
\index{init\+State\+Plus\+Kernel@{init\+State\+Plus\+Kernel}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{init\+State\+Plus\+Kernel()}{initStatePlusKernel()}}
{\footnotesize\ttfamily void \+\_\+\+\_\+global\+\_\+\+\_\+ init\+State\+Plus\+Kernel (\begin{DoxyParamCaption}\item[{long long int}]{state\+Vec\+Size,  }\item[{\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$}]{state\+Vec\+Real,  }\item[{\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$}]{state\+Vec\+Imag }\end{DoxyParamCaption})}



Definition at line 240 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References R\+E\+AL.


\begin{DoxyCode}
240                                                                                                        \{
241     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
242 
243     index = blockIdx.x*blockDim.x + threadIdx.x;
244     \textcolor{keywordflow}{if} (index>=stateVecSize) \textcolor{keywordflow}{return};
245 
246     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} normFactor = 1.0/sqrt((\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})stateVecSize);
247     stateVecReal[index] = normFactor;
248     stateVecImag[index] = 0.0;
249 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a9ba8171c9ec5c42202b144026527e9ec}\label{QuEST__env__localGPU_8cu_a9ba8171c9ec5c42202b144026527e9ec}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!init\+State\+Zero@{init\+State\+Zero}}
\index{init\+State\+Zero@{init\+State\+Zero}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{init\+State\+Zero()}{initStateZero()}}
{\footnotesize\ttfamily void init\+State\+Zero (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit }\end{DoxyParamCaption})}



Initialise a set of $ N $ qubits to the classical zero state $ {| 0 \rangle}^{\otimes N} $. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & the object representing the set of all qubits to initialise \\
\hline
\end{DoxyParams}


Definition at line 229 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::chunk\+Id, Multi\+Qubit\+::device\+State\+Vec, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Complex\+Array\+::real, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
230 \{
231     \textcolor{keywordtype}{int} threadsPerCUDABlock, CUDABlocks;
232     threadsPerCUDABlock = 128;
233     CUDABlocks = ceil((\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})(multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}})/threadsPerCUDABlock);
234     initStateZeroKernel<<<CUDABlocks, threadsPerCUDABlock>>>(
235         multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}, 
236         multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}}, 
237         multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}});
238 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_aa6b649062c49c37ac93aac0d6be6eedd}\label{QuEST__env__localGPU_8cu_aa6b649062c49c37ac93aac0d6be6eedd}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!init\+State\+Zero\+Kernel@{init\+State\+Zero\+Kernel}}
\index{init\+State\+Zero\+Kernel@{init\+State\+Zero\+Kernel}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{init\+State\+Zero\+Kernel()}{initStateZeroKernel()}}
{\footnotesize\ttfamily void \+\_\+\+\_\+global\+\_\+\+\_\+ init\+State\+Zero\+Kernel (\begin{DoxyParamCaption}\item[{long long int}]{state\+Vec\+Size,  }\item[{\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$}]{state\+Vec\+Real,  }\item[{\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$}]{state\+Vec\+Imag }\end{DoxyParamCaption})}



Definition at line 213 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.


\begin{DoxyCode}
213                                                                                                        \{
214     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
215 
216     \textcolor{comment}{// initialise the state to |0000..0000>}
217     index = blockIdx.x*blockDim.x + threadIdx.x;
218     \textcolor{keywordflow}{if} (index>=stateVecSize) \textcolor{keywordflow}{return};
219     stateVecReal[index] = 0.0;
220     stateVecImag[index] = 0.0;
221 
222     \textcolor{keywordflow}{if} (index==0)\{
223         \textcolor{comment}{// zero state |0000..0000> has probability 1}
224         stateVecReal[0] = 1.0;
225         stateVecImag[0] = 0.0;
226     \}
227 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a8ce1e311ea72b862a8757dc71082fbf3}\label{QuEST__env__localGPU_8cu_a8ce1e311ea72b862a8757dc71082fbf3}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!log2\+Int@{log2\+Int}}
\index{log2\+Int@{log2\+Int}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{log2\+Int()}{log2Int()}}
{\footnotesize\ttfamily \+\_\+\+\_\+device\+\_\+\+\_\+ \+\_\+\+\_\+host\+\_\+\+\_\+ unsigned int log2\+Int (\begin{DoxyParamCaption}\item[{unsigned int}]{x }\end{DoxyParamCaption})}



Definition at line 1116 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



Referenced by reduce\+Block().


\begin{DoxyCode}
1117 \{
1118     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} ans = 0 ;
1119     \textcolor{keywordflow}{while}( x>>=1 ) ans++;
1120     \textcolor{keywordflow}{return} ans ;
1121 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_ad5774247d836267175c664cd0e451bcb}\label{QuEST__env__localGPU_8cu_ad5774247d836267175c664cd0e451bcb}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!measure@{measure}}
\index{measure@{measure}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{measure()}{measure()}}
{\footnotesize\ttfamily int measure (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{int}]{measure\+Qubit }\end{DoxyParamCaption})}



Measures a single qubit, collapsing it randomly to 0 or 1. 

Outcome probabilities are weighted by the state vector, which is irreversibly changed after collapse to be consistent with the outcome.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em measure\+Qubit} & qubit to measure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the measurement outcome, 0 or 1 
\end{DoxyReturn}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily measure\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}) \\
\hline
\end{DoxyExceptions}


Definition at line 1400 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References measure\+With\+Stats(), Multi\+Qubit\+::num\+Qubits, Qu\+E\+S\+T\+Assert(), and R\+E\+AL.


\begin{DoxyCode}
1400                                                     \{
1401     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(measureQubit >= 0 && measureQubit < multiQubit.
      \mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}}, 2, \_\_func\_\_);
1402     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} stateProb;
1403     \textcolor{keywordflow}{return} \mbox{\hyperlink{QuEST__env__localGPU_8cu_a2ac46e470c750bf93c754e06c64b0a7a}{measureWithStats}}(multiQubit, measureQubit, &stateProb);
1404 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a21094de735f3cb48488a184cfa4d8d41}\label{QuEST__env__localGPU_8cu_a21094de735f3cb48488a184cfa4d8d41}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!measure\+In\+Zero@{measure\+In\+Zero}}
\index{measure\+In\+Zero@{measure\+In\+Zero}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{measure\+In\+Zero()}{measureInZero()}}
{\footnotesize\ttfamily \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} measure\+In\+Zero (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{measure\+Qubit }\end{DoxyParamCaption})}



Update the state vector to be consistent with measuring measure\+Qubit=0. 

Measure in Zero performs an irreversible change to the state vector\+: it updates the vector according to the event that a zero have been measured on the qubit indicated by measure\+Qubit (where his label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measure\+Qubit=0. It then returns the probability of making this measurement.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em measure\+Qubit} & qubit to measure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
probability of qubit measure\+Qubit being zero 
\end{DoxyReturn}


Definition at line 1388 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References find\+Probability\+Of\+Zero(), Multi\+Qubit\+::num\+Amps\+Per\+Chunk, and R\+E\+AL.


\begin{DoxyCode}
1389 \{        
1390     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} stateProb;
1391     stateProb = \mbox{\hyperlink{QuEST__env__localGPU_8cu_a2e4cedb70bd181d250b3abb945cc108e}{findProbabilityOfZero}}(multiQubit, measureQubit);
1392 
1393     \textcolor{keywordtype}{int} threadsPerCUDABlock, CUDABlocks;
1394     threadsPerCUDABlock = 128;
1395     CUDABlocks = ceil((\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})(multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1)/threadsPerCUDABlock);
1396     \textcolor{keywordflow}{if} (stateProb!=0) measureInZeroKernel<<<CUDABlocks, threadsPerCUDABlock>>>(multiQubit, measureQubit, 
      stateProb);
1397     \textcolor{keywordflow}{return} stateProb;
1398 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a8f87a4777c69c875fece83d4b5eb29ba}\label{QuEST__env__localGPU_8cu_a8f87a4777c69c875fece83d4b5eb29ba}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!measure\+In\+Zero\+Kernel@{measure\+In\+Zero\+Kernel}}
\index{measure\+In\+Zero\+Kernel@{measure\+In\+Zero\+Kernel}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{measure\+In\+Zero\+Kernel()}{measureInZeroKernel()}}
{\footnotesize\ttfamily \+\_\+\+\_\+global\+\_\+\+\_\+ void measure\+In\+Zero\+Kernel (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{int}]{measure\+Qubit,  }\item[{\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}}}]{total\+Probability }\end{DoxyParamCaption})}



Definition at line 1341 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::device\+State\+Vec, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Complex\+Array\+::real, and R\+E\+AL.


\begin{DoxyCode}
1342 \{
1343     \textcolor{comment}{// ----- sizes}
1344     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} sizeBlock,                                           \textcolor{comment}{// size of blocks}
1345          sizeHalfBlock;                                       \textcolor{comment}{// size of blocks halved}
1346     \textcolor{comment}{// ----- indices}
1347     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisBlock,                                           \textcolor{comment}{// current block}
1348          index;                                               \textcolor{comment}{// current index for first half block}
1349     \textcolor{comment}{// ----- measured probability}
1350     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}}   renorm;                                    \textcolor{comment}{// probability (returned) value}
1351     \textcolor{comment}{// ----- temp variables}
1352     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisTask;                                   \textcolor{comment}{// task based approach for expose loop with
       small granularity}
1353     \textcolor{comment}{// (good for shared memory parallelism)}
1354     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numTasks=multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1;
1355 
1356     \textcolor{comment}{// ---------------------------------------------------------------- //}
1357     \textcolor{comment}{//            tests                                                 //}
1358     \textcolor{comment}{// ---------------------------------------------------------------- //}
1359     \textcolor{comment}{// ---------------------------------------------------------------- //}
1360     \textcolor{comment}{//            dimensions                                            //}
1361     \textcolor{comment}{// ---------------------------------------------------------------- //}
1362     sizeHalfBlock = 1LL << (measureQubit);                       \textcolor{comment}{// number of state vector elements to sum,}
1363     \textcolor{comment}{// and then the number to skip}
1364     sizeBlock     = 2LL * sizeHalfBlock;                           \textcolor{comment}{// size of blocks (pairs of measure and
       skip entries)}
1365 
1366     \textcolor{comment}{// ---------------------------------------------------------------- //}
1367     \textcolor{comment}{//            find probability                                      //}
1368     \textcolor{comment}{// ---------------------------------------------------------------- //}
1369 
1370     \textcolor{comment}{//}
1371     \textcolor{comment}{// --- task-based shared-memory parallel implementation}
1372     \textcolor{comment}{//}
1373     renorm=1/sqrt(totalProbability);
1374     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecReal = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}};
1375     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecImag = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}};
1376 
1377     thisTask = blockIdx.x*blockDim.x + threadIdx.x;
1378     \textcolor{keywordflow}{if} (thisTask>=numTasks) \textcolor{keywordflow}{return};
1379     thisBlock = thisTask / sizeHalfBlock;
1380     index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
1381     stateVecReal[index]=stateVecReal[index]*renorm;
1382     stateVecImag[index]=stateVecImag[index]*renorm;
1383 
1384     stateVecReal[index+sizeHalfBlock]=0;
1385     stateVecImag[index+sizeHalfBlock]=0;
1386 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a2ac46e470c750bf93c754e06c64b0a7a}\label{QuEST__env__localGPU_8cu_a2ac46e470c750bf93c754e06c64b0a7a}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!measure\+With\+Stats@{measure\+With\+Stats}}
\index{measure\+With\+Stats@{measure\+With\+Stats}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{measure\+With\+Stats()}{measureWithStats()}}
{\footnotesize\ttfamily int measure\+With\+Stats (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{int}]{measure\+Qubit,  }\item[{\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$}]{state\+Prob }\end{DoxyParamCaption})}



Measures a single qubit, collapsing it randomly to 0 or 1, and additionally gives the probability of that outcome. 

Outcome probabilities are weighted by the state vector, which is irreversibly changed after collapse to be consistent with the outcome.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em measure\+Qubit} & qubit to measure \\
\hline
\mbox{\tt out}  & {\em state\+Prob} & a pointer to a R\+E\+AL which is set to the probability of the occurred outcome \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the measurement outcome, 0 or 1 
\end{DoxyReturn}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily measure\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}) \\
\hline
\end{DoxyExceptions}


Definition at line 1406 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References collapse\+To\+Outcome\+Local(), find\+Probability\+Of\+Outcome(), genrand\+\_\+real1(), Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Multi\+Qubit\+::num\+Qubits, Qu\+E\+S\+T\+Assert(), R\+E\+AL, and R\+E\+A\+L\+\_\+\+E\+PS.



Referenced by measure().


\begin{DoxyCode}
1406                                                                               \{
1407     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(measureQubit >= 0 && measureQubit < multiQubit.
      \mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}}, 2, \_\_func\_\_);
1408 
1409     \textcolor{keywordtype}{int} outcome;
1410     \textcolor{comment}{// find probability of qubit being in state 1}
1411     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} stateProbInternal = \mbox{\hyperlink{QuEST__env__localGPU_8cu_ad315c941a51bc053d39ebfa2040fd32e}{findProbabilityOfOutcome}}(multiQubit, measureQubit,
       1);
1412 
1413     \textcolor{comment}{// we can't collapse to a state that has a probability too close to zero}
1414     \textcolor{keywordflow}{if} (stateProbInternal<\mbox{\hyperlink{QuEST__precision_8h_aebb5e6716e06431296af4d1a71744dec}{REAL\_EPS}}) outcome=0;
1415     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (1-stateProbInternal<\mbox{\hyperlink{QuEST__precision_8h_aebb5e6716e06431296af4d1a71744dec}{REAL\_EPS}}) outcome=1;
1416     \textcolor{keywordflow}{else} \{
1417         \textcolor{comment}{// ok. both P(0) and P(1) are large enough to resolve}
1418         \textcolor{comment}{// generate random float on [0,1]}
1419         \textcolor{keywordtype}{float} randNum = \mbox{\hyperlink{mt19937ar_8c_ac94ab75771800274ed1a2bedeca86f04}{genrand\_real1}}();
1420         \textcolor{keywordflow}{if} (randNum<=stateProbInternal) outcome = 1;
1421         \textcolor{keywordflow}{else} outcome = 0;
1422     \} 
1423     \textcolor{keywordflow}{if} (outcome==0) stateProbInternal = 1-stateProbInternal;
1424 
1425     \textcolor{keywordtype}{int} threadsPerCUDABlock, CUDABlocks;
1426     threadsPerCUDABlock = 128;
1427     CUDABlocks = ceil((\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})(multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1)/threadsPerCUDABlock);
1428     collapseToOutcomeKernel<<<CUDABlocks, threadsPerCUDABlock>>>(multiQubit, measureQubit, 
      stateProbInternal, outcome);
1429 
1430     *stateProb = stateProbInternal;
1431     \textcolor{keywordflow}{return} outcome;
1432 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_afc1835c6b43b6e59ce7df7b13f274fc7}\label{QuEST__env__localGPU_8cu_afc1835c6b43b6e59ce7df7b13f274fc7}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!multi\+Controlled\+Phase\+Gate@{multi\+Controlled\+Phase\+Gate}}
\index{multi\+Controlled\+Phase\+Gate@{multi\+Controlled\+Phase\+Gate}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{multi\+Controlled\+Phase\+Gate()}{multiControlledPhaseGate()}}
{\footnotesize\ttfamily void multi\+Controlled\+Phase\+Gate (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{int $\ast$}]{control\+Qubits,  }\item[{int}]{num\+Control\+Qubits }\end{DoxyParamCaption})}



Apply the multiple-\/qubit controlled phase gate, also known as the multiple-\/qubit controlled sigmaZ gate. 

For each state, if all control qubits have value one, multiply the amplitude of that state by -\/1. This applies the many-\/qubit unitary\+: \[ \begin{pmatrix} 1 \\ & 1 \\\ & & \ddots \\ & & & 1 \\ & & & & -1 \end{pmatrix} \] on the control qubits.

\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {controls}; \node[draw=none] at (0, 6) {$\vdots$}; \draw (0, 5) -- (0, 4); \draw (-2, 4) -- (2, 4); \draw[fill=black] (0, 4) circle (.2); \draw (0, 4) -- (0, 2); \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 0); \draw (-2,0) -- (2, 0); \draw[fill=black] (0, 0) circle (.2); \end{tikzpicture} } \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em control\+Qubits} & array of input qubits \\
\hline
\mbox{\tt in}  & {\em num\+Control\+Qubits} & number of input qubits \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily num\+Control\+Qubits} is outside \mbox{[}1, {\ttfamily multi\+Qubit.\+num\+Qubits}) \\
\hline
\end{DoxyExceptions}


Definition at line 993 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::chunk\+Id, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Multi\+Qubit\+::num\+Qubits, Qu\+E\+S\+T\+Assert(), Complex\+Array\+::real, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
994 \{
995     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(numControlQubits > 0 && numControlQubits <= multiQubit.
      \mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}}, 4, \_\_func\_\_);
996 
997     \textcolor{keywordtype}{int} threadsPerCUDABlock, CUDABlocks;
998     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} mask=0;
999     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0; i<numControlQubits; i++) mask = mask | (1LL<<controlQubits[i]);
1000     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(mask >=0 && mask <= (1LL<<multiQubit.\mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}})-1, 2, \_\_func\_\_);
1001     threadsPerCUDABlock = 128;
1002     CUDABlocks = ceil((\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})(multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}})/threadsPerCUDABlock);
1003     multiControlledPhaseGateKernel<<<CUDABlocks, threadsPerCUDABlock>>>(multiQubit, mask);
1004 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a31833a4edc084f5bcdbf10ee6845064a}\label{QuEST__env__localGPU_8cu_a31833a4edc084f5bcdbf10ee6845064a}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!multi\+Controlled\+Phase\+Gate\+Kernel@{multi\+Controlled\+Phase\+Gate\+Kernel}}
\index{multi\+Controlled\+Phase\+Gate\+Kernel@{multi\+Controlled\+Phase\+Gate\+Kernel}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{multi\+Controlled\+Phase\+Gate\+Kernel()}{multiControlledPhaseGateKernel()}}
{\footnotesize\ttfamily \+\_\+\+\_\+global\+\_\+\+\_\+ void multi\+Controlled\+Phase\+Gate\+Kernel (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{long long int}]{mask }\end{DoxyParamCaption})}



Definition at line 975 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::device\+State\+Vec, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Complex\+Array\+::real, and R\+E\+AL.


\begin{DoxyCode}
976 \{
977     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
978     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} stateVecSize;
979 
980     stateVecSize = multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}};
981     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecReal = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}};
982     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecImag = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}};
983 
984     index = blockIdx.x*blockDim.x + threadIdx.x;
985     \textcolor{keywordflow}{if} (index>=stateVecSize) \textcolor{keywordflow}{return};
986 
987     \textcolor{keywordflow}{if} (mask == (mask & index) )\{
988         stateVecReal [index] = - stateVecReal [index];
989         stateVecImag [index] = - stateVecImag [index];
990     \}
991 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_aa29551d2d5c883891faa75a4741dc71a}\label{QuEST__env__localGPU_8cu_aa29551d2d5c883891faa75a4741dc71a}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!multi\+Controlled\+Unitary@{multi\+Controlled\+Unitary}}
\index{multi\+Controlled\+Unitary@{multi\+Controlled\+Unitary}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{multi\+Controlled\+Unitary()}{multiControlledUnitary()}}
{\footnotesize\ttfamily void multi\+Controlled\+Unitary (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{int $\ast$}]{control\+Qubits,  }\item[{const int}]{num\+Control\+Qubits,  }\item[{const int}]{target\+Qubit,  }\item[{\mbox{\hyperlink{structComplexMatrix2}{Complex\+Matrix2}}}]{u }\end{DoxyParamCaption})}



Apply a general multiple-\/control single-\/target unitary, which can include a global phase factor. 

Any number of control qubits can be specified, and if all have value 1, the given unitary is applied to the target qubit. This effects the many-\/qubit unitary \[ \begin{pmatrix} 1 \\ & 1 \\\ & & \ddots \\ & & & u_{00} & u_{01}\\ & & & u_{10} & u_{11} \end{pmatrix} \] on the control and target qubits. The given 2x2 Complex\+Matrix must be unitary, otherwise an error is thrown.

\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 3) {controls}; \node[draw=none] at (-3.5, 0) {target}; \node[draw=none] at (0, 6) {$\vdots$}; \draw (0, 5) -- (0, 4); \draw (-2, 4) -- (2, 4); \draw[fill=black] (0, 4) circle (.2); \draw (0, 4) -- (0, 2); \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 1); \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {U}; \end{tikzpicture} } \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em control\+Qubits} & applies unitary if all qubits in this array equal 1 \\
\hline
\mbox{\tt in}  & {\em num\+Control\+Qubits} & number of control qubits \\
\hline
\mbox{\tt in}  & {\em target\+Qubit} & qubit to operate on \\
\hline
\mbox{\tt in}  & {\em u} & single-\/qubit unitary matrix to apply \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily num\+Control\+Qubits} is outside \mbox{[}1, {\ttfamily multi\+Qubit.\+num\+Qubits}\mbox{]}), or if any qubit index ({\ttfamily target\+Qubit} or one in {\ttfamily control\+Qubits}) is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}\mbox{]}), or if {\ttfamily control\+Qubits} contains {\ttfamily target\+Qubit}, or if {\ttfamily u} is not unitary. \\
\hline
\end{DoxyExceptions}


Definition at line 757 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References multi\+Controlled\+Unitary\+Local(), Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Multi\+Qubit\+::num\+Qubits, Qu\+E\+S\+T\+Assert(), R\+E\+AL, and validate\+Matrix\+Is\+Unitary().


\begin{DoxyCode}
758 \{
759     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(targetQubit >= 0 && targetQubit < multiQubit.
      \mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}}, 1, \_\_func\_\_);
760     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(numControlQubits > 0 && numControlQubits <= multiQubit.
      \mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}}, 4, \_\_func\_\_);
761     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(\mbox{\hyperlink{QuEST_8c_ae4fea133d1a8f09ff8da03038100adb2}{validateMatrixIsUnitary}}(u), 5, \_\_func\_\_);
762     \textcolor{keywordtype}{int} threadsPerCUDABlock, CUDABlocks;
763     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} mask=0;
764     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0; i<numControlQubits; i++) mask = mask | (1LL<<controlQubits[i]);
765     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(mask >=0 && mask <= (1LL<<multiQubit.\mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}})-1, 2, \_\_func\_\_);
766     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}((mask & (1LL<<targetQubit)) != (1LL<<targetQubit), 3, \_\_func\_\_);
767     threadsPerCUDABlock = 128;
768     CUDABlocks = ceil((\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})(multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1)/threadsPerCUDABlock);
769 
770     multiControlledUnitaryKernel<<<CUDABlocks, threadsPerCUDABlock>>>(multiQubit, mask, targetQubit, u);
771 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_af76f428eec6053839eb228152a51b5e3}\label{QuEST__env__localGPU_8cu_af76f428eec6053839eb228152a51b5e3}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!multi\+Controlled\+Unitary\+Kernel@{multi\+Controlled\+Unitary\+Kernel}}
\index{multi\+Controlled\+Unitary\+Kernel@{multi\+Controlled\+Unitary\+Kernel}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{multi\+Controlled\+Unitary\+Kernel()}{multiControlledUnitaryKernel()}}
{\footnotesize\ttfamily \+\_\+\+\_\+global\+\_\+\+\_\+ void multi\+Controlled\+Unitary\+Kernel (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{long long int}]{mask,  }\item[{const int}]{target\+Qubit,  }\item[{\mbox{\hyperlink{structComplexMatrix2}{Complex\+Matrix2}}}]{u }\end{DoxyParamCaption})}

fix -- no necessary for G\+PU version 

Definition at line 701 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::device\+State\+Vec, Complex\+Array\+::imag, Complex\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Complex\+Matrix2\+::r0c0, Complex\+Matrix2\+::r0c1, Complex\+Matrix2\+::r1c0, Complex\+Matrix2\+::r1c1, Complex\+Array\+::real, R\+E\+AL, and Complex\+::real.


\begin{DoxyCode}
701                                                                                                            
                           \{
702     \textcolor{comment}{// ----- sizes}
703     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} sizeBlock,                                           \textcolor{comment}{// size of blocks}
704          sizeHalfBlock;                                       \textcolor{comment}{// size of blocks halved}
705     \textcolor{comment}{// ----- indices}
706     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisBlock,                                           \textcolor{comment}{// current block}
707          indexUp,indexLo;                                     \textcolor{comment}{// current index and corresponding index in
       lower half block}
708 
709     \textcolor{comment}{// ----- temp variables}
710     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}}   stateRealUp,stateRealLo,                             \textcolor{comment}{// storage for previous state values}
711            stateImagUp,stateImagLo;                             \textcolor{comment}{// (used in updates)}
712     \textcolor{comment}{// ----- temp variables}
713     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisTask;                                   \textcolor{comment}{// task based approach for expose loop with
       small granularity}
714     \textcolor{keyword}{const} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numTasks=multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1;
715 
716 
717     sizeHalfBlock = 1LL << targetQubit;                               \textcolor{comment}{// size of blocks halved}
718     sizeBlock     = 2LL * sizeHalfBlock;                           \textcolor{comment}{// size of blocks}
719 
720     \textcolor{comment}{// ---------------------------------------------------------------- //}
721     \textcolor{comment}{//            rotate                                                //}
722     \textcolor{comment}{// ---------------------------------------------------------------- //}
723 
725     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecReal = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}};
726     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecImag = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}};
727 
728     thisTask = blockIdx.x*blockDim.x + threadIdx.x;
729     \textcolor{keywordflow}{if} (thisTask>=numTasks) \textcolor{keywordflow}{return};
730 
731     thisBlock   = thisTask / sizeHalfBlock;
732     indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
733     indexLo     = indexUp + sizeHalfBlock;
734 
735     \textcolor{keywordflow}{if} (mask == (mask & indexUp) )\{
736         \textcolor{comment}{// store current state vector values in temp variables}
737         stateRealUp = stateVecReal[indexUp];
738         stateImagUp = stateVecImag[indexUp];
739 
740         stateRealLo = stateVecReal[indexLo];
741         stateImagLo = stateVecImag[indexLo];
742 
743         \textcolor{comment}{// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]}
744         stateVecReal[indexUp] = u.\mbox{\hyperlink{structComplexMatrix2_ae72b4458233b077a636beee1892e81ff}{r0c0}}.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}}*stateRealUp - u.\mbox{\hyperlink{structComplexMatrix2_ae72b4458233b077a636beee1892e81ff}{r0c0}}.
      \mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}*stateImagUp 
745             + u.\mbox{\hyperlink{structComplexMatrix2_a0f3932f055a8b05cef361bce25d51172}{r0c1}}.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}}*stateRealLo - u.\mbox{\hyperlink{structComplexMatrix2_a0f3932f055a8b05cef361bce25d51172}{r0c1}}.\mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}*stateImagLo;
746         stateVecImag[indexUp] = u.\mbox{\hyperlink{structComplexMatrix2_ae72b4458233b077a636beee1892e81ff}{r0c0}}.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}}*stateImagUp + u.\mbox{\hyperlink{structComplexMatrix2_ae72b4458233b077a636beee1892e81ff}{r0c0}}.
      \mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}*stateRealUp 
747             + u.\mbox{\hyperlink{structComplexMatrix2_a0f3932f055a8b05cef361bce25d51172}{r0c1}}.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}}*stateImagLo + u.\mbox{\hyperlink{structComplexMatrix2_a0f3932f055a8b05cef361bce25d51172}{r0c1}}.\mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}*stateRealLo;
748 
749         \textcolor{comment}{// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]}
750         stateVecReal[indexLo] = u.\mbox{\hyperlink{structComplexMatrix2_ab98282015ed2065e53fbc9638e2583ab}{r1c0}}.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}}*stateRealUp  - u.\mbox{\hyperlink{structComplexMatrix2_ab98282015ed2065e53fbc9638e2583ab}{r1c0}}.
      \mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}*stateImagUp 
751             + u.\mbox{\hyperlink{structComplexMatrix2_a763007c3070802373549ba0350f83c8a}{r1c1}}.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}}*stateRealLo  -  u.\mbox{\hyperlink{structComplexMatrix2_a763007c3070802373549ba0350f83c8a}{r1c1}}.\mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}*stateImagLo;
752         stateVecImag[indexLo] = u.\mbox{\hyperlink{structComplexMatrix2_ab98282015ed2065e53fbc9638e2583ab}{r1c0}}.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}}*stateImagUp + u.\mbox{\hyperlink{structComplexMatrix2_ab98282015ed2065e53fbc9638e2583ab}{r1c0}}.
      \mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}*stateRealUp 
753             + u.\mbox{\hyperlink{structComplexMatrix2_a763007c3070802373549ba0350f83c8a}{r1c1}}.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}}*stateImagLo + u.\mbox{\hyperlink{structComplexMatrix2_a763007c3070802373549ba0350f83c8a}{r1c1}}.\mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}*stateRealLo;
754     \}
755 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_aae7a8a7f1ccbddb7f76b6c52b746bb43}\label{QuEST__env__localGPU_8cu_aae7a8a7f1ccbddb7f76b6c52b746bb43}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!phase\+Gate@{phase\+Gate}}
\index{phase\+Gate@{phase\+Gate}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{phase\+Gate()}{phaseGate()}}
{\footnotesize\ttfamily void phase\+Gate (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{target\+Qubit,  }\item[{enum \mbox{\hyperlink{QuEST_8h_a5739021c733cecc49647956b2f7338ea}{phase\+Gate\+Type}}}]{type }\end{DoxyParamCaption})}



Definition at line 933 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Multi\+Qubit\+::num\+Qubits, phase\+Gate\+Local(), Qu\+E\+S\+T\+Assert(), and R\+E\+AL.


\begin{DoxyCode}
934 \{
935     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(targetQubit >= 0 && targetQubit < multiQubit.
      \mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}}, 1, \_\_func\_\_);
936     \textcolor{keywordtype}{int} threadsPerCUDABlock, CUDABlocks;
937     threadsPerCUDABlock = 128;
938     CUDABlocks = ceil((\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})(multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1)/threadsPerCUDABlock);
939     phaseGateKernel<<<CUDABlocks, threadsPerCUDABlock>>>(multiQubit, targetQubit, type);
940 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_aaf4f43971c469524f45d3bbc6d5f1167}\label{QuEST__env__localGPU_8cu_aaf4f43971c469524f45d3bbc6d5f1167}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!phase\+Gate\+Kernel@{phase\+Gate\+Kernel}}
\index{phase\+Gate\+Kernel@{phase\+Gate\+Kernel}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{phase\+Gate\+Kernel()}{phaseGateKernel()}}
{\footnotesize\ttfamily \+\_\+\+\_\+global\+\_\+\+\_\+ void phase\+Gate\+Kernel (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{target\+Qubit,  }\item[{enum \mbox{\hyperlink{QuEST_8h_a5739021c733cecc49647956b2f7338ea}{phase\+Gate\+Type}}}]{type }\end{DoxyParamCaption})}

fix -- no necessary for G\+PU version 

Definition at line 880 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::device\+State\+Vec, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Complex\+Array\+::real, R\+E\+AL, S\+\_\+\+G\+A\+TE, S\+I\+G\+M\+A\+\_\+Z, and T\+\_\+\+G\+A\+TE.


\begin{DoxyCode}
880                                                                                                       \{
881     \textcolor{comment}{// ----- sizes}
882     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} sizeBlock,                                           \textcolor{comment}{// size of blocks}
883          sizeHalfBlock;                                       \textcolor{comment}{// size of blocks halved}
884     \textcolor{comment}{// ----- indices}
885     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisBlock,                                           \textcolor{comment}{// current block}
886          indexUp,indexLo;                                     \textcolor{comment}{// current index and corresponding index in
       lower half block}
887 
888     \textcolor{comment}{// ----- temp variables}
889     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}}   stateRealLo,                             \textcolor{comment}{// storage for previous state values}
890            stateImagLo;                             \textcolor{comment}{// (used in updates)}
891     \textcolor{comment}{// ----- temp variables}
892     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisTask;                                   \textcolor{comment}{// task based approach for expose loop with
       small granularity}
893     \textcolor{keyword}{const} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numTasks=multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1;
894 
895     sizeHalfBlock = 1LL << targetQubit;                               \textcolor{comment}{// size of blocks halved}
896     sizeBlock     = 2LL * sizeHalfBlock;                           \textcolor{comment}{// size of blocks}
897 
898     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} recRoot2 = 1.0/sqrt(2.0);
899 
900     \textcolor{comment}{// ---------------------------------------------------------------- //}
901     \textcolor{comment}{//            rotate                                                //}
902     \textcolor{comment}{// ---------------------------------------------------------------- //}
903 
905     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecReal = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}};
906     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecImag = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}};
907 
908     thisTask = blockIdx.x*blockDim.x + threadIdx.x;
909     \textcolor{keywordflow}{if} (thisTask>=numTasks) \textcolor{keywordflow}{return};
910     thisBlock   = thisTask / sizeHalfBlock;
911     indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
912     indexLo     = indexUp + sizeHalfBlock;
913 
914     \textcolor{keywordflow}{if} (type==\mbox{\hyperlink{QuEST_8h_a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac}{SIGMA\_Z}})\{
915         stateVecReal[indexLo] = -stateVecReal[indexLo];
916         stateVecImag[indexLo] = -stateVecImag[indexLo];
917     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (type==\mbox{\hyperlink{QuEST_8h_a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f}{S\_GATE}})\{
918         stateRealLo = stateVecReal[indexLo];
919         stateImagLo = stateVecImag[indexLo];
920 
921         stateVecReal[indexLo] = -stateImagLo;
922         stateVecImag[indexLo] = stateRealLo;
923     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (type==\mbox{\hyperlink{QuEST_8h_a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab}{T\_GATE}})\{
924         stateRealLo = stateVecReal[indexLo];
925         stateImagLo = stateVecImag[indexLo];
926 
927         stateVecReal[indexLo] = recRoot2 * (stateRealLo - stateImagLo);
928         stateVecImag[indexLo] = recRoot2 * (stateRealLo + stateImagLo);
929     \}
930 
931 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}\label{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!Qu\+E\+S\+T\+Assert@{Qu\+E\+S\+T\+Assert}}
\index{Qu\+E\+S\+T\+Assert@{Qu\+E\+S\+T\+Assert}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{Qu\+E\+S\+T\+Assert()}{QuESTAssert()}}
{\footnotesize\ttfamily void Qu\+E\+S\+T\+Assert (\begin{DoxyParamCaption}\item[{int}]{is\+Valid,  }\item[{int}]{error\+Code,  }\item[{const char $\ast$}]{func }\end{DoxyParamCaption})}



Definition at line 1442 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References exit\+With\+Error().



Referenced by collapse\+To\+Outcome(), compact\+Unitary(), controlled\+Compact\+Unitary(), controlled\+Not(), controlled\+Phase\+Gate(), controlled\+Unitary(), create\+Multi\+Qubit(), find\+Probability\+Of\+Outcome(), hadamard(), measure(), measure\+With\+Stats(), multi\+Controlled\+Phase\+Gate(), multi\+Controlled\+Unitary(), phase\+Gate(), sigma\+X(), sigma\+Y(), and unitary().


\begin{DoxyCode}
1442                                                               \{
1443     \textcolor{keywordflow}{if} (!isValid) \mbox{\hyperlink{QuEST__env__localGPU_8cu_ae5f9019826f35e8b51b1716cfe397b45}{exitWithError}}(errorCode, func);
1444 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a4c740fa3ae25c71c1736790c674bdc98}\label{QuEST__env__localGPU_8cu_a4c740fa3ae25c71c1736790c674bdc98}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!reduce\+Block@{reduce\+Block}}
\index{reduce\+Block@{reduce\+Block}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{reduce\+Block()}{reduceBlock()}}
{\footnotesize\ttfamily \+\_\+\+\_\+device\+\_\+\+\_\+ void reduce\+Block (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$}]{array\+In,  }\item[{\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$}]{reduced\+Array,  }\item[{int}]{length }\end{DoxyParamCaption})}



Definition at line 1123 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References log2\+Int().



Referenced by copy\+Shared\+Reduce\+Block(), and find\+Probability\+Of\+Zero\+Kernel().


\begin{DoxyCode}
1123                                                                           \{
1124     \textcolor{keywordtype}{int} i, l, r;
1125     \textcolor{keywordtype}{int} threadMax, maxDepth;
1126     threadMax = length/2;
1127     maxDepth = \mbox{\hyperlink{QuEST__env__localGPU_8cu_a8ce1e311ea72b862a8757dc71082fbf3}{log2Int}}(length/2);
1128 
1129     \textcolor{keywordflow}{for} (i=0; i<maxDepth+1; i++)\{
1130         \textcolor{keywordflow}{if} (threadIdx.x<threadMax)\{
1131             l = threadIdx.x;
1132             r = l + threadMax;
1133             arrayIn[l] = arrayIn[r] + arrayIn[l];
1134         \}
1135         threadMax = threadMax >> 1;
1136         \_\_syncthreads(); \textcolor{comment}{// optimise -- use warp shuffle instead}
1137     \}
1138 
1139     \textcolor{keywordflow}{if} (threadIdx.x==0) reducedArray[blockIdx.x] = arrayIn[0];
1140 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_af8a14ae79c3fb2c0b5f6255cc37bebf9}\label{QuEST__env__localGPU_8cu_af8a14ae79c3fb2c0b5f6255cc37bebf9}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!report\+Qu\+E\+S\+T\+Env@{report\+Qu\+E\+S\+T\+Env}}
\index{report\+Qu\+E\+S\+T\+Env@{report\+Qu\+E\+S\+T\+Env}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{report\+Qu\+E\+S\+T\+Env()}{reportQuESTEnv()}}
{\footnotesize\ttfamily void report\+Qu\+E\+S\+T\+Env (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}}}]{env }\end{DoxyParamCaption})}



Report information about the Qu\+E\+ST environment. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em env} & object representing the execution environment. A single instance is used for each program \\
\hline
\end{DoxyParams}


Definition at line 129 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References env, Qu\+E\+S\+T\+Env\+::num\+Ranks, and R\+E\+AL.


\begin{DoxyCode}
129                                  \{
130     printf(\textcolor{stringliteral}{"EXECUTION ENVIRONMENT:\(\backslash\)n"});
131     printf(\textcolor{stringliteral}{"Running locally on one node with GPU\(\backslash\)n"});
132     printf(\textcolor{stringliteral}{"Number of ranks is %d\(\backslash\)n"}, \mbox{\hyperlink{runTests_8c_a5fd8ba97fcae3408ae6221dfc3cc1f93}{env}}.\mbox{\hyperlink{structQuESTEnv_af22aacd7c9905accae28484785c193b4}{numRanks}});
133 \textcolor{preprocessor}{# ifdef \_OPENMP}
134     printf(\textcolor{stringliteral}{"OpenMP enabled\(\backslash\)n"});
135     printf(\textcolor{stringliteral}{"Number of threads available is %d\(\backslash\)n"}, omp\_get\_max\_threads());
136 \textcolor{preprocessor}{# else}
137     printf(\textcolor{stringliteral}{"OpenMP disabled\(\backslash\)n"});
138 \textcolor{preprocessor}{# endif}
139 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a842d6884e063a5865a2232cba56b65ac}\label{QuEST__env__localGPU_8cu_a842d6884e063a5865a2232cba56b65ac}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!report\+State\+To\+Screen@{report\+State\+To\+Screen}}
\index{report\+State\+To\+Screen@{report\+State\+To\+Screen}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{report\+State\+To\+Screen()}{reportStateToScreen()}}
{\footnotesize\ttfamily void report\+State\+To\+Screen (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{\mbox{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}}}]{env,  }\item[{int}]{report\+Rank }\end{DoxyParamCaption})}



Print the current state vector of probability amplitudes for a set of qubits to standard out. 

For debugging purposes. Each rank should print output serially. Only print output for systems $<$= 5 qubits 

Definition at line 173 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::chunk\+Id, copy\+State\+From\+G\+P\+U(), env, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Multi\+Qubit\+::num\+Chunks, Multi\+Qubit\+::num\+Qubits, Complex\+Array\+::real, R\+E\+A\+L\+\_\+\+S\+T\+R\+I\+N\+G\+\_\+\+F\+O\+R\+M\+AT, Multi\+Qubit\+::state\+Vec, and sync\+Qu\+E\+S\+T\+Env().


\begin{DoxyCode}
173                                                                              \{
174     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
175     \textcolor{keywordtype}{int} rank;
176     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a0d255fec1e375244d4cb980fac92621d}{copyStateFromGPU}}(multiQubit); 
177     \textcolor{keywordflow}{if} (multiQubit.\mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}}<=5)\{
178         \textcolor{keywordflow}{for} (rank=0; rank<multiQubit.\mbox{\hyperlink{structMultiQubit_acd43f2f57991709c9e94f73662c972b2}{numChunks}}; rank++)\{
179             \textcolor{keywordflow}{if} (multiQubit.\mbox{\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId}}==rank)\{
180                 \textcolor{keywordflow}{if} (reportRank) \{
181                     printf(\textcolor{stringliteral}{"Reporting state from rank %d [\(\backslash\)n"}, multiQubit.
      \mbox{\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId}});
182                     \textcolor{comment}{//printf("\(\backslash\)trank, index, real, imag\(\backslash\)n");}
183                     printf(\textcolor{stringliteral}{"real, imag\(\backslash\)n"});
184                 \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (rank==0) \{
185                     printf(\textcolor{stringliteral}{"Reporting state [\(\backslash\)n"});
186                     printf(\textcolor{stringliteral}{"real, imag\(\backslash\)n"});
187                 \}
188 
189                 \textcolor{keywordflow}{for}(index=0; index<multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}; index++)\{
190                     printf(\mbox{\hyperlink{QuEST__precision_8h_ad751ac7ddc8ec19f23fb33083c0da8da}{REAL\_STRING\_FORMAT}} \textcolor{stringliteral}{", "} 
      \mbox{\hyperlink{QuEST__precision_8h_ad751ac7ddc8ec19f23fb33083c0da8da}{REAL\_STRING\_FORMAT}} \textcolor{stringliteral}{"\(\backslash\)n"}, multiQubit.\mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}}[index], multiQubit.
      \mbox{\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}}[index]);
191                 \}
192                 \textcolor{keywordflow}{if} (reportRank || rank==multiQubit.\mbox{\hyperlink{structMultiQubit_acd43f2f57991709c9e94f73662c972b2}{numChunks}}-1) printf(\textcolor{stringliteral}{"]\(\backslash\)n"});
193             \}
194             \mbox{\hyperlink{QuEST__env__localGPU_8cu_a8d31fe2d1ad4d01e2a1f5f6b8bc15b77}{syncQuESTEnv}}(\mbox{\hyperlink{runTests_8c_a5fd8ba97fcae3408ae6221dfc3cc1f93}{env}});
195         \}
196     \}
197 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a86e396e06b7d527cac20ba0108872423}\label{QuEST__env__localGPU_8cu_a86e396e06b7d527cac20ba0108872423}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!sigmaX@{sigmaX}}
\index{sigmaX@{sigmaX}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{sigma\+X()}{sigmaX()}}
{\footnotesize\ttfamily void sigmaX (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{target\+Qubit }\end{DoxyParamCaption})}



Apply the single-\/qubit sigma-\/X (also known as the X, Pauli-\/X, N\+OT or bit-\/flip) gate. 

This is a rotation of $\pi$ around the x-\/axis on the Bloch sphere. I.\+e. \[ \begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix} \] ~\newline
 \[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (2, 0); \draw (0, 0) circle (.5); \draw (0, .5) -- (0, -.5); \end{tikzpicture} } \] ~\newline
 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em target\+Qubit} & qubit to operate on \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily target\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}). \\
\hline
\end{DoxyExceptions}


Definition at line 817 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Multi\+Qubit\+::num\+Qubits, Qu\+E\+S\+T\+Assert(), R\+E\+AL, and sigma\+X\+Local().


\begin{DoxyCode}
818 \{
819     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(targetQubit >= 0 && targetQubit < multiQubit.
      \mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}}, 1, \_\_func\_\_);
820     \textcolor{keywordtype}{int} threadsPerCUDABlock, CUDABlocks;
821     threadsPerCUDABlock = 128;
822     CUDABlocks = ceil((\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})(multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1)/threadsPerCUDABlock);
823     sigmaXKernel<<<CUDABlocks, threadsPerCUDABlock>>>(multiQubit, targetQubit);
824 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_ad43da9e3fa8837956a5ea17f2259d65e}\label{QuEST__env__localGPU_8cu_ad43da9e3fa8837956a5ea17f2259d65e}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!sigma\+X\+Kernel@{sigma\+X\+Kernel}}
\index{sigma\+X\+Kernel@{sigma\+X\+Kernel}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{sigma\+X\+Kernel()}{sigmaXKernel()}}
{\footnotesize\ttfamily \+\_\+\+\_\+global\+\_\+\+\_\+ void sigma\+X\+Kernel (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{target\+Qubit }\end{DoxyParamCaption})}

fix -- no necessary for G\+PU version 

Definition at line 773 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::device\+State\+Vec, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Complex\+Array\+::real, and R\+E\+AL.


\begin{DoxyCode}
773                                                                           \{
774     \textcolor{comment}{// ----- sizes}
775     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} sizeBlock,                                           \textcolor{comment}{// size of blocks}
776          sizeHalfBlock;                                       \textcolor{comment}{// size of blocks halved}
777     \textcolor{comment}{// ----- indices}
778     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisBlock,                                           \textcolor{comment}{// current block}
779          indexUp,indexLo;                                     \textcolor{comment}{// current index and corresponding index in
       lower half block}
780 
781     \textcolor{comment}{// ----- temp variables}
782     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}}   stateRealUp,                             \textcolor{comment}{// storage for previous state values}
783            stateImagUp;                             \textcolor{comment}{// (used in updates)}
784     \textcolor{comment}{// ----- temp variables}
785     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisTask;                                   \textcolor{comment}{// task based approach for expose loop with
       small granularity}
786     \textcolor{keyword}{const} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numTasks=multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1;
787 
788     sizeHalfBlock = 1LL << targetQubit;                               \textcolor{comment}{// size of blocks halved}
789     sizeBlock     = 2LL * sizeHalfBlock;                           \textcolor{comment}{// size of blocks}
790 
791     \textcolor{comment}{// ---------------------------------------------------------------- //}
792     \textcolor{comment}{//            rotate                                                //}
793     \textcolor{comment}{// ---------------------------------------------------------------- //}
794 
796     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecReal = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}};
797     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecImag = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}};
798 
799     thisTask = blockIdx.x*blockDim.x + threadIdx.x;
800     \textcolor{keywordflow}{if} (thisTask>=numTasks) \textcolor{keywordflow}{return};
801 
802     thisBlock   = thisTask / sizeHalfBlock;
803     indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
804     indexLo     = indexUp + sizeHalfBlock;
805 
806     \textcolor{comment}{// store current state vector values in temp variables}
807     stateRealUp = stateVecReal[indexUp];
808     stateImagUp = stateVecImag[indexUp];
809 
810     stateVecReal[indexUp] = stateVecReal[indexLo];
811     stateVecImag[indexUp] = stateVecImag[indexLo];
812 
813     stateVecReal[indexLo] = stateRealUp;
814     stateVecImag[indexLo] = stateImagUp;
815 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a1f54d70a42403f7e1c2e2c2007332f61}\label{QuEST__env__localGPU_8cu_a1f54d70a42403f7e1c2e2c2007332f61}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!sigmaY@{sigmaY}}
\index{sigmaY@{sigmaY}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{sigma\+Y()}{sigmaY()}}
{\footnotesize\ttfamily void sigmaY (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{target\+Qubit }\end{DoxyParamCaption})}



Apply the single-\/qubit sigma-\/Y (also known as the Y or Pauli-\/Y) gate. 

This is a rotation of $\pi$ around the Y-\/axis on the Bloch sphere. I.\+e. \[ \begin{pmatrix} 0 & -i \\ i & 0 \end{pmatrix} \] ~\newline
 \[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$\sigma_y$}; \end{tikzpicture} } \] ~\newline
 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em target\+Qubit} & qubit to operate on \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily target\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}). \\
\hline
\end{DoxyExceptions}
fix -- put duplicate code (sigmaX, sigmaY) in seperate function 

Definition at line 871 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Multi\+Qubit\+::num\+Qubits, Qu\+E\+S\+T\+Assert(), R\+E\+AL, and sigma\+Y\+Local().


\begin{DoxyCode}
872 \{
873     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(targetQubit >= 0 && targetQubit < multiQubit.
      \mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}}, 1, \_\_func\_\_);
874     \textcolor{keywordtype}{int} threadsPerCUDABlock, CUDABlocks;
875     threadsPerCUDABlock = 128;
876     CUDABlocks = ceil((\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})(multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1)/threadsPerCUDABlock);
877     sigmaYKernel<<<CUDABlocks, threadsPerCUDABlock>>>(multiQubit, targetQubit);
878 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_ac4766903f6ff9c70f6c957aa3d0a5c5f}\label{QuEST__env__localGPU_8cu_ac4766903f6ff9c70f6c957aa3d0a5c5f}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!sigma\+Y\+Kernel@{sigma\+Y\+Kernel}}
\index{sigma\+Y\+Kernel@{sigma\+Y\+Kernel}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{sigma\+Y\+Kernel()}{sigmaYKernel()}}
{\footnotesize\ttfamily \+\_\+\+\_\+global\+\_\+\+\_\+ void sigma\+Y\+Kernel (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{target\+Qubit }\end{DoxyParamCaption})}

fix -- no necessary for G\+PU version 

Definition at line 827 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::device\+State\+Vec, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Complex\+Array\+::real, and R\+E\+AL.


\begin{DoxyCode}
827                                                                           \{
828     \textcolor{comment}{// ----- sizes}
829     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} sizeBlock,                                           \textcolor{comment}{// size of blocks}
830          sizeHalfBlock;                                       \textcolor{comment}{// size of blocks halved}
831     \textcolor{comment}{// ----- indices}
832     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisBlock,                                           \textcolor{comment}{// current block}
833          indexUp,indexLo;                                     \textcolor{comment}{// current index and corresponding index in
       lower half block}
834 
835     \textcolor{comment}{// ----- temp variables}
836     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}}   stateRealUp,                             \textcolor{comment}{// storage for previous state values}
837            stateImagUp;                             \textcolor{comment}{// (used in updates)}
838     \textcolor{comment}{// ----- temp variables}
839     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisTask;                                   \textcolor{comment}{// task based approach for expose loop with
       small granularity}
840     \textcolor{keyword}{const} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numTasks=multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1;
841 
842     sizeHalfBlock = 1LL << targetQubit;                               \textcolor{comment}{// size of blocks halved}
843     sizeBlock     = 2LL * sizeHalfBlock;                           \textcolor{comment}{// size of blocks}
844 
845     \textcolor{comment}{// ---------------------------------------------------------------- //}
846     \textcolor{comment}{//            rotate                                                //}
847     \textcolor{comment}{// ---------------------------------------------------------------- //}
848 
850     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecReal = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}};
851     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecImag = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}};
852 
853     thisTask = blockIdx.x*blockDim.x + threadIdx.x;
854     \textcolor{keywordflow}{if} (thisTask>=numTasks) \textcolor{keywordflow}{return};
855 
856     thisBlock   = thisTask / sizeHalfBlock;
857     indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
858     indexLo     = indexUp + sizeHalfBlock;
859 
860     \textcolor{comment}{// store current state vector values in temp variables}
861     stateRealUp = stateVecReal[indexUp];
862     stateImagUp = stateVecImag[indexUp];
863 
864     stateVecReal[indexUp] = stateVecImag[indexLo];
865     stateVecImag[indexUp] = -stateVecReal[indexLo];
866 
867     stateVecReal[indexLo] = -stateImagUp;
868     stateVecImag[indexLo] = stateRealUp;
869 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_aac328dfe6dd7cceec36a83d989b180b6}\label{QuEST__env__localGPU_8cu_aac328dfe6dd7cceec36a83d989b180b6}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!swap\+Double@{swap\+Double}}
\index{swap\+Double@{swap\+Double}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{swap\+Double()}{swapDouble()}}
{\footnotesize\ttfamily void swap\+Double (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$$\ast$}]{a,  }\item[{\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}} $\ast$$\ast$}]{b }\end{DoxyParamCaption})}



Definition at line 1210 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References R\+E\+AL.



Referenced by find\+Probability\+Of\+Zero().


\begin{DoxyCode}
1210                                    \{
1211     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *temp;
1212     temp = *a;
1213     *a = *b;
1214     *b = temp;
1215 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a8d31fe2d1ad4d01e2a1f5f6b8bc15b77}\label{QuEST__env__localGPU_8cu_a8d31fe2d1ad4d01e2a1f5f6b8bc15b77}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!sync\+Qu\+E\+S\+T\+Env@{sync\+Qu\+E\+S\+T\+Env}}
\index{sync\+Qu\+E\+S\+T\+Env@{sync\+Qu\+E\+S\+T\+Env}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{sync\+Qu\+E\+S\+T\+Env()}{syncQuESTEnv()}}
{\footnotesize\ttfamily void sync\+Qu\+E\+S\+T\+Env (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}}}]{env }\end{DoxyParamCaption})}



Guarantees that all code up to the given point has been executed on all nodes (if running in distributed mode) 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em env} & object representing the execution environment. A single instance is used for each program \\
\hline
\end{DoxyParams}


Definition at line 117 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



Referenced by report\+State\+To\+Screen().


\begin{DoxyCode}
117                                \{
118     cudaDeviceSynchronize();
119 \} 
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_ac7e38d768a1bd79019f88cc1e6295092}\label{QuEST__env__localGPU_8cu_ac7e38d768a1bd79019f88cc1e6295092}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!sync\+Qu\+E\+S\+T\+Success@{sync\+Qu\+E\+S\+T\+Success}}
\index{sync\+Qu\+E\+S\+T\+Success@{sync\+Qu\+E\+S\+T\+Success}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{sync\+Qu\+E\+S\+T\+Success()}{syncQuESTSuccess()}}
{\footnotesize\ttfamily int sync\+Qu\+E\+S\+T\+Success (\begin{DoxyParamCaption}\item[{int}]{success\+Code }\end{DoxyParamCaption})}



Performs a logical A\+ND on all success\+Codes held by all processes. 

If any one process has a zero success\+Code all processes will return a zero success code.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em env} & object representing the execution environment. A single instance is used for each program \\
\hline
\mbox{\tt in}  & {\em success\+Code} & 1 if process task succeeded, 0 if process task failed \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if all processes succeeded, 0 if any one process failed 
\end{DoxyReturn}


Definition at line 121 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.


\begin{DoxyCode}
121                                      \{
122     \textcolor{keywordflow}{return} successCode;
123 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a7a0877e33700f6bad48adb51b7b3fb67}\label{QuEST__env__localGPU_8cu_a7a0877e33700f6bad48adb51b7b3fb67}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!unitary@{unitary}}
\index{unitary@{unitary}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{unitary()}{unitary()}}
{\footnotesize\ttfamily void unitary (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{target\+Qubit,  }\item[{\mbox{\hyperlink{structComplexMatrix2}{Complex\+Matrix2}}}]{u }\end{DoxyParamCaption})}



Apply a general single-\/qubit unitary (including a global phase factor). 

The passed 2x2 Complex\+Matrix must be unitary, otherwise an error is thrown.

\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {U}; \end{tikzpicture} } \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em target\+Qubit} & qubit to operate on \\
\hline
\mbox{\tt in}  & {\em u} & unitary matrix to apply \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily target\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}), or matrix {\ttfamily u} is not unitary. \\
\hline
\end{DoxyExceptions}


Definition at line 620 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Multi\+Qubit\+::num\+Qubits, Qu\+E\+S\+T\+Assert(), R\+E\+AL, unitary\+Local(), and validate\+Matrix\+Is\+Unitary().


\begin{DoxyCode}
621 \{
622     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(targetQubit >= 0 && targetQubit < multiQubit.
      \mbox{\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}}, 1, \_\_func\_\_);
623     \mbox{\hyperlink{QuEST__env__localGPU_8cu_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}}(\mbox{\hyperlink{QuEST_8c_ae4fea133d1a8f09ff8da03038100adb2}{validateMatrixIsUnitary}}(u), 5, \_\_func\_\_);
624     \textcolor{keywordtype}{int} threadsPerCUDABlock, CUDABlocks;
625     threadsPerCUDABlock = 128;
626     CUDABlocks = ceil((\mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}})(multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1)/threadsPerCUDABlock);
627     unitaryKernel<<<CUDABlocks, threadsPerCUDABlock>>>(multiQubit, targetQubit, u);
628 \}
\end{DoxyCode}
\mbox{\Hypertarget{QuEST__env__localGPU_8cu_a266ad950d573d78d37df09828d63de17}\label{QuEST__env__localGPU_8cu_a266ad950d573d78d37df09828d63de17}} 
\index{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}!unitary\+Kernel@{unitary\+Kernel}}
\index{unitary\+Kernel@{unitary\+Kernel}!Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu@{Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu}}
\paragraph{\texorpdfstring{unitary\+Kernel()}{unitaryKernel()}}
{\footnotesize\ttfamily \+\_\+\+\_\+global\+\_\+\+\_\+ void unitary\+Kernel (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMultiQubit}{Multi\+Qubit}}}]{multi\+Qubit,  }\item[{const int}]{target\+Qubit,  }\item[{\mbox{\hyperlink{structComplexMatrix2}{Complex\+Matrix2}}}]{u }\end{DoxyParamCaption})}

fix -- no necessary for G\+PU version 

Definition at line 567 of file Qu\+E\+S\+T\+\_\+env\+\_\+local\+G\+P\+U.\+cu.



References Multi\+Qubit\+::device\+State\+Vec, Complex\+Array\+::imag, Complex\+::imag, Multi\+Qubit\+::num\+Amps\+Per\+Chunk, Complex\+Matrix2\+::r0c0, Complex\+Matrix2\+::r0c1, Complex\+Matrix2\+::r1c0, Complex\+Matrix2\+::r1c1, Complex\+Array\+::real, R\+E\+AL, and Complex\+::real.


\begin{DoxyCode}
567                                                                                              \{
568     \textcolor{comment}{// ----- sizes}
569     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} sizeBlock,                                           \textcolor{comment}{// size of blocks}
570          sizeHalfBlock;                                       \textcolor{comment}{// size of blocks halved}
571     \textcolor{comment}{// ----- indices}
572     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisBlock,                                           \textcolor{comment}{// current block}
573          indexUp,indexLo;                                     \textcolor{comment}{// current index and corresponding index in
       lower half block}
574 
575     \textcolor{comment}{// ----- temp variables}
576     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}}   stateRealUp,stateRealLo,                             \textcolor{comment}{// storage for previous state values}
577            stateImagUp,stateImagLo;                             \textcolor{comment}{// (used in updates)}
578     \textcolor{comment}{// ----- temp variables}
579     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} thisTask;                                   \textcolor{comment}{// task based approach for expose loop with
       small granularity}
580     \textcolor{keyword}{const} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numTasks=multiQubit.\mbox{\hyperlink{structMultiQubit_a1cad83601a78635dd278259c7ed54f18}{numAmpsPerChunk}}>>1;
581 
582     sizeHalfBlock = 1LL << targetQubit;                               \textcolor{comment}{// size of blocks halved}
583     sizeBlock     = 2LL * sizeHalfBlock;                           \textcolor{comment}{// size of blocks}
584 
585     \textcolor{comment}{// ---------------------------------------------------------------- //}
586     \textcolor{comment}{//            rotate                                                //}
587     \textcolor{comment}{// ---------------------------------------------------------------- //}
588 
590     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecReal = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}};
591     \mbox{\hyperlink{QuEST__precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}} *stateVecImag = multiQubit.\mbox{\hyperlink{structMultiQubit_a59ac613486a41b8c9a4b6e79cc8d2cc3}{deviceStateVec}}.\mbox{\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}};
592 
593     thisTask = blockIdx.x*blockDim.x + threadIdx.x;
594     \textcolor{keywordflow}{if} (thisTask>=numTasks) \textcolor{keywordflow}{return};
595 
596     thisBlock   = thisTask / sizeHalfBlock;
597     indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
598     indexLo     = indexUp + sizeHalfBlock;
599 
600     \textcolor{comment}{// store current state vector values in temp variables}
601     stateRealUp = stateVecReal[indexUp];
602     stateImagUp = stateVecImag[indexUp];
603 
604     stateRealLo = stateVecReal[indexLo];
605     stateImagLo = stateVecImag[indexLo];
606 
607     \textcolor{comment}{// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]}
608     stateVecReal[indexUp] = u.\mbox{\hyperlink{structComplexMatrix2_ae72b4458233b077a636beee1892e81ff}{r0c0}}.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}}*stateRealUp - u.\mbox{\hyperlink{structComplexMatrix2_ae72b4458233b077a636beee1892e81ff}{r0c0}}.\mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}*stateImagUp 
609         + u.\mbox{\hyperlink{structComplexMatrix2_a0f3932f055a8b05cef361bce25d51172}{r0c1}}.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}}*stateRealLo - u.\mbox{\hyperlink{structComplexMatrix2_a0f3932f055a8b05cef361bce25d51172}{r0c1}}.\mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}*stateImagLo;
610     stateVecImag[indexUp] = u.\mbox{\hyperlink{structComplexMatrix2_ae72b4458233b077a636beee1892e81ff}{r0c0}}.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}}*stateImagUp + u.\mbox{\hyperlink{structComplexMatrix2_ae72b4458233b077a636beee1892e81ff}{r0c0}}.\mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}*stateRealUp 
611         + u.\mbox{\hyperlink{structComplexMatrix2_a0f3932f055a8b05cef361bce25d51172}{r0c1}}.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}}*stateImagLo + u.\mbox{\hyperlink{structComplexMatrix2_a0f3932f055a8b05cef361bce25d51172}{r0c1}}.\mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}*stateRealLo;
612 
613     \textcolor{comment}{// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]}
614     stateVecReal[indexLo] = u.\mbox{\hyperlink{structComplexMatrix2_ab98282015ed2065e53fbc9638e2583ab}{r1c0}}.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}}*stateRealUp  - u.\mbox{\hyperlink{structComplexMatrix2_ab98282015ed2065e53fbc9638e2583ab}{r1c0}}.\mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}*stateImagUp 
615         + u.\mbox{\hyperlink{structComplexMatrix2_a763007c3070802373549ba0350f83c8a}{r1c1}}.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}}*stateRealLo  -  u.\mbox{\hyperlink{structComplexMatrix2_a763007c3070802373549ba0350f83c8a}{r1c1}}.\mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}*stateImagLo;
616     stateVecImag[indexLo] = u.\mbox{\hyperlink{structComplexMatrix2_ab98282015ed2065e53fbc9638e2583ab}{r1c0}}.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}}*stateImagUp + u.\mbox{\hyperlink{structComplexMatrix2_ab98282015ed2065e53fbc9638e2583ab}{r1c0}}.\mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}*stateRealUp 
617         + u.\mbox{\hyperlink{structComplexMatrix2_a763007c3070802373549ba0350f83c8a}{r1c1}}.\mbox{\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}}*stateImagLo + u.\mbox{\hyperlink{structComplexMatrix2_a763007c3070802373549ba0350f83c8a}{r1c1}}.\mbox{\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}}*stateRealLo;
618 \}
\end{DoxyCode}
