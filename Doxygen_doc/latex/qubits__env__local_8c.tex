\hypertarget{qubits__env__local_8c}{
\subsection{qubits\_\-env\_\-local.c File Reference}
\label{qubits__env__local_8c}\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}}
}


An implementation of the API in \hyperlink{qubits_8h}{qubits.h} for a local (non-\/MPI) environment.  
{\ttfamily \#include $<$stdlib.h$>$}\par
{\ttfamily \#include $<$stdio.h$>$}\par
{\ttfamily \#include $<$omp.h$>$}\par
{\ttfamily \#include \char`\"{}precision.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}qubits.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}qubits\_\-internal.h\char`\"{}}\par
\subsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{qubits__env__local_8c_ad84a3ce68d1ca02b4e3f741ea45b6054}{initQuESTEnv} (\hyperlink{structQuESTEnv}{QuESTEnv} $\ast$env)
\begin{DoxyCompactList}\small\item\em Initialize QuEST environment. \item\end{DoxyCompactList}\item 
void \hyperlink{qubits__env__local_8c_a8d31fe2d1ad4d01e2a1f5f6b8bc15b77}{syncQuESTEnv} (\hyperlink{structQuESTEnv}{QuESTEnv} env)
\begin{DoxyCompactList}\small\item\em Guarantees that all code up to the given point has been executed on all nodes. \item\end{DoxyCompactList}\item 
int \hyperlink{qubits__env__local_8c_a877396e10f0e9aeead078664c51bb0e3}{syncQuESTSuccess} (\hyperlink{structQuESTEnv}{QuESTEnv} env, int successCode)
\begin{DoxyCompactList}\small\item\em Performs a logical AND on all successCodes held by all processes. \item\end{DoxyCompactList}\item 
void \hyperlink{qubits__env__local_8c_abd4bc926cd3f9b65610bb228d0c59fe0}{closeQuESTEnv} (\hyperlink{structQuESTEnv}{QuESTEnv} env)
\begin{DoxyCompactList}\small\item\em Close QuEST environment. \item\end{DoxyCompactList}\item 
void \hyperlink{qubits__env__local_8c_af8a14ae79c3fb2c0b5f6255cc37bebf9}{reportQuESTEnv} (\hyperlink{structQuESTEnv}{QuESTEnv} env)
\begin{DoxyCompactList}\small\item\em Report information about the QuEST environment. \item\end{DoxyCompactList}\item 
void \hyperlink{qubits__env__local_8c_a62da5b58d8ce84e6f4d24be1b872294e}{reportNodeList} (\hyperlink{structQuESTEnv}{QuESTEnv} env)
\begin{DoxyCompactList}\small\item\em Report a list of CPU hostnames and the rank that is running on each if running with MPI enabled and an error message otherwise. \item\end{DoxyCompactList}\item 
REAL \hyperlink{qubits__env__local_8c_a818a4c7cd7252d2b10b896b12fa431d3}{calcTotalProbability} (\hyperlink{structMultiQubit}{MultiQubit} multiQubit)
\begin{DoxyCompactList}\small\item\em Calculate the probability of being in any state by taking the norm of the entire state vector. \item\end{DoxyCompactList}\item 
REAL \hyperlink{qubits__env__local_8c_a317b786f577fa6bc136ea7f0ee7330a7}{getRealAmpEl} (\hyperlink{structMultiQubit}{MultiQubit} multiQubit, long long int index)
\begin{DoxyCompactList}\small\item\em Get the real component of the probability amplitude at an index in the state vector. \item\end{DoxyCompactList}\item 
REAL \hyperlink{qubits__env__local_8c_a3615f76fd5f57008d9b74bbd10533dd0}{getImagAmpEl} (\hyperlink{structMultiQubit}{MultiQubit} multiQubit, long long int index)
\begin{DoxyCompactList}\small\item\em Get the imaginary component of the probability amplitude at an index in the state vector. \item\end{DoxyCompactList}\item 
void \hyperlink{qubits__env__local_8c_a4ba468aa69f812efd1f964e10a45ca2f}{rotateQubit} (\hyperlink{structMultiQubit}{MultiQubit} multiQubit, const int rotQubit, \hyperlink{structComplex}{Complex} alpha, \hyperlink{structComplex}{Complex} beta)
\begin{DoxyCompactList}\small\item\em Rotate a single qubit in the state vector of probability amplitudes. \item\end{DoxyCompactList}\item 
void \hyperlink{qubits__env__local_8c_abac5189a14bc12e79580ba0d75de796e}{controlRotateQubit} (\hyperlink{structMultiQubit}{MultiQubit} multiQubit, const int rotQubit, const int controlQubit, \hyperlink{structComplex}{Complex} alpha, \hyperlink{structComplex}{Complex} beta)
\begin{DoxyCompactList}\small\item\em Rotate a single qubit in the state vector of probability amplitudes. \item\end{DoxyCompactList}\item 
void \hyperlink{qubits__env__local_8c_acda82bebb0a62f419eec9c1e0575daad}{sigmaX} (\hyperlink{structMultiQubit}{MultiQubit} multiQubit, const int rotQubit)
\begin{DoxyCompactList}\small\item\em Rotate a single qubit by \{\{0,1\},\{1,0\}\} -\/-\/ swap $|$0$>$ and $|$1$>$. \item\end{DoxyCompactList}\item 
void \hyperlink{qubits__env__local_8c_a7b022c75cef77be046bd5d61e38a581e}{sigmaY} (\hyperlink{structMultiQubit}{MultiQubit} multiQubit, const int rotQubit)
\begin{DoxyCompactList}\small\item\em Rotate a single qubit by \{\{0,-\/i\},\{i,0\}\} -\/-\/ swap $|$0$>$ and $|$1$>$ and apply a phase of -\/i or i. \item\end{DoxyCompactList}\item 
void \hyperlink{qubits__env__local_8c_ae275b94c1a483dda43bf4ec947635605}{phaseGate} (\hyperlink{structMultiQubit}{MultiQubit} multiQubit, const int rotQubit, enum \hyperlink{qubits_8h_a5739021c733cecc49647956b2f7338ea}{phaseGateType} type)
\begin{DoxyCompactList}\small\item\em Rotate a single qubit by \{\{1,0\},\{0,p\}\} where p is a phase term determined by the type argument. \item\end{DoxyCompactList}\item 
void \hyperlink{qubits__env__local_8c_ad247d084dc7150893e9051a438a5807e}{hadamard} (\hyperlink{structMultiQubit}{MultiQubit} multiQubit, const int rotQubit)
\begin{DoxyCompactList}\small\item\em Rotate a single qubit by \{\{1,1\},\{1,-\/1\}\}/sqrt2 -\/-\/ turn a $|$0$>$ into a $|$+$>$ and a $|$1$>$ into a $|$-\/$>$. \item\end{DoxyCompactList}\item 
void \hyperlink{qubits__env__local_8c_a4b3e91607bfbce06faf1d2e5dfcf2ea9}{controlNot} (\hyperlink{structMultiQubit}{MultiQubit} multiQubit, const int targetQubit, const int controlQubit)
\begin{DoxyCompactList}\small\item\em Rotate a single qubit by \{\{0,-\/i\},\{i,0\}\} -\/-\/ swap $|$0$>$ and $|$1$>$ and apply a phase of -\/i or i, only for elements when control qubit is 1. \item\end{DoxyCompactList}\item 
REAL \hyperlink{qubits__env__local_8c_ad315c941a51bc053d39ebfa2040fd32e}{findProbabilityOfOutcome} (\hyperlink{structMultiQubit}{MultiQubit} multiQubit, const int measureQubit, int outcome)
\begin{DoxyCompactList}\small\item\em Measure the probability of a specified qubit being in the zero or one state. \item\end{DoxyCompactList}\item 
REAL \hyperlink{qubits__env__local_8c_a88605f373c2401760aab0e08719e08dd}{measureInState} (\hyperlink{structMultiQubit}{MultiQubit} multiQubit, const int measureQubit, int outcome)
\begin{DoxyCompactList}\small\item\em Update the state vector to be consistent with measuring measureQubit=0 or measureQubit=1 according to the value of outcome. \item\end{DoxyCompactList}\item 
REAL \hyperlink{qubits__env__local_8c_ae8fcabd3f22c6c9a9104e1807fb78f80}{filterOut111} (\hyperlink{structMultiQubit}{MultiQubit} multiQubit, const int idQubit1, const int idQubit2, const int idQubit3)
\begin{DoxyCompactList}\small\item\em Updates the state according to this scenario: we ask \char`\"{}are these 3 qubits in 111\char`\"{} and the answer is \char`\"{}no\char`\"{}. \item\end{DoxyCompactList}\item 
REAL \hyperlink{qubits__env__local_8c_a909ba48b5a82c9f5c3a94d17a72b1aa3}{probOfFilterOut111} (\hyperlink{structMultiQubit}{MultiQubit} multiQubit, const int idQubit1, const int idQubit2, const int idQubit3)
\begin{DoxyCompactList}\small\item\em Evaluates the state according to this scenario: we ask \char`\"{}are these 3 qubits in 111\char`\"{} and the answer is \char`\"{}no\char`\"{}. \item\end{DoxyCompactList}\end{DoxyCompactItemize}


\subsubsection{Detailed Description}
An implementation of the API in \hyperlink{qubits_8h}{qubits.h} for a local (non-\/MPI) environment. 

Definition in file \hyperlink{qubits__env__local_8c_source}{qubits\_\-env\_\-local.c}.

\subsubsection{Function Documentation}
\hypertarget{qubits__env__local_8c_a818a4c7cd7252d2b10b896b12fa431d3}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!calcTotalProbability@{calcTotalProbability}}
\index{calcTotalProbability@{calcTotalProbability}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{calcTotalProbability}]{\setlength{\rightskip}{0pt plus 5cm}REAL calcTotalProbability ({\bf MultiQubit} {\em multiQubit})}\hfill}
\label{qubits__env__local_8c_a818a4c7cd7252d2b10b896b12fa431d3}


Calculate the probability of being in any state by taking the norm of the entire state vector. Should be equal to 1. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em multiQubit}]object representing a set of qubits \end{DoxyParams}
\begin{DoxyReturn}{Returns}
total probability 
\end{DoxyReturn}


Definition at line 47 of file qubits\_\-env\_\-local.c.

References ComplexArray::imag, MultiQubit::numAmps, ComplexArray::real, REAL, and MultiQubit::stateVec.


\begin{DoxyCode}
47                                                 {
48   /* IJB - implemented using Kahan summation for greater accuracy at a slight flo
      ating
49      point operation overhead. For more details see https://en.wikipedia.org/wiki
      /Kahan_summation_algorithm */
50   /* Don't change the bracketing in this routine! */
51   REAL pTotal=0; 
52   REAL y, t, c;
53   long long int index;
54   long long int numAmpsPerRank = multiQubit.numAmps;
55   c = 0.0;
56   for (index=0; index<numAmpsPerRank; index++){ 
57     /* Perform pTotal+=multiQubit.stateVec.real[index]*multiQubit.stateVec.real[i
      ndex]; by Kahan */
58    // pTotal+=multiQubit.stateVec.real[index]*multiQubit.stateVec.real[index];
59     
60     y = multiQubit.stateVec.real[index]*multiQubit.stateVec.real[index] - c;
61     t = pTotal + y;
62     c = ( t - pTotal ) - y;
63     pTotal = t;
64     
65     /* Perform pTotal+=multiQubit.stateVec.imag[index]*multiQubit.stateVec.imag[i
      ndex]; by Kahan */
66     //pTotal+=multiQubit.stateVec.imag[index]*multiQubit.stateVec.imag[index];
67     
68     
69     y = multiQubit.stateVec.imag[index]*multiQubit.stateVec.imag[index] - c;
70     t = pTotal + y;
71     c = ( t - pTotal ) - y;
72     pTotal = t;
73     
74     
75   } 
76   return pTotal;
77 }
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_abd4bc926cd3f9b65610bb228d0c59fe0}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!closeQuESTEnv@{closeQuESTEnv}}
\index{closeQuESTEnv@{closeQuESTEnv}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{closeQuESTEnv}]{\setlength{\rightskip}{0pt plus 5cm}void closeQuESTEnv ({\bf QuESTEnv} {\em env})}\hfill}
\label{qubits__env__local_8c_abd4bc926cd3f9b65610bb228d0c59fe0}


Close QuEST environment. If something needs to be done to clean up the execution environment, such as finalizing MPI when running in distributed mode, it is handled here 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em env}]object representing the execution environment. A single instance is used for each program \end{DoxyParams}


Definition at line 26 of file qubits\_\-env\_\-local.c.


\begin{DoxyCode}
26                                 {
27         // MPI finalize goes here in MPI version. Call this function anyway for c
      onsistency
28 }
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_a4b3e91607bfbce06faf1d2e5dfcf2ea9}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!controlNot@{controlNot}}
\index{controlNot@{controlNot}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{controlNot}]{\setlength{\rightskip}{0pt plus 5cm}void controlNot ({\bf MultiQubit} {\em multiQubit}, \/  const int {\em targetQubit}, \/  const int {\em controlQubit})}\hfill}
\label{qubits__env__local_8c_a4b3e91607bfbce06faf1d2e5dfcf2ea9}


Rotate a single qubit by \{\{0,-\/i\},\{i,0\}\} -\/-\/ swap $|$0$>$ and $|$1$>$ and apply a phase of -\/i or i, only for elements when control qubit is 1. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftrightarrow$} {\em multiQubit}]object representing the set of qubits \item[\mbox{$\leftarrow$} {\em rotQubit}]qubit to rotate \item[\mbox{$\leftarrow$} {\em controlQubit}]perform sigmaX rotation if this qubit is 1 \end{DoxyParams}


Definition at line 118 of file qubits\_\-env\_\-local.c.

References controlNotLocal().


\begin{DoxyCode}
119 {
120         controlNotLocal(multiQubit, targetQubit, controlQubit);
121 }
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_abac5189a14bc12e79580ba0d75de796e}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!controlRotateQubit@{controlRotateQubit}}
\index{controlRotateQubit@{controlRotateQubit}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{controlRotateQubit}]{\setlength{\rightskip}{0pt plus 5cm}void controlRotateQubit ({\bf MultiQubit} {\em multiQubit}, \/  const int {\em rotQubit}, \/  const int {\em controlQubit}, \/  {\bf Complex} {\em alpha}, \/  {\bf Complex} {\em beta})}\hfill}
\label{qubits__env__local_8c_abac5189a14bc12e79580ba0d75de796e}


Rotate a single qubit in the state vector of probability amplitudes. Given two complex numbers alpha and beta and a control qubit, applies the operation: \par
 \mbox{[}alpha, -\/beta$\ast$ \par
 beta, alpha$\ast$\mbox{]} \par
 Only when the control qubit is one.

\begin{DoxyRemark}{Remarks}
Qubits are zero-\/based and the the first qubit is the rightmost
\end{DoxyRemark}
alpha, beta must obey $|$alpha$|$$^\wedge$2 + $|$beta$|$$^\wedge$2 = 1


\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftrightarrow$} {\em multiQubit}]object representing the set of qubits \item[\mbox{$\leftarrow$} {\em rotQubit}]qubit to rotate \item[\mbox{$\leftarrow$} {\em controlQubit}]perform rotation if this qubit is 1 \item[\mbox{$\leftarrow$} {\em alpha}]rotation angle \item[\mbox{$\leftarrow$} {\em beta}]rotation angle \end{DoxyParams}


Definition at line 93 of file qubits\_\-env\_\-local.c.

References controlRotateQubitLocal().


\begin{DoxyCode}
94 {
95         controlRotateQubitLocal(multiQubit, rotQubit, controlQubit, alpha, beta);
      
96 }
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_ae8fcabd3f22c6c9a9104e1807fb78f80}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!filterOut111@{filterOut111}}
\index{filterOut111@{filterOut111}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{filterOut111}]{\setlength{\rightskip}{0pt plus 5cm}REAL filterOut111 ({\bf MultiQubit} {\em multiQubit}, \/  const int {\em idQubit1}, \/  const int {\em idQubit2}, \/  const int {\em idQubit3})}\hfill}
\label{qubits__env__local_8c_ae8fcabd3f22c6c9a9104e1807fb78f80}


Updates the state according to this scenario: we ask \char`\"{}are these 3 qubits in 111\char`\"{} and the answer is \char`\"{}no\char`\"{}. The function returns the probability of this outcome (if zero, it will exit with error) 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftrightarrow$} {\em multiQubit}]object representing the set of qubits \item[\mbox{$\leftarrow$} {\em idQubit1,idQubit2,idQubit3}]specified qubits \end{DoxyParams}
\begin{DoxyReturn}{Returns}
Total probability that the 3 qubits are not all in the 1 state. 
\end{DoxyReturn}


Definition at line 139 of file qubits\_\-env\_\-local.c.

References filterOut111Local(), probOfFilterOut111(), and REAL.


\begin{DoxyCode}
140 {
141         REAL stateProb=0;
142         stateProb = probOfFilterOut111(multiQubit, idQubit1, idQubit2, idQubit3);
      
143         if (stateProb!=0) filterOut111Local(multiQubit, idQubit1, idQubit2, idQub
      it3, stateProb);
144         return stateProb;
145 }
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_ad315c941a51bc053d39ebfa2040fd32e}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!findProbabilityOfOutcome@{findProbabilityOfOutcome}}
\index{findProbabilityOfOutcome@{findProbabilityOfOutcome}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{findProbabilityOfOutcome}]{\setlength{\rightskip}{0pt plus 5cm}REAL findProbabilityOfOutcome ({\bf MultiQubit} {\em multiQubit}, \/  const int {\em measureQubit}, \/  int {\em outcome})}\hfill}
\label{qubits__env__local_8c_ad315c941a51bc053d39ebfa2040fd32e}


Measure the probability of a specified qubit being in the zero or one state. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em multiQubit}]object representing the set of qubits \item[\mbox{$\leftarrow$} {\em measureQubit}]qubit to measure \item[\mbox{$\leftarrow$} {\em outcome}]to measure the probability of -\/-\/ either zero or one \end{DoxyParams}
\begin{DoxyReturn}{Returns}
probability of qubit measureQubit being either zero or one 
\end{DoxyReturn}


Definition at line 123 of file qubits\_\-env\_\-local.c.

References findProbabilityOfZeroLocal(), and REAL.


\begin{DoxyCode}
124 {
125         REAL stateProb=0;
126         stateProb = findProbabilityOfZeroLocal(multiQubit, measureQubit);
127         if (outcome==1) stateProb = 1.0 - stateProb;
128         return stateProb;
129 }
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_a3615f76fd5f57008d9b74bbd10533dd0}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!getImagAmpEl@{getImagAmpEl}}
\index{getImagAmpEl@{getImagAmpEl}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{getImagAmpEl}]{\setlength{\rightskip}{0pt plus 5cm}REAL getImagAmpEl ({\bf MultiQubit} {\em multiQubit}, \/  long long int {\em index})}\hfill}
\label{qubits__env__local_8c_a3615f76fd5f57008d9b74bbd10533dd0}


Get the imaginary component of the probability amplitude at an index in the state vector. For debugging purposes. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em multiQubit}]object representing a set of qubits \item[\mbox{$\leftarrow$} {\em index}]index in state vector of probability amplitudes \end{DoxyParams}
\begin{DoxyReturn}{Returns}
imaginary component at that index 
\end{DoxyReturn}


Definition at line 83 of file qubits\_\-env\_\-local.c.

References ComplexArray::imag, and MultiQubit::stateVec.


\begin{DoxyCode}
83                                                              {
84         return multiQubit.stateVec.imag[index];
85 }
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_a317b786f577fa6bc136ea7f0ee7330a7}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!getRealAmpEl@{getRealAmpEl}}
\index{getRealAmpEl@{getRealAmpEl}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{getRealAmpEl}]{\setlength{\rightskip}{0pt plus 5cm}REAL getRealAmpEl ({\bf MultiQubit} {\em multiQubit}, \/  long long int {\em index})}\hfill}
\label{qubits__env__local_8c_a317b786f577fa6bc136ea7f0ee7330a7}


Get the real component of the probability amplitude at an index in the state vector. For debugging purposes. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em multiQubit}]object representing a set of qubits \item[\mbox{$\leftarrow$} {\em index}]index in state vector of probability amplitudes \end{DoxyParams}
\begin{DoxyReturn}{Returns}
real component at that index 
\end{DoxyReturn}


Definition at line 79 of file qubits\_\-env\_\-local.c.

References ComplexArray::real, and MultiQubit::stateVec.


\begin{DoxyCode}
79                                                              {
80         return multiQubit.stateVec.real[index];
81 }
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_ad247d084dc7150893e9051a438a5807e}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!hadamard@{hadamard}}
\index{hadamard@{hadamard}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{hadamard}]{\setlength{\rightskip}{0pt plus 5cm}void hadamard ({\bf MultiQubit} {\em multiQubit}, \/  const int {\em rotQubit})}\hfill}
\label{qubits__env__local_8c_ad247d084dc7150893e9051a438a5807e}


Rotate a single qubit by \{\{1,1\},\{1,-\/1\}\}/sqrt2 -\/-\/ turn a $|$0$>$ into a $|$+$>$ and a $|$1$>$ into a $|$-\/$>$. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftrightarrow$} {\em multiQubit}]object representing the set of qubits \item[\mbox{$\leftarrow$} {\em rotQubit}]qubit to rotate \end{DoxyParams}


Definition at line 113 of file qubits\_\-env\_\-local.c.

References hadamardLocal().


\begin{DoxyCode}
114 {
115         hadamardLocal(multiQubit, rotQubit);
116 }
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_ad84a3ce68d1ca02b4e3f741ea45b6054}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!initQuESTEnv@{initQuESTEnv}}
\index{initQuESTEnv@{initQuESTEnv}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{initQuESTEnv}]{\setlength{\rightskip}{0pt plus 5cm}void initQuESTEnv ({\bf QuESTEnv} $\ast$ {\em env})}\hfill}
\label{qubits__env__local_8c_ad84a3ce68d1ca02b4e3f741ea45b6054}


Initialize QuEST environment. If something needs to be done to set up the execution environment, such as initializing MPI when running in distributed mode, it is handled here 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftrightarrow$} {\em env}]object representing the execution environment. A single instance is used for each program \end{DoxyParams}


Definition at line 12 of file qubits\_\-env\_\-local.c.

References QuESTEnv::numRanks, and QuESTEnv::rank.


\begin{DoxyCode}
12                                 {
13         // init MPI environment
14         env->rank=0;
15         env->numRanks=1;
16 }
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_a88605f373c2401760aab0e08719e08dd}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!measureInState@{measureInState}}
\index{measureInState@{measureInState}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{measureInState}]{\setlength{\rightskip}{0pt plus 5cm}REAL measureInState ({\bf MultiQubit} {\em multiQubit}, \/  const int {\em measureQubit}, \/  int {\em outcome})}\hfill}
\label{qubits__env__local_8c_a88605f373c2401760aab0e08719e08dd}


Update the state vector to be consistent with measuring measureQubit=0 or measureQubit=1 according to the value of outcome. Measure in Zero performs an irreversible change to the state vector: it updates the vector according to the event that an outcome has been measured on the qubit indicated by measureQubit (where his label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 if outcome=0 or measureQubit=1 if outcome=1. It then returns the probability of making this measurement.


\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftrightarrow$} {\em multiQubit}]object representing the set of qubits \item[\mbox{$\leftarrow$} {\em measureQubit}]qubit to measure \item[\mbox{$\leftarrow$} {\em outcome}]to measure the probability of and set the state to -\/-\/ either zero or one \end{DoxyParams}
\begin{DoxyReturn}{Returns}
probability of qubit measureQubit being either zero or one 
\end{DoxyReturn}


Definition at line 131 of file qubits\_\-env\_\-local.c.

References findProbabilityOfOutcome(), measureInStateLocal(), and REAL.


\begin{DoxyCode}
132 {
133         REAL stateProb;
134         stateProb = findProbabilityOfOutcome(multiQubit, measureQubit, outcome);
135         if (stateProb!=0) measureInStateLocal(multiQubit, measureQubit, stateProb
      , outcome);
136         return stateProb;
137 }
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_ae275b94c1a483dda43bf4ec947635605}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!phaseGate@{phaseGate}}
\index{phaseGate@{phaseGate}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{phaseGate}]{\setlength{\rightskip}{0pt plus 5cm}void phaseGate ({\bf MultiQubit} {\em multiQubit}, \/  const int {\em rotQubit}, \/  enum {\bf phaseGateType} {\em type})}\hfill}
\label{qubits__env__local_8c_ae275b94c1a483dda43bf4ec947635605}


Rotate a single qubit by \{\{1,0\},\{0,p\}\} where p is a phase term determined by the type argument. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftrightarrow$} {\em multiQubit}]object representing the set of qubits \item[\mbox{$\leftarrow$} {\em rotQubit}]qubit to rotate \item[\mbox{$\leftarrow$} {\em type}]the type of phase gate to apply -\/-\/ one of \{SIGMA\_\-Z, S\_\-GATE, T\_\-GATE\} \end{DoxyParams}


Definition at line 108 of file qubits\_\-env\_\-local.c.

Referenced by sGate(), sigmaZ(), and tGate().


\begin{DoxyCode}
109 {
110         phaseGateLocal(multiQubit, rotQubit, type);
111 }
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_a909ba48b5a82c9f5c3a94d17a72b1aa3}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!probOfFilterOut111@{probOfFilterOut111}}
\index{probOfFilterOut111@{probOfFilterOut111}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{probOfFilterOut111}]{\setlength{\rightskip}{0pt plus 5cm}REAL probOfFilterOut111 ({\bf MultiQubit} {\em multiQubit}, \/  const int {\em idQubit1}, \/  const int {\em idQubit2}, \/  const int {\em idQubit3})}\hfill}
\label{qubits__env__local_8c_a909ba48b5a82c9f5c3a94d17a72b1aa3}


Evaluates the state according to this scenario: we ask \char`\"{}are these 3 qubits in 111\char`\"{} and the answer is \char`\"{}no\char`\"{}. The function returns the probability of this outcome (if zero, it will exit with error) 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftrightarrow$} {\em multiQubit}]object representing the set of qubits \item[\mbox{$\leftarrow$} {\em idQubit1,idQubit2,idQubit3}]specified qubits \end{DoxyParams}
\begin{DoxyReturn}{Returns}
Total probability that the 3 qubits are not all in the 1 state. 
\end{DoxyReturn}


Definition at line 147 of file qubits\_\-env\_\-local.c.

References probOfFilterOut111Local(), and REAL.


\begin{DoxyCode}
148 {
149         REAL stateProb=0;
150         stateProb = probOfFilterOut111Local(multiQubit, idQubit1, idQubit2, idQub
      it3);
151         return stateProb;
152 }
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_a62da5b58d8ce84e6f4d24be1b872294e}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!reportNodeList@{reportNodeList}}
\index{reportNodeList@{reportNodeList}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{reportNodeList}]{\setlength{\rightskip}{0pt plus 5cm}void reportNodeList ({\bf QuESTEnv} {\em env})}\hfill}
\label{qubits__env__local_8c_a62da5b58d8ce84e6f4d24be1b872294e}


Report a list of CPU hostnames and the rank that is running on each if running with MPI enabled and an error message otherwise. For debugging purposes. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em env}]object representing the execution environment. A single instance is used for each program \end{DoxyParams}


Definition at line 43 of file qubits\_\-env\_\-local.c.


\begin{DoxyCode}
43                                  {
44         printf("Hostname unknown: running locally\n");
45 }
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_af8a14ae79c3fb2c0b5f6255cc37bebf9}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!reportQuESTEnv@{reportQuESTEnv}}
\index{reportQuESTEnv@{reportQuESTEnv}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{reportQuESTEnv}]{\setlength{\rightskip}{0pt plus 5cm}void reportQuESTEnv ({\bf QuESTEnv} {\em env})}\hfill}
\label{qubits__env__local_8c_af8a14ae79c3fb2c0b5f6255cc37bebf9}


Report information about the QuEST environment. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em env}]object representing the execution environment. A single instance is used for each program \end{DoxyParams}


Definition at line 30 of file qubits\_\-env\_\-local.c.

References QuESTEnv::numRanks, and REAL.


\begin{DoxyCode}
30                                  {
31         printf("EXECUTION ENVIRONMENT:\n");
32         printf("Running locally on one node\n");
33         printf("Number of ranks is %d\n", env.numRanks);
34 # ifdef _OPENMP
35         printf("OpenMP enabled\n");
36         printf("Number of threads available is %d\n", omp_get_max_threads());
37 # else
38         printf("OpenMP disabled\n");
39 # endif
40         printf("Precision: size of REAL is %ld bytes\n", sizeof(REAL));
41 }
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_a4ba468aa69f812efd1f964e10a45ca2f}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!rotateQubit@{rotateQubit}}
\index{rotateQubit@{rotateQubit}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{rotateQubit}]{\setlength{\rightskip}{0pt plus 5cm}void rotateQubit ({\bf MultiQubit} {\em multiQubit}, \/  const int {\em rotQubit}, \/  {\bf Complex} {\em alpha}, \/  {\bf Complex} {\em beta})}\hfill}
\label{qubits__env__local_8c_a4ba468aa69f812efd1f964e10a45ca2f}


Rotate a single qubit in the state vector of probability amplitudes. Given two complex numbers alpha and beta, applies the operation \par
 \mbox{[}alpha, -\/beta$\ast$ \par
 beta, alpha$\ast$\mbox{]} \par


\begin{DoxyRemark}{Remarks}
Qubits are zero-\/based and the the first qubit is the rightmost
\end{DoxyRemark}
alpha, beta must obey $|$alpha$|$$^\wedge$2 + $|$beta$|$$^\wedge$2 = 1


\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftrightarrow$} {\em multiQubit}]object representing the set of qubits \item[\mbox{$\leftarrow$} {\em rotQubit}]qubit to rotate \item[\mbox{$\leftarrow$} {\em alpha}]rotation angle \item[\mbox{$\leftarrow$} {\em beta}]rotation angle \end{DoxyParams}


Definition at line 87 of file qubits\_\-env\_\-local.c.

References rotateQubitLocal().


\begin{DoxyCode}
88 {
89         // all values required to update state vector lie in this rank
90         rotateQubitLocal(multiQubit, rotQubit, alpha, beta);
91 }
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_acda82bebb0a62f419eec9c1e0575daad}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!sigmaX@{sigmaX}}
\index{sigmaX@{sigmaX}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{sigmaX}]{\setlength{\rightskip}{0pt plus 5cm}void sigmaX ({\bf MultiQubit} {\em multiQubit}, \/  const int {\em rotQubit})}\hfill}
\label{qubits__env__local_8c_acda82bebb0a62f419eec9c1e0575daad}


Rotate a single qubit by \{\{0,1\},\{1,0\}\} -\/-\/ swap $|$0$>$ and $|$1$>$. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftrightarrow$} {\em multiQubit}]object representing the set of qubits \item[\mbox{$\leftarrow$} {\em rotQubit}]qubit to rotate \end{DoxyParams}


Definition at line 98 of file qubits\_\-env\_\-local.c.

References sigmaXLocal().


\begin{DoxyCode}
99 {
100         sigmaXLocal(multiQubit, rotQubit);
101 }
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_a7b022c75cef77be046bd5d61e38a581e}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!sigmaY@{sigmaY}}
\index{sigmaY@{sigmaY}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{sigmaY}]{\setlength{\rightskip}{0pt plus 5cm}void sigmaY ({\bf MultiQubit} {\em multiQubit}, \/  const int {\em rotQubit})}\hfill}
\label{qubits__env__local_8c_a7b022c75cef77be046bd5d61e38a581e}


Rotate a single qubit by \{\{0,-\/i\},\{i,0\}\} -\/-\/ swap $|$0$>$ and $|$1$>$ and apply a phase of -\/i or i. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftrightarrow$} {\em multiQubit}]object representing the set of qubits \item[\mbox{$\leftarrow$} {\em rotQubit}]qubit to rotate \end{DoxyParams}


Definition at line 103 of file qubits\_\-env\_\-local.c.

References sigmaYLocal().


\begin{DoxyCode}
104 {
105         sigmaYLocal(multiQubit, rotQubit);
106 }
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_a8d31fe2d1ad4d01e2a1f5f6b8bc15b77}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!syncQuESTEnv@{syncQuESTEnv}}
\index{syncQuESTEnv@{syncQuESTEnv}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{syncQuESTEnv}]{\setlength{\rightskip}{0pt plus 5cm}void syncQuESTEnv ({\bf QuESTEnv} {\em env})}\hfill}
\label{qubits__env__local_8c_a8d31fe2d1ad4d01e2a1f5f6b8bc15b77}


Guarantees that all code up to the given point has been executed on all nodes. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em env}]object representing the execution environment. A single instance is used for each program \end{DoxyParams}


Definition at line 18 of file qubits\_\-env\_\-local.c.


\begin{DoxyCode}
18                                {
19         // MPI Barrier goes here in MPI version. 
20 } 
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_a877396e10f0e9aeead078664c51bb0e3}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!syncQuESTSuccess@{syncQuESTSuccess}}
\index{syncQuESTSuccess@{syncQuESTSuccess}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{syncQuESTSuccess}]{\setlength{\rightskip}{0pt plus 5cm}int syncQuESTSuccess ({\bf QuESTEnv} {\em env}, \/  int {\em successCode})}\hfill}
\label{qubits__env__local_8c_a877396e10f0e9aeead078664c51bb0e3}


Performs a logical AND on all successCodes held by all processes. If any one process has a zero successCode all processes will return a zero success code. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em env}]object representing the execution environment. A single instance is used for each program \item[\mbox{$\leftarrow$} {\em successCode}]1 if process task succeeded, 0 if process task failed \end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if all processes succeeded, 0 if any one process failed 
\end{DoxyReturn}


Definition at line 22 of file qubits\_\-env\_\-local.c.


\begin{DoxyCode}
22                                                    {
23         return successCode;
24 }
\end{DoxyCode}
