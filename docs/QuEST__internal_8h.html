<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Distributed QuEST: QuEST_internal.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>QuEST_internal.h File Reference</h1>
<p>Internal functions used to implement the public facing API in qubits.h.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="QuEST__precision_8h_source.html">QuEST_precision.h</a>&quot;</code><br/>

<p><a href="QuEST__internal_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a9cee2d8716667a3318420a3b672f5b92">compactUnitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a20ee1878a63ae6112e8845f4a8787592">compactUnitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta, and a subset of the state vector with upper and lower block values stored seperately.  <a href="#a20ee1878a63ae6112e8845f4a8787592"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ac134fb45b0a7248c5d15e16eb7139a35">unitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> <a class="el" href="README_8md.html#a5d1c311241dc8d8ffa4badf059977dc5">u</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a2343b7240118e89aa615e2c9140b770b">unitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a unitary operation to a single qubit given a subset of the state vector with upper and lower block values stored seperately.  <a href="#a2343b7240118e89aa615e2c9140b770b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#afc77657651d52c47403b44b923a098a8">controlledCompactUnitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a717855e835e3161e08c18cdc15325d27">controlledCompactUnitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately.  <a href="#a717855e835e3161e08c18cdc15325d27"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a8a4afcff70195a306c082b8ed8d4e09a">controlledUnitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> <a class="el" href="README_8md.html#a5d1c311241dc8d8ffa4badf059977dc5">u</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a642093063a1f889f61a1311f6d6f2d3f">controlledUnitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately.  <a href="#a642093063a1f889f61a1311f6d6f2d3f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a1309eabcba3cb97fbc3cd2e606d17766">multiControlledUnitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, long long int mask, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> <a class="el" href="README_8md.html#a5d1c311241dc8d8ffa4badf059977dc5">u</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a9dbf856ebeea0cf0a3ee5aae6782f2d2">multiControlledUnitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, long long int mask, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a unitary operation to a single qubit in the state vector of probability amplitudes, given a subset of the state vector with upper and lower block values stored seperately.  <a href="#a9dbf856ebeea0cf0a3ee5aae6782f2d2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a74822fd86bb5d81766e6e8dbdcd62df1">sigmaXLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a2275fff50824fe47485890ff5a857785">sigmaXDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecIn, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{0,1},{1,0}.  <a href="#a2275fff50824fe47485890ff5a857785"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a81fbfaed65a742a7dfd622e17652245e">sigmaYLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#af5ef5166f00c0572354b4ac53dcf40cf">sigmaYDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecIn, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut, int updateUpper)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{0,-i},{i,0}.  <a href="#af5ef5166f00c0572354b4ac53dcf40cf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#aa9f0718b4dd794a3e1b143e3b153bfc5">hadamardLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ae6a897066979fc52d977007d959ca09d">hadamardDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut, int updateUpper)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{1,1},{1,-1}}/sqrt2.  <a href="#ae6a897066979fc52d977007d959ca09d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a3a54566b73ac84c312d7da4f56ffbc3b">phaseGateLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, enum <a class="el" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a> type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#af832ed00b02a0597b7fe0b714032c54a">phaseGateDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, enum <a class="el" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a> type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ad357a43e80e3baf013975b1b70942f4c">controlledNotLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a05875a70b539a3efb28d027823403f34">controlledNotDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecIn, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{0,1},{1,0}.  <a href="#a05875a70b539a3efb28d027823403f34"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a7c02cd0e1b4eac19771a0525f023249e">findProbabilityOfZeroLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Measure the total probability of a specified qubit being in the zero state across all amplitudes in this chunk.  <a href="#a7c02cd0e1b4eac19771a0525f023249e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a9ac9bb717a889f09d307eda9f0b65957">findProbabilityOfZeroDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Measure the probability of a specified qubit being in the zero state across all amplitudes held in this chunk.  <a href="#a9ac9bb717a889f09d307eda9f0b65957"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a01d9a8b7ff0e09ec399e158389783aa9">collapseToOutcomeLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, int measureQubit, REAL totalProbability, int outcome)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update the state vector to be consistent with measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1.  <a href="#a01d9a8b7ff0e09ec399e158389783aa9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a7a1f63ec3c42d9ad72f1f01c14a885db">collapseToOutcomeDistributedRenorm</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit, const REAL totalProbability)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Renormalise parts of the state vector where measureQubit=0 or 1, based on the total probability of that qubit being in state 0 or 1.  <a href="#a7a1f63ec3c42d9ad72f1f01c14a885db"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a78908fe8e75a21fd4f7fa7dff05d6be1">collapseToOutcomeDistributedSetZero</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set all amplitudes in one chunk to 0.  <a href="#a78908fe8e75a21fd4f7fa7dff05d6be1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ae4fea133d1a8f09ff8da03038100adb2">validateMatrixIsUnitary</a> (<a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> <a class="el" href="README_8md.html#a5d1c311241dc8d8ffa4badf059977dc5">u</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ae2b2c14a07dd7d50ff86032a3ca101d7">validateAlphaBeta</a> (<a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a71c14976f63cfcda70026fa20ee531fe">validateUnitVector</a> (REAL ux, REAL uy, REAL uz)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#aae7a8a7f1ccbddb7f76b6c52b746bb43">phaseGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, enum <a class="el" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a> type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ae5f9019826f35e8b51b1716cfe397b45">exitWithError</a> (int errorCode, const char *func)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a> (int isValid, int errorCode, const char *func)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned long int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ab76254cfde16f0808476649507a1a2fc">hashString</a> (char *str)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#aac1637696885c75b73a1ecf381cea713">errorCodes</a> []</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Internal functions used to implement the public facing API in qubits.h. </p>
<p>Do not call these functions directly. In general, qubits_env_local.c and qubits_env_mpi.c will implement the public API by choosing the correct function or combination of functions to use from those included here. </p>

<p>Definition in file <a class="el" href="QuEST__internal_8h_source.html">QuEST_internal.h</a>.</p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a7a1f63ec3c42d9ad72f1f01c14a885db"></a><!-- doxytag: member="QuEST_internal.h::collapseToOutcomeDistributedRenorm" ref="a7a1f63ec3c42d9ad72f1f01c14a885db" args="(MultiQubit multiQubit, const int measureQubit, const REAL totalProbability)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL collapseToOutcomeDistributedRenorm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>totalProbability</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Renormalise parts of the state vector where measureQubit=0 or 1, based on the total probability of that qubit being in state 0 or 1. </p>
<p>Measure in Zero performs an irreversible change to the state vector: it updates the vector according to the event that the value 'outcome' has been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1. In the distributed version, one block (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) is spread over multiple chunks, meaning that each chunks performs only renormalisation or only setting amplitudes to 0. This function handles the renormalisation.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>totalProbability</em>&nbsp;</td><td>probability of qubit measureQubit being zero </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l01872">1872</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00675">collapseToOutcome()</a>, and <a class="el" href="QuEST__env__mpi_8c_source.html#l00709">measureWithStats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01873"></a>01873 {
<a name="l01874"></a>01874     <span class="comment">// ----- temp variables</span>
<a name="l01875"></a>01875     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   
<a name="l01876"></a>01876     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01877"></a>01877 
<a name="l01878"></a>01878     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> renorm=1/sqrt(totalProbability);
<a name="l01879"></a>01879 
<a name="l01880"></a>01880     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01881"></a>01881     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01882"></a>01882 
<a name="l01883"></a>01883 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01884"></a>01884 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01885"></a>01885 <span class="preprocessor">    shared    (numTasks,stateVecReal,stateVecImag) \</span>
<a name="l01886"></a>01886 <span class="preprocessor">    private   (thisTask)</span>
<a name="l01887"></a>01887 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01888"></a>01888 <span class="preprocessor"></span>    {
<a name="l01889"></a>01889 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01890"></a>01890 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule  (static)</span>
<a name="l01891"></a>01891 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01892"></a>01892 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01893"></a>01893             stateVecReal[thisTask] = stateVecReal[thisTask]*renorm;
<a name="l01894"></a>01894             stateVecImag[thisTask] = stateVecImag[thisTask]*renorm;
<a name="l01895"></a>01895         }
<a name="l01896"></a>01896     }
<a name="l01897"></a>01897     <span class="keywordflow">return</span> totalProbability;
<a name="l01898"></a>01898 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a78908fe8e75a21fd4f7fa7dff05d6be1"></a><!-- doxytag: member="QuEST_internal.h::collapseToOutcomeDistributedSetZero" ref="a78908fe8e75a21fd4f7fa7dff05d6be1" args="(MultiQubit multiQubit, const int measureQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void collapseToOutcomeDistributedSetZero </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set all amplitudes in one chunk to 0. </p>
<p>Measure in Zero performs an irreversible change to the state vector: it updates the vector according to the event that a zero have been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 or 1. In the distributed version, one block (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) is spread over multiple chunks, meaning that each chunks performs only renormalisation or only setting amplitudes to 0. This function handles setting amplitudes to 0.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l01912">1912</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00675">collapseToOutcome()</a>, and <a class="el" href="QuEST__env__mpi_8c_source.html#l00709">measureWithStats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01913"></a>01913 {
<a name="l01914"></a>01914     <span class="comment">// ----- temp variables</span>
<a name="l01915"></a>01915     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   
<a name="l01916"></a>01916     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01917"></a>01917 
<a name="l01918"></a>01918     <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01919"></a>01919     <span class="comment">//            find probability                                      //</span>
<a name="l01920"></a>01920     <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01921"></a>01921 
<a name="l01922"></a>01922     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01923"></a>01923     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01924"></a>01924 
<a name="l01925"></a>01925 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01926"></a>01926 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01927"></a>01927 <span class="preprocessor">    shared    (numTasks,stateVecReal,stateVecImag) \</span>
<a name="l01928"></a>01928 <span class="preprocessor">    private   (thisTask)</span>
<a name="l01929"></a>01929 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01930"></a>01930 <span class="preprocessor"></span>    {
<a name="l01931"></a>01931 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01932"></a>01932 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule  (static)</span>
<a name="l01933"></a>01933 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01934"></a>01934 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01935"></a>01935             stateVecReal[thisTask] = 0;
<a name="l01936"></a>01936             stateVecImag[thisTask] = 0;
<a name="l01937"></a>01937         }
<a name="l01938"></a>01938     }
<a name="l01939"></a>01939 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a01d9a8b7ff0e09ec399e158389783aa9"></a><!-- doxytag: member="QuEST_internal.h::collapseToOutcomeLocal" ref="a01d9a8b7ff0e09ec399e158389783aa9" args="(MultiQubit multiQubit, int measureQubit, REAL totalProbability, int outcome)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void collapseToOutcomeLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>totalProbability</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outcome</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Update the state vector to be consistent with measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1. </p>
<p>Performs an irreversible change to the state vector: it updates the vector according to the event that an outcome have been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 or 1 according to the value of outcome. In the local version, one or more blocks (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) fit entirely into one chunk.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>totalProbability</em>&nbsp;</td><td>probability of qubit measureQubit being either zero or one </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>outcome</em>&nbsp;</td><td>to measure the probability of and set the state to -- either zero or one </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l01790">1790</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00189">collapseToOutcome()</a>, and <a class="el" href="QuEST__env__local_8c_source.html#l00206">measureWithStats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01791"></a>01791 {
<a name="l01792"></a>01792     <span class="comment">// ----- sizes</span>
<a name="l01793"></a>01793     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock,                                  <span class="comment">// size of blocks</span>
<a name="l01794"></a>01794          sizeHalfBlock;                                       <span class="comment">// size of blocks halved</span>
<a name="l01795"></a>01795     <span class="comment">// ----- indices</span>
<a name="l01796"></a>01796     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock,                                  <span class="comment">// current block</span>
<a name="l01797"></a>01797          index;                                               <span class="comment">// current index for first half block</span>
<a name="l01798"></a>01798     <span class="comment">// ----- measured probability</span>
<a name="l01799"></a>01799     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   renorm;                                            <span class="comment">// probability (returned) value</span>
<a name="l01800"></a>01800     <span class="comment">// ----- temp variables</span>
<a name="l01801"></a>01801     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span>
<a name="l01802"></a>01802     <span class="comment">// (good for shared memory parallelism)</span>
<a name="l01803"></a>01803     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01804"></a>01804 
<a name="l01805"></a>01805     <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01806"></a>01806     <span class="comment">//            dimensions                                            //</span>
<a name="l01807"></a>01807     <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01808"></a>01808     sizeHalfBlock = 1LL &lt;&lt; (measureQubit);                       <span class="comment">// number of state vector elements to sum,</span>
<a name="l01809"></a>01809     <span class="comment">// and then the number to skip</span>
<a name="l01810"></a>01810     sizeBlock     = 2LL * sizeHalfBlock;                         <span class="comment">// size of blocks (pairs of measure and skip entries)</span>
<a name="l01811"></a>01811 
<a name="l01812"></a>01812     renorm=1/sqrt(totalProbability);
<a name="l01813"></a>01813     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01814"></a>01814     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01815"></a>01815 
<a name="l01816"></a>01816 
<a name="l01817"></a>01817 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01818"></a>01818 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01819"></a>01819 <span class="preprocessor">    default (none) \</span>
<a name="l01820"></a>01820 <span class="preprocessor">    shared    (numTasks,sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag,renorm,outcome) \</span>
<a name="l01821"></a>01821 <span class="preprocessor">    private   (thisTask,thisBlock,index)</span>
<a name="l01822"></a>01822 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01823"></a>01823 <span class="preprocessor"></span>    {
<a name="l01824"></a>01824         <span class="keywordflow">if</span> (outcome==0){
<a name="l01825"></a>01825             <span class="comment">// measure qubit is 0</span>
<a name="l01826"></a>01826 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01827"></a>01827 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule  (static)</span>
<a name="l01828"></a>01828 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01829"></a>01829 <span class="preprocessor"></span>            <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01830"></a>01830                 thisBlock = thisTask / sizeHalfBlock;
<a name="l01831"></a>01831                 index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01832"></a>01832                 stateVecReal[index]=stateVecReal[index]*renorm;
<a name="l01833"></a>01833                 stateVecImag[index]=stateVecImag[index]*renorm;
<a name="l01834"></a>01834 
<a name="l01835"></a>01835                 stateVecReal[index+sizeHalfBlock]=0;
<a name="l01836"></a>01836                 stateVecImag[index+sizeHalfBlock]=0;
<a name="l01837"></a>01837             }
<a name="l01838"></a>01838         } <span class="keywordflow">else</span> {
<a name="l01839"></a>01839             <span class="comment">// measure qubit is 1</span>
<a name="l01840"></a>01840 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01841"></a>01841 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule  (static)</span>
<a name="l01842"></a>01842 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01843"></a>01843 <span class="preprocessor"></span>            <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01844"></a>01844                 thisBlock = thisTask / sizeHalfBlock;
<a name="l01845"></a>01845                 index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01846"></a>01846                 stateVecReal[index]=0;
<a name="l01847"></a>01847                 stateVecImag[index]=0;
<a name="l01848"></a>01848 
<a name="l01849"></a>01849                 stateVecReal[index+sizeHalfBlock]=stateVecReal[index+sizeHalfBlock]*renorm;
<a name="l01850"></a>01850                 stateVecImag[index+sizeHalfBlock]=stateVecImag[index+sizeHalfBlock]*renorm;
<a name="l01851"></a>01851             }
<a name="l01852"></a>01852         }
<a name="l01853"></a>01853     }
<a name="l01854"></a>01854 
<a name="l01855"></a>01855 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a20ee1878a63ae6112e8845f4a8787592"></a><!-- doxytag: member="QuEST_internal.h::compactUnitaryDistributed" ref="a20ee1878a63ae6112e8845f4a8787592" args="(MultiQubit multiQubit, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compactUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta, and a subset of the state vector with upper and lower block values stored seperately. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot1</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot2</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l00574">574</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="QuEST_8h_source.html#l00024">Complex::real</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00269">compactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00579"></a>00579 {
<a name="l00580"></a>00580 
<a name="l00581"></a>00581     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00582"></a>00582     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l00583"></a>00583     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00584"></a>00584 
<a name="l00585"></a>00585     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00586"></a>00586     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00587"></a>00587     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00588"></a>00588     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00589"></a>00589     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00590"></a>00590 
<a name="l00591"></a>00591 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00592"></a>00592 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00593"></a>00593 <span class="preprocessor">    default  (none) \</span>
<a name="l00594"></a>00594 <span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l00595"></a>00595 <span class="preprocessor">            rot1Real,rot1Imag, rot2Real,rot2Imag) \</span>
<a name="l00596"></a>00596 <span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span>
<a name="l00597"></a>00597 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00598"></a>00598 <span class="preprocessor"></span>    {
<a name="l00599"></a>00599 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00600"></a>00600 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00601"></a>00601 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00602"></a>00602 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00603"></a>00603             <span class="comment">// store current state vector values in temp variables</span>
<a name="l00604"></a>00604             stateRealUp = stateVecRealUp[thisTask];
<a name="l00605"></a>00605             stateImagUp = stateVecImagUp[thisTask];
<a name="l00606"></a>00606 
<a name="l00607"></a>00607             stateRealLo = stateVecRealLo[thisTask];
<a name="l00608"></a>00608             stateImagLo = stateVecImagLo[thisTask];
<a name="l00609"></a>00609 
<a name="l00610"></a>00610             <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span>
<a name="l00611"></a>00611             stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp + rot2Real*stateRealLo + rot2Imag*stateImagLo;
<a name="l00612"></a>00612             stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp + rot2Real*stateImagLo - rot2Imag*stateRealLo;
<a name="l00613"></a>00613         }
<a name="l00614"></a>00614     }
<a name="l00615"></a>00615 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9cee2d8716667a3318420a3b672f5b92"></a><!-- doxytag: member="QuEST_internal.h::compactUnitaryLocal" ref="a9cee2d8716667a3318420a3b672f5b92" args="(MultiQubit multiQubit, const int targetQubit, Complex alpha, Complex beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compactUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l00445">445</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00024">Complex::real</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00095">compactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00446"></a>00446 {
<a name="l00447"></a>00447     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l00448"></a>00448     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l00449"></a>00449          indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l00450"></a>00450 
<a name="l00451"></a>00451     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00452"></a>00452     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l00453"></a>00453     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l00454"></a>00454 
<a name="l00455"></a>00455     <span class="comment">// set dimensions</span>
<a name="l00456"></a>00456     sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l00457"></a>00457     sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l00458"></a>00458 
<a name="l00459"></a>00459     <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l00460"></a>00460     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00461"></a>00461     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00462"></a>00462     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> alphaImag=alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>, alphaReal=alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;
<a name="l00463"></a>00463     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> betaImag=beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>, betaReal=beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;
<a name="l00464"></a>00464 
<a name="l00465"></a>00465 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00466"></a>00466 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00467"></a>00467 <span class="preprocessor">    default  (none) \</span>
<a name="l00468"></a>00468 <span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, alphaReal,alphaImag, betaReal,betaImag) \</span>
<a name="l00469"></a>00469 <span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span>
<a name="l00470"></a>00470 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00471"></a>00471 <span class="preprocessor"></span>    {
<a name="l00472"></a>00472 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00473"></a>00473 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00474"></a>00474 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00475"></a>00475 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00476"></a>00476 
<a name="l00477"></a>00477             thisBlock   = thisTask / sizeHalfBlock;
<a name="l00478"></a>00478             indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l00479"></a>00479             indexLo     = indexUp + sizeHalfBlock;
<a name="l00480"></a>00480 
<a name="l00481"></a>00481             <span class="comment">// store current state vector values in temp variables</span>
<a name="l00482"></a>00482             stateRealUp = stateVecReal[indexUp];
<a name="l00483"></a>00483             stateImagUp = stateVecImag[indexUp];
<a name="l00484"></a>00484 
<a name="l00485"></a>00485             stateRealLo = stateVecReal[indexLo];
<a name="l00486"></a>00486             stateImagLo = stateVecImag[indexLo];
<a name="l00487"></a>00487 
<a name="l00488"></a>00488             <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span>
<a name="l00489"></a>00489             stateVecReal[indexUp] = alphaReal*stateRealUp - alphaImag*stateImagUp 
<a name="l00490"></a>00490                 - betaReal*stateRealLo - betaImag*stateImagLo;
<a name="l00491"></a>00491             stateVecImag[indexUp] = alphaReal*stateImagUp + alphaImag*stateRealUp 
<a name="l00492"></a>00492                 - betaReal*stateImagLo + betaImag*stateRealLo;
<a name="l00493"></a>00493 
<a name="l00494"></a>00494             <span class="comment">// state[indexLo] = beta  * state[indexUp] + conj(alpha) * state[indexLo]</span>
<a name="l00495"></a>00495             stateVecReal[indexLo] = betaReal*stateRealUp - betaImag*stateImagUp 
<a name="l00496"></a>00496                 + alphaReal*stateRealLo + alphaImag*stateImagLo;
<a name="l00497"></a>00497             stateVecImag[indexLo] = betaReal*stateImagUp + betaImag*stateRealUp 
<a name="l00498"></a>00498                 + alphaReal*stateImagLo - alphaImag*stateRealLo;
<a name="l00499"></a>00499         } 
<a name="l00500"></a>00500     }
<a name="l00501"></a>00501 
<a name="l00502"></a>00502 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a717855e835e3161e08c18cdc15325d27"></a><!-- doxytag: member="QuEST_internal.h::controlledCompactUnitaryDistributed" ref="a717855e835e3161e08c18cdc15325d27" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledCompactUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately. </p>
<p>Only perform the rotation where the control qubit is one.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>qubit to determine whether or not to perform a rotation </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot1</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot2</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l00884">884</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="QuEST_8c_source.html#l01698">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="QuEST_8h_source.html#l00024">Complex::real</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00351">controlledCompactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00889"></a>00889 {
<a name="l00890"></a>00890 
<a name="l00891"></a>00891     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00892"></a>00892     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l00893"></a>00893     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00894"></a>00894     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00895"></a>00895     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l00896"></a>00896 
<a name="l00897"></a>00897     <span class="keywordtype">int</span> controlBit;
<a name="l00898"></a>00898 
<a name="l00899"></a>00899     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00900"></a>00900     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00901"></a>00901     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00902"></a>00902     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00903"></a>00903     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00904"></a>00904 
<a name="l00905"></a>00905 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00906"></a>00906 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00907"></a>00907 <span class="preprocessor">    default  (none) \</span>
<a name="l00908"></a>00908 <span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l00909"></a>00909 <span class="preprocessor">            rot1Real,rot1Imag, rot2Real,rot2Imag) \</span>
<a name="l00910"></a>00910 <span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit)</span>
<a name="l00911"></a>00911 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00912"></a>00912 <span class="preprocessor"></span>    {
<a name="l00913"></a>00913 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00914"></a>00914 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00915"></a>00915 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00916"></a>00916 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00917"></a>00917             controlBit = <a class="code" href="QuEST_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);
<a name="l00918"></a>00918             <span class="keywordflow">if</span> (controlBit){
<a name="l00919"></a>00919                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l00920"></a>00920                 stateRealUp = stateVecRealUp[thisTask];
<a name="l00921"></a>00921                 stateImagUp = stateVecImagUp[thisTask];
<a name="l00922"></a>00922 
<a name="l00923"></a>00923                 stateRealLo = stateVecRealLo[thisTask];
<a name="l00924"></a>00924                 stateImagLo = stateVecImagLo[thisTask];
<a name="l00925"></a>00925 
<a name="l00926"></a>00926                 <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span>
<a name="l00927"></a>00927                 stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp + rot2Real*stateRealLo + rot2Imag*stateImagLo;
<a name="l00928"></a>00928                 stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp + rot2Real*stateImagLo - rot2Imag*stateRealLo;
<a name="l00929"></a>00929             }
<a name="l00930"></a>00930         }
<a name="l00931"></a>00931     }
<a name="l00932"></a>00932 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="afc77657651d52c47403b44b923a098a8"></a><!-- doxytag: member="QuEST_internal.h::controlledCompactUnitaryLocal" ref="afc77657651d52c47403b44b923a098a8" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, Complex alpha, Complex beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledCompactUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l00675">675</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="QuEST_8c_source.html#l01698">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00024">Complex::real</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00113">controlledCompactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00677"></a>00677 {
<a name="l00678"></a>00678     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l00679"></a>00679     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l00680"></a>00680          indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l00681"></a>00681 
<a name="l00682"></a>00682     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00683"></a>00683     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l00684"></a>00684     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l00685"></a>00685     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00686"></a>00686     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l00687"></a>00687 
<a name="l00688"></a>00688     <span class="keywordtype">int</span> controlBit;
<a name="l00689"></a>00689 
<a name="l00690"></a>00690     <span class="comment">// set dimensions</span>
<a name="l00691"></a>00691     sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l00692"></a>00692     sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l00693"></a>00693 
<a name="l00694"></a>00694     <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l00695"></a>00695     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00696"></a>00696     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00697"></a>00697     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> alphaImag=alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>, alphaReal=alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;
<a name="l00698"></a>00698     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> betaImag=beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>, betaReal=beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;
<a name="l00699"></a>00699 
<a name="l00700"></a>00700 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00701"></a>00701 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00702"></a>00702 <span class="preprocessor">    default  (none) \</span>
<a name="l00703"></a>00703 <span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, alphaReal,alphaImag, betaReal,betaImag) \</span>
<a name="l00704"></a>00704 <span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit) </span>
<a name="l00705"></a>00705 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00706"></a>00706 <span class="preprocessor"></span>    {
<a name="l00707"></a>00707 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00708"></a>00708 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00709"></a>00709 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00710"></a>00710 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00711"></a>00711 
<a name="l00712"></a>00712             thisBlock   = thisTask / sizeHalfBlock;
<a name="l00713"></a>00713             indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l00714"></a>00714             indexLo     = indexUp + sizeHalfBlock;
<a name="l00715"></a>00715 
<a name="l00716"></a>00716             controlBit = <a class="code" href="QuEST_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, indexUp+chunkId*chunkSize);
<a name="l00717"></a>00717             <span class="keywordflow">if</span> (controlBit){
<a name="l00718"></a>00718                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l00719"></a>00719                 stateRealUp = stateVecReal[indexUp];
<a name="l00720"></a>00720                 stateImagUp = stateVecImag[indexUp];
<a name="l00721"></a>00721 
<a name="l00722"></a>00722                 stateRealLo = stateVecReal[indexLo];
<a name="l00723"></a>00723                 stateImagLo = stateVecImag[indexLo];
<a name="l00724"></a>00724 
<a name="l00725"></a>00725                 <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span>
<a name="l00726"></a>00726                 stateVecReal[indexUp] = alphaReal*stateRealUp - alphaImag*stateImagUp 
<a name="l00727"></a>00727                     - betaReal*stateRealLo - betaImag*stateImagLo;
<a name="l00728"></a>00728                 stateVecImag[indexUp] = alphaReal*stateImagUp + alphaImag*stateRealUp 
<a name="l00729"></a>00729                     - betaReal*stateImagLo + betaImag*stateRealLo;
<a name="l00730"></a>00730 
<a name="l00731"></a>00731                 <span class="comment">// state[indexLo] = beta  * state[indexUp] + conj(alpha) * state[indexLo]</span>
<a name="l00732"></a>00732                 stateVecReal[indexLo] = betaReal*stateRealUp - betaImag*stateImagUp 
<a name="l00733"></a>00733                     + alphaReal*stateRealLo + alphaImag*stateImagLo;
<a name="l00734"></a>00734                 stateVecImag[indexLo] = betaReal*stateImagUp + betaImag*stateRealUp 
<a name="l00735"></a>00735                     + alphaReal*stateImagLo - alphaImag*stateRealLo;
<a name="l00736"></a>00736             }
<a name="l00737"></a>00737         } 
<a name="l00738"></a>00738     }
<a name="l00739"></a>00739 
<a name="l00740"></a>00740 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a05875a70b539a3efb28d027823403f34"></a><!-- doxytag: member="QuEST_internal.h::controlledNotDistributed" ref="a05875a70b539a3efb28d027823403f34" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledNotDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{0,1},{1,0}. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk. Only perform the rotation for elements where controlQubit is one.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecIn</em>&nbsp;</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l01213">1213</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="QuEST_8c_source.html#l01698">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00513">controlledNot()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01216"></a>01216 {
<a name="l01217"></a>01217 
<a name="l01218"></a>01218     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01219"></a>01219     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01220"></a>01220     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01221"></a>01221     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01222"></a>01222 
<a name="l01223"></a>01223     <span class="keywordtype">int</span> controlBit;
<a name="l01224"></a>01224 
<a name="l01225"></a>01225     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealIn=stateVecIn.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagIn=stateVecIn.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01226"></a>01226     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01227"></a>01227 
<a name="l01228"></a>01228 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01229"></a>01229 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01230"></a>01230 <span class="preprocessor">    default  (none) \</span>
<a name="l01231"></a>01231 <span class="preprocessor">    shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut) \</span>
<a name="l01232"></a>01232 <span class="preprocessor">    private  (thisTask,controlBit)</span>
<a name="l01233"></a>01233 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01234"></a>01234 <span class="preprocessor"></span>    {
<a name="l01235"></a>01235 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01236"></a>01236 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01237"></a>01237 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01238"></a>01238 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01239"></a>01239             controlBit = <a class="code" href="QuEST_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);
<a name="l01240"></a>01240             <span class="keywordflow">if</span> (controlBit){
<a name="l01241"></a>01241                 stateVecRealOut[thisTask] = stateVecRealIn[thisTask];
<a name="l01242"></a>01242                 stateVecImagOut[thisTask] = stateVecImagIn[thisTask];
<a name="l01243"></a>01243             }
<a name="l01244"></a>01244         }
<a name="l01245"></a>01245     }
<a name="l01246"></a>01246 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad357a43e80e3baf013975b1b70942f4c"></a><!-- doxytag: member="QuEST_internal.h::controlledNotLocal" ref="ad357a43e80e3baf013975b1b70942f4c" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledNotLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l01148">1148</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="QuEST_8c_source.html#l01698">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00172">controlledNot()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01149"></a>01149 {
<a name="l01150"></a>01150     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01151"></a>01151     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01152"></a>01152          indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01153"></a>01153 
<a name="l01154"></a>01154     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateImagUp;
<a name="l01155"></a>01155     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01156"></a>01156     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01157"></a>01157     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01158"></a>01158     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01159"></a>01159 
<a name="l01160"></a>01160     <span class="keywordtype">int</span> controlBit;
<a name="l01161"></a>01161 
<a name="l01162"></a>01162     <span class="comment">// set dimensions</span>
<a name="l01163"></a>01163     sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01164"></a>01164     sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01165"></a>01165 
<a name="l01166"></a>01166 
<a name="l01167"></a>01167     <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l01168"></a>01168     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01169"></a>01169     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01170"></a>01170 
<a name="l01171"></a>01171 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01172"></a>01172 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01173"></a>01173 <span class="preprocessor">    default  (none) \</span>
<a name="l01174"></a>01174 <span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span>
<a name="l01175"></a>01175 <span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,controlBit) </span>
<a name="l01176"></a>01176 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01177"></a>01177 <span class="preprocessor"></span>    {
<a name="l01178"></a>01178 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01179"></a>01179 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01180"></a>01180 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01181"></a>01181 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01182"></a>01182             thisBlock   = thisTask / sizeHalfBlock;
<a name="l01183"></a>01183             indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01184"></a>01184             indexLo     = indexUp + sizeHalfBlock;
<a name="l01185"></a>01185 
<a name="l01186"></a>01186             controlBit = <a class="code" href="QuEST_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a>(controlQubit, indexUp+chunkId*chunkSize);
<a name="l01187"></a>01187             <span class="keywordflow">if</span> (controlBit){
<a name="l01188"></a>01188                 stateRealUp = stateVecReal[indexUp];
<a name="l01189"></a>01189                 stateImagUp = stateVecImag[indexUp];
<a name="l01190"></a>01190 
<a name="l01191"></a>01191                 stateVecReal[indexUp] = stateVecReal[indexLo];
<a name="l01192"></a>01192                 stateVecImag[indexUp] = stateVecImag[indexLo];
<a name="l01193"></a>01193 
<a name="l01194"></a>01194                 stateVecReal[indexLo] = stateRealUp;
<a name="l01195"></a>01195                 stateVecImag[indexLo] = stateImagUp;
<a name="l01196"></a>01196             }
<a name="l01197"></a>01197         } 
<a name="l01198"></a>01198     }
<a name="l01199"></a>01199 
<a name="l01200"></a>01200 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a642093063a1f889f61a1311f6d6f2d3f"></a><!-- doxytag: member="QuEST_internal.h::controlledUnitaryDistributed" ref="a642093063a1f889f61a1311f6d6f2d3f" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately. </p>
<p>Only perform the rotation where the control qubit is one.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>qubit to determine whether or not to perform a rotation </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot1</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot2</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l00947">947</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="QuEST_8c_source.html#l01698">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="QuEST_8h_source.html#l00024">Complex::real</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00394">controlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00952"></a>00952 {
<a name="l00953"></a>00953 
<a name="l00954"></a>00954     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00955"></a>00955     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l00956"></a>00956     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00957"></a>00957     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00958"></a>00958     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l00959"></a>00959 
<a name="l00960"></a>00960     <span class="keywordtype">int</span> controlBit;
<a name="l00961"></a>00961 
<a name="l00962"></a>00962     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00963"></a>00963     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00964"></a>00964     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00965"></a>00965     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00966"></a>00966     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00967"></a>00967 
<a name="l00968"></a>00968 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00969"></a>00969 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00970"></a>00970 <span class="preprocessor">    default  (none) \</span>
<a name="l00971"></a>00971 <span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l00972"></a>00972 <span class="preprocessor">            rot1Real,rot1Imag, rot2Real,rot2Imag) \</span>
<a name="l00973"></a>00973 <span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit)</span>
<a name="l00974"></a>00974 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00975"></a>00975 <span class="preprocessor"></span>    {
<a name="l00976"></a>00976 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00977"></a>00977 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00978"></a>00978 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00979"></a>00979 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00980"></a>00980             controlBit = <a class="code" href="QuEST_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);
<a name="l00981"></a>00981             <span class="keywordflow">if</span> (controlBit){
<a name="l00982"></a>00982                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l00983"></a>00983                 stateRealUp = stateVecRealUp[thisTask];
<a name="l00984"></a>00984                 stateImagUp = stateVecImagUp[thisTask];
<a name="l00985"></a>00985 
<a name="l00986"></a>00986                 stateRealLo = stateVecRealLo[thisTask];
<a name="l00987"></a>00987                 stateImagLo = stateVecImagLo[thisTask];
<a name="l00988"></a>00988 
<a name="l00989"></a>00989                 stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp 
<a name="l00990"></a>00990                     + rot2Real*stateRealLo - rot2Imag*stateImagLo;
<a name="l00991"></a>00991                 stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp 
<a name="l00992"></a>00992                     + rot2Real*stateImagLo + rot2Imag*stateRealLo;
<a name="l00993"></a>00993             }
<a name="l00994"></a>00994         }
<a name="l00995"></a>00995     }
<a name="l00996"></a>00996 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8a4afcff70195a306c082b8ed8d4e09a"></a><!-- doxytag: member="QuEST_internal.h::controlledUnitaryLocal" ref="a8a4afcff70195a306c082b8ed8d4e09a" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l00805">805</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="QuEST_8c_source.html#l01698">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00032">ComplexMatrix2::r0c0</a>, <a class="el" href="QuEST_8h_source.html#l00032">ComplexMatrix2::r0c1</a>, <a class="el" href="QuEST_8h_source.html#l00033">ComplexMatrix2::r1c0</a>, <a class="el" href="QuEST_8h_source.html#l00033">ComplexMatrix2::r1c1</a>, <a class="el" href="QuEST_8h_source.html#l00024">Complex::real</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00124">controlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00807"></a>00807 {
<a name="l00808"></a>00808     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l00809"></a>00809     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l00810"></a>00810          indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l00811"></a>00811 
<a name="l00812"></a>00812     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00813"></a>00813     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l00814"></a>00814     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l00815"></a>00815     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00816"></a>00816     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l00817"></a>00817 
<a name="l00818"></a>00818     <span class="keywordtype">int</span> controlBit;
<a name="l00819"></a>00819 
<a name="l00820"></a>00820     <span class="comment">// set dimensions</span>
<a name="l00821"></a>00821     sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l00822"></a>00822     sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l00823"></a>00823 
<a name="l00824"></a>00824     <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l00825"></a>00825     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00826"></a>00826     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00827"></a>00827 
<a name="l00828"></a>00828 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00829"></a>00829 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00830"></a>00830 <span class="preprocessor">    default  (none) \</span>
<a name="l00831"></a>00831 <span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, u) \</span>
<a name="l00832"></a>00832 <span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit) </span>
<a name="l00833"></a>00833 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00834"></a>00834 <span class="preprocessor"></span>    {
<a name="l00835"></a>00835 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00836"></a>00836 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00837"></a>00837 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00838"></a>00838 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00839"></a>00839 
<a name="l00840"></a>00840             thisBlock   = thisTask / sizeHalfBlock;
<a name="l00841"></a>00841             indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l00842"></a>00842             indexLo     = indexUp + sizeHalfBlock;
<a name="l00843"></a>00843 
<a name="l00844"></a>00844             controlBit = <a class="code" href="QuEST_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, indexUp+chunkId*chunkSize);
<a name="l00845"></a>00845             <span class="keywordflow">if</span> (controlBit){
<a name="l00846"></a>00846                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l00847"></a>00847                 stateRealUp = stateVecReal[indexUp];
<a name="l00848"></a>00848                 stateImagUp = stateVecImag[indexUp];
<a name="l00849"></a>00849 
<a name="l00850"></a>00850                 stateRealLo = stateVecReal[indexLo];
<a name="l00851"></a>00851                 stateImagLo = stateVecImag[indexLo];
<a name="l00852"></a>00852 
<a name="l00853"></a>00853 
<a name="l00854"></a>00854                 <span class="comment">// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]</span>
<a name="l00855"></a>00855                 stateVecReal[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp 
<a name="l00856"></a>00856                     + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo - u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;
<a name="l00857"></a>00857                 stateVecImag[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp 
<a name="l00858"></a>00858                     + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;
<a name="l00859"></a>00859 
<a name="l00860"></a>00860                 <span class="comment">// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]</span>
<a name="l00861"></a>00861                 stateVecReal[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp  - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp 
<a name="l00862"></a>00862                     + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo  -  u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;
<a name="l00863"></a>00863                 stateVecImag[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp 
<a name="l00864"></a>00864                     + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;
<a name="l00865"></a>00865             }
<a name="l00866"></a>00866         } 
<a name="l00867"></a>00867     }
<a name="l00868"></a>00868 
<a name="l00869"></a>00869 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae5f9019826f35e8b51b1716cfe397b45"></a><!-- doxytag: member="QuEST_internal.h::exitWithError" ref="ae5f9019826f35e8b51b1716cfe397b45" args="(int errorCode, const char *func)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void exitWithError </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>errorCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>func</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00229">229</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p>References <a class="el" href="QuEST_8c_source.html#l00029">errorCodes</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00237">QuESTAssert()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00229"></a>00229                                                    {
<a name="l00230"></a>00230     printf(<span class="stringliteral">&quot;!!!\n&quot;</span>);
<a name="l00231"></a>00231     printf(<span class="stringliteral">&quot;QuEST Error in function %s: %s\n&quot;</span>, func, <a class="code" href="QuEST_8c.html#aac1637696885c75b73a1ecf381cea713">errorCodes</a>[errorCode]);
<a name="l00232"></a>00232     printf(<span class="stringliteral">&quot;!!!\n&quot;</span>);
<a name="l00233"></a>00233     printf(<span class="stringliteral">&quot;exiting..\n&quot;</span>);
<a name="l00234"></a>00234     exit(errorCode);
<a name="l00235"></a>00235 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9ac9bb717a889f09d307eda9f0b65957"></a><!-- doxytag: member="QuEST_internal.h::findProbabilityOfZeroDistributed" ref="a9ac9bb717a889f09d307eda9f0b65957" args="(MultiQubit multiQubit, const int measureQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL findProbabilityOfZeroDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Measure the probability of a specified qubit being in the zero state across all amplitudes held in this chunk. </p>
<p>Size of regions to skip is a multiple of chunkSize.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>probability of qubit measureQubit being zero </dd></dl>

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l01654">1654</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00656">findProbabilityOfOutcome()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01656"></a>01656 {
<a name="l01657"></a>01657     <span class="comment">// ----- measured probability</span>
<a name="l01658"></a>01658     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   totalProbability;                                  <span class="comment">// probability (returned) value</span>
<a name="l01659"></a>01659     <span class="comment">// ----- temp variables</span>
<a name="l01660"></a>01660     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span>
<a name="l01661"></a>01661     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01662"></a>01662 
<a name="l01663"></a>01663     <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01664"></a>01664     <span class="comment">//            find probability                                      //</span>
<a name="l01665"></a>01665     <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01666"></a>01666 
<a name="l01667"></a>01667     <span class="comment">// initialise returned value</span>
<a name="l01668"></a>01668     totalProbability = 0.0;
<a name="l01669"></a>01669 
<a name="l01670"></a>01670     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01671"></a>01671     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01672"></a>01672 
<a name="l01673"></a>01673 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01674"></a>01674 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01675"></a>01675 <span class="preprocessor">    shared    (numTasks,stateVecReal,stateVecImag) \</span>
<a name="l01676"></a>01676 <span class="preprocessor">    private   (thisTask) \</span>
<a name="l01677"></a>01677 <span class="preprocessor">    reduction ( +:totalProbability )</span>
<a name="l01678"></a>01678 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01679"></a>01679 <span class="preprocessor"></span>    {
<a name="l01680"></a>01680 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01681"></a>01681 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule  (static)</span>
<a name="l01682"></a>01682 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01683"></a>01683 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01684"></a>01684             totalProbability += stateVecReal[thisTask]*stateVecReal[thisTask]
<a name="l01685"></a>01685                 + stateVecImag[thisTask]*stateVecImag[thisTask];
<a name="l01686"></a>01686         }
<a name="l01687"></a>01687     }
<a name="l01688"></a>01688 
<a name="l01689"></a>01689     <span class="keywordflow">return</span> totalProbability;
<a name="l01690"></a>01690 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7c02cd0e1b4eac19771a0525f023249e"></a><!-- doxytag: member="QuEST_internal.h::findProbabilityOfZeroLocal" ref="a7c02cd0e1b4eac19771a0525f023249e" args="(MultiQubit multiQubit, const int measureQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL findProbabilityOfZeroLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Measure the total probability of a specified qubit being in the zero state across all amplitudes in this chunk. </p>
<p>Size of regions to skip is less than the size of one chunk.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>probability of qubit measureQubit being zero </dd></dl>

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l01598">1598</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00180">findProbabilityOfOutcome()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01600"></a>01600 {
<a name="l01601"></a>01601     <span class="comment">// ----- sizes</span>
<a name="l01602"></a>01602     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock,                                  <span class="comment">// size of blocks</span>
<a name="l01603"></a>01603          sizeHalfBlock;                                       <span class="comment">// size of blocks halved</span>
<a name="l01604"></a>01604     <span class="comment">// ----- indices</span>
<a name="l01605"></a>01605     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock,                                  <span class="comment">// current block</span>
<a name="l01606"></a>01606          index;                                               <span class="comment">// current index for first half block</span>
<a name="l01607"></a>01607     <span class="comment">// ----- measured probability</span>
<a name="l01608"></a>01608     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   totalProbability;                                  <span class="comment">// probability (returned) value</span>
<a name="l01609"></a>01609     <span class="comment">// ----- temp variables</span>
<a name="l01610"></a>01610     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   
<a name="l01611"></a>01611     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01612"></a>01612 
<a name="l01613"></a>01613     <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01614"></a>01614     <span class="comment">//            dimensions                                            //</span>
<a name="l01615"></a>01615     <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01616"></a>01616     sizeHalfBlock = 1LL &lt;&lt; (measureQubit);                       <span class="comment">// number of state vector elements to sum,</span>
<a name="l01617"></a>01617     <span class="comment">// and then the number to skip</span>
<a name="l01618"></a>01618     sizeBlock     = 2LL * sizeHalfBlock;                         <span class="comment">// size of blocks (pairs of measure and skip entries)</span>
<a name="l01619"></a>01619 
<a name="l01620"></a>01620     <span class="comment">// initialise returned value</span>
<a name="l01621"></a>01621     totalProbability = 0.0;
<a name="l01622"></a>01622 
<a name="l01623"></a>01623     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01624"></a>01624     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01625"></a>01625 
<a name="l01626"></a>01626 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01627"></a>01627 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01628"></a>01628 <span class="preprocessor">    shared    (numTasks,sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span>
<a name="l01629"></a>01629 <span class="preprocessor">    private   (thisTask,thisBlock,index) \</span>
<a name="l01630"></a>01630 <span class="preprocessor">    reduction ( +:totalProbability )</span>
<a name="l01631"></a>01631 <span class="preprocessor"></span><span class="preprocessor"># endif </span>
<a name="l01632"></a>01632 <span class="preprocessor"></span>    {
<a name="l01633"></a>01633 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01634"></a>01634 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule  (static)</span>
<a name="l01635"></a>01635 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01636"></a>01636 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01637"></a>01637             thisBlock = thisTask / sizeHalfBlock;
<a name="l01638"></a>01638             index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01639"></a>01639 
<a name="l01640"></a>01640             totalProbability += stateVecReal[index]*stateVecReal[index]
<a name="l01641"></a>01641                 + stateVecImag[index]*stateVecImag[index];
<a name="l01642"></a>01642         }
<a name="l01643"></a>01643     }
<a name="l01644"></a>01644     <span class="keywordflow">return</span> totalProbability;
<a name="l01645"></a>01645 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae6a897066979fc52d977007d959ca09d"></a><!-- doxytag: member="QuEST_internal.h::hadamardDistributed" ref="ae6a897066979fc52d977007d959ca09d" args="(MultiQubit multiQubit, const int targetQubit, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut, int updateUpper)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hadamardDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>updateUpper</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{1,1},{1,-1}}/sqrt2. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecIn</em>&nbsp;</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>updateUpper</em>&nbsp;</td><td>flag, 1: updating upper values, 0: updating lower values in block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l01401">1401</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00599">hadamard()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01406"></a>01406 {
<a name="l01407"></a>01407 
<a name="l01408"></a>01408     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l01409"></a>01409     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01410"></a>01410     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01411"></a>01411 
<a name="l01412"></a>01412     <span class="keywordtype">int</span> sign;
<a name="l01413"></a>01413     <span class="keywordflow">if</span> (updateUpper) sign=1;
<a name="l01414"></a>01414     <span class="keywordflow">else</span> sign=-1;
<a name="l01415"></a>01415 
<a name="l01416"></a>01416     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> recRoot2 = 1.0/sqrt(2);
<a name="l01417"></a>01417 
<a name="l01418"></a>01418     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01419"></a>01419     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01420"></a>01420     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01421"></a>01421 
<a name="l01422"></a>01422 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01423"></a>01423 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01424"></a>01424 <span class="preprocessor">    default  (none) \</span>
<a name="l01425"></a>01425 <span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l01426"></a>01426 <span class="preprocessor">            recRoot2, sign) \</span>
<a name="l01427"></a>01427 <span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span>
<a name="l01428"></a>01428 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01429"></a>01429 <span class="preprocessor"></span>    {
<a name="l01430"></a>01430 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01431"></a>01431 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01432"></a>01432 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01433"></a>01433 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01434"></a>01434             <span class="comment">// store current state vector values in temp variables</span>
<a name="l01435"></a>01435             stateRealUp = stateVecRealUp[thisTask];
<a name="l01436"></a>01436             stateImagUp = stateVecImagUp[thisTask];
<a name="l01437"></a>01437 
<a name="l01438"></a>01438             stateRealLo = stateVecRealLo[thisTask];
<a name="l01439"></a>01439             stateImagLo = stateVecImagLo[thisTask];
<a name="l01440"></a>01440 
<a name="l01441"></a>01441             stateVecRealOut[thisTask] = recRoot2*(stateRealUp + sign*stateRealLo);
<a name="l01442"></a>01442             stateVecImagOut[thisTask] = recRoot2*(stateImagUp + sign*stateImagLo);
<a name="l01443"></a>01443         }
<a name="l01444"></a>01444     }
<a name="l01445"></a>01445 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa9f0718b4dd794a3e1b143e3b153bfc5"></a><!-- doxytag: member="QuEST_internal.h::hadamardLocal" ref="aa9f0718b4dd794a3e1b143e3b153bfc5" args="(MultiQubit multiQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hadamardLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l01340">1340</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00166">hadamard()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01341"></a>01341 {
<a name="l01342"></a>01342     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01343"></a>01343     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01344"></a>01344          indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01345"></a>01345 
<a name="l01346"></a>01346     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l01347"></a>01347     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01348"></a>01348     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01349"></a>01349 
<a name="l01350"></a>01350     <span class="comment">// set dimensions</span>
<a name="l01351"></a>01351     sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01352"></a>01352     sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01353"></a>01353 
<a name="l01354"></a>01354     <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l01355"></a>01355     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01356"></a>01356     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01357"></a>01357 
<a name="l01358"></a>01358     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> recRoot2 = 1.0/sqrt(2);
<a name="l01359"></a>01359 
<a name="l01360"></a>01360 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01361"></a>01361 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01362"></a>01362 <span class="preprocessor">    default  (none) \</span>
<a name="l01363"></a>01363 <span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, recRoot2) \</span>
<a name="l01364"></a>01364 <span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span>
<a name="l01365"></a>01365 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01366"></a>01366 <span class="preprocessor"></span>    {
<a name="l01367"></a>01367 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01368"></a>01368 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01369"></a>01369 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01370"></a>01370 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01371"></a>01371             thisBlock   = thisTask / sizeHalfBlock;
<a name="l01372"></a>01372             indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01373"></a>01373             indexLo     = indexUp + sizeHalfBlock;
<a name="l01374"></a>01374 
<a name="l01375"></a>01375             stateRealUp = stateVecReal[indexUp];
<a name="l01376"></a>01376             stateImagUp = stateVecImag[indexUp];
<a name="l01377"></a>01377 
<a name="l01378"></a>01378             stateRealLo = stateVecReal[indexLo];
<a name="l01379"></a>01379             stateImagLo = stateVecImag[indexLo];
<a name="l01380"></a>01380 
<a name="l01381"></a>01381             stateVecReal[indexUp] = recRoot2*(stateRealUp + stateRealLo);
<a name="l01382"></a>01382             stateVecImag[indexUp] = recRoot2*(stateImagUp + stateImagLo);
<a name="l01383"></a>01383 
<a name="l01384"></a>01384             stateVecReal[indexLo] = recRoot2*(stateRealUp - stateRealLo);
<a name="l01385"></a>01385             stateVecImag[indexLo] = recRoot2*(stateImagUp - stateImagLo);
<a name="l01386"></a>01386         } 
<a name="l01387"></a>01387     }
<a name="l01388"></a>01388 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab76254cfde16f0808476649507a1a2fc"></a><!-- doxytag: member="QuEST_internal.h::hashString" ref="ab76254cfde16f0808476649507a1a2fc" args="(char *str)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long int hashString </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>str</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l01983">1983</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l01949">QuESTSeedRandomDefault()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01983"></a>01983                                        {
<a name="l01984"></a>01984     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> hash = 5381;
<a name="l01985"></a>01985     <span class="keywordtype">int</span> c;
<a name="l01986"></a>01986 
<a name="l01987"></a>01987     <span class="keywordflow">while</span> ((c = *str++))
<a name="l01988"></a>01988         hash = ((hash &lt;&lt; 5) + hash) + c; <span class="comment">/* hash * 33 + c */</span>
<a name="l01989"></a>01989 
<a name="l01990"></a>01990     <span class="keywordflow">return</span> hash;    
<a name="l01991"></a>01991 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9dbf856ebeea0cf0a3ee5aae6782f2d2"></a><!-- doxytag: member="QuEST_internal.h::multiControlledUnitaryDistributed" ref="a9dbf856ebeea0cf0a3ee5aae6782f2d2" args="(MultiQubit multiQubit, const int targetQubit, long long int mask, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multiControlledUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply a unitary operation to a single qubit in the state vector of probability amplitudes, given a subset of the state vector with upper and lower block values stored seperately. </p>
<p>Only perform the rotation where all the control qubits are 1.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>qubit to determine whether or not to perform a rotation </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot1</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot2</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l01011">1011</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="QuEST_8h_source.html#l00024">Complex::real</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00438">multiControlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01018"></a>01018 {
<a name="l01019"></a>01019 
<a name="l01020"></a>01020     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l01021"></a>01021     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01022"></a>01022     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01023"></a>01023     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01024"></a>01024     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01025"></a>01025 
<a name="l01026"></a>01026     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l01027"></a>01027     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l01028"></a>01028     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01029"></a>01029     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01030"></a>01030     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01031"></a>01031 
<a name="l01032"></a>01032 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01033"></a>01033 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01034"></a>01034 <span class="preprocessor">    default  (none) \</span>
<a name="l01035"></a>01035 <span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l01036"></a>01036 <span class="preprocessor">            rot1Real,rot1Imag, rot2Real,rot2Imag, mask) \</span>
<a name="l01037"></a>01037 <span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span>
<a name="l01038"></a>01038 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01039"></a>01039 <span class="preprocessor"></span>    {
<a name="l01040"></a>01040 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01041"></a>01041 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01042"></a>01042 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01043"></a>01043 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01044"></a>01044             <span class="keywordflow">if</span> (mask == (mask &amp; (thisTask+chunkId*chunkSize)) ){
<a name="l01045"></a>01045                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l01046"></a>01046                 stateRealUp = stateVecRealUp[thisTask];
<a name="l01047"></a>01047                 stateImagUp = stateVecImagUp[thisTask];
<a name="l01048"></a>01048 
<a name="l01049"></a>01049                 stateRealLo = stateVecRealLo[thisTask];
<a name="l01050"></a>01050                 stateImagLo = stateVecImagLo[thisTask];
<a name="l01051"></a>01051 
<a name="l01052"></a>01052                 stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp 
<a name="l01053"></a>01053                     + rot2Real*stateRealLo - rot2Imag*stateImagLo;
<a name="l01054"></a>01054                 stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp 
<a name="l01055"></a>01055                     + rot2Real*stateImagLo + rot2Imag*stateRealLo;
<a name="l01056"></a>01056             }
<a name="l01057"></a>01057         }
<a name="l01058"></a>01058     }
<a name="l01059"></a>01059 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1309eabcba3cb97fbc3cd2e606d17766"></a><!-- doxytag: member="QuEST_internal.h::multiControlledUnitaryLocal" ref="a1309eabcba3cb97fbc3cd2e606d17766" args="(MultiQubit multiQubit, const int targetQubit, long long int mask, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multiControlledUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l00742">742</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00032">ComplexMatrix2::r0c0</a>, <a class="el" href="QuEST_8h_source.html#l00032">ComplexMatrix2::r0c1</a>, <a class="el" href="QuEST_8h_source.html#l00033">ComplexMatrix2::r1c0</a>, <a class="el" href="QuEST_8h_source.html#l00033">ComplexMatrix2::r1c1</a>, <a class="el" href="QuEST_8h_source.html#l00024">Complex::real</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00134">multiControlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00744"></a>00744 {
<a name="l00745"></a>00745     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l00746"></a>00746     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l00747"></a>00747          indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l00748"></a>00748 
<a name="l00749"></a>00749     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00750"></a>00750     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l00751"></a>00751     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l00752"></a>00752     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00753"></a>00753     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l00754"></a>00754 
<a name="l00755"></a>00755     <span class="comment">// set dimensions</span>
<a name="l00756"></a>00756     sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l00757"></a>00757     sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l00758"></a>00758 
<a name="l00759"></a>00759     <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l00760"></a>00760     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00761"></a>00761     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00762"></a>00762 
<a name="l00763"></a>00763 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00764"></a>00764 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00765"></a>00765 <span class="preprocessor">    default  (none) \</span>
<a name="l00766"></a>00766 <span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, u, mask) \</span>
<a name="l00767"></a>00767 <span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span>
<a name="l00768"></a>00768 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00769"></a>00769 <span class="preprocessor"></span>    {
<a name="l00770"></a>00770 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00771"></a>00771 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00772"></a>00772 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00773"></a>00773 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00774"></a>00774 
<a name="l00775"></a>00775             thisBlock   = thisTask / sizeHalfBlock;
<a name="l00776"></a>00776             indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l00777"></a>00777             indexLo     = indexUp + sizeHalfBlock;
<a name="l00778"></a>00778 
<a name="l00779"></a>00779             <span class="keywordflow">if</span> (mask == (mask &amp; (indexUp+chunkId*chunkSize)) ){
<a name="l00780"></a>00780                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l00781"></a>00781                 stateRealUp = stateVecReal[indexUp];
<a name="l00782"></a>00782                 stateImagUp = stateVecImag[indexUp];
<a name="l00783"></a>00783 
<a name="l00784"></a>00784                 stateRealLo = stateVecReal[indexLo];
<a name="l00785"></a>00785                 stateImagLo = stateVecImag[indexLo];
<a name="l00786"></a>00786 
<a name="l00787"></a>00787 
<a name="l00788"></a>00788                 <span class="comment">// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]</span>
<a name="l00789"></a>00789                 stateVecReal[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp 
<a name="l00790"></a>00790                     + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo - u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;
<a name="l00791"></a>00791                 stateVecImag[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp 
<a name="l00792"></a>00792                     + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;
<a name="l00793"></a>00793 
<a name="l00794"></a>00794                 <span class="comment">// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]</span>
<a name="l00795"></a>00795                 stateVecReal[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp  - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp 
<a name="l00796"></a>00796                     + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo  -  u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;
<a name="l00797"></a>00797                 stateVecImag[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp 
<a name="l00798"></a>00798                     + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;
<a name="l00799"></a>00799             }
<a name="l00800"></a>00800         } 
<a name="l00801"></a>00801     }
<a name="l00802"></a>00802 
<a name="l00803"></a>00803 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aae7a8a7f1ccbddb7f76b6c52b746bb43"></a><!-- doxytag: member="QuEST_internal.h::phaseGate" ref="aae7a8a7f1ccbddb7f76b6c52b746bb43" args="(MultiQubit multiQubit, const int targetQubit, enum phaseGateType type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void phaseGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a>&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00160">160</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00147">chunkIsUpper()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00232">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="QuEST_8c_source.html#l01523">phaseGateDistributed()</a>, <a class="el" href="QuEST_8c_source.html#l01447">phaseGateLocal()</a>, and <a class="el" href="QuEST__env__local_8c_source.html#l00237">QuESTAssert()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l01581">sGate()</a>, <a class="el" href="QuEST_8c_source.html#l01576">sigmaZ()</a>, and <a class="el" href="QuEST_8c_source.html#l01586">tGate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00161"></a>00161 {
<a name="l00162"></a>00162     <a class="code" href="QuEST__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00163"></a>00163     <a class="code" href="QuEST_8c.html#a3a54566b73ac84c312d7da4f56ffbc3b">phaseGateLocal</a>(multiQubit, targetQubit, type);
<a name="l00164"></a>00164 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af832ed00b02a0597b7fe0b714032c54a"></a><!-- doxytag: member="QuEST_internal.h::phaseGateDistributed" ref="af832ed00b02a0597b7fe0b714032c54a" args="(MultiQubit multiQubit, const int targetQubit, enum phaseGateType type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void phaseGateDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a>&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l01523">1523</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, <a class="el" href="QuEST_8h_source.html#l00073">S_GATE</a>, <a class="el" href="QuEST_8h_source.html#l00073">SIGMA_Z</a>, <a class="el" href="QuEST_8h_source.html#l00049">MultiQubit::stateVec</a>, and <a class="el" href="QuEST_8h_source.html#l00073">T_GATE</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00581">phaseGate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01524"></a>01524 {
<a name="l01525"></a>01525     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealLo,stateImagLo;
<a name="l01526"></a>01526     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01527"></a>01527     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01528"></a>01528 
<a name="l01529"></a>01529     <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l01530"></a>01530     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01531"></a>01531     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01532"></a>01532 
<a name="l01533"></a>01533     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> recRoot2 = 1.0/sqrt(2);
<a name="l01534"></a>01534 
<a name="l01535"></a>01535 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01536"></a>01536 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01537"></a>01537 <span class="preprocessor">    default  (none) \</span>
<a name="l01538"></a>01538 <span class="preprocessor">    shared   (stateVecReal,stateVecImag, recRoot2, type) \</span>
<a name="l01539"></a>01539 <span class="preprocessor">    private  (thisTask,stateRealLo,stateImagLo) </span>
<a name="l01540"></a>01540 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01541"></a>01541 <span class="preprocessor"></span>    {
<a name="l01542"></a>01542         <span class="keywordflow">if</span> (type==<a class="code" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a>){
<a name="l01543"></a>01543 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01544"></a>01544 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01545"></a>01545 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01546"></a>01546 <span class="preprocessor"></span>            <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01547"></a>01547                 stateVecReal[thisTask] = -stateVecReal[thisTask];
<a name="l01548"></a>01548                 stateVecImag[thisTask] = -stateVecImag[thisTask];
<a name="l01549"></a>01549             } 
<a name="l01550"></a>01550         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<a class="code" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a>){
<a name="l01551"></a>01551 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01552"></a>01552 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01553"></a>01553 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01554"></a>01554 <span class="preprocessor"></span>            <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01555"></a>01555                 stateRealLo = stateVecReal[thisTask];
<a name="l01556"></a>01556                 stateImagLo = stateVecImag[thisTask];
<a name="l01557"></a>01557 
<a name="l01558"></a>01558                 stateVecReal[thisTask] = -stateImagLo;
<a name="l01559"></a>01559                 stateVecImag[thisTask] = stateRealLo;
<a name="l01560"></a>01560             } 
<a name="l01561"></a>01561         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<a class="code" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a>){
<a name="l01562"></a>01562 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01563"></a>01563 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01564"></a>01564 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01565"></a>01565 <span class="preprocessor"></span>            <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01566"></a>01566                 stateRealLo = stateVecReal[thisTask];
<a name="l01567"></a>01567                 stateImagLo = stateVecImag[thisTask];
<a name="l01568"></a>01568 
<a name="l01569"></a>01569                 stateVecReal[thisTask] = recRoot2 * (stateRealLo - stateImagLo);
<a name="l01570"></a>01570                 stateVecImag[thisTask] = recRoot2 * (stateRealLo + stateImagLo);
<a name="l01571"></a>01571             } 
<a name="l01572"></a>01572         } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Type %d is an invalid phase gate\n&quot;</span>, type);
<a name="l01573"></a>01573     }
<a name="l01574"></a>01574 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3a54566b73ac84c312d7da4f56ffbc3b"></a><!-- doxytag: member="QuEST_internal.h::phaseGateLocal" ref="a3a54566b73ac84c312d7da4f56ffbc3b" args="(MultiQubit multiQubit, const int targetQubit, enum phaseGateType type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void phaseGateLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a>&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>fix -- can i rewrite this to not use mod?</p>
<p>fix -- can i rewrite this to not use mod?</p>
<p>fix -- can i rewrite this to not use mod? </p>
</p>

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l01447">1447</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, <a class="el" href="QuEST_8h_source.html#l00073">S_GATE</a>, <a class="el" href="QuEST_8h_source.html#l00073">SIGMA_Z</a>, <a class="el" href="QuEST_8h_source.html#l00049">MultiQubit::stateVec</a>, and <a class="el" href="QuEST_8h_source.html#l00073">T_GATE</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00160">phaseGate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01448"></a>01448 {
<a name="l01449"></a>01449     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01450"></a>01450     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01451"></a>01451          indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01452"></a>01452 
<a name="l01453"></a>01453     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealLo,stateImagLo;
<a name="l01454"></a>01454     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01455"></a>01455     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01456"></a>01456 
<a name="l01457"></a>01457     <span class="comment">// set dimensions</span>
<a name="l01458"></a>01458     sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01459"></a>01459     sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01460"></a>01460 
<a name="l01461"></a>01461     <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l01462"></a>01462     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01463"></a>01463     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01464"></a>01464 
<a name="l01465"></a>01465     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> recRoot2 = 1.0/sqrt(2);
<a name="l01466"></a>01466 
<a name="l01467"></a>01467 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01468"></a>01468 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01469"></a>01469 <span class="preprocessor">    default  (none) \</span>
<a name="l01470"></a>01470 <span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock,stateVecReal,stateVecImag,recRoot2,type) \</span>
<a name="l01471"></a>01471 <span class="preprocessor">    private  (thisTask,thisBlock,indexUp,indexLo,stateRealLo,stateImagLo) </span>
<a name="l01472"></a>01472 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01473"></a>01473 <span class="preprocessor"></span>    {
<a name="l01474"></a>01474         <span class="keywordflow">if</span> (type==<a class="code" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a>){
<a name="l01475"></a>01475 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01476"></a>01476 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01477"></a>01477 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01478"></a>01478 <span class="preprocessor"></span>            <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01480"></a>01480                 thisBlock   = thisTask / sizeHalfBlock;
<a name="l01481"></a>01481                 indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01482"></a>01482                 indexLo     = indexUp + sizeHalfBlock;
<a name="l01483"></a>01483 
<a name="l01484"></a>01484                 stateVecReal[indexLo] = -stateVecReal[indexLo];
<a name="l01485"></a>01485                 stateVecImag[indexLo] = -stateVecImag[indexLo];
<a name="l01486"></a>01486             } 
<a name="l01487"></a>01487         } 
<a name="l01488"></a>01488 
<a name="l01489"></a>01489         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<a class="code" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a>){
<a name="l01490"></a>01490 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01491"></a>01491 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01492"></a>01492 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01493"></a>01493 <span class="preprocessor"></span>            <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01495"></a>01495                 thisBlock   = thisTask / sizeHalfBlock;
<a name="l01496"></a>01496                 indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01497"></a>01497                 indexLo     = indexUp + sizeHalfBlock;
<a name="l01498"></a>01498                 stateRealLo = stateVecReal[indexLo];
<a name="l01499"></a>01499                 stateImagLo = stateVecImag[indexLo];
<a name="l01500"></a>01500 
<a name="l01501"></a>01501                 stateVecReal[indexLo] = -stateImagLo;
<a name="l01502"></a>01502                 stateVecImag[indexLo] = stateRealLo;
<a name="l01503"></a>01503             } 
<a name="l01504"></a>01504         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<a class="code" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a>){
<a name="l01505"></a>01505 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01506"></a>01506 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01507"></a>01507 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01508"></a>01508 <span class="preprocessor"></span>            <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01510"></a>01510                 thisBlock   = thisTask / sizeHalfBlock;
<a name="l01511"></a>01511                 indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01512"></a>01512                 indexLo     = indexUp + sizeHalfBlock;
<a name="l01513"></a>01513                 stateRealLo = stateVecReal[indexLo];
<a name="l01514"></a>01514                 stateImagLo = stateVecImag[indexLo];
<a name="l01515"></a>01515 
<a name="l01516"></a>01516                 stateVecReal[indexLo] = recRoot2 * (stateRealLo - stateImagLo);
<a name="l01517"></a>01517                 stateVecImag[indexLo] = recRoot2 * (stateRealLo + stateImagLo);
<a name="l01518"></a>01518             } 
<a name="l01519"></a>01519         } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Type %d is an invalid phase gate\n&quot;</span>, type);
<a name="l01520"></a>01520     }
<a name="l01521"></a>01521 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3587b9d533e633ccf1abf9ad2ce45d8d"></a><!-- doxytag: member="QuEST_internal.h::QuESTAssert" ref="a3587b9d533e633ccf1abf9ad2ce45d8d" args="(int isValid, int errorCode, const char *func)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void QuESTAssert </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>isValid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>errorCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>func</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__env__local_8c_source.html#l00237">237</a> of file <a class="el" href="QuEST__env__local_8c_source.html">QuEST_env_local.c</a>.</p>

<p>References <a class="el" href="QuEST__env__local_8c_source.html#l00229">exitWithError()</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00189">collapseToOutcome()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00095">compactUnitary()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00113">controlledCompactUnitary()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00172">controlledNot()</a>, <a class="el" href="QuEST_8c_source.html#l01703">controlledPhaseGate()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00124">controlledUnitary()</a>, <a class="el" href="QuEST_8c_source.html#l00046">createMultiQubit()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00180">findProbabilityOfOutcome()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00166">hadamard()</a>, <a class="el" href="QuEST_8c_source.html#l00298">initializeStateFromSingleFile()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00200">measure()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00206">measureWithStats()</a>, <a class="el" href="QuEST_8c_source.html#l01738">multiControlledPhaseGate()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00134">multiControlledUnitary()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00160">phaseGate()</a>, <a class="el" href="QuEST_8c_source.html#l00088">reportState()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00148">sigmaX()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00154">sigmaY()</a>, and <a class="el" href="QuEST__env__local_8c_source.html#l00104">unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00237"></a>00237                                                               {
<a name="l00238"></a>00238     <span class="keywordflow">if</span> (!isValid) <a class="code" href="QuEST__env__local_8c.html#ae5f9019826f35e8b51b1716cfe397b45">exitWithError</a>(errorCode, func);
<a name="l00239"></a>00239 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2275fff50824fe47485890ff5a857785"></a><!-- doxytag: member="QuEST_internal.h::sigmaXDistributed" ref="a2275fff50824fe47485890ff5a857785" args="(MultiQubit multiQubit, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaXDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{0,1},{1,0}. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecIn</em>&nbsp;</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l01120">1120</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00484">sigmaX()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01123"></a>01123 {
<a name="l01124"></a>01124 
<a name="l01125"></a>01125     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01126"></a>01126     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01127"></a>01127 
<a name="l01128"></a>01128     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealIn=stateVecIn.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagIn=stateVecIn.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01129"></a>01129     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01130"></a>01130 
<a name="l01131"></a>01131 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01132"></a>01132 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01133"></a>01133 <span class="preprocessor">    default  (none) \</span>
<a name="l01134"></a>01134 <span class="preprocessor">    shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut) \</span>
<a name="l01135"></a>01135 <span class="preprocessor">    private  (thisTask)</span>
<a name="l01136"></a>01136 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01137"></a>01137 <span class="preprocessor"></span>    {
<a name="l01138"></a>01138 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01139"></a>01139 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01140"></a>01140 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01141"></a>01141 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01142"></a>01142             stateVecRealOut[thisTask] = stateVecRealIn[thisTask];
<a name="l01143"></a>01143             stateVecImagOut[thisTask] = stateVecImagIn[thisTask];
<a name="l01144"></a>01144         }
<a name="l01145"></a>01145     }
<a name="l01146"></a>01146 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a74822fd86bb5d81766e6e8dbdcd62df1"></a><!-- doxytag: member="QuEST_internal.h::sigmaXLocal" ref="a74822fd86bb5d81766e6e8dbdcd62df1" args="(MultiQubit multiQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaXLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l01061">1061</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00148">sigmaX()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01062"></a>01062 {
<a name="l01063"></a>01063     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01064"></a>01064     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01065"></a>01065          indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01066"></a>01066 
<a name="l01067"></a>01067     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateImagUp;
<a name="l01068"></a>01068     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01069"></a>01069     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01070"></a>01070 
<a name="l01071"></a>01071     <span class="comment">// set dimensions</span>
<a name="l01072"></a>01072     sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01073"></a>01073     sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01074"></a>01074 
<a name="l01075"></a>01075     <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l01076"></a>01076     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01077"></a>01077     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01078"></a>01078 
<a name="l01079"></a>01079 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01080"></a>01080 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01081"></a>01081 <span class="preprocessor">    default  (none) \</span>
<a name="l01082"></a>01082 <span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span>
<a name="l01083"></a>01083 <span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp) </span>
<a name="l01084"></a>01084 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01085"></a>01085 <span class="preprocessor"></span>    {
<a name="l01086"></a>01086 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01087"></a>01087 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01088"></a>01088 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01089"></a>01089 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01090"></a>01090             thisBlock   = thisTask / sizeHalfBlock;
<a name="l01091"></a>01091             indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01092"></a>01092             indexLo     = indexUp + sizeHalfBlock;
<a name="l01093"></a>01093 
<a name="l01094"></a>01094             stateRealUp = stateVecReal[indexUp];
<a name="l01095"></a>01095             stateImagUp = stateVecImag[indexUp];
<a name="l01096"></a>01096 
<a name="l01097"></a>01097             stateVecReal[indexUp] = stateVecReal[indexLo];
<a name="l01098"></a>01098             stateVecImag[indexUp] = stateVecImag[indexLo];
<a name="l01099"></a>01099 
<a name="l01100"></a>01100             stateVecReal[indexLo] = stateRealUp;
<a name="l01101"></a>01101             stateVecImag[indexLo] = stateImagUp;
<a name="l01102"></a>01102         } 
<a name="l01103"></a>01103     }
<a name="l01104"></a>01104 
<a name="l01105"></a>01105 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af5ef5166f00c0572354b4ac53dcf40cf"></a><!-- doxytag: member="QuEST_internal.h::sigmaYDistributed" ref="af5ef5166f00c0572354b4ac53dcf40cf" args="(MultiQubit multiQubit, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut, int updateUpper)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaYDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>updateUpper</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{0,-i},{i,0}. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecIn</em>&nbsp;</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>updateUpper</em>&nbsp;</td><td>flag, 1: updating upper values, 0: updating lower values in block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l01307">1307</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00550">sigmaY()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01311"></a>01311 {
<a name="l01312"></a>01312 
<a name="l01313"></a>01313     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01314"></a>01314     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01315"></a>01315 
<a name="l01316"></a>01316     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealIn=stateVecIn.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagIn=stateVecIn.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01317"></a>01317     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01318"></a>01318 
<a name="l01319"></a>01319     <span class="keywordtype">int</span> realSign=1, imagSign=1;
<a name="l01320"></a>01320     <span class="keywordflow">if</span> (updateUpper) imagSign=-1;
<a name="l01321"></a>01321     <span class="keywordflow">else</span> realSign = -1;
<a name="l01322"></a>01322 
<a name="l01323"></a>01323 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01324"></a>01324 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01325"></a>01325 <span class="preprocessor">    default  (none) \</span>
<a name="l01326"></a>01326 <span class="preprocessor">    shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut,realSign,imagSign) \</span>
<a name="l01327"></a>01327 <span class="preprocessor">    private  (thisTask)</span>
<a name="l01328"></a>01328 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01329"></a>01329 <span class="preprocessor"></span>    {
<a name="l01330"></a>01330 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01331"></a>01331 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01332"></a>01332 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01333"></a>01333 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01334"></a>01334             stateVecRealOut[thisTask] = realSign*stateVecImagIn[thisTask];
<a name="l01335"></a>01335             stateVecImagOut[thisTask] = imagSign*stateVecRealIn[thisTask];
<a name="l01336"></a>01336         }
<a name="l01337"></a>01337     }
<a name="l01338"></a>01338 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a81fbfaed65a742a7dfd622e17652245e"></a><!-- doxytag: member="QuEST_internal.h::sigmaYLocal" ref="a81fbfaed65a742a7dfd622e17652245e" args="(MultiQubit multiQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaYLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l01248">1248</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00154">sigmaY()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01249"></a>01249 {
<a name="l01250"></a>01250     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01251"></a>01251     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01252"></a>01252          indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01253"></a>01253 
<a name="l01254"></a>01254     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateImagUp;
<a name="l01255"></a>01255     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01256"></a>01256     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01257"></a>01257 
<a name="l01258"></a>01258     <span class="comment">// set dimensions</span>
<a name="l01259"></a>01259     sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01260"></a>01260     sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01261"></a>01261 
<a name="l01262"></a>01262     <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l01263"></a>01263     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01264"></a>01264     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01265"></a>01265 
<a name="l01266"></a>01266 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01267"></a>01267 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01268"></a>01268 <span class="preprocessor">    default  (none) \</span>
<a name="l01269"></a>01269 <span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span>
<a name="l01270"></a>01270 <span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp) </span>
<a name="l01271"></a>01271 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01272"></a>01272 <span class="preprocessor"></span>    {
<a name="l01273"></a>01273 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01274"></a>01274 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01275"></a>01275 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01276"></a>01276 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01277"></a>01277             thisBlock   = thisTask / sizeHalfBlock;
<a name="l01278"></a>01278             indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01279"></a>01279             indexLo     = indexUp + sizeHalfBlock;
<a name="l01280"></a>01280 
<a name="l01281"></a>01281             stateRealUp = stateVecReal[indexUp];
<a name="l01282"></a>01282             stateImagUp = stateVecImag[indexUp];
<a name="l01283"></a>01283 
<a name="l01284"></a>01284             stateVecReal[indexUp] = stateVecImag[indexLo];
<a name="l01285"></a>01285             stateVecImag[indexUp] = -stateVecReal[indexLo];
<a name="l01286"></a>01286 
<a name="l01287"></a>01287             stateVecReal[indexLo] = -stateImagUp;
<a name="l01288"></a>01288             stateVecImag[indexLo] = stateRealUp;
<a name="l01289"></a>01289         } 
<a name="l01290"></a>01290     }
<a name="l01291"></a>01291 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2343b7240118e89aa615e2c9140b770b"></a><!-- doxytag: member="QuEST_internal.h::unitaryDistributed" ref="a2343b7240118e89aa615e2c9140b770b" args="(MultiQubit multiQubit, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void unitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply a unitary operation to a single qubit given a subset of the state vector with upper and lower block values stored seperately. </p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>u</em>&nbsp;</td><td>unitary matrix to apply </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l00630">630</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="QuEST_8h_source.html#l00024">Complex::real</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00309">unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00635"></a>00635 {
<a name="l00636"></a>00636 
<a name="l00637"></a>00637     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00638"></a>00638     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l00639"></a>00639     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00640"></a>00640 
<a name="l00641"></a>00641     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00642"></a>00642     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00643"></a>00643     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00644"></a>00644     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00645"></a>00645     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00646"></a>00646 
<a name="l00647"></a>00647 
<a name="l00648"></a>00648 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00649"></a>00649 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00650"></a>00650 <span class="preprocessor">    default  (none) \</span>
<a name="l00651"></a>00651 <span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l00652"></a>00652 <span class="preprocessor">            rot1Real, rot1Imag, rot2Real, rot2Imag) \</span>
<a name="l00653"></a>00653 <span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span>
<a name="l00654"></a>00654 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00655"></a>00655 <span class="preprocessor"></span>    {
<a name="l00656"></a>00656 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00657"></a>00657 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00658"></a>00658 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00659"></a>00659 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00660"></a>00660             <span class="comment">// store current state vector values in temp variables</span>
<a name="l00661"></a>00661             stateRealUp = stateVecRealUp[thisTask];
<a name="l00662"></a>00662             stateImagUp = stateVecImagUp[thisTask];
<a name="l00663"></a>00663 
<a name="l00664"></a>00664             stateRealLo = stateVecRealLo[thisTask];
<a name="l00665"></a>00665             stateImagLo = stateVecImagLo[thisTask];
<a name="l00666"></a>00666 
<a name="l00667"></a>00667             stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp 
<a name="l00668"></a>00668                 + rot2Real*stateRealLo - rot2Imag*stateImagLo;
<a name="l00669"></a>00669             stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp 
<a name="l00670"></a>00670                 + rot2Real*stateImagLo + rot2Imag*stateRealLo;
<a name="l00671"></a>00671         }
<a name="l00672"></a>00672     }
<a name="l00673"></a>00673 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac134fb45b0a7248c5d15e16eb7139a35"></a><!-- doxytag: member="QuEST_internal.h::unitaryLocal" ref="ac134fb45b0a7248c5d15e16eb7139a35" args="(MultiQubit multiQubit, const int targetQubit, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void unitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l00504">504</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="QuEST_8h_source.html#l00032">ComplexMatrix2::r0c0</a>, <a class="el" href="QuEST_8h_source.html#l00032">ComplexMatrix2::r0c1</a>, <a class="el" href="QuEST_8h_source.html#l00033">ComplexMatrix2::r1c0</a>, <a class="el" href="QuEST_8h_source.html#l00033">ComplexMatrix2::r1c1</a>, <a class="el" href="QuEST_8h_source.html#l00024">Complex::real</a>, <a class="el" href="QuEST_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00104">unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00505"></a>00505 {
<a name="l00506"></a>00506     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l00507"></a>00507     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l00508"></a>00508          indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l00509"></a>00509 
<a name="l00510"></a>00510     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00511"></a>00511     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l00512"></a>00512     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l00513"></a>00513 
<a name="l00514"></a>00514     <span class="comment">// set dimensions</span>
<a name="l00515"></a>00515     sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l00516"></a>00516     sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l00517"></a>00517 
<a name="l00518"></a>00518     <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l00519"></a>00519     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00520"></a>00520     <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00521"></a>00521 
<a name="l00522"></a>00522 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00523"></a>00523 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00524"></a>00524 <span class="preprocessor">    default  (none) \</span>
<a name="l00525"></a>00525 <span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, u) \</span>
<a name="l00526"></a>00526 <span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span>
<a name="l00527"></a>00527 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00528"></a>00528 <span class="preprocessor"></span>    {
<a name="l00529"></a>00529 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00530"></a>00530 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00531"></a>00531 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00532"></a>00532 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00533"></a>00533 
<a name="l00534"></a>00534             thisBlock   = thisTask / sizeHalfBlock;
<a name="l00535"></a>00535             indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l00536"></a>00536             indexLo     = indexUp + sizeHalfBlock;
<a name="l00537"></a>00537 
<a name="l00538"></a>00538             <span class="comment">// store current state vector values in temp variables</span>
<a name="l00539"></a>00539             stateRealUp = stateVecReal[indexUp];
<a name="l00540"></a>00540             stateImagUp = stateVecImag[indexUp];
<a name="l00541"></a>00541 
<a name="l00542"></a>00542             stateRealLo = stateVecReal[indexLo];
<a name="l00543"></a>00543             stateImagLo = stateVecImag[indexLo];
<a name="l00544"></a>00544 
<a name="l00545"></a>00545 
<a name="l00546"></a>00546             <span class="comment">// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]</span>
<a name="l00547"></a>00547             stateVecReal[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp 
<a name="l00548"></a>00548                 + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo - u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;
<a name="l00549"></a>00549             stateVecImag[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp 
<a name="l00550"></a>00550                 + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;
<a name="l00551"></a>00551 
<a name="l00552"></a>00552             <span class="comment">// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]</span>
<a name="l00553"></a>00553             stateVecReal[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp  - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp 
<a name="l00554"></a>00554                 + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo  -  u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;
<a name="l00555"></a>00555             stateVecImag[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp 
<a name="l00556"></a>00556                 + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;
<a name="l00557"></a>00557 
<a name="l00558"></a>00558         } 
<a name="l00559"></a>00559     }
<a name="l00560"></a>00560 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae2b2c14a07dd7d50ff86032a3ca101d7"></a><!-- doxytag: member="QuEST_internal.h::validateAlphaBeta" ref="ae2b2c14a07dd7d50ff86032a3ca101d7" args="(Complex alpha, Complex beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int validateAlphaBeta </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l00370">370</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00024">Complex::real</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00028">REAL_EPS</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00095">compactUnitary()</a>, and <a class="el" href="QuEST__env__local_8c_source.html#l00113">controlledCompactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00370"></a>00370                                                   {
<a name="l00371"></a>00371     <span class="keywordflow">if</span> ( fabs(alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> 
<a name="l00372"></a>00372                 + alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00373"></a>00373                 + beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> 
<a name="l00374"></a>00374                 + beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> - 1) &gt; <a class="code" href="QuEST__precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;
<a name="l00375"></a>00375     <span class="keywordflow">else</span> <span class="keywordflow">return</span> 1;
<a name="l00376"></a>00376 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae4fea133d1a8f09ff8da03038100adb2"></a><!-- doxytag: member="QuEST_internal.h::validateMatrixIsUnitary" ref="ae4fea133d1a8f09ff8da03038100adb2" args="(ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int validateMatrixIsUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l00346">346</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00025">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00032">ComplexMatrix2::r0c0</a>, <a class="el" href="QuEST_8h_source.html#l00032">ComplexMatrix2::r0c1</a>, <a class="el" href="QuEST_8h_source.html#l00033">ComplexMatrix2::r1c0</a>, <a class="el" href="QuEST_8h_source.html#l00033">ComplexMatrix2::r1c1</a>, <a class="el" href="QuEST_8h_source.html#l00024">Complex::real</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00028">REAL_EPS</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00124">controlledUnitary()</a>, <a class="el" href="QuEST__env__local_8c_source.html#l00134">multiControlledUnitary()</a>, and <a class="el" href="QuEST__env__local_8c_source.html#l00104">unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00346"></a>00346                                              {
<a name="l00347"></a>00347 
<a name="l00348"></a>00348     <span class="keywordflow">if</span> ( fabs(u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> 
<a name="l00349"></a>00349                 + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00350"></a>00350                 + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>
<a name="l00351"></a>00351                 + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> - 1) &gt; <a class="code" href="QuEST__precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;
<a name="l00352"></a>00352     <span class="keywordflow">if</span> ( fabs(u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> 
<a name="l00353"></a>00353                 + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00354"></a>00354                 + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>
<a name="l00355"></a>00355                 + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> - 1) &gt; <a class="code" href="QuEST__precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;
<a name="l00356"></a>00356 
<a name="l00357"></a>00357     <span class="keywordflow">if</span> ( fabs(u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> 
<a name="l00358"></a>00358                 + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00359"></a>00359                 + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>
<a name="l00360"></a>00360                 + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>) &gt; <a class="code" href="QuEST__precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;
<a name="l00361"></a>00361 
<a name="l00362"></a>00362     <span class="keywordflow">if</span> ( fabs(u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00363"></a>00363                 - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00364"></a>00364                 + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00365"></a>00365                 - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>) &gt; <a class="code" href="QuEST__precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;
<a name="l00366"></a>00366 
<a name="l00367"></a>00367     <span class="keywordflow">return</span> 1;
<a name="l00368"></a>00368 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a71c14976f63cfcda70026fa20ee531fe"></a><!-- doxytag: member="QuEST_internal.h::validateUnitVector" ref="a71c14976f63cfcda70026fa20ee531fe" args="(REAL ux, REAL uy, REAL uz)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int validateUnitVector </td>
          <td>(</td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>ux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>uy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>uz</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l00378">378</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>References <a class="el" href="QuEST__precision_8h_source.html#l00028">REAL_EPS</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00378"></a>00378                                                  {
<a name="l00379"></a>00379     <span class="keywordflow">if</span> ( fabs(sqrt(ux*ux + uy*uy + uz*uz) - 1) &gt; <a class="code" href="QuEST__precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;
<a name="l00380"></a>00380     <span class="keywordflow">else</span> <span class="keywordflow">return</span> 1;
<a name="l00381"></a>00381 }
</pre></div></p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="aac1637696885c75b73a1ecf381cea713"></a><!-- doxytag: member="QuEST_internal.h::errorCodes" ref="aac1637696885c75b73a1ecf381cea713" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="QuEST__internal_8h.html#aac1637696885c75b73a1ecf381cea713">errorCodes</a>[]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST_8c_source.html#l00029">29</a> of file <a class="el" href="QuEST_8c_source.html">QuEST.c</a>.</p>

<p>Referenced by <a class="el" href="QuEST__env__local_8c_source.html#l00229">exitWithError()</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 2 May 2018 for Distributed QuEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
