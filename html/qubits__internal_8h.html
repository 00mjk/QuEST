<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Distributed QuEST: qubits_internal.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>qubits_internal.h File Reference</h1>
<p>Internal functions used to implement the public facing API in <a class="el" href="qubits_8h.html" title="The QuEST library API and objects.">qubits.h</a>.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="precision_8h_source.html">precision.h</a>&quot;</code><br/>

<p><a href="qubits__internal_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#a9cee2d8716667a3318420a3b672f5b92">compactUnitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#a20ee1878a63ae6112e8845f4a8787592">compactUnitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta, and a subset of the state vector with upper and lower block values stored seperately.  <a href="#a20ee1878a63ae6112e8845f4a8787592"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#ac134fb45b0a7248c5d15e16eb7139a35">unitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#a2343b7240118e89aa615e2c9140b770b">unitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a unitary operation to a single qubit given a subset of the state vector with upper and lower block values stored seperately.  <a href="#a2343b7240118e89aa615e2c9140b770b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#afc77657651d52c47403b44b923a098a8">controlledCompactUnitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#a717855e835e3161e08c18cdc15325d27">controlledCompactUnitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately.  <a href="#a717855e835e3161e08c18cdc15325d27"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#a8a4afcff70195a306c082b8ed8d4e09a">controlledUnitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#a642093063a1f889f61a1311f6d6f2d3f">controlledUnitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately.  <a href="#a642093063a1f889f61a1311f6d6f2d3f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#a1309eabcba3cb97fbc3cd2e606d17766">multiControlledUnitaryLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, long long int mask, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#a9dbf856ebeea0cf0a3ee5aae6782f2d2">multiControlledUnitaryDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, long long int mask, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a unitary operation to a single qubit in the state vector of probability amplitudes, given a subset of the state vector with upper and lower block values stored seperately.  <a href="#a9dbf856ebeea0cf0a3ee5aae6782f2d2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#a74822fd86bb5d81766e6e8dbdcd62df1">sigmaXLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#a2275fff50824fe47485890ff5a857785">sigmaXDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecIn, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{0,1},{1,0}.  <a href="#a2275fff50824fe47485890ff5a857785"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#a81fbfaed65a742a7dfd622e17652245e">sigmaYLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#af5ef5166f00c0572354b4ac53dcf40cf">sigmaYDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecIn, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut, int updateUpper)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{0,-i},{i,0}.  <a href="#af5ef5166f00c0572354b4ac53dcf40cf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#aa9f0718b4dd794a3e1b143e3b153bfc5">hadamardLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#ae6a897066979fc52d977007d959ca09d">hadamardDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut, int updateUpper)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{1,1},{1,-1}}/sqrt2.  <a href="#ae6a897066979fc52d977007d959ca09d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#a3a54566b73ac84c312d7da4f56ffbc3b">phaseGateLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, enum <a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a> type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#af832ed00b02a0597b7fe0b714032c54a">phaseGateDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, enum <a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a> type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#ad357a43e80e3baf013975b1b70942f4c">controlledNotLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#a05875a70b539a3efb28d027823403f34">controlledNotDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecIn, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{0,1},{1,0}.  <a href="#a05875a70b539a3efb28d027823403f34"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#a7c02cd0e1b4eac19771a0525f023249e">findProbabilityOfZeroLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Measure the total probability of a specified qubit being in the zero state across all amplitudes in this chunk.  <a href="#a7c02cd0e1b4eac19771a0525f023249e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#a9ac9bb717a889f09d307eda9f0b65957">findProbabilityOfZeroDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Measure the probability of a specified qubit being in the zero state across all amplitudes held in this chunk.  <a href="#a9ac9bb717a889f09d307eda9f0b65957"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#a01d9a8b7ff0e09ec399e158389783aa9">collapseToOutcomeLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, int measureQubit, REAL totalProbability, int outcome)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update the state vector to be consistent with measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1.  <a href="#a01d9a8b7ff0e09ec399e158389783aa9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#a7a1f63ec3c42d9ad72f1f01c14a885db">collapseToOutcomeDistributedRenorm</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit, const REAL totalProbability)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Renormalise parts of the state vector where measureQubit=0 or 1, based on the total probability of that qubit being in state 0 or 1.  <a href="#a7a1f63ec3c42d9ad72f1f01c14a885db"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#a78908fe8e75a21fd4f7fa7dff05d6be1">collapseToOutcomeDistributedSetZero</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set all amplitudes in one chunk to 0.  <a href="#a78908fe8e75a21fd4f7fa7dff05d6be1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#ae4fea133d1a8f09ff8da03038100adb2">validateMatrixIsUnitary</a> (<a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#ae2b2c14a07dd7d50ff86032a3ca101d7">validateAlphaBeta</a> (<a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#a71c14976f63cfcda70026fa20ee531fe">validateUnitVector</a> (REAL ux, REAL uy, REAL uz)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#aae7a8a7f1ccbddb7f76b6c52b746bb43">phaseGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, enum <a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a> type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#ae5f9019826f35e8b51b1716cfe397b45">exitWithError</a> (int errorCode, const char *func)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a> (int isValid, int errorCode, const char *func)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__internal_8h.html#aac1637696885c75b73a1ecf381cea713">errorCodes</a> []</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Internal functions used to implement the public facing API in <a class="el" href="qubits_8h.html" title="The QuEST library API and objects.">qubits.h</a>. </p>
<p>Do not call these functions directly. In general, <a class="el" href="qubits__env__local_8c.html" title="An implementation of the API in qubits.h for a local (non-MPI) environment.">qubits_env_local.c</a> and <a class="el" href="qubits__env__mpi_8c.html" title="An implementation of the API in qubits.h for an MPI environment.">qubits_env_mpi.c</a> will implement the public API by choosing the correct function or combination of functions to use from those included here. </p>

<p>Definition in file <a class="el" href="qubits__internal_8h_source.html">qubits_internal.h</a>.</p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a7a1f63ec3c42d9ad72f1f01c14a885db"></a><!-- doxytag: member="qubits_internal.h::collapseToOutcomeDistributedRenorm" ref="a7a1f63ec3c42d9ad72f1f01c14a885db" args="(MultiQubit multiQubit, const int measureQubit, const REAL totalProbability)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL collapseToOutcomeDistributedRenorm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>totalProbability</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Renormalise parts of the state vector where measureQubit=0 or 1, based on the total probability of that qubit being in state 0 or 1. </p>
<p>Measure in Zero performs an irreversible change to the state vector: it updates the vector according to the event that the value 'outcome' has been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1. In the distributed version, one block (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) is spread over multiple chunks, meaning that each chunks performs only renormalisation or only setting amplitudes to 0. This function handles the renormalisation.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>totalProbability</em>&nbsp;</td><td>probability of qubit measureQubit being zero </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01871">1871</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00691">collapseToOutcome()</a>, and <a class="el" href="qubits__env__mpi_8c_source.html#l00724">measureWithStats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01872"></a>01872 {
<a name="l01873"></a>01873         <span class="comment">// ----- temp variables</span>
<a name="l01874"></a>01874         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span>
<a name="l01875"></a>01875         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01876"></a>01876         <span class="comment">// (good for shared memory parallelism)</span>
<a name="l01877"></a>01877 
<a name="l01878"></a>01878         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> renorm=1/sqrt(totalProbability);
<a name="l01879"></a>01879         
<a name="l01880"></a>01880         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01881"></a>01881         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01882"></a>01882 
<a name="l01883"></a>01883 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01884"></a>01884 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01885"></a>01885 <span class="preprocessor">        shared    (numTasks,stateVecReal,stateVecImag) \</span>
<a name="l01886"></a>01886 <span class="preprocessor">        private   (thisTask)</span>
<a name="l01887"></a>01887 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01888"></a>01888 <span class="preprocessor"></span>        {
<a name="l01889"></a>01889 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01890"></a>01890 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule  (static)</span>
<a name="l01891"></a>01891 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01892"></a>01892 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01893"></a>01893                         <span class="comment">// summation -- simple implementation</span>
<a name="l01894"></a>01894                         stateVecReal[thisTask] = stateVecReal[thisTask]*renorm;
<a name="l01895"></a>01895                         stateVecImag[thisTask] = stateVecImag[thisTask]*renorm;
<a name="l01896"></a>01896                 }
<a name="l01897"></a>01897         }
<a name="l01898"></a>01898         <span class="keywordflow">return</span> totalProbability;
<a name="l01899"></a>01899 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a78908fe8e75a21fd4f7fa7dff05d6be1"></a><!-- doxytag: member="qubits_internal.h::collapseToOutcomeDistributedSetZero" ref="a78908fe8e75a21fd4f7fa7dff05d6be1" args="(MultiQubit multiQubit, const int measureQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void collapseToOutcomeDistributedSetZero </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set all amplitudes in one chunk to 0. </p>
<p>Measure in Zero performs an irreversible change to the state vector: it updates the vector according to the event that a zero have been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 or 1. In the distributed version, one block (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) is spread over multiple chunks, meaning that each chunks performs only renormalisation or only setting amplitudes to 0. This function handles setting amplitudes to 0.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01913">1913</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00691">collapseToOutcome()</a>, and <a class="el" href="qubits__env__mpi_8c_source.html#l00724">measureWithStats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01914"></a>01914 {
<a name="l01915"></a>01915         <span class="comment">// ----- temp variables</span>
<a name="l01916"></a>01916         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span>
<a name="l01917"></a>01917         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01918"></a>01918         <span class="comment">// (good for shared memory parallelism)</span>
<a name="l01919"></a>01919 
<a name="l01920"></a>01920         <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01921"></a>01921         <span class="comment">//            find probability                                      //</span>
<a name="l01922"></a>01922         <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01923"></a>01923 
<a name="l01924"></a>01924         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01925"></a>01925         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01926"></a>01926 
<a name="l01927"></a>01927 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01928"></a>01928 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01929"></a>01929 <span class="preprocessor">        shared    (numTasks,stateVecReal,stateVecImag) \</span>
<a name="l01930"></a>01930 <span class="preprocessor">        private   (thisTask)</span>
<a name="l01931"></a>01931 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01932"></a>01932 <span class="preprocessor"></span>        {
<a name="l01933"></a>01933 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01934"></a>01934 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule  (static)</span>
<a name="l01935"></a>01935 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01936"></a>01936 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01937"></a>01937                         <span class="comment">// summation -- simple implementation</span>
<a name="l01938"></a>01938                         stateVecReal[thisTask] = 0;
<a name="l01939"></a>01939                         stateVecImag[thisTask] = 0;
<a name="l01940"></a>01940                 }
<a name="l01941"></a>01941         }
<a name="l01942"></a>01942 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a01d9a8b7ff0e09ec399e158389783aa9"></a><!-- doxytag: member="qubits_internal.h::collapseToOutcomeLocal" ref="a01d9a8b7ff0e09ec399e158389783aa9" args="(MultiQubit multiQubit, int measureQubit, REAL totalProbability, int outcome)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void collapseToOutcomeLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>totalProbability</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outcome</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Update the state vector to be consistent with measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1. </p>
<p>Performs an irreversible change to the state vector: it updates the vector according to the event that an outcome have been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 or 1 according to the value of outcome. In the local version, one or more blocks (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) fit entirely into one chunk.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>totalProbability</em>&nbsp;</td><td>probability of qubit measureQubit being either zero or one </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>outcome</em>&nbsp;</td><td>to measure the probability of and set the state to -- either zero or one </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01789">1789</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00195">collapseToOutcome()</a>, and <a class="el" href="qubits__env__local_8c_source.html#l00211">measureWithStats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01790"></a>01790 {
<a name="l01791"></a>01791         <span class="comment">// ----- sizes</span>
<a name="l01792"></a>01792         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock,                                           <span class="comment">// size of blocks</span>
<a name="l01793"></a>01793         sizeHalfBlock;                                       <span class="comment">// size of blocks halved</span>
<a name="l01794"></a>01794         <span class="comment">// ----- indices</span>
<a name="l01795"></a>01795         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock,                                           <span class="comment">// current block</span>
<a name="l01796"></a>01796              index;                                               <span class="comment">// current index for first half block</span>
<a name="l01797"></a>01797         <span class="comment">// ----- measured probability</span>
<a name="l01798"></a>01798         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   renorm;                                    <span class="comment">// probability (returned) value</span>
<a name="l01799"></a>01799         <span class="comment">// ----- temp variables</span>
<a name="l01800"></a>01800         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span>
<a name="l01801"></a>01801         <span class="comment">// (good for shared memory parallelism)</span>
<a name="l01802"></a>01802         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01803"></a>01803 
<a name="l01804"></a>01804         <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01805"></a>01805         <span class="comment">//            dimensions                                            //</span>
<a name="l01806"></a>01806         <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01807"></a>01807         sizeHalfBlock = 1LL &lt;&lt; (measureQubit);                       <span class="comment">// number of state vector elements to sum,</span>
<a name="l01808"></a>01808         <span class="comment">// and then the number to skip</span>
<a name="l01809"></a>01809         sizeBlock     = 2LL * sizeHalfBlock;                           <span class="comment">// size of blocks (pairs of measure and skip entries)</span>
<a name="l01810"></a>01810         
<a name="l01811"></a>01811         renorm=1/sqrt(totalProbability);
<a name="l01812"></a>01812         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01813"></a>01813         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01814"></a>01814 
<a name="l01815"></a>01815 
<a name="l01816"></a>01816 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01817"></a>01817 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01818"></a>01818 <span class="preprocessor">        default (none) \</span>
<a name="l01819"></a>01819 <span class="preprocessor">        shared    (numTasks,sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag,renorm,outcome) \</span>
<a name="l01820"></a>01820 <span class="preprocessor">        private   (thisTask,thisBlock,index)</span>
<a name="l01821"></a>01821 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01822"></a>01822 <span class="preprocessor"></span>        {
<a name="l01823"></a>01823                 <span class="keywordflow">if</span> (outcome==0){
<a name="l01824"></a>01824                         <span class="comment">// measure qubit is 0</span>
<a name="l01825"></a>01825 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01826"></a>01826 <span class="preprocessor"></span><span class="preprocessor">                        # pragma omp for schedule  (static)</span>
<a name="l01827"></a>01827 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01828"></a>01828 <span class="preprocessor"></span>                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01829"></a>01829                                 thisBlock = thisTask / sizeHalfBlock;
<a name="l01830"></a>01830                                 index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01831"></a>01831                                 stateVecReal[index]=stateVecReal[index]*renorm;
<a name="l01832"></a>01832                                 stateVecImag[index]=stateVecImag[index]*renorm;
<a name="l01833"></a>01833 
<a name="l01834"></a>01834                                 stateVecReal[index+sizeHalfBlock]=0;
<a name="l01835"></a>01835                                 stateVecImag[index+sizeHalfBlock]=0;
<a name="l01836"></a>01836                         }
<a name="l01837"></a>01837                 } <span class="keywordflow">else</span> {
<a name="l01838"></a>01838                         <span class="comment">// measure qubit is 1</span>
<a name="l01839"></a>01839 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01840"></a>01840 <span class="preprocessor"></span><span class="preprocessor">                        # pragma omp for schedule  (static)</span>
<a name="l01841"></a>01841 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01842"></a>01842 <span class="preprocessor"></span>                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01843"></a>01843                                 thisBlock = thisTask / sizeHalfBlock;
<a name="l01844"></a>01844                                 index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01845"></a>01845                                 stateVecReal[index]=0;
<a name="l01846"></a>01846                                 stateVecImag[index]=0;
<a name="l01847"></a>01847 
<a name="l01848"></a>01848                                 stateVecReal[index+sizeHalfBlock]=stateVecReal[index+sizeHalfBlock]*renorm;
<a name="l01849"></a>01849                                 stateVecImag[index+sizeHalfBlock]=stateVecImag[index+sizeHalfBlock]*renorm;
<a name="l01850"></a>01850                         }
<a name="l01851"></a>01851                 }
<a name="l01852"></a>01852         }
<a name="l01853"></a>01853 
<a name="l01854"></a>01854 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a20ee1878a63ae6112e8845f4a8787592"></a><!-- doxytag: member="qubits_internal.h::compactUnitaryDistributed" ref="a20ee1878a63ae6112e8845f4a8787592" args="(MultiQubit multiQubit, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compactUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta, and a subset of the state vector with upper and lower block values stored seperately. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot1</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot2</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00546">546</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, and <a class="el" href="precision_8h_source.html#l00023">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00285">compactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00551"></a>00551 {
<a name="l00552"></a>00552 
<a name="l00553"></a>00553         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00554"></a>00554         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l00555"></a>00555         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00556"></a>00556 
<a name="l00557"></a>00557         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00558"></a>00558         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00559"></a>00559         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00560"></a>00560         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00561"></a>00561         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00562"></a>00562 
<a name="l00563"></a>00563 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00564"></a>00564 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00565"></a>00565 <span class="preprocessor">        default  (none) \</span>
<a name="l00566"></a>00566 <span class="preprocessor">        shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l00567"></a>00567 <span class="preprocessor">                        rot1Real,rot1Imag, rot2Real,rot2Imag) \</span>
<a name="l00568"></a>00568 <span class="preprocessor">        private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span>
<a name="l00569"></a>00569 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00570"></a>00570 <span class="preprocessor"></span>        {
<a name="l00571"></a>00571 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00572"></a>00572 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00573"></a>00573 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00574"></a>00574 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00575"></a>00575                         <span class="comment">// store current state vector values in temp variables</span>
<a name="l00576"></a>00576                         stateRealUp = stateVecRealUp[thisTask];
<a name="l00577"></a>00577                         stateImagUp = stateVecImagUp[thisTask];
<a name="l00578"></a>00578 
<a name="l00579"></a>00579                         stateRealLo = stateVecRealLo[thisTask];
<a name="l00580"></a>00580                         stateImagLo = stateVecImagLo[thisTask];
<a name="l00581"></a>00581 
<a name="l00582"></a>00582                         <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span>
<a name="l00583"></a>00583                         stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp + rot2Real*stateRealLo + rot2Imag*stateImagLo;
<a name="l00584"></a>00584                         stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp + rot2Real*stateImagLo - rot2Imag*stateRealLo;
<a name="l00585"></a>00585                 }
<a name="l00586"></a>00586         }
<a name="l00587"></a>00587 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9cee2d8716667a3318420a3b672f5b92"></a><!-- doxytag: member="qubits_internal.h::compactUnitaryLocal" ref="a9cee2d8716667a3318420a3b672f5b92" args="(MultiQubit multiQubit, const int targetQubit, Complex alpha, Complex beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compactUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00417">417</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00101">compactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00418"></a>00418 {
<a name="l00419"></a>00419         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l00420"></a>00420         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l00421"></a>00421              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l00422"></a>00422 
<a name="l00423"></a>00423         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00424"></a>00424         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l00425"></a>00425         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l00426"></a>00426 
<a name="l00427"></a>00427         <span class="comment">// set dimensions</span>
<a name="l00428"></a>00428         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l00429"></a>00429         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l00430"></a>00430 
<a name="l00431"></a>00431         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l00432"></a>00432         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00433"></a>00433         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00434"></a>00434         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> alphaImag=alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>, alphaReal=alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;
<a name="l00435"></a>00435         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> betaImag=beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>, betaReal=beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;
<a name="l00436"></a>00436 
<a name="l00437"></a>00437 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00438"></a>00438 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00439"></a>00439 <span class="preprocessor">        default  (none) \</span>
<a name="l00440"></a>00440 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, alphaReal,alphaImag, betaReal,betaImag) \</span>
<a name="l00441"></a>00441 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span>
<a name="l00442"></a>00442 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00443"></a>00443 <span class="preprocessor"></span>        {
<a name="l00444"></a>00444 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00445"></a>00445 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00446"></a>00446 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00447"></a>00447 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00448"></a>00448 
<a name="l00449"></a>00449                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l00450"></a>00450                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l00451"></a>00451                         indexLo     = indexUp + sizeHalfBlock;
<a name="l00452"></a>00452 
<a name="l00453"></a>00453                         <span class="comment">// store current state vector values in temp variables</span>
<a name="l00454"></a>00454                         stateRealUp = stateVecReal[indexUp];
<a name="l00455"></a>00455                         stateImagUp = stateVecImag[indexUp];
<a name="l00456"></a>00456 
<a name="l00457"></a>00457                         stateRealLo = stateVecReal[indexLo];
<a name="l00458"></a>00458                         stateImagLo = stateVecImag[indexLo];
<a name="l00459"></a>00459 
<a name="l00460"></a>00460                         <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span>
<a name="l00461"></a>00461                         stateVecReal[indexUp] = alphaReal*stateRealUp - alphaImag*stateImagUp 
<a name="l00462"></a>00462                                 - betaReal*stateRealLo - betaImag*stateImagLo;
<a name="l00463"></a>00463                         stateVecImag[indexUp] = alphaReal*stateImagUp + alphaImag*stateRealUp 
<a name="l00464"></a>00464                                 - betaReal*stateImagLo + betaImag*stateRealLo;
<a name="l00465"></a>00465 
<a name="l00466"></a>00466                         <span class="comment">// state[indexLo] = beta  * state[indexUp] + conj(alpha) * state[indexLo]</span>
<a name="l00467"></a>00467                         stateVecReal[indexLo] = betaReal*stateRealUp - betaImag*stateImagUp 
<a name="l00468"></a>00468                                 + alphaReal*stateRealLo + alphaImag*stateImagLo;
<a name="l00469"></a>00469                         stateVecImag[indexLo] = betaReal*stateImagUp + betaImag*stateRealUp 
<a name="l00470"></a>00470                                 + alphaReal*stateImagLo - alphaImag*stateRealLo;
<a name="l00471"></a>00471                 } 
<a name="l00472"></a>00472         }
<a name="l00473"></a>00473 
<a name="l00474"></a>00474 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a717855e835e3161e08c18cdc15325d27"></a><!-- doxytag: member="qubits_internal.h::controlledCompactUnitaryDistributed" ref="a717855e835e3161e08c18cdc15325d27" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledCompactUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately. </p>
<p>Only perform the rotation where the control qubit is one.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>qubit to determine whether or not to perform a rotation </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot1</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot2</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00856">856</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00055">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01697">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, and <a class="el" href="precision_8h_source.html#l00023">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00367">controlledCompactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00861"></a>00861 {
<a name="l00862"></a>00862 
<a name="l00863"></a>00863         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00864"></a>00864         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l00865"></a>00865         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00866"></a>00866         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00867"></a>00867         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l00868"></a>00868 
<a name="l00869"></a>00869         <span class="keywordtype">int</span> controlBit;
<a name="l00870"></a>00870 
<a name="l00871"></a>00871     <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00872"></a>00872         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00873"></a>00873         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00874"></a>00874         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00875"></a>00875         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00876"></a>00876 
<a name="l00877"></a>00877 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00878"></a>00878 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00879"></a>00879 <span class="preprocessor">        default  (none) \</span>
<a name="l00880"></a>00880 <span class="preprocessor">        shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l00881"></a>00881 <span class="preprocessor">                        rot1Real,rot1Imag, rot2Real,rot2Imag) \</span>
<a name="l00882"></a>00882 <span class="preprocessor">        private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit)</span>
<a name="l00883"></a>00883 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00884"></a>00884 <span class="preprocessor"></span>        {
<a name="l00885"></a>00885 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00886"></a>00886 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00887"></a>00887 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00888"></a>00888 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00889"></a>00889                         controlBit = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);
<a name="l00890"></a>00890                         <span class="keywordflow">if</span> (controlBit){
<a name="l00891"></a>00891                                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l00892"></a>00892                                 stateRealUp = stateVecRealUp[thisTask];
<a name="l00893"></a>00893                                 stateImagUp = stateVecImagUp[thisTask];
<a name="l00894"></a>00894 
<a name="l00895"></a>00895                                 stateRealLo = stateVecRealLo[thisTask];
<a name="l00896"></a>00896                                 stateImagLo = stateVecImagLo[thisTask];
<a name="l00897"></a>00897 
<a name="l00898"></a>00898                                 <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span>
<a name="l00899"></a>00899                                 stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp + rot2Real*stateRealLo + rot2Imag*stateImagLo;
<a name="l00900"></a>00900                                 stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp + rot2Real*stateImagLo - rot2Imag*stateRealLo;
<a name="l00901"></a>00901                         }
<a name="l00902"></a>00902                 }
<a name="l00903"></a>00903         }
<a name="l00904"></a>00904 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="afc77657651d52c47403b44b923a098a8"></a><!-- doxytag: member="qubits_internal.h::controlledCompactUnitaryLocal" ref="afc77657651d52c47403b44b923a098a8" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, Complex alpha, Complex beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledCompactUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00647">647</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00055">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01697">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00119">controlledCompactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00649"></a>00649 {
<a name="l00650"></a>00650         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l00651"></a>00651         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l00652"></a>00652              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l00653"></a>00653 
<a name="l00654"></a>00654         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00655"></a>00655         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l00656"></a>00656         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l00657"></a>00657         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00658"></a>00658         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l00659"></a>00659 
<a name="l00660"></a>00660         <span class="keywordtype">int</span> controlBit;
<a name="l00661"></a>00661 
<a name="l00662"></a>00662     <span class="comment">// set dimensions</span>
<a name="l00663"></a>00663         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l00664"></a>00664         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l00665"></a>00665 
<a name="l00666"></a>00666         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l00667"></a>00667         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00668"></a>00668         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00669"></a>00669         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> alphaImag=alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>, alphaReal=alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;
<a name="l00670"></a>00670         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> betaImag=beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>, betaReal=beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;
<a name="l00671"></a>00671 
<a name="l00672"></a>00672 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00673"></a>00673 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00674"></a>00674 <span class="preprocessor">        default  (none) \</span>
<a name="l00675"></a>00675 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, alphaReal,alphaImag, betaReal,betaImag) \</span>
<a name="l00676"></a>00676 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit) </span>
<a name="l00677"></a>00677 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00678"></a>00678 <span class="preprocessor"></span>        {
<a name="l00679"></a>00679 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00680"></a>00680 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00681"></a>00681 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00682"></a>00682 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00683"></a>00683 
<a name="l00684"></a>00684                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l00685"></a>00685                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l00686"></a>00686                         indexLo     = indexUp + sizeHalfBlock;
<a name="l00687"></a>00687 
<a name="l00688"></a>00688                         controlBit = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, indexUp+chunkId*chunkSize);
<a name="l00689"></a>00689                         <span class="keywordflow">if</span> (controlBit){
<a name="l00690"></a>00690                                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l00691"></a>00691                                 stateRealUp = stateVecReal[indexUp];
<a name="l00692"></a>00692                                 stateImagUp = stateVecImag[indexUp];
<a name="l00693"></a>00693 
<a name="l00694"></a>00694                                 stateRealLo = stateVecReal[indexLo];
<a name="l00695"></a>00695                                 stateImagLo = stateVecImag[indexLo];
<a name="l00696"></a>00696 
<a name="l00697"></a>00697                                 <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span>
<a name="l00698"></a>00698                                 stateVecReal[indexUp] = alphaReal*stateRealUp - alphaImag*stateImagUp 
<a name="l00699"></a>00699                                         - betaReal*stateRealLo - betaImag*stateImagLo;
<a name="l00700"></a>00700                                 stateVecImag[indexUp] = alphaReal*stateImagUp + alphaImag*stateRealUp 
<a name="l00701"></a>00701                                         - betaReal*stateImagLo + betaImag*stateRealLo;
<a name="l00702"></a>00702 
<a name="l00703"></a>00703                                 <span class="comment">// state[indexLo] = beta  * state[indexUp] + conj(alpha) * state[indexLo]</span>
<a name="l00704"></a>00704                                 stateVecReal[indexLo] = betaReal*stateRealUp - betaImag*stateImagUp 
<a name="l00705"></a>00705                                         + alphaReal*stateRealLo + alphaImag*stateImagLo;
<a name="l00706"></a>00706                                 stateVecImag[indexLo] = betaReal*stateImagUp + betaImag*stateRealUp 
<a name="l00707"></a>00707                                         + alphaReal*stateImagLo - alphaImag*stateRealLo;
<a name="l00708"></a>00708                         }
<a name="l00709"></a>00709                 } 
<a name="l00710"></a>00710         }
<a name="l00711"></a>00711 
<a name="l00712"></a>00712 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a05875a70b539a3efb28d027823403f34"></a><!-- doxytag: member="qubits_internal.h::controlledNotDistributed" ref="a05875a70b539a3efb28d027823403f34" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledNotDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{0,1},{1,0}. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk. Only perform the rotation for elements where controlQubit is one.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecIn</em>&nbsp;</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01185">1185</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00055">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01697">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, and <a class="el" href="precision_8h_source.html#l00023">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00529">controlledNot()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01188"></a>01188 {
<a name="l01189"></a>01189 
<a name="l01190"></a>01190         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01191"></a>01191         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01192"></a>01192         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01193"></a>01193         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01194"></a>01194 
<a name="l01195"></a>01195         <span class="keywordtype">int</span> controlBit;
<a name="l01196"></a>01196 
<a name="l01197"></a>01197         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealIn=stateVecIn.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagIn=stateVecIn.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01198"></a>01198         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01199"></a>01199 
<a name="l01200"></a>01200 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01201"></a>01201 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01202"></a>01202 <span class="preprocessor">        default  (none) \</span>
<a name="l01203"></a>01203 <span class="preprocessor">        shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut) \</span>
<a name="l01204"></a>01204 <span class="preprocessor">        private  (thisTask,controlBit)</span>
<a name="l01205"></a>01205 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01206"></a>01206 <span class="preprocessor"></span>        {
<a name="l01207"></a>01207 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01208"></a>01208 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01209"></a>01209 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01210"></a>01210 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01211"></a>01211                         controlBit = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);
<a name="l01212"></a>01212                         <span class="keywordflow">if</span> (controlBit){
<a name="l01213"></a>01213                                 stateVecRealOut[thisTask] = stateVecRealIn[thisTask];
<a name="l01214"></a>01214                                 stateVecImagOut[thisTask] = stateVecImagIn[thisTask];
<a name="l01215"></a>01215                         }
<a name="l01216"></a>01216                 }
<a name="l01217"></a>01217         }
<a name="l01218"></a>01218 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad357a43e80e3baf013975b1b70942f4c"></a><!-- doxytag: member="qubits_internal.h::controlledNotLocal" ref="ad357a43e80e3baf013975b1b70942f4c" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledNotLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01120">1120</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00055">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01697">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00178">controlledNot()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01121"></a>01121 {
<a name="l01122"></a>01122         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01123"></a>01123         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01124"></a>01124              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01125"></a>01125 
<a name="l01126"></a>01126         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateImagUp;
<a name="l01127"></a>01127         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01128"></a>01128         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01129"></a>01129         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01130"></a>01130         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01131"></a>01131 
<a name="l01132"></a>01132         <span class="keywordtype">int</span> controlBit;
<a name="l01133"></a>01133 
<a name="l01134"></a>01134         <span class="comment">// set dimensions</span>
<a name="l01135"></a>01135         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01136"></a>01136         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01137"></a>01137 
<a name="l01138"></a>01138 
<a name="l01139"></a>01139         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l01140"></a>01140         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01141"></a>01141         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01142"></a>01142 
<a name="l01143"></a>01143 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01144"></a>01144 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01145"></a>01145 <span class="preprocessor">        default  (none) \</span>
<a name="l01146"></a>01146 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span>
<a name="l01147"></a>01147 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,controlBit) </span>
<a name="l01148"></a>01148 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01149"></a>01149 <span class="preprocessor"></span>        {
<a name="l01150"></a>01150 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01151"></a>01151 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01152"></a>01152 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01153"></a>01153 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01154"></a>01154                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l01155"></a>01155                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01156"></a>01156                         indexLo     = indexUp + sizeHalfBlock;
<a name="l01157"></a>01157 
<a name="l01158"></a>01158                         controlBit = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a>(controlQubit, indexUp+chunkId*chunkSize);
<a name="l01159"></a>01159                         <span class="keywordflow">if</span> (controlBit){
<a name="l01160"></a>01160                                 stateRealUp = stateVecReal[indexUp];
<a name="l01161"></a>01161                                 stateImagUp = stateVecImag[indexUp];
<a name="l01162"></a>01162 
<a name="l01163"></a>01163                                 stateVecReal[indexUp] = stateVecReal[indexLo];
<a name="l01164"></a>01164                                 stateVecImag[indexUp] = stateVecImag[indexLo];
<a name="l01165"></a>01165 
<a name="l01166"></a>01166                                 stateVecReal[indexLo] = stateRealUp;
<a name="l01167"></a>01167                                 stateVecImag[indexLo] = stateImagUp;
<a name="l01168"></a>01168                         }
<a name="l01169"></a>01169                 } 
<a name="l01170"></a>01170         }
<a name="l01171"></a>01171 
<a name="l01172"></a>01172 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a642093063a1f889f61a1311f6d6f2d3f"></a><!-- doxytag: member="qubits_internal.h::controlledUnitaryDistributed" ref="a642093063a1f889f61a1311f6d6f2d3f" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately. </p>
<p>Only perform the rotation where the control qubit is one.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>qubit to determine whether or not to perform a rotation </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot1</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot2</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00919">919</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00055">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01697">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, and <a class="el" href="precision_8h_source.html#l00023">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00410">controlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00924"></a>00924 {
<a name="l00925"></a>00925 
<a name="l00926"></a>00926         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00927"></a>00927         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l00928"></a>00928         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00929"></a>00929         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00930"></a>00930         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l00931"></a>00931 
<a name="l00932"></a>00932         <span class="keywordtype">int</span> controlBit;
<a name="l00933"></a>00933 
<a name="l00934"></a>00934         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00935"></a>00935         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00936"></a>00936         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00937"></a>00937         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00938"></a>00938         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00939"></a>00939 
<a name="l00940"></a>00940 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00941"></a>00941 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00942"></a>00942 <span class="preprocessor">        default  (none) \</span>
<a name="l00943"></a>00943 <span class="preprocessor">        shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l00944"></a>00944 <span class="preprocessor">                        rot1Real,rot1Imag, rot2Real,rot2Imag) \</span>
<a name="l00945"></a>00945 <span class="preprocessor">        private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit)</span>
<a name="l00946"></a>00946 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00947"></a>00947 <span class="preprocessor"></span>        {
<a name="l00948"></a>00948 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00949"></a>00949 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00950"></a>00950 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00951"></a>00951 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00952"></a>00952                         controlBit = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);
<a name="l00953"></a>00953                         <span class="keywordflow">if</span> (controlBit){
<a name="l00954"></a>00954                                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l00955"></a>00955                                 stateRealUp = stateVecRealUp[thisTask];
<a name="l00956"></a>00956                                 stateImagUp = stateVecImagUp[thisTask];
<a name="l00957"></a>00957 
<a name="l00958"></a>00958                                 stateRealLo = stateVecRealLo[thisTask];
<a name="l00959"></a>00959                                 stateImagLo = stateVecImagLo[thisTask];
<a name="l00960"></a>00960 
<a name="l00961"></a>00961                 stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp 
<a name="l00962"></a>00962                     + rot2Real*stateRealLo - rot2Imag*stateImagLo;
<a name="l00963"></a>00963                 stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp 
<a name="l00964"></a>00964                     + rot2Real*stateImagLo + rot2Imag*stateRealLo;
<a name="l00965"></a>00965                         }
<a name="l00966"></a>00966                 }
<a name="l00967"></a>00967         }
<a name="l00968"></a>00968 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8a4afcff70195a306c082b8ed8d4e09a"></a><!-- doxytag: member="qubits_internal.h::controlledUnitaryLocal" ref="a8a4afcff70195a306c082b8ed8d4e09a" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00777">777</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00055">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01697">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00029">ComplexMatrix2::r0c0</a>, <a class="el" href="qubits_8h_source.html#l00029">ComplexMatrix2::r0c1</a>, <a class="el" href="qubits_8h_source.html#l00030">ComplexMatrix2::r1c0</a>, <a class="el" href="qubits_8h_source.html#l00030">ComplexMatrix2::r1c1</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00130">controlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00779"></a>00779 {
<a name="l00780"></a>00780         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l00781"></a>00781         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l00782"></a>00782              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l00783"></a>00783 
<a name="l00784"></a>00784         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00785"></a>00785         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l00786"></a>00786         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l00787"></a>00787         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00788"></a>00788         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l00789"></a>00789 
<a name="l00790"></a>00790         <span class="keywordtype">int</span> controlBit;
<a name="l00791"></a>00791 
<a name="l00792"></a>00792     <span class="comment">// set dimensions</span>
<a name="l00793"></a>00793         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l00794"></a>00794         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l00795"></a>00795 
<a name="l00796"></a>00796         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l00797"></a>00797         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00798"></a>00798         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00799"></a>00799 
<a name="l00800"></a>00800 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00801"></a>00801 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00802"></a>00802 <span class="preprocessor">        default  (none) \</span>
<a name="l00803"></a>00803 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, u) \</span>
<a name="l00804"></a>00804 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit) </span>
<a name="l00805"></a>00805 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00806"></a>00806 <span class="preprocessor"></span>        {
<a name="l00807"></a>00807 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00808"></a>00808 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00809"></a>00809 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00810"></a>00810 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00811"></a>00811 
<a name="l00812"></a>00812                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l00813"></a>00813                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l00814"></a>00814                         indexLo     = indexUp + sizeHalfBlock;
<a name="l00815"></a>00815 
<a name="l00816"></a>00816                         controlBit = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, indexUp+chunkId*chunkSize);
<a name="l00817"></a>00817                         <span class="keywordflow">if</span> (controlBit){
<a name="l00818"></a>00818                                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l00819"></a>00819                                 stateRealUp = stateVecReal[indexUp];
<a name="l00820"></a>00820                                 stateImagUp = stateVecImag[indexUp];
<a name="l00821"></a>00821 
<a name="l00822"></a>00822                                 stateRealLo = stateVecReal[indexLo];
<a name="l00823"></a>00823                                 stateImagLo = stateVecImag[indexLo];
<a name="l00824"></a>00824 
<a name="l00825"></a>00825 
<a name="l00826"></a>00826                                 <span class="comment">// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]</span>
<a name="l00827"></a>00827                                 stateVecReal[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp 
<a name="l00828"></a>00828                                         + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo - u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;
<a name="l00829"></a>00829                                 stateVecImag[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp 
<a name="l00830"></a>00830                                         + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;
<a name="l00831"></a>00831 
<a name="l00832"></a>00832                                 <span class="comment">// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]</span>
<a name="l00833"></a>00833                                 stateVecReal[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp  - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp 
<a name="l00834"></a>00834                                         + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo  -  u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;
<a name="l00835"></a>00835                                 stateVecImag[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp 
<a name="l00836"></a>00836                                         + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;
<a name="l00837"></a>00837                         }
<a name="l00838"></a>00838                 } 
<a name="l00839"></a>00839         }
<a name="l00840"></a>00840 
<a name="l00841"></a>00841 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae5f9019826f35e8b51b1716cfe397b45"></a><!-- doxytag: member="qubits_internal.h::exitWithError" ref="ae5f9019826f35e8b51b1716cfe397b45" args="(int errorCode, const char *func)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void exitWithError </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>errorCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>func</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00234">234</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>References <a class="el" href="qubits_8c_source.html#l00017">errorCodes</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00242">QuESTAssert()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00234"></a>00234                                                    {
<a name="l00235"></a>00235     printf(<span class="stringliteral">&quot;!!!\n&quot;</span>);
<a name="l00236"></a>00236     printf(<span class="stringliteral">&quot;QuEST Error in function %s: %s\n&quot;</span>, func, <a class="code" href="qubits_8c.html#aac1637696885c75b73a1ecf381cea713">errorCodes</a>[errorCode]);
<a name="l00237"></a>00237     printf(<span class="stringliteral">&quot;!!!\n&quot;</span>);
<a name="l00238"></a>00238     printf(<span class="stringliteral">&quot;exiting..\n&quot;</span>);
<a name="l00239"></a>00239     exit(errorCode);
<a name="l00240"></a>00240 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9ac9bb717a889f09d307eda9f0b65957"></a><!-- doxytag: member="qubits_internal.h::findProbabilityOfZeroDistributed" ref="a9ac9bb717a889f09d307eda9f0b65957" args="(MultiQubit multiQubit, const int measureQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL findProbabilityOfZeroDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Measure the probability of a specified qubit being in the zero state across all amplitudes held in this chunk. </p>
<p>Size of regions to skip is a multiple of chunkSize.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>probability of qubit measureQubit being zero </dd></dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01642">1642</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00672">findProbabilityOfOutcome()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01644"></a>01644 {
<a name="l01645"></a>01645         <span class="comment">// ----- measured probability</span>
<a name="l01646"></a>01646         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   totalProbability;                                    <span class="comment">// probability (returned) value</span>
<a name="l01647"></a>01647         <span class="comment">// ----- temp variables</span>
<a name="l01648"></a>01648         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span>
<a name="l01649"></a>01649         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01650"></a>01650 
<a name="l01651"></a>01651         <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01652"></a>01652         <span class="comment">//            find probability                                      //</span>
<a name="l01653"></a>01653         <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01654"></a>01654 
<a name="l01655"></a>01655         <span class="comment">// initialise returned value</span>
<a name="l01656"></a>01656         totalProbability = 0.0;
<a name="l01657"></a>01657 
<a name="l01658"></a>01658         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01659"></a>01659         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01660"></a>01660 
<a name="l01661"></a>01661 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01662"></a>01662 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01663"></a>01663 <span class="preprocessor">        shared    (numTasks,stateVecReal,stateVecImag) \</span>
<a name="l01664"></a>01664 <span class="preprocessor">        private   (thisTask) \</span>
<a name="l01665"></a>01665 <span class="preprocessor">        reduction ( +:totalProbability )</span>
<a name="l01666"></a>01666 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01667"></a>01667 <span class="preprocessor"></span>        {
<a name="l01668"></a>01668 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01669"></a>01669 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule  (static)</span>
<a name="l01670"></a>01670 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01671"></a>01671 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01672"></a>01672                         <span class="comment">// summation -- simple implementation</span>
<a name="l01673"></a>01673                         totalProbability += stateVecReal[thisTask]*stateVecReal[thisTask]
<a name="l01674"></a>01674                                 + stateVecImag[thisTask]*stateVecImag[thisTask];
<a name="l01675"></a>01675 
<a name="l01676"></a>01676                         <span class="comment">/*</span>
<a name="l01677"></a>01677 <span class="comment">                        // summation -- kahan correction</span>
<a name="l01678"></a>01678 <span class="comment">                        y = stateVecReal[thisTask]*stateVecReal[thisTask]</span>
<a name="l01679"></a>01679 <span class="comment">                        + stateVecImag[thisTask]*stateVecImag[thisTask] - c;</span>
<a name="l01680"></a>01680 <span class="comment">                        t = totalProbability + y;</span>
<a name="l01681"></a>01681 <span class="comment">                        c = (t - totalProbability) - y;</span>
<a name="l01682"></a>01682 <span class="comment">                        totalProbability = t;</span>
<a name="l01683"></a>01683 <span class="comment">                        */</span>
<a name="l01684"></a>01684 
<a name="l01685"></a>01685                 }
<a name="l01686"></a>01686         }
<a name="l01687"></a>01687 
<a name="l01688"></a>01688         <span class="keywordflow">return</span> totalProbability;
<a name="l01689"></a>01689 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7c02cd0e1b4eac19771a0525f023249e"></a><!-- doxytag: member="qubits_internal.h::findProbabilityOfZeroLocal" ref="a7c02cd0e1b4eac19771a0525f023249e" args="(MultiQubit multiQubit, const int measureQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL findProbabilityOfZeroLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Measure the total probability of a specified qubit being in the zero state across all amplitudes in this chunk. </p>
<p>Size of regions to skip is less than the size of one chunk.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>probability of qubit measureQubit being zero </dd></dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01570">1570</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8c_source.html#l00015">DEBUG</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00186">findProbabilityOfOutcome()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01572"></a>01572 {
<a name="l01573"></a>01573         <span class="comment">// ----- sizes</span>
<a name="l01574"></a>01574         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock,                                           <span class="comment">// size of blocks</span>
<a name="l01575"></a>01575         sizeHalfBlock;                                       <span class="comment">// size of blocks halved</span>
<a name="l01576"></a>01576         <span class="comment">// ----- indices</span>
<a name="l01577"></a>01577         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock,                                           <span class="comment">// current block</span>
<a name="l01578"></a>01578              index;                                               <span class="comment">// current index for first half block</span>
<a name="l01579"></a>01579         <span class="comment">// ----- measured probability</span>
<a name="l01580"></a>01580         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   totalProbability;                                    <span class="comment">// probability (returned) value</span>
<a name="l01581"></a>01581         <span class="comment">// ----- temp variables</span>
<a name="l01582"></a>01582         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span>
<a name="l01583"></a>01583         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01584"></a>01584 
<a name="l01585"></a>01585         <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01586"></a>01586         <span class="comment">//            dimensions                                            //</span>
<a name="l01587"></a>01587         <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l01588"></a>01588         sizeHalfBlock = 1LL &lt;&lt; (measureQubit);                       <span class="comment">// number of state vector elements to sum,</span>
<a name="l01589"></a>01589         <span class="comment">// and then the number to skip</span>
<a name="l01590"></a>01590         sizeBlock     = 2LL * sizeHalfBlock;                           <span class="comment">// size of blocks (pairs of measure and skip entries)</span>
<a name="l01591"></a>01591 
<a name="l01592"></a>01592         <span class="comment">// initialise returned value</span>
<a name="l01593"></a>01593         totalProbability = 0.0;
<a name="l01594"></a>01594 
<a name="l01595"></a>01595         <span class="comment">// initialise correction for kahan summation</span>
<a name="l01596"></a>01596         <span class="keywordflow">if</span> (<a class="code" href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>) printf(<span class="stringliteral">&quot;sizeHalfBlock=%Ld sizeBlock=%Ld numTasks=%Ld\n&quot;</span>,sizeHalfBlock,sizeBlock,numTasks);
<a name="l01597"></a>01597 
<a name="l01598"></a>01598         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01599"></a>01599         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01600"></a>01600 
<a name="l01601"></a>01601 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01602"></a>01602 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01603"></a>01603 <span class="preprocessor">        shared    (numTasks,sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span>
<a name="l01604"></a>01604 <span class="preprocessor">        private   (thisTask,thisBlock,index) \</span>
<a name="l01605"></a>01605 <span class="preprocessor">        reduction ( +:totalProbability )</span>
<a name="l01606"></a>01606 <span class="preprocessor"></span><span class="preprocessor"># endif </span>
<a name="l01607"></a>01607 <span class="preprocessor"></span>        {
<a name="l01608"></a>01608 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01609"></a>01609 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule  (static)</span>
<a name="l01610"></a>01610 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01611"></a>01611 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01612"></a>01612                         thisBlock = thisTask / sizeHalfBlock;
<a name="l01613"></a>01613                         index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01614"></a>01614 
<a name="l01615"></a>01615                         <span class="keywordflow">if</span> (index&lt;0){ printf(<span class="stringliteral">&quot;ABORTING as index=%Ld with thisBlock = %Ld  thisTask=%Ld \n&quot;</span>, index,thisBlock,thisTask); exit(1);}
<a name="l01616"></a>01616 
<a name="l01617"></a>01617                         <span class="comment">// summation -- simple implementation</span>
<a name="l01618"></a>01618                         totalProbability += stateVecReal[index]*stateVecReal[index]
<a name="l01619"></a>01619                                 + stateVecImag[index]*stateVecImag[index];
<a name="l01620"></a>01620 
<a name="l01621"></a>01621                         <span class="comment">/*</span>
<a name="l01622"></a>01622 <span class="comment">                        // summation -- kahan correction</span>
<a name="l01623"></a>01623 <span class="comment">                        y = stateVecReal[index]*stateVecReal[index]</span>
<a name="l01624"></a>01624 <span class="comment">                        + stateVecImag[index]*stateVecImag[index] - c;</span>
<a name="l01625"></a>01625 <span class="comment">                        t = totalProbability + y;</span>
<a name="l01626"></a>01626 <span class="comment">                        c = (t - totalProbability) - y;</span>
<a name="l01627"></a>01627 <span class="comment">                        totalProbability = t;</span>
<a name="l01628"></a>01628 <span class="comment">                        */</span>
<a name="l01629"></a>01629 
<a name="l01630"></a>01630                 }
<a name="l01631"></a>01631         }
<a name="l01632"></a>01632         <span class="keywordflow">return</span> totalProbability;
<a name="l01633"></a>01633 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae6a897066979fc52d977007d959ca09d"></a><!-- doxytag: member="qubits_internal.h::hadamardDistributed" ref="ae6a897066979fc52d977007d959ca09d" args="(MultiQubit multiQubit, const int targetQubit, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut, int updateUpper)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hadamardDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>updateUpper</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{1,1},{1,-1}}/sqrt2. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecIn</em>&nbsp;</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>updateUpper</em>&nbsp;</td><td>flag, 1: updating upper values, 0: updating lower values in block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01373">1373</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, and <a class="el" href="precision_8h_source.html#l00023">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00615">hadamard()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01378"></a>01378 {
<a name="l01379"></a>01379 
<a name="l01380"></a>01380         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l01381"></a>01381         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01382"></a>01382         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01383"></a>01383 
<a name="l01384"></a>01384         <span class="keywordtype">int</span> sign;
<a name="l01385"></a>01385         <span class="keywordflow">if</span> (updateUpper) sign=1;
<a name="l01386"></a>01386         <span class="keywordflow">else</span> sign=-1;
<a name="l01387"></a>01387 
<a name="l01388"></a>01388         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> recRoot2 = 1.0/sqrt(2);
<a name="l01389"></a>01389 
<a name="l01390"></a>01390         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01391"></a>01391         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01392"></a>01392         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01393"></a>01393 
<a name="l01394"></a>01394 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01395"></a>01395 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01396"></a>01396 <span class="preprocessor">        default  (none) \</span>
<a name="l01397"></a>01397 <span class="preprocessor">        shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l01398"></a>01398 <span class="preprocessor">                        recRoot2, sign) \</span>
<a name="l01399"></a>01399 <span class="preprocessor">        private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span>
<a name="l01400"></a>01400 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01401"></a>01401 <span class="preprocessor"></span>        {
<a name="l01402"></a>01402 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01403"></a>01403 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01404"></a>01404 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01405"></a>01405 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01406"></a>01406                         <span class="comment">// store current state vector values in temp variables</span>
<a name="l01407"></a>01407                         stateRealUp = stateVecRealUp[thisTask];
<a name="l01408"></a>01408                         stateImagUp = stateVecImagUp[thisTask];
<a name="l01409"></a>01409 
<a name="l01410"></a>01410                         stateRealLo = stateVecRealLo[thisTask];
<a name="l01411"></a>01411                         stateImagLo = stateVecImagLo[thisTask];
<a name="l01412"></a>01412 
<a name="l01413"></a>01413                         stateVecRealOut[thisTask] = recRoot2*(stateRealUp + sign*stateRealLo);
<a name="l01414"></a>01414                         stateVecImagOut[thisTask] = recRoot2*(stateImagUp + sign*stateImagLo);
<a name="l01415"></a>01415                 }
<a name="l01416"></a>01416         }
<a name="l01417"></a>01417 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa9f0718b4dd794a3e1b143e3b153bfc5"></a><!-- doxytag: member="qubits_internal.h::hadamardLocal" ref="aa9f0718b4dd794a3e1b143e3b153bfc5" args="(MultiQubit multiQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hadamardLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01312">1312</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00172">hadamard()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01313"></a>01313 {
<a name="l01314"></a>01314         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01315"></a>01315         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01316"></a>01316              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01317"></a>01317 
<a name="l01318"></a>01318         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l01319"></a>01319         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01320"></a>01320         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01321"></a>01321 
<a name="l01322"></a>01322         <span class="comment">// set dimensions</span>
<a name="l01323"></a>01323         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01324"></a>01324         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01325"></a>01325 
<a name="l01326"></a>01326         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l01327"></a>01327         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01328"></a>01328         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01329"></a>01329 
<a name="l01330"></a>01330         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> recRoot2 = 1.0/sqrt(2);
<a name="l01331"></a>01331 
<a name="l01332"></a>01332 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01333"></a>01333 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01334"></a>01334 <span class="preprocessor">        default  (none) \</span>
<a name="l01335"></a>01335 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, recRoot2) \</span>
<a name="l01336"></a>01336 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span>
<a name="l01337"></a>01337 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01338"></a>01338 <span class="preprocessor"></span>        {
<a name="l01339"></a>01339 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01340"></a>01340 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01341"></a>01341 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01342"></a>01342 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01343"></a>01343                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l01344"></a>01344                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01345"></a>01345                         indexLo     = indexUp + sizeHalfBlock;
<a name="l01346"></a>01346 
<a name="l01347"></a>01347                         stateRealUp = stateVecReal[indexUp];
<a name="l01348"></a>01348                         stateImagUp = stateVecImag[indexUp];
<a name="l01349"></a>01349 
<a name="l01350"></a>01350                         stateRealLo = stateVecReal[indexLo];
<a name="l01351"></a>01351                         stateImagLo = stateVecImag[indexLo];
<a name="l01352"></a>01352 
<a name="l01353"></a>01353                         stateVecReal[indexUp] = recRoot2*(stateRealUp + stateRealLo);
<a name="l01354"></a>01354                         stateVecImag[indexUp] = recRoot2*(stateImagUp + stateImagLo);
<a name="l01355"></a>01355 
<a name="l01356"></a>01356                         stateVecReal[indexLo] = recRoot2*(stateRealUp - stateRealLo);
<a name="l01357"></a>01357                         stateVecImag[indexLo] = recRoot2*(stateImagUp - stateImagLo);
<a name="l01358"></a>01358                 } 
<a name="l01359"></a>01359         }
<a name="l01360"></a>01360 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9dbf856ebeea0cf0a3ee5aae6782f2d2"></a><!-- doxytag: member="qubits_internal.h::multiControlledUnitaryDistributed" ref="a9dbf856ebeea0cf0a3ee5aae6782f2d2" args="(MultiQubit multiQubit, const int targetQubit, long long int mask, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multiControlledUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply a unitary operation to a single qubit in the state vector of probability amplitudes, given a subset of the state vector with upper and lower block values stored seperately. </p>
<p>Only perform the rotation where all the control qubits are 1.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>qubit to determine whether or not to perform a rotation </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot1</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot2</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00983">983</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00055">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, and <a class="el" href="precision_8h_source.html#l00023">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00454">multiControlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00990"></a>00990 {
<a name="l00991"></a>00991 
<a name="l00992"></a>00992         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00993"></a>00993         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l00994"></a>00994         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00995"></a>00995         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00996"></a>00996         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l00997"></a>00997 
<a name="l00998"></a>00998         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00999"></a>00999         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l01000"></a>01000         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01001"></a>01001         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01002"></a>01002         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01003"></a>01003 
<a name="l01004"></a>01004 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01005"></a>01005 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01006"></a>01006 <span class="preprocessor">        default  (none) \</span>
<a name="l01007"></a>01007 <span class="preprocessor">        shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l01008"></a>01008 <span class="preprocessor">                        rot1Real,rot1Imag, rot2Real,rot2Imag, mask) \</span>
<a name="l01009"></a>01009 <span class="preprocessor">        private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span>
<a name="l01010"></a>01010 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01011"></a>01011 <span class="preprocessor"></span>        {
<a name="l01012"></a>01012 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01013"></a>01013 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01014"></a>01014 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01015"></a>01015 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01016"></a>01016                         <span class="keywordflow">if</span> (mask == (mask &amp; (thisTask+chunkId*chunkSize)) ){
<a name="l01017"></a>01017                                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l01018"></a>01018                                 stateRealUp = stateVecRealUp[thisTask];
<a name="l01019"></a>01019                                 stateImagUp = stateVecImagUp[thisTask];
<a name="l01020"></a>01020 
<a name="l01021"></a>01021                                 stateRealLo = stateVecRealLo[thisTask];
<a name="l01022"></a>01022                                 stateImagLo = stateVecImagLo[thisTask];
<a name="l01023"></a>01023 
<a name="l01024"></a>01024                 stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp 
<a name="l01025"></a>01025                     + rot2Real*stateRealLo - rot2Imag*stateImagLo;
<a name="l01026"></a>01026                 stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp 
<a name="l01027"></a>01027                     + rot2Real*stateImagLo + rot2Imag*stateRealLo;
<a name="l01028"></a>01028                         }
<a name="l01029"></a>01029                 }
<a name="l01030"></a>01030         }
<a name="l01031"></a>01031 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1309eabcba3cb97fbc3cd2e606d17766"></a><!-- doxytag: member="qubits_internal.h::multiControlledUnitaryLocal" ref="a1309eabcba3cb97fbc3cd2e606d17766" args="(MultiQubit multiQubit, const int targetQubit, long long int mask, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multiControlledUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00714">714</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00055">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00029">ComplexMatrix2::r0c0</a>, <a class="el" href="qubits_8h_source.html#l00029">ComplexMatrix2::r0c1</a>, <a class="el" href="qubits_8h_source.html#l00030">ComplexMatrix2::r1c0</a>, <a class="el" href="qubits_8h_source.html#l00030">ComplexMatrix2::r1c1</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00140">multiControlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00716"></a>00716 {
<a name="l00717"></a>00717         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l00718"></a>00718         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l00719"></a>00719              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l00720"></a>00720 
<a name="l00721"></a>00721         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00722"></a>00722         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l00723"></a>00723         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l00724"></a>00724         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00725"></a>00725         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l00726"></a>00726 
<a name="l00727"></a>00727         <span class="comment">// set dimensions</span>
<a name="l00728"></a>00728         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l00729"></a>00729         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l00730"></a>00730 
<a name="l00731"></a>00731         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l00732"></a>00732         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00733"></a>00733         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00734"></a>00734 
<a name="l00735"></a>00735 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00736"></a>00736 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00737"></a>00737 <span class="preprocessor">        default  (none) \</span>
<a name="l00738"></a>00738 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, u, mask) \</span>
<a name="l00739"></a>00739 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span>
<a name="l00740"></a>00740 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00741"></a>00741 <span class="preprocessor"></span>        {
<a name="l00742"></a>00742 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00743"></a>00743 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00744"></a>00744 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00745"></a>00745 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00746"></a>00746 
<a name="l00747"></a>00747                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l00748"></a>00748                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l00749"></a>00749                         indexLo     = indexUp + sizeHalfBlock;
<a name="l00750"></a>00750 
<a name="l00751"></a>00751                         <span class="keywordflow">if</span> (mask == (mask &amp; (indexUp+chunkId*chunkSize)) ){
<a name="l00752"></a>00752                                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l00753"></a>00753                                 stateRealUp = stateVecReal[indexUp];
<a name="l00754"></a>00754                                 stateImagUp = stateVecImag[indexUp];
<a name="l00755"></a>00755 
<a name="l00756"></a>00756                                 stateRealLo = stateVecReal[indexLo];
<a name="l00757"></a>00757                                 stateImagLo = stateVecImag[indexLo];
<a name="l00758"></a>00758 
<a name="l00759"></a>00759 
<a name="l00760"></a>00760                                 <span class="comment">// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]</span>
<a name="l00761"></a>00761                                 stateVecReal[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp 
<a name="l00762"></a>00762                                         + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo - u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;
<a name="l00763"></a>00763                                 stateVecImag[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp 
<a name="l00764"></a>00764                                         + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;
<a name="l00765"></a>00765 
<a name="l00766"></a>00766                                 <span class="comment">// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]</span>
<a name="l00767"></a>00767                                 stateVecReal[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp  - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp 
<a name="l00768"></a>00768                                         + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo  -  u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;
<a name="l00769"></a>00769                                 stateVecImag[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp 
<a name="l00770"></a>00770                                         + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;
<a name="l00771"></a>00771                         }
<a name="l00772"></a>00772                 } 
<a name="l00773"></a>00773         }
<a name="l00774"></a>00774 
<a name="l00775"></a>00775 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aae7a8a7f1ccbddb7f76b6c52b746bb43"></a><!-- doxytag: member="qubits_internal.h::phaseGate" ref="aae7a8a7f1ccbddb7f76b6c52b746bb43" args="(MultiQubit multiQubit, const int targetQubit, enum phaseGateType type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void phaseGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a>&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00166">166</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00055">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00161">chunkIsUpper()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00246">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00050">MultiQubit::numQubits</a>, <a class="el" href="qubits_8c_source.html#l01495">phaseGateDistributed()</a>, <a class="el" href="qubits_8c_source.html#l01419">phaseGateLocal()</a>, and <a class="el" href="qubits__env__local_8c_source.html#l00242">QuESTAssert()</a>.</p>

<p>Referenced by <a class="el" href="qubits_8c_source.html#l01553">sGate()</a>, <a class="el" href="qubits_8c_source.html#l01548">sigmaZ()</a>, and <a class="el" href="qubits_8c_source.html#l01558">tGate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00167"></a>00167 {
<a name="l00168"></a>00168     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00169"></a>00169         <a class="code" href="qubits_8c.html#a3a54566b73ac84c312d7da4f56ffbc3b">phaseGateLocal</a>(multiQubit, targetQubit, type);
<a name="l00170"></a>00170 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af832ed00b02a0597b7fe0b714032c54a"></a><!-- doxytag: member="qubits_internal.h::phaseGateDistributed" ref="af832ed00b02a0597b7fe0b714032c54a" args="(MultiQubit multiQubit, const int targetQubit, enum phaseGateType type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void phaseGateDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a>&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01495">1495</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, <a class="el" href="qubits_8h_source.html#l00070">S_GATE</a>, <a class="el" href="qubits_8h_source.html#l00070">SIGMA_Z</a>, <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::stateVec</a>, and <a class="el" href="qubits_8h_source.html#l00070">T_GATE</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00597">phaseGate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01496"></a>01496 {
<a name="l01497"></a>01497         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealLo,stateImagLo;
<a name="l01498"></a>01498         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01499"></a>01499         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01500"></a>01500 
<a name="l01501"></a>01501         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l01502"></a>01502         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01503"></a>01503         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01504"></a>01504 
<a name="l01505"></a>01505         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> recRoot2 = 1.0/sqrt(2);
<a name="l01506"></a>01506 
<a name="l01507"></a>01507 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01508"></a>01508 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01509"></a>01509 <span class="preprocessor">        default  (none) \</span>
<a name="l01510"></a>01510 <span class="preprocessor">        shared   (stateVecReal,stateVecImag, recRoot2, type) \</span>
<a name="l01511"></a>01511 <span class="preprocessor">        private  (thisTask,stateRealLo,stateImagLo) </span>
<a name="l01512"></a>01512 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01513"></a>01513 <span class="preprocessor"></span>        {
<a name="l01514"></a>01514                 <span class="keywordflow">if</span> (type==<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a>){
<a name="l01515"></a>01515 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01516"></a>01516 <span class="preprocessor"></span><span class="preprocessor">                        # pragma omp for schedule (static)</span>
<a name="l01517"></a>01517 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01518"></a>01518 <span class="preprocessor"></span>                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01519"></a>01519                                 stateVecReal[thisTask] = -stateVecReal[thisTask];
<a name="l01520"></a>01520                                 stateVecImag[thisTask] = -stateVecImag[thisTask];
<a name="l01521"></a>01521                         } 
<a name="l01522"></a>01522                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a>){
<a name="l01523"></a>01523 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01524"></a>01524 <span class="preprocessor"></span><span class="preprocessor">                        # pragma omp for schedule (static)</span>
<a name="l01525"></a>01525 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01526"></a>01526 <span class="preprocessor"></span>                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01527"></a>01527                                 stateRealLo = stateVecReal[thisTask];
<a name="l01528"></a>01528                                 stateImagLo = stateVecImag[thisTask];
<a name="l01529"></a>01529 
<a name="l01530"></a>01530                                 stateVecReal[thisTask] = -stateImagLo;
<a name="l01531"></a>01531                                 stateVecImag[thisTask] = stateRealLo;
<a name="l01532"></a>01532                         } 
<a name="l01533"></a>01533                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a>){
<a name="l01534"></a>01534 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01535"></a>01535 <span class="preprocessor"></span><span class="preprocessor">                        # pragma omp for schedule (static)</span>
<a name="l01536"></a>01536 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01537"></a>01537 <span class="preprocessor"></span>                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01538"></a>01538                                 stateRealLo = stateVecReal[thisTask];
<a name="l01539"></a>01539                                 stateImagLo = stateVecImag[thisTask];
<a name="l01540"></a>01540 
<a name="l01541"></a>01541                                 stateVecReal[thisTask] = recRoot2 * (stateRealLo - stateImagLo);
<a name="l01542"></a>01542                                 stateVecImag[thisTask] = recRoot2 * (stateRealLo + stateImagLo);
<a name="l01543"></a>01543                         } 
<a name="l01544"></a>01544                 } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Type %d is an invalid phase gate\n&quot;</span>, type);
<a name="l01545"></a>01545         }
<a name="l01546"></a>01546 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3a54566b73ac84c312d7da4f56ffbc3b"></a><!-- doxytag: member="qubits_internal.h::phaseGateLocal" ref="a3a54566b73ac84c312d7da4f56ffbc3b" args="(MultiQubit multiQubit, const int targetQubit, enum phaseGateType type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void phaseGateLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a>&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>fix -- can i rewrite this to not use mod?</p>
<p>fix -- can i rewrite this to not use mod?</p>
<p>fix -- can i rewrite this to not use mod? </p>
</p>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01419">1419</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, <a class="el" href="qubits_8h_source.html#l00070">S_GATE</a>, <a class="el" href="qubits_8h_source.html#l00070">SIGMA_Z</a>, <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::stateVec</a>, and <a class="el" href="qubits_8h_source.html#l00070">T_GATE</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00166">phaseGate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01420"></a>01420 {
<a name="l01421"></a>01421         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01422"></a>01422         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01423"></a>01423              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01424"></a>01424 
<a name="l01425"></a>01425         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealLo,stateImagLo;
<a name="l01426"></a>01426         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01427"></a>01427         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01428"></a>01428 
<a name="l01429"></a>01429         <span class="comment">// set dimensions</span>
<a name="l01430"></a>01430         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01431"></a>01431         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01432"></a>01432 
<a name="l01433"></a>01433         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l01434"></a>01434         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01435"></a>01435         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01436"></a>01436 
<a name="l01437"></a>01437         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> recRoot2 = 1.0/sqrt(2);
<a name="l01438"></a>01438 
<a name="l01439"></a>01439 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01440"></a>01440 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01441"></a>01441 <span class="preprocessor">        default  (none) \</span>
<a name="l01442"></a>01442 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock,stateVecReal,stateVecImag,recRoot2,type) \</span>
<a name="l01443"></a>01443 <span class="preprocessor">        private  (thisTask,thisBlock,indexUp,indexLo,stateRealLo,stateImagLo) </span>
<a name="l01444"></a>01444 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01445"></a>01445 <span class="preprocessor"></span>        {
<a name="l01446"></a>01446                 <span class="keywordflow">if</span> (type==<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a>){
<a name="l01447"></a>01447 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01448"></a>01448 <span class="preprocessor"></span><span class="preprocessor">                        # pragma omp for schedule (static)</span>
<a name="l01449"></a>01449 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01450"></a>01450 <span class="preprocessor"></span>                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01452"></a>01452                                 thisBlock   = thisTask / sizeHalfBlock;
<a name="l01453"></a>01453                                 indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01454"></a>01454                                 indexLo     = indexUp + sizeHalfBlock;
<a name="l01455"></a>01455 
<a name="l01456"></a>01456                                 stateVecReal[indexLo] = -stateVecReal[indexLo];
<a name="l01457"></a>01457                                 stateVecImag[indexLo] = -stateVecImag[indexLo];
<a name="l01458"></a>01458                         } 
<a name="l01459"></a>01459                 } 
<a name="l01460"></a>01460                 
<a name="l01461"></a>01461                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a>){
<a name="l01462"></a>01462 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01463"></a>01463 <span class="preprocessor"></span><span class="preprocessor">                        # pragma omp for schedule (static)</span>
<a name="l01464"></a>01464 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01465"></a>01465 <span class="preprocessor"></span>                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01467"></a>01467                                 thisBlock   = thisTask / sizeHalfBlock;
<a name="l01468"></a>01468                                 indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01469"></a>01469                                 indexLo     = indexUp + sizeHalfBlock;
<a name="l01470"></a>01470                                 stateRealLo = stateVecReal[indexLo];
<a name="l01471"></a>01471                                 stateImagLo = stateVecImag[indexLo];
<a name="l01472"></a>01472 
<a name="l01473"></a>01473                                 stateVecReal[indexLo] = -stateImagLo;
<a name="l01474"></a>01474                                 stateVecImag[indexLo] = stateRealLo;
<a name="l01475"></a>01475                         } 
<a name="l01476"></a>01476                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a>){
<a name="l01477"></a>01477 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01478"></a>01478 <span class="preprocessor"></span><span class="preprocessor">                        # pragma omp for schedule (static)</span>
<a name="l01479"></a>01479 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01480"></a>01480 <span class="preprocessor"></span>                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01482"></a>01482                                 thisBlock   = thisTask / sizeHalfBlock;
<a name="l01483"></a>01483                                 indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01484"></a>01484                                 indexLo     = indexUp + sizeHalfBlock;
<a name="l01485"></a>01485                                 stateRealLo = stateVecReal[indexLo];
<a name="l01486"></a>01486                                 stateImagLo = stateVecImag[indexLo];
<a name="l01487"></a>01487 
<a name="l01488"></a>01488                                 stateVecReal[indexLo] = recRoot2 * (stateRealLo - stateImagLo);
<a name="l01489"></a>01489                                 stateVecImag[indexLo] = recRoot2 * (stateRealLo + stateImagLo);
<a name="l01490"></a>01490                         } 
<a name="l01491"></a>01491                 } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Type %d is an invalid phase gate\n&quot;</span>, type);
<a name="l01492"></a>01492         }
<a name="l01493"></a>01493 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3587b9d533e633ccf1abf9ad2ce45d8d"></a><!-- doxytag: member="qubits_internal.h::QuESTAssert" ref="a3587b9d533e633ccf1abf9ad2ce45d8d" args="(int isValid, int errorCode, const char *func)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void QuESTAssert </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>isValid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>errorCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>func</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00242">242</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00234">exitWithError()</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00195">collapseToOutcome()</a>, <a class="el" href="qubits__env__local_8c_source.html#l00101">compactUnitary()</a>, <a class="el" href="qubits__env__local_8c_source.html#l00119">controlledCompactUnitary()</a>, <a class="el" href="qubits__env__local_8c_source.html#l00178">controlledNot()</a>, <a class="el" href="qubits_8c_source.html#l01702">controlledPhaseGate()</a>, <a class="el" href="qubits__env__local_8c_source.html#l00130">controlledUnitary()</a>, <a class="el" href="qubits_8c_source.html#l00035">createMultiQubit()</a>, <a class="el" href="qubits__env__local_8c_source.html#l00186">findProbabilityOfOutcome()</a>, <a class="el" href="qubits__env__local_8c_source.html#l00172">hadamard()</a>, <a class="el" href="qubits__env__local_8c_source.html#l00205">measure()</a>, <a class="el" href="qubits__env__local_8c_source.html#l00211">measureWithStats()</a>, <a class="el" href="qubits_8c_source.html#l01737">multiControlledPhaseGate()</a>, <a class="el" href="qubits__env__local_8c_source.html#l00140">multiControlledUnitary()</a>, <a class="el" href="qubits__env__local_8c_source.html#l00166">phaseGate()</a>, <a class="el" href="qubits__env__local_8c_source.html#l00154">sigmaX()</a>, <a class="el" href="qubits__env__local_8c_source.html#l00160">sigmaY()</a>, and <a class="el" href="qubits__env__local_8c_source.html#l00110">unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00242"></a>00242                                                               {
<a name="l00243"></a>00243     <span class="keywordflow">if</span> (!isValid) <a class="code" href="qubits__env__local_8c.html#ae5f9019826f35e8b51b1716cfe397b45">exitWithError</a>(errorCode, func);
<a name="l00244"></a>00244 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2275fff50824fe47485890ff5a857785"></a><!-- doxytag: member="qubits_internal.h::sigmaXDistributed" ref="a2275fff50824fe47485890ff5a857785" args="(MultiQubit multiQubit, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaXDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{0,1},{1,0}. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecIn</em>&nbsp;</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01092">1092</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, and <a class="el" href="precision_8h_source.html#l00023">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00500">sigmaX()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01095"></a>01095 {
<a name="l01096"></a>01096 
<a name="l01097"></a>01097         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01098"></a>01098         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01099"></a>01099 
<a name="l01100"></a>01100         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealIn=stateVecIn.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagIn=stateVecIn.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01101"></a>01101         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01102"></a>01102 
<a name="l01103"></a>01103 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01104"></a>01104 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01105"></a>01105 <span class="preprocessor">        default  (none) \</span>
<a name="l01106"></a>01106 <span class="preprocessor">        shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut) \</span>
<a name="l01107"></a>01107 <span class="preprocessor">        private  (thisTask)</span>
<a name="l01108"></a>01108 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01109"></a>01109 <span class="preprocessor"></span>        {
<a name="l01110"></a>01110 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01111"></a>01111 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01112"></a>01112 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01113"></a>01113 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01114"></a>01114                         stateVecRealOut[thisTask] = stateVecRealIn[thisTask];
<a name="l01115"></a>01115                         stateVecImagOut[thisTask] = stateVecImagIn[thisTask];
<a name="l01116"></a>01116                 }
<a name="l01117"></a>01117         }
<a name="l01118"></a>01118 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a74822fd86bb5d81766e6e8dbdcd62df1"></a><!-- doxytag: member="qubits_internal.h::sigmaXLocal" ref="a74822fd86bb5d81766e6e8dbdcd62df1" args="(MultiQubit multiQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaXLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01033">1033</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00154">sigmaX()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01034"></a>01034 {
<a name="l01035"></a>01035         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01036"></a>01036         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01037"></a>01037              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01038"></a>01038 
<a name="l01039"></a>01039         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateImagUp;
<a name="l01040"></a>01040         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01041"></a>01041         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01042"></a>01042 
<a name="l01043"></a>01043         <span class="comment">// set dimensions</span>
<a name="l01044"></a>01044         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01045"></a>01045         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01046"></a>01046 
<a name="l01047"></a>01047         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l01048"></a>01048         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01049"></a>01049         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01050"></a>01050 
<a name="l01051"></a>01051 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01052"></a>01052 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01053"></a>01053 <span class="preprocessor">        default  (none) \</span>
<a name="l01054"></a>01054 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span>
<a name="l01055"></a>01055 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp) </span>
<a name="l01056"></a>01056 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01057"></a>01057 <span class="preprocessor"></span>        {
<a name="l01058"></a>01058 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01059"></a>01059 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01060"></a>01060 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01061"></a>01061 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01062"></a>01062                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l01063"></a>01063                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01064"></a>01064                         indexLo     = indexUp + sizeHalfBlock;
<a name="l01065"></a>01065 
<a name="l01066"></a>01066                         stateRealUp = stateVecReal[indexUp];
<a name="l01067"></a>01067                         stateImagUp = stateVecImag[indexUp];
<a name="l01068"></a>01068 
<a name="l01069"></a>01069                         stateVecReal[indexUp] = stateVecReal[indexLo];
<a name="l01070"></a>01070                         stateVecImag[indexUp] = stateVecImag[indexLo];
<a name="l01071"></a>01071 
<a name="l01072"></a>01072                         stateVecReal[indexLo] = stateRealUp;
<a name="l01073"></a>01073                         stateVecImag[indexLo] = stateImagUp;
<a name="l01074"></a>01074                 } 
<a name="l01075"></a>01075         }
<a name="l01076"></a>01076 
<a name="l01077"></a>01077 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af5ef5166f00c0572354b4ac53dcf40cf"></a><!-- doxytag: member="qubits_internal.h::sigmaYDistributed" ref="af5ef5166f00c0572354b4ac53dcf40cf" args="(MultiQubit multiQubit, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut, int updateUpper)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaYDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>updateUpper</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{0,-i},{i,0}. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecIn</em>&nbsp;</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>updateUpper</em>&nbsp;</td><td>flag, 1: updating upper values, 0: updating lower values in block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01279">1279</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, and <a class="el" href="precision_8h_source.html#l00023">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00566">sigmaY()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01283"></a>01283 {
<a name="l01284"></a>01284 
<a name="l01285"></a>01285         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01286"></a>01286         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01287"></a>01287 
<a name="l01288"></a>01288         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealIn=stateVecIn.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagIn=stateVecIn.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01289"></a>01289         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01290"></a>01290 
<a name="l01291"></a>01291         <span class="keywordtype">int</span> realSign=1, imagSign=1;
<a name="l01292"></a>01292         <span class="keywordflow">if</span> (updateUpper) imagSign=-1;
<a name="l01293"></a>01293         <span class="keywordflow">else</span> realSign = -1;
<a name="l01294"></a>01294 
<a name="l01295"></a>01295 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01296"></a>01296 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01297"></a>01297 <span class="preprocessor">        default  (none) \</span>
<a name="l01298"></a>01298 <span class="preprocessor">        shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut,realSign,imagSign) \</span>
<a name="l01299"></a>01299 <span class="preprocessor">        private  (thisTask)</span>
<a name="l01300"></a>01300 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01301"></a>01301 <span class="preprocessor"></span>        {
<a name="l01302"></a>01302 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01303"></a>01303 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01304"></a>01304 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01305"></a>01305 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01306"></a>01306                         stateVecRealOut[thisTask] = realSign*stateVecImagIn[thisTask];
<a name="l01307"></a>01307                         stateVecImagOut[thisTask] = imagSign*stateVecRealIn[thisTask];
<a name="l01308"></a>01308                 }
<a name="l01309"></a>01309         }
<a name="l01310"></a>01310 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a81fbfaed65a742a7dfd622e17652245e"></a><!-- doxytag: member="qubits_internal.h::sigmaYLocal" ref="a81fbfaed65a742a7dfd622e17652245e" args="(MultiQubit multiQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaYLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01220">1220</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00160">sigmaY()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01221"></a>01221 {
<a name="l01222"></a>01222         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01223"></a>01223         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01224"></a>01224              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01225"></a>01225 
<a name="l01226"></a>01226         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateImagUp;
<a name="l01227"></a>01227         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01228"></a>01228         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l01229"></a>01229 
<a name="l01230"></a>01230         <span class="comment">// set dimensions</span>
<a name="l01231"></a>01231         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01232"></a>01232         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01233"></a>01233 
<a name="l01234"></a>01234         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l01235"></a>01235         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01236"></a>01236         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01237"></a>01237 
<a name="l01238"></a>01238 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01239"></a>01239 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01240"></a>01240 <span class="preprocessor">        default  (none) \</span>
<a name="l01241"></a>01241 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span>
<a name="l01242"></a>01242 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp) </span>
<a name="l01243"></a>01243 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01244"></a>01244 <span class="preprocessor"></span>        {
<a name="l01245"></a>01245 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01246"></a>01246 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01247"></a>01247 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01248"></a>01248 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01249"></a>01249                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l01250"></a>01250                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01251"></a>01251                         indexLo     = indexUp + sizeHalfBlock;
<a name="l01252"></a>01252 
<a name="l01253"></a>01253                         stateRealUp = stateVecReal[indexUp];
<a name="l01254"></a>01254                         stateImagUp = stateVecImag[indexUp];
<a name="l01255"></a>01255 
<a name="l01256"></a>01256                         stateVecReal[indexUp] = stateVecImag[indexLo];
<a name="l01257"></a>01257                         stateVecImag[indexUp] = -stateVecReal[indexLo];
<a name="l01258"></a>01258 
<a name="l01259"></a>01259                         stateVecReal[indexLo] = -stateImagUp;
<a name="l01260"></a>01260                         stateVecImag[indexLo] = stateRealUp;
<a name="l01261"></a>01261                 } 
<a name="l01262"></a>01262         }
<a name="l01263"></a>01263 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2343b7240118e89aa615e2c9140b770b"></a><!-- doxytag: member="qubits_internal.h::unitaryDistributed" ref="a2343b7240118e89aa615e2c9140b770b" args="(MultiQubit multiQubit, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void unitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply a unitary operation to a single qubit given a subset of the state vector with upper and lower block values stored seperately. </p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>u</em>&nbsp;</td><td>unitary matrix to apply </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00602">602</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, and <a class="el" href="precision_8h_source.html#l00023">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00325">unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00607"></a>00607 {
<a name="l00608"></a>00608 
<a name="l00609"></a>00609         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00610"></a>00610         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l00611"></a>00611         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00612"></a>00612 
<a name="l00613"></a>00613         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00614"></a>00614         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00615"></a>00615         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00616"></a>00616         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00617"></a>00617         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00618"></a>00618 
<a name="l00619"></a>00619 
<a name="l00620"></a>00620 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00621"></a>00621 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00622"></a>00622 <span class="preprocessor">        default  (none) \</span>
<a name="l00623"></a>00623 <span class="preprocessor">        shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l00624"></a>00624 <span class="preprocessor">                        rot1Real, rot1Imag, rot2Real, rot2Imag) \</span>
<a name="l00625"></a>00625 <span class="preprocessor">        private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span>
<a name="l00626"></a>00626 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00627"></a>00627 <span class="preprocessor"></span>        {
<a name="l00628"></a>00628 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00629"></a>00629 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00630"></a>00630 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00631"></a>00631 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00632"></a>00632                         <span class="comment">// store current state vector values in temp variables</span>
<a name="l00633"></a>00633                         stateRealUp = stateVecRealUp[thisTask];
<a name="l00634"></a>00634                         stateImagUp = stateVecImagUp[thisTask];
<a name="l00635"></a>00635 
<a name="l00636"></a>00636                         stateRealLo = stateVecRealLo[thisTask];
<a name="l00637"></a>00637                         stateImagLo = stateVecImagLo[thisTask];
<a name="l00638"></a>00638 
<a name="l00639"></a>00639                         stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp 
<a name="l00640"></a>00640                                 + rot2Real*stateRealLo - rot2Imag*stateImagLo;
<a name="l00641"></a>00641                         stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp 
<a name="l00642"></a>00642                                 + rot2Real*stateImagLo + rot2Imag*stateRealLo;
<a name="l00643"></a>00643                 }
<a name="l00644"></a>00644         }
<a name="l00645"></a>00645 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac134fb45b0a7248c5d15e16eb7139a35"></a><!-- doxytag: member="qubits_internal.h::unitaryLocal" ref="ac134fb45b0a7248c5d15e16eb7139a35" args="(MultiQubit multiQubit, const int targetQubit, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void unitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00476">476</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00029">ComplexMatrix2::r0c0</a>, <a class="el" href="qubits_8h_source.html#l00029">ComplexMatrix2::r0c1</a>, <a class="el" href="qubits_8h_source.html#l00030">ComplexMatrix2::r1c0</a>, <a class="el" href="qubits_8h_source.html#l00030">ComplexMatrix2::r1c1</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00110">unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00477"></a>00477 {
<a name="l00478"></a>00478         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l00479"></a>00479         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l00480"></a>00480              indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l00481"></a>00481 
<a name="l00482"></a>00482         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l00483"></a>00483         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l00484"></a>00484         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&gt;&gt;1;
<a name="l00485"></a>00485 
<a name="l00486"></a>00486         <span class="comment">// set dimensions</span>
<a name="l00487"></a>00487         sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l00488"></a>00488         sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l00489"></a>00489 
<a name="l00490"></a>00490         <span class="comment">// Can&apos;t use multiQubit.stateVec as a private OMP var</span>
<a name="l00491"></a>00491         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00492"></a>00492         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00493"></a>00493 
<a name="l00494"></a>00494 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00495"></a>00495 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00496"></a>00496 <span class="preprocessor">        default  (none) \</span>
<a name="l00497"></a>00497 <span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, u) \</span>
<a name="l00498"></a>00498 <span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span>
<a name="l00499"></a>00499 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00500"></a>00500 <span class="preprocessor"></span>        {
<a name="l00501"></a>00501 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00502"></a>00502 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00503"></a>00503 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00504"></a>00504 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00505"></a>00505 
<a name="l00506"></a>00506                         thisBlock   = thisTask / sizeHalfBlock;
<a name="l00507"></a>00507                         indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l00508"></a>00508                         indexLo     = indexUp + sizeHalfBlock;
<a name="l00509"></a>00509 
<a name="l00510"></a>00510                         <span class="comment">// store current state vector values in temp variables</span>
<a name="l00511"></a>00511                         stateRealUp = stateVecReal[indexUp];
<a name="l00512"></a>00512                         stateImagUp = stateVecImag[indexUp];
<a name="l00513"></a>00513 
<a name="l00514"></a>00514                         stateRealLo = stateVecReal[indexLo];
<a name="l00515"></a>00515                         stateImagLo = stateVecImag[indexLo];
<a name="l00516"></a>00516 
<a name="l00517"></a>00517 
<a name="l00518"></a>00518                         <span class="comment">// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]</span>
<a name="l00519"></a>00519                         stateVecReal[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp 
<a name="l00520"></a>00520                                 + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo - u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;
<a name="l00521"></a>00521                         stateVecImag[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp 
<a name="l00522"></a>00522                                 + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;
<a name="l00523"></a>00523 
<a name="l00524"></a>00524                         <span class="comment">// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]</span>
<a name="l00525"></a>00525                         stateVecReal[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealUp  - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagUp 
<a name="l00526"></a>00526                                 + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateRealLo  -  u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateImagLo;
<a name="l00527"></a>00527                         stateVecImag[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealUp 
<a name="l00528"></a>00528                                 + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*stateRealLo;
<a name="l00529"></a>00529 
<a name="l00530"></a>00530                 } 
<a name="l00531"></a>00531         }
<a name="l00532"></a>00532 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae2b2c14a07dd7d50ff86032a3ca101d7"></a><!-- doxytag: member="qubits_internal.h::validateAlphaBeta" ref="ae2b2c14a07dd7d50ff86032a3ca101d7" args="(Complex alpha, Complex beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int validateAlphaBeta </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00365">365</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, and <a class="el" href="precision_8h_source.html#l00026">REAL_EPS</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00101">compactUnitary()</a>, and <a class="el" href="qubits__env__local_8c_source.html#l00119">controlledCompactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00365"></a>00365                                                   {
<a name="l00366"></a>00366         <span class="keywordflow">if</span> ( fabs(alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> 
<a name="l00367"></a>00367                 + alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00368"></a>00368                 + beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> 
<a name="l00369"></a>00369                 + beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> - 1) &gt; <a class="code" href="precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;
<a name="l00370"></a>00370         <span class="keywordflow">else</span> <span class="keywordflow">return</span> 1;
<a name="l00371"></a>00371 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae4fea133d1a8f09ff8da03038100adb2"></a><!-- doxytag: member="qubits_internal.h::validateMatrixIsUnitary" ref="ae4fea133d1a8f09ff8da03038100adb2" args="(ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int validateMatrixIsUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00340">340</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00029">ComplexMatrix2::r0c0</a>, <a class="el" href="qubits_8h_source.html#l00029">ComplexMatrix2::r0c1</a>, <a class="el" href="qubits_8h_source.html#l00030">ComplexMatrix2::r1c0</a>, <a class="el" href="qubits_8h_source.html#l00030">ComplexMatrix2::r1c1</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, and <a class="el" href="precision_8h_source.html#l00026">REAL_EPS</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00130">controlledUnitary()</a>, <a class="el" href="qubits__env__local_8c_source.html#l00140">multiControlledUnitary()</a>, and <a class="el" href="qubits__env__local_8c_source.html#l00110">unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00340"></a>00340                                              {
<a name="l00341"></a>00341 
<a name="l00342"></a>00342         <span class="keywordflow">if</span> ( fabs(u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> 
<a name="l00343"></a>00343                 + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00344"></a>00344                 + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>
<a name="l00345"></a>00345                 + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> - 1) &gt; <a class="code" href="precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;
<a name="l00346"></a>00346     <span class="comment">// check</span>
<a name="l00347"></a>00347         <span class="keywordflow">if</span> ( fabs(u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> 
<a name="l00348"></a>00348                 + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00349"></a>00349                 + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>
<a name="l00350"></a>00350                 + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> - 1) &gt; <a class="code" href="precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;
<a name="l00351"></a>00351 
<a name="l00352"></a>00352         <span class="keywordflow">if</span> ( fabs(u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> 
<a name="l00353"></a>00353                 + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00354"></a>00354                 + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>
<a name="l00355"></a>00355                 + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>) &gt; <a class="code" href="precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;
<a name="l00356"></a>00356 
<a name="l00357"></a>00357         <span class="keywordflow">if</span> ( fabs(u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00358"></a>00358                 - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00359"></a>00359                 + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>
<a name="l00360"></a>00360                 - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>*u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>) &gt; <a class="code" href="precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;
<a name="l00361"></a>00361 
<a name="l00362"></a>00362         <span class="keywordflow">return</span> 1;
<a name="l00363"></a>00363 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a71c14976f63cfcda70026fa20ee531fe"></a><!-- doxytag: member="qubits_internal.h::validateUnitVector" ref="a71c14976f63cfcda70026fa20ee531fe" args="(REAL ux, REAL uy, REAL uz)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int validateUnitVector </td>
          <td>(</td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>ux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>uy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>uz</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00373">373</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="precision_8h_source.html#l00026">REAL_EPS</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00373"></a>00373                                                  {
<a name="l00374"></a>00374         <span class="keywordflow">if</span> ( fabs(sqrt(ux*ux + uy*uy + uz*uz) - 1) &gt; <a class="code" href="precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a> ) <span class="keywordflow">return</span> 0;
<a name="l00375"></a>00375         <span class="keywordflow">else</span> <span class="keywordflow">return</span> 1;
<a name="l00376"></a>00376 }
</pre></div></p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="aac1637696885c75b73a1ecf381cea713"></a><!-- doxytag: member="qubits_internal.h::errorCodes" ref="aac1637696885c75b73a1ecf381cea713" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="qubits__internal_8h.html#aac1637696885c75b73a1ecf381cea713">errorCodes</a>[]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00017">17</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00234">exitWithError()</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 15 Feb 2018 for Distributed QuEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
