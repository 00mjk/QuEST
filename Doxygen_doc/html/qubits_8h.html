<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Distributed QUEST: qubits.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>qubits.h File Reference</h1>
<p>The QUEST library API and objects.  
<a href="#_details">More...</a></p>

<p><a href="qubits_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structComplexArray.html">ComplexArray</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Represents an array of complex numbers grouped into an array of real components and an array of coressponding complex components.  <a href="structComplexArray.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structComplex.html">Complex</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Represents one complex number.  <a href="structComplex.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMultiQubit.html">MultiQubit</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Represents a system of qubits.  <a href="structMultiQubit.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structQUESTEnv.html">QUESTEnv</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Information about the environment the program is running in.  <a href="structQUESTEnv.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#ae729f311efd2a426ce5161df3e017a16">createMultiQubit</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> *multiQubit, int numQubits, <a class="el" href="structQUESTEnv.html">QUESTEnv</a> env)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a <a class="el" href="structMultiQubit.html" title="Represents a system of qubits.">MultiQubit</a> object representing a set of qubits.  <a href="#ae729f311efd2a426ce5161df3e017a16"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#ab796aea79288b974f63474db650be878">destroyMultiQubit</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, <a class="el" href="structQUESTEnv.html">QUESTEnv</a> env)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deallocate a <a class="el" href="structMultiQubit.html" title="Represents a system of qubits.">MultiQubit</a> object representing a set of qubits Free memory allocated to state vector of probability amplitudes, including temporary vector for values copied from another chunk if running the distributed version.  <a href="#ab796aea79288b974f63474db650be878"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a96f4de9ce7fefc7680a44d601fc3d894">reportState</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print the current state vector of probability amplitudes for a set of qubits to file.  <a href="#a96f4de9ce7fefc7680a44d601fc3d894"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#aa5e77e0e64f3a4a3d3f5cc7382bffcd9">reportMultiQubitParams</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Report metainformation about a set of qubits: number of qubits, number of probability amplitudes.  <a href="#aa5e77e0e64f3a4a3d3f5cc7382bffcd9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a492d10377278f685c7a1fabc3ee60623">initStateVec</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> *multiQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialise the state vector of probability amplitudes for a set of qubits to the zero state: |000...00&gt;.  <a href="#a492d10377278f685c7a1fabc3ee60623"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a652d8c53f8f1cfb096133791de2b219d">initQUESTEnv</a> (<a class="el" href="structQUESTEnv.html">QUESTEnv</a> *env)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize QUEST environment.  <a href="#a652d8c53f8f1cfb096133791de2b219d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#ad7494473d827399d7fd9c327ea3a23e6">closeQUESTEnv</a> (<a class="el" href="structQUESTEnv.html">QUESTEnv</a> env)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Close QUEST environment.  <a href="#ad7494473d827399d7fd9c327ea3a23e6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a83dffc500bf5b4e41dd63ba1ea9422ae">syncQUESTEnv</a> (<a class="el" href="structQUESTEnv.html">QUESTEnv</a> env)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Guarantees that all code up to the given point has been executed on all nodes.  <a href="#a83dffc500bf5b4e41dd63ba1ea9422ae"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#aa5d0566a6ef6519ff7b5241915fbf170">reportQUESTEnv</a> (<a class="el" href="structQUESTEnv.html">QUESTEnv</a> env)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Report information about the QUEST environment.  <a href="#aa5d0566a6ef6519ff7b5241915fbf170"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a2205c8fde15213df52040dc3df233090">calcTotalProbability</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate the probability of being in any state by taking the norm of the entire state vector.  <a href="#a2205c8fde15213df52040dc3df233090"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a4ba468aa69f812efd1f964e10a45ca2f">rotateQubit</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given the angle rotation arguments.  <a href="#a4ba468aa69f812efd1f964e10a45ca2f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#af31016680d01044cee9321d4cae32703">findProbabilityOfZero</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Measure the probability of a specified qubit being in the zero state.  <a href="#af31016680d01044cee9321d4cae32703"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>The QUEST library API and objects. </p>

<p>Definition in file <a class="el" href="qubits_8h_source.html">qubits.h</a>.</p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a2205c8fde15213df52040dc3df233090"></a><!-- doxytag: member="qubits.h::calcTotalProbability" ref="a2205c8fde15213df52040dc3df233090" args="(MultiQubit multiQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calcTotalProbability </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate the probability of being in any state by taking the norm of the entire state vector. </p>
<p>Should be equal to 1. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing a set of qubits </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>total probability </dd></dl>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00037">37</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>References <a class="el" href="qubits_8c_source.html#l00011">DEBUG</a>, <a class="el" href="qubits_8h_source.html#l00012">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00036">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00040">MultiQubit::numChunks</a>, <a class="el" href="qubits_8h_source.html#l00011">ComplexArray::real</a>, and <a class="el" href="qubits_8h_source.html#l00029">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="basicTemplate_8c_source.html#l00030">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00037"></a>00037                                                   {
<a name="l00038"></a>00038         <span class="keywordtype">double</span> pTotal=0; 
<a name="l00039"></a>00039         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00040"></a>00040         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmpsPerRank = multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00041"></a>00041         <span class="keywordflow">for</span> (index=0; index&lt;numAmpsPerRank; index++){ 
<a name="l00042"></a>00042                 pTotal+=multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a1cf9fd31d6dce5ef618d2bcf3e4f8b69">real</a>[index]*multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a1cf9fd31d6dce5ef618d2bcf3e4f8b69">real</a>[index];      
<a name="l00043"></a>00043                 pTotal+=multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#aa409fd14e1ff3e1fdcc53cc4eb77a7a8">imag</a>[index]*multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#aa409fd14e1ff3e1fdcc53cc4eb77a7a8">imag</a>[index];      
<a name="l00044"></a>00044         } 
<a name="l00045"></a>00045         <span class="keywordflow">return</span> pTotal;
<a name="l00046"></a>00046 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad7494473d827399d7fd9c327ea3a23e6"></a><!-- doxytag: member="qubits.h::closeQUESTEnv" ref="ad7494473d827399d7fd9c327ea3a23e6" args="(QUESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void closeQUESTEnv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQUESTEnv.html">QUESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Close QUEST environment. </p>
<p>If something needs to be done to clean up the execution environment, such as finalizing MPI when running in distributed mode, it is handled here </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00021">21</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>Referenced by <a class="el" href="basicTemplate_8c_source.html#l00030">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00021"></a>00021                                 {
<a name="l00022"></a>00022         <span class="comment">// MPI finalize goes here in MPI version. Call this function anyway for consistency</span>
<a name="l00023"></a>00023 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae729f311efd2a426ce5161df3e017a16"></a><!-- doxytag: member="qubits.h::createMultiQubit" ref="ae729f311efd2a426ce5161df3e017a16" args="(MultiQubit *multiQubit, int numQubits, QUESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void createMultiQubit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a> *&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQUESTEnv.html">QUESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create a <a class="el" href="structMultiQubit.html" title="Represents a system of qubits.">MultiQubit</a> object representing a set of qubits. </p>
<p>Allocate space for state vector of probability amplitudes, including space for temporary values to be copied from one other chunk if running the distributed version. Define properties related to the size of the set of qubits. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>numQubits</em>&nbsp;</td><td>number of qubits in the system </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment (local, multinode etc) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00024">24</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00012">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00036">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00040">MultiQubit::numChunks</a>, <a class="el" href="qubits_8h_source.html#l00033">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00049">QUESTEnv::numRanks</a>, <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::pairStateVec</a>, <a class="el" href="qubits_8h_source.html#l00048">QUESTEnv::rank</a>, <a class="el" href="qubits_8h_source.html#l00011">ComplexArray::real</a>, and <a class="el" href="qubits_8h_source.html#l00029">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="basicTemplate_8c_source.html#l00030">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00025"></a>00025 {
<a name="l00026"></a>00026         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = 1L &lt;&lt; numQubits;
<a name="l00027"></a>00027         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmpsPerRank = numAmps/env.<a class="code" href="structQUESTEnv.html#ab9d9ce82e2d5f1b39aa9efc3accb3742">numRanks</a>;
<a name="l00028"></a>00028 
<a name="l00029"></a>00029         multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a1cf9fd31d6dce5ef618d2bcf3e4f8b69">real</a> = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a1cf9fd31d6dce5ef618d2bcf3e4f8b69">real</a>));
<a name="l00030"></a>00030         multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#aa409fd14e1ff3e1fdcc53cc4eb77a7a8">imag</a> = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#aa409fd14e1ff3e1fdcc53cc4eb77a7a8">imag</a>));
<a name="l00031"></a>00031         <span class="keywordflow">if</span> (env.<a class="code" href="structQUESTEnv.html#ab9d9ce82e2d5f1b39aa9efc3accb3742">numRanks</a>&gt;1){
<a name="l00032"></a>00032                 multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a1cf9fd31d6dce5ef618d2bcf3e4f8b69">real</a> = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a1cf9fd31d6dce5ef618d2bcf3e4f8b69">real</a>));
<a name="l00033"></a>00033                 multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#aa409fd14e1ff3e1fdcc53cc4eb77a7a8">imag</a> = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#aa409fd14e1ff3e1fdcc53cc4eb77a7a8">imag</a>));
<a name="l00034"></a>00034         }
<a name="l00035"></a>00035 
<a name="l00036"></a>00036         <span class="keywordflow">if</span> ( (!(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a1cf9fd31d6dce5ef618d2bcf3e4f8b69">real</a>) || !(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#aa409fd14e1ff3e1fdcc53cc4eb77a7a8">imag</a>))
<a name="l00037"></a>00037                  &amp;&amp; numAmpsPerRank ) {
<a name="l00038"></a>00038                 printf(<span class="stringliteral">&quot;Could not allocate memory!&quot;</span>);
<a name="l00039"></a>00039                 exit (EXIT_FAILURE);
<a name="l00040"></a>00040         }
<a name="l00041"></a>00041 
<a name="l00042"></a>00042         <span class="keywordflow">if</span> ( env.<a class="code" href="structQUESTEnv.html#ab9d9ce82e2d5f1b39aa9efc3accb3742">numRanks</a>&gt;1 &amp;&amp; (!(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a1cf9fd31d6dce5ef618d2bcf3e4f8b69">real</a>) || !(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#aa409fd14e1ff3e1fdcc53cc4eb77a7a8">imag</a>))
<a name="l00043"></a>00043                  &amp;&amp; numAmpsPerRank ) {
<a name="l00044"></a>00044                 printf(<span class="stringliteral">&quot;Could not allocate memory!&quot;</span>);
<a name="l00045"></a>00045                 exit (EXIT_FAILURE);
<a name="l00046"></a>00046         }
<a name="l00047"></a>00047 
<a name="l00048"></a>00048         multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a> = numQubits;
<a name="l00049"></a>00049         multiQubit-&gt;<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a> = numAmpsPerRank;
<a name="l00050"></a>00050         multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a> = env.<a class="code" href="structQUESTEnv.html#a1bdb6d425a2ce6a468f93929c0b26d73">rank</a>;
<a name="l00051"></a>00051         multiQubit-&gt;<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a> = env.<a class="code" href="structQUESTEnv.html#ab9d9ce82e2d5f1b39aa9efc3accb3742">numRanks</a>;
<a name="l00052"></a>00052 
<a name="l00053"></a>00053 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab796aea79288b974f63474db650be878"></a><!-- doxytag: member="qubits.h::destroyMultiQubit" ref="ab796aea79288b974f63474db650be878" args="(MultiQubit multiQubit, QUESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void destroyMultiQubit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQUESTEnv.html">QUESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deallocate a <a class="el" href="structMultiQubit.html" title="Represents a system of qubits.">MultiQubit</a> object representing a set of qubits Free memory allocated to state vector of probability amplitudes, including temporary vector for values copied from another chunk if running the distributed version. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object to be deallocated </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment (local, multinode etc) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00060">60</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00012">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">QUESTEnv::numRanks</a>, <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::pairStateVec</a>, <a class="el" href="qubits_8h_source.html#l00011">ComplexArray::real</a>, and <a class="el" href="qubits_8h_source.html#l00029">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="basicTemplate_8c_source.html#l00030">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00060"></a>00060                                                            {
<a name="l00061"></a>00061         free(multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a1cf9fd31d6dce5ef618d2bcf3e4f8b69">real</a>);
<a name="l00062"></a>00062         free(multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#aa409fd14e1ff3e1fdcc53cc4eb77a7a8">imag</a>);
<a name="l00063"></a>00063         <span class="keywordflow">if</span> (env.<a class="code" href="structQUESTEnv.html#ab9d9ce82e2d5f1b39aa9efc3accb3742">numRanks</a>&gt;1){
<a name="l00064"></a>00064                 free(multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a1cf9fd31d6dce5ef618d2bcf3e4f8b69">real</a>);
<a name="l00065"></a>00065                 free(multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#aa409fd14e1ff3e1fdcc53cc4eb77a7a8">imag</a>);
<a name="l00066"></a>00066         }
<a name="l00067"></a>00067 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af31016680d01044cee9321d4cae32703"></a><!-- doxytag: member="qubits.h::findProbabilityOfZero" ref="af31016680d01044cee9321d4cae32703" args="(MultiQubit multiQubit, const int measureQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double findProbabilityOfZero </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Measure the probability of a specified qubit being in the zero state. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits to be initialised </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>probability of qubit measureQubit being zero </dd></dl>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00055">55</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l00429">findProbabilityOfZeroDistributed()</a>, <a class="el" href="qubits_8c_source.html#l00340">findProbabilityOfZeroLocal()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00169">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00075">isChunkToSkipInFindPZero()</a>, and <a class="el" href="qubits_8h_source.html#l00036">MultiQubit::numAmps</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00057"></a>00057 {
<a name="l00058"></a>00058         <span class="keywordtype">double</span> stateProb=0;
<a name="l00059"></a>00059         stateProb = <a class="code" href="qubits_8c.html#a1c0a25823add0bd9f925a9164dc21870" title="Measure the probability of a specified qubit being in the zero state.">findProbabilityOfZeroLocal</a>(multiQubit, measureQubit);
<a name="l00060"></a>00060         <span class="keywordflow">return</span> stateProb;
<a name="l00061"></a>00061 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a652d8c53f8f1cfb096133791de2b219d"></a><!-- doxytag: member="qubits.h::initQUESTEnv" ref="a652d8c53f8f1cfb096133791de2b219d" args="(QUESTEnv *env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initQUESTEnv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQUESTEnv.html">QUESTEnv</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize QUEST environment. </p>
<p>If something needs to be done to set up the execution environment, such as initializing MPI when running in distributed mode, it is handled here </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00011">11</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>References <a class="el" href="qubits_8c_source.html#l00011">DEBUG</a>, <a class="el" href="qubits_8h_source.html#l00049">QUESTEnv::numRanks</a>, and <a class="el" href="qubits_8h_source.html#l00048">QUESTEnv::rank</a>.</p>

<p>Referenced by <a class="el" href="basicTemplate_8c_source.html#l00030">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00011"></a>00011                                 {
<a name="l00012"></a>00012         <span class="comment">// init MPI environment</span>
<a name="l00013"></a>00013         env-&gt;<a class="code" href="structQUESTEnv.html#a1bdb6d425a2ce6a468f93929c0b26d73">rank</a>=0;
<a name="l00014"></a>00014         env-&gt;<a class="code" href="structQUESTEnv.html#ab9d9ce82e2d5f1b39aa9efc3accb3742">numRanks</a>=1;
<a name="l00015"></a>00015 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a492d10377278f685c7a1fabc3ee60623"></a><!-- doxytag: member="qubits.h::initStateVec" ref="a492d10377278f685c7a1fabc3ee60623" args="(MultiQubit *multiQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initStateVec </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a> *&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialise the state vector of probability amplitudes for a set of qubits to the zero state: |000...00&gt;. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits to be initialised </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00122">122</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l00011">DEBUG</a>, <a class="el" href="qubits_8h_source.html#l00012">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00036">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00011">ComplexArray::real</a>, and <a class="el" href="qubits_8h_source.html#l00029">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="basicTemplate_8c_source.html#l00030">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00123"></a>00123 {
<a name="l00124"></a>00124         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l00125"></a>00125         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00126"></a>00126 
<a name="l00127"></a>00127         <span class="comment">// dimension of the state vector</span>
<a name="l00128"></a>00128         stateVecSize = multiQubit-&gt;<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00129"></a>00129 
<a name="l00130"></a>00130         <span class="comment">// Can&apos;t use multiQubit-&gt;stateVec as a private OMP var</span>
<a name="l00131"></a>00131         <span class="keywordtype">double</span> *stateVecReal = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a1cf9fd31d6dce5ef618d2bcf3e4f8b69">real</a>;
<a name="l00132"></a>00132         <span class="keywordtype">double</span> *stateVecImag = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#aa409fd14e1ff3e1fdcc53cc4eb77a7a8">imag</a>;
<a name="l00133"></a>00133 
<a name="l00134"></a>00134         <span class="comment">// initialise the state to |0000..0000&gt;</span>
<a name="l00135"></a>00135 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00136"></a>00136 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00137"></a>00137 <span class="preprocessor">        default  (none) \</span>
<a name="l00138"></a>00138 <span class="preprocessor">        shared   (stateVecSize, stateVecReal, stateVecImag) \</span>
<a name="l00139"></a>00139 <span class="preprocessor">        private  (index) </span>
<a name="l00140"></a>00140 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00141"></a>00141 <span class="preprocessor"></span>        {
<a name="l00142"></a>00142 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00143"></a>00143 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00144"></a>00144 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00145"></a>00145 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l00146"></a>00146                         stateVecReal[index] = 0.0;
<a name="l00147"></a>00147                         stateVecImag[index] = 0.0;
<a name="l00148"></a>00148                 }
<a name="l00149"></a>00149         }
<a name="l00150"></a>00150 
<a name="l00151"></a>00151         <span class="keywordflow">if</span> (multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>==0){
<a name="l00152"></a>00152                 <span class="comment">// zero state |0000..0000&gt; has probability 1</span>
<a name="l00153"></a>00153                 stateVecReal[0] = 1.0;
<a name="l00154"></a>00154                 stateVecImag[0] = 0.0;
<a name="l00155"></a>00155         }
<a name="l00156"></a>00156 
<a name="l00157"></a>00157         <span class="keywordflow">if</span> (<a class="code" href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>) printf(<span class="stringliteral">&quot;COMPLETED INIT\n&quot;</span>);
<a name="l00158"></a>00158 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa5e77e0e64f3a4a3d3f5cc7382bffcd9"></a><!-- doxytag: member="qubits.h::reportMultiQubitParams" ref="aa5e77e0e64f3a4a3d3f5cc7382bffcd9" args="(MultiQubit multiQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportMultiQubitParams </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Report metainformation about a set of qubits: number of qubits, number of probability amplitudes. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment (local, multinode etc) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00107">107</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00040">MultiQubit::numChunks</a>, and <a class="el" href="qubits_8h_source.html#l00033">MultiQubit::numQubits</a>.</p>

<p>Referenced by <a class="el" href="basicTemplate_8c_source.html#l00030">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00107"></a>00107                                                   {
<a name="l00108"></a>00108         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = 1L &lt;&lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>;
<a name="l00109"></a>00109         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmpsPerRank = numAmps/multiQubit.<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>;
<a name="l00110"></a>00110         <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>==0){
<a name="l00111"></a>00111                 printf(<span class="stringliteral">&quot;QUBITS:\n&quot;</span>);
<a name="l00112"></a>00112                 printf(<span class="stringliteral">&quot;Number of qubits is %d.\n&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>);
<a name="l00113"></a>00113                 printf(<span class="stringliteral">&quot;Number of amps is %lld.\n&quot;</span>, numAmps);
<a name="l00114"></a>00114                 printf(<span class="stringliteral">&quot;Number of amps per rank is %lld.\n&quot;</span>, numAmpsPerRank);
<a name="l00115"></a>00115         }
<a name="l00116"></a>00116 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa5d0566a6ef6519ff7b5241915fbf170"></a><!-- doxytag: member="qubits.h::reportQUESTEnv" ref="aa5d0566a6ef6519ff7b5241915fbf170" args="(QUESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportQUESTEnv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQUESTEnv.html">QUESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Report information about the QUEST environment. </p>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00025">25</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00049">QUESTEnv::numRanks</a>, and <a class="el" href="qubits_8h_source.html#l00048">QUESTEnv::rank</a>.</p>

<p>Referenced by <a class="el" href="basicTemplate_8c_source.html#l00030">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00025"></a>00025                                  {
<a name="l00026"></a>00026         printf(<span class="stringliteral">&quot;EXECUTION ENVIRONMENT:\n&quot;</span>);
<a name="l00027"></a>00027         printf(<span class="stringliteral">&quot;Running locally on one node\n&quot;</span>);
<a name="l00028"></a>00028         printf(<span class="stringliteral">&quot;Number of ranks is %d\n&quot;</span>, env.<a class="code" href="structQUESTEnv.html#ab9d9ce82e2d5f1b39aa9efc3accb3742">numRanks</a>);
<a name="l00029"></a>00029 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span>        printf(<span class="stringliteral">&quot;OpenMP enabled\n&quot;</span>);
<a name="l00031"></a>00031         printf(<span class="stringliteral">&quot;Number of threads available is %d\n&quot;</span>, omp_get_max_threads());
<a name="l00032"></a>00032 <span class="preprocessor"># else</span>
<a name="l00033"></a>00033 <span class="preprocessor"></span>        printf(<span class="stringliteral">&quot;OpenMP disabled\n&quot;</span>);
<a name="l00034"></a>00034 <span class="preprocessor"># endif</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span>}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a96f4de9ce7fefc7680a44d601fc3d894"></a><!-- doxytag: member="qubits.h::reportState" ref="a96f4de9ce7fefc7680a44d601fc3d894" args="(MultiQubit multiQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Print the current state vector of probability amplitudes for a set of qubits to file. </p>
<p>File format: </p>
<div class="fragment"><pre class="fragment">
real, imag
realComponent1, imagComponent1
realComponent2, imagComponent2
...
realComponentN, imagComponentN
</pre></div><p>File naming convention:</p>
<p>For each node that the program runs on, a file 'state_rank_[node_rank].csv' is generated. If there is more than one node, ranks after the first do not include the header </p>
<div class="fragment"><pre class="fragment">
real, imag
</pre></div><p> so that files are easier to combine. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00089">89</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00012">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00036">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00011">ComplexArray::real</a>, and <a class="el" href="qubits_8h_source.html#l00029">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="basicTemplate_8c_source.html#l00030">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00089"></a>00089                                        {
<a name="l00090"></a>00090         FILE *state;
<a name="l00091"></a>00091         <span class="keywordtype">char</span> filename[100];
<a name="l00092"></a>00092         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00093"></a>00093         sprintf(filename, <span class="stringliteral">&quot;state_rank_%d.csv&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>);
<a name="l00094"></a>00094         state = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>);
<a name="l00095"></a>00095         <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>==0) fprintf(state, <span class="stringliteral">&quot;real, imag\n&quot;</span>);
<a name="l00096"></a>00096 
<a name="l00097"></a>00097         <span class="keywordflow">for</span>(index=0; index&lt;multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>; index++){
<a name="l00098"></a>00098                 fprintf(state, <span class="stringliteral">&quot;%.12f, %.12f\n&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a1cf9fd31d6dce5ef618d2bcf3e4f8b69">real</a>[index], multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#aa409fd14e1ff3e1fdcc53cc4eb77a7a8">imag</a>[index]);
<a name="l00099"></a>00099         }
<a name="l00100"></a>00100         fclose(state);
<a name="l00101"></a>00101 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4ba468aa69f812efd1f964e10a45ca2f"></a><!-- doxytag: member="qubits.h::rotateQubit" ref="a4ba468aa69f812efd1f964e10a45ca2f" args="(MultiQubit multiQubit, const int rotQubit, Complex alpha, Complex beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotateQubit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given the angle rotation arguments. </p>
<p>alphaRe = cos(angle1) * cos(angle2) <br/>
 alphaIm = cos(angle1) * sin(angle2) <br/>
 betaRe = sin(angle1) * cos(angle3) <br/>
 betaIm = sin(angle1) * sin(angle3) <br/>
</p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits to be initialised </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rotQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>alpha</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>beta</em>&nbsp;</td><td>rotation angle </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00048">48</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00108">chunkIsUpper()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00150">getChunkPairId()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00129">getRotAngle()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00169">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits_8h_source.html#l00012">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00036">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::pairStateVec</a>, <a class="el" href="qubits_8h_source.html#l00011">ComplexArray::real</a>, <a class="el" href="qubits_8c_source.html#l00271">rotateQubitDistributed()</a>, <a class="el" href="qubits_8c_source.html#l00174">rotateQubitLocal()</a>, and <a class="el" href="qubits_8h_source.html#l00029">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="basicTemplate_8c_source.html#l00030">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00050"></a>00050 {
<a name="l00051"></a>00051         <span class="comment">// all values required to update state vector lie in this rank</span>
<a name="l00052"></a>00052         <a class="code" href="qubits_8c.html#acb059cbcb8c7910a5fc43d21da4f5dea" title="Rotate a single qubit in the state vector of probability amplitudes, given the angle...">rotateQubitLocal</a>(multiQubit, rotQubit, alpha, beta);
<a name="l00053"></a>00053 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a83dffc500bf5b4e41dd63ba1ea9422ae"></a><!-- doxytag: member="qubits.h::syncQUESTEnv" ref="a83dffc500bf5b4e41dd63ba1ea9422ae" args="(QUESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void syncQUESTEnv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQUESTEnv.html">QUESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Guarantees that all code up to the given point has been executed on all nodes. </p>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00017">17</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00017"></a>00017                                {
<a name="l00018"></a>00018         <span class="comment">// MPI Barrier goes here in MPI version. </span>
<a name="l00019"></a>00019 } 
</pre></div></p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 6 Apr 2017 for Distributed QUEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
