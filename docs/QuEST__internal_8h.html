<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Quantum Exact Simulation Toolkit: QuEST_internal.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Quantum Exact Simulation Toolkit
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_e145b6391efe0b6e575fd5bb5f76dbf8.html">QuEST</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">QuEST_internal.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions used internally, supplied by QuEST_common or by hardware-specific backends.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="QuEST_8h_source.html">QuEST.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="QuEST__precision_8h_source.html">QuEST_precision.h</a>&quot;</code><br />
</div>
<p><a href="QuEST__internal_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7c14b7f97aac42f390383893e703841f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a7c14b7f97aac42f390383893e703841f">densmatr_addDensityMatrix</a> (<a class="el" href="structQureg.html">Qureg</a> combineQureg, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> otherProb, <a class="el" href="structQureg.html">Qureg</a> otherQureg)</td></tr>
<tr class="separator:a7c14b7f97aac42f390383893e703841f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6c3f86010ad398f42b0577ea3bb5bcf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#aa6c3f86010ad398f42b0577ea3bb5bcf">densmatr_calcFidelity</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structQureg.html">Qureg</a> pureState)</td></tr>
<tr class="separator:aa6c3f86010ad398f42b0577ea3bb5bcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad405e3fac20997043e0236b751e44270"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ad405e3fac20997043e0236b751e44270">densmatr_calcProbOfOutcome</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int measureQubit, int outcome)</td></tr>
<tr class="separator:ad405e3fac20997043e0236b751e44270"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae45eefa65f4ecd37bab84fade7cf7f1f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ae45eefa65f4ecd37bab84fade7cf7f1f">densmatr_calcPurity</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr class="memdesc:ae45eefa65f4ecd37bab84fade7cf7f1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the trace of the density matrix squared.  <a href="#ae45eefa65f4ecd37bab84fade7cf7f1f">More...</a><br /></td></tr>
<tr class="separator:ae45eefa65f4ecd37bab84fade7cf7f1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6153547f245c05874161a105e9a2f02c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a6153547f245c05874161a105e9a2f02c">densmatr_calcTotalProb</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr class="separator:a6153547f245c05874161a105e9a2f02c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab321af37fe3490253e12b7c70b8d2a98"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ab321af37fe3490253e12b7c70b8d2a98">densmatr_collapseToKnownProbOutcome</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int measureQubit, int outcome, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> outcomeProb)</td></tr>
<tr class="memdesc:ab321af37fe3490253e12b7c70b8d2a98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Renorms (/prob) every | * outcome * &gt;&lt; * outcome * | state, setting all others to zero.  <a href="#ab321af37fe3490253e12b7c70b8d2a98">More...</a><br /></td></tr>
<tr class="separator:ab321af37fe3490253e12b7c70b8d2a98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20a155f53efc45c16803d7539c2c199d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a20a155f53efc45c16803d7539c2c199d">densmatr_initClassicalState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int stateInd)</td></tr>
<tr class="separator:a20a155f53efc45c16803d7539c2c199d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2418bd9a6b9e6a0acf11faf5982d5d29"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a2418bd9a6b9e6a0acf11faf5982d5d29">densmatr_initPlusState</a> (<a class="el" href="structQureg.html">Qureg</a> targetQureg)</td></tr>
<tr class="separator:a2418bd9a6b9e6a0acf11faf5982d5d29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5ad68d054875913d0f7ec654840a9ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ae5ad68d054875913d0f7ec654840a9ec">densmatr_initPureState</a> (<a class="el" href="structQureg.html">Qureg</a> targetQureg, <a class="el" href="structQureg.html">Qureg</a> copyQureg)</td></tr>
<tr class="separator:ae5ad68d054875913d0f7ec654840a9ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4ebc1f4dd48922bfb30ad1692310269"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ae4ebc1f4dd48922bfb30ad1692310269">densmatr_measureWithStats</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int measureQubit, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *outcomeProb)</td></tr>
<tr class="separator:ae4ebc1f4dd48922bfb30ad1692310269"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56b32228c24a7c4e1894d991ef4b6b99"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a56b32228c24a7c4e1894d991ef4b6b99">densmatr_oneQubitDephase</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> dephase)</td></tr>
<tr class="separator:a56b32228c24a7c4e1894d991ef4b6b99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5bf84ca607e1484e0ddb5570726848d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ae5bf84ca607e1484e0ddb5570726848d">densmatr_oneQubitDepolarise</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> depolLevel)</td></tr>
<tr class="separator:ae5bf84ca607e1484e0ddb5570726848d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fde996ce8ba014fce542549406813f9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a8fde996ce8ba014fce542549406813f9">densmatr_twoQubitDephase</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int qubit1, const int qubit2, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> dephase)</td></tr>
<tr class="separator:a8fde996ce8ba014fce542549406813f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa500e14a9ed1683f9c056f03f4c24cea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#aa500e14a9ed1683f9c056f03f4c24cea">densmatr_twoQubitDepolarise</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int qubit1, int qubit2, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> depolLevel)</td></tr>
<tr class="separator:aa500e14a9ed1683f9c056f03f4c24cea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8ea84dd85eca525daeeb30b3c96b673"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ac8ea84dd85eca525daeeb30b3c96b673">ensureIndsIncrease</a> (int *ind1, int *ind2)</td></tr>
<tr class="separator:ac8ea84dd85eca525daeeb30b3c96b673"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73300e3cdca56a7615980274905ba097"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a73300e3cdca56a7615980274905ba097">getComplexPairAndPhaseFromUnitary</a> (<a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u, <a class="el" href="structComplex.html">Complex</a> *alpha, <a class="el" href="structComplex.html">Complex</a> *beta, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *globalPhase)</td></tr>
<tr class="memdesc:a73300e3cdca56a7615980274905ba097"><td class="mdescLeft">&#160;</td><td class="mdescRight">maps U(r0c0, r0c1, r1c0, r1c1) to exp(i globalPhase) U(alpha, beta)  <a href="#a73300e3cdca56a7615980274905ba097">More...</a><br /></td></tr>
<tr class="separator:a73300e3cdca56a7615980274905ba097"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71b3ae4402c1c5039d3086ca0e47a522"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a71b3ae4402c1c5039d3086ca0e47a522">getComplexPairFromRotation</a> (<a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> angle, <a class="el" href="structVector.html">Vector</a> axis, <a class="el" href="structComplex.html">Complex</a> *alpha, <a class="el" href="structComplex.html">Complex</a> *beta)</td></tr>
<tr class="separator:a71b3ae4402c1c5039d3086ca0e47a522"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac711ba2f44edc3f4f286ba9e9a7d6288"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ac711ba2f44edc3f4f286ba9e9a7d6288">getConjugateMatrix</a> (<a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> matr)</td></tr>
<tr class="separator:ac711ba2f44edc3f4f286ba9e9a7d6288"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af92fa737f4491324408b3d15543dced4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structComplex.html">Complex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#af92fa737f4491324408b3d15543dced4">getConjugateScalar</a> (<a class="el" href="structComplex.html">Complex</a> scalar)</td></tr>
<tr class="separator:af92fa737f4491324408b3d15543dced4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cf54148e2162b04aeb634badb90826c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a3cf54148e2162b04aeb634badb90826c">getVectorMagnitude</a> (<a class="el" href="structVector.html">Vector</a> vec)</td></tr>
<tr class="separator:a3cf54148e2162b04aeb634badb90826c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a404d177b894ce008289e44a599ad77d6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a404d177b894ce008289e44a599ad77d6">getZYZRotAnglesFromComplexPair</a> (<a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *rz2, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *ry, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *rz1)</td></tr>
<tr class="memdesc:a404d177b894ce008289e44a599ad77d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">maps U(alpha, beta) to Rz(rz2) Ry(ry) Rz(rz1)  <a href="#a404d177b894ce008289e44a599ad77d6">More...</a><br /></td></tr>
<tr class="separator:a404d177b894ce008289e44a599ad77d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab76254cfde16f0808476649507a1a2fc"><td class="memItemLeft" align="right" valign="top">unsigned long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ab76254cfde16f0808476649507a1a2fc">hashString</a> (char *str)</td></tr>
<tr class="separator:ab76254cfde16f0808476649507a1a2fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf1c651a4359a370a2d9b3e1e1ebd430"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#acf1c651a4359a370a2d9b3e1e1ebd430">shiftIndices</a> (int *indices, int numIndices, int shift)</td></tr>
<tr class="separator:acf1c651a4359a370a2d9b3e1e1ebd430"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeeec9fe1501e25930adf6c38763a158e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#aeeec9fe1501e25930adf6c38763a158e">statevec_calcFidelity</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structQureg.html">Qureg</a> pureState)</td></tr>
<tr class="separator:aeeec9fe1501e25930adf6c38763a158e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ebd3198a198f4cd20840f64fd8b84d0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structComplex.html">Complex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a7ebd3198a198f4cd20840f64fd8b84d0">statevec_calcInnerProduct</a> (<a class="el" href="structQureg.html">Qureg</a> bra, <a class="el" href="structQureg.html">Qureg</a> ket)</td></tr>
<tr class="memdesc:a7ebd3198a198f4cd20840f64fd8b84d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Terrible code which unnecessarily individually computes and sums the real and imaginary components of the inner product, so as to not have to worry about keeping the sums separated during reduction.  <a href="#a7ebd3198a198f4cd20840f64fd8b84d0">More...</a><br /></td></tr>
<tr class="separator:a7ebd3198a198f4cd20840f64fd8b84d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab33cdf01831c4545e51299178acf7f27"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ab33cdf01831c4545e51299178acf7f27">statevec_calcProbOfOutcome</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int measureQubit, int outcome)</td></tr>
<tr class="separator:ab33cdf01831c4545e51299178acf7f27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad65ad1b5ea6f30b0c6b4ffda96e1a8e6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ad65ad1b5ea6f30b0c6b4ffda96e1a8e6">statevec_calcTotalProb</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr class="separator:ad65ad1b5ea6f30b0c6b4ffda96e1a8e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4b77089145184d990848cd66993aa8b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#aa4b77089145184d990848cd66993aa8b">statevec_cloneQureg</a> (<a class="el" href="structQureg.html">Qureg</a> targetQureg, <a class="el" href="structQureg.html">Qureg</a> copyQureg)</td></tr>
<tr class="memdesc:aa4b77089145184d990848cd66993aa8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">works for both statevectors and density matrices  <a href="#aa4b77089145184d990848cd66993aa8b">More...</a><br /></td></tr>
<tr class="separator:aa4b77089145184d990848cd66993aa8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7f25bb40734e18a992403b17355893b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ae7f25bb40734e18a992403b17355893b">statevec_collapseToKnownProbOutcome</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int measureQubit, int outcome, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> outcomeProb)</td></tr>
<tr class="separator:ae7f25bb40734e18a992403b17355893b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94ee4df9faba286ad7a5bc829ef5174d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a94ee4df9faba286ad7a5bc829ef5174d">statevec_compactUnitary</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr class="separator:a94ee4df9faba286ad7a5bc829ef5174d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6cecbad32a03416138b321cdc1a2c33"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ae6cecbad32a03416138b321cdc1a2c33">statevec_compareStates</a> (<a class="el" href="structQureg.html">Qureg</a> mq1, <a class="el" href="structQureg.html">Qureg</a> mq2, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> precision)</td></tr>
<tr class="separator:ae6cecbad32a03416138b321cdc1a2c33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47b467a5445c7f15d1a8b0b2ec0ef2de"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a47b467a5445c7f15d1a8b0b2ec0ef2de">statevec_controlledCompactUnitary</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr class="separator:a47b467a5445c7f15d1a8b0b2ec0ef2de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a114038296eb404b9b8a66aaad7b48800"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a114038296eb404b9b8a66aaad7b48800">statevec_controlledNot</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit)</td></tr>
<tr class="separator:a114038296eb404b9b8a66aaad7b48800"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a708246b16236c492094c2633da0c08ff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a708246b16236c492094c2633da0c08ff">statevec_controlledPauliY</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit)</td></tr>
<tr class="separator:a708246b16236c492094c2633da0c08ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e647339720bf82b30c6331fad544ec5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a9e647339720bf82b30c6331fad544ec5">statevec_controlledPauliYConj</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit)</td></tr>
<tr class="separator:a9e647339720bf82b30c6331fad544ec5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c0067cb9f243ead20de7392aea328bc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a7c0067cb9f243ead20de7392aea328bc">statevec_controlledPhaseFlip</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int idQubit1, const int idQubit2)</td></tr>
<tr class="separator:a7c0067cb9f243ead20de7392aea328bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adeb715f3f2c167f9bfbe92b75f5988ce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#adeb715f3f2c167f9bfbe92b75f5988ce">statevec_controlledPhaseShift</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int idQubit1, const int idQubit2, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> angle)</td></tr>
<tr class="separator:adeb715f3f2c167f9bfbe92b75f5988ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c489375aad6fb71203553c60bff043b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a2c489375aad6fb71203553c60bff043b">statevec_controlledRotateAroundAxis</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> angle, <a class="el" href="structVector.html">Vector</a> axis)</td></tr>
<tr class="separator:a2c489375aad6fb71203553c60bff043b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb4ddeb09a3c0fa39ac33984bd5ca0ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#aeb4ddeb09a3c0fa39ac33984bd5ca0ea">statevec_controlledRotateAroundAxisConj</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> angle, <a class="el" href="structVector.html">Vector</a> axis)</td></tr>
<tr class="separator:aeb4ddeb09a3c0fa39ac33984bd5ca0ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af59bc61f97d42cdceaf7fc0257a387d6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#af59bc61f97d42cdceaf7fc0257a387d6">statevec_controlledRotateX</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> angle)</td></tr>
<tr class="separator:af59bc61f97d42cdceaf7fc0257a387d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2dc0754043172e0449c78569d27fd4a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ad2dc0754043172e0449c78569d27fd4a">statevec_controlledRotateY</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> angle)</td></tr>
<tr class="separator:ad2dc0754043172e0449c78569d27fd4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06bffb653fa42a67254d034b6cce6d7d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a06bffb653fa42a67254d034b6cce6d7d">statevec_controlledRotateZ</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> angle)</td></tr>
<tr class="separator:a06bffb653fa42a67254d034b6cce6d7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2600999a19c817bfcf7ca14779e33b9a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a2600999a19c817bfcf7ca14779e33b9a">statevec_controlledUnitary</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr class="separator:a2600999a19c817bfcf7ca14779e33b9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a365bbb1b80cb00405c8bf1a4fa1ea8e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a365bbb1b80cb00405c8bf1a4fa1ea8e5">statevec_createQureg</a> (<a class="el" href="structQureg.html">Qureg</a> *qureg, int numQubits, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr class="separator:a365bbb1b80cb00405c8bf1a4fa1ea8e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a52ad9f9ad9b2fd6a76f6d433b3b217"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a2a52ad9f9ad9b2fd6a76f6d433b3b217">statevec_destroyQureg</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr class="separator:a2a52ad9f9ad9b2fd6a76f6d433b3b217"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd509244d57657e148e4084c5ab5d28f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#abd509244d57657e148e4084c5ab5d28f">statevec_getImagAmp</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int index)</td></tr>
<tr class="separator:abd509244d57657e148e4084c5ab5d28f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3afe58e49dce5536bc4c1b7caddf44a6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a3afe58e49dce5536bc4c1b7caddf44a6">statevec_getProbAmp</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int index)</td></tr>
<tr class="separator:a3afe58e49dce5536bc4c1b7caddf44a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc9a9ef4344c7faaaf28ac25c76649b9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#abc9a9ef4344c7faaaf28ac25c76649b9">statevec_getRealAmp</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int index)</td></tr>
<tr class="separator:abc9a9ef4344c7faaaf28ac25c76649b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9226f386d010aaa85efc0e8889d341d5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a9226f386d010aaa85efc0e8889d341d5">statevec_hadamard</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit)</td></tr>
<tr class="separator:a9226f386d010aaa85efc0e8889d341d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a288dc4b46bdacd69cbf4a6fd070d26a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a288dc4b46bdacd69cbf4a6fd070d26a7">statevec_initClassicalState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int stateInd)</td></tr>
<tr class="separator:a288dc4b46bdacd69cbf4a6fd070d26a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a482fc361fd5f08075404c72e536316a0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a482fc361fd5f08075404c72e536316a0">statevec_initPlusState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr class="separator:a482fc361fd5f08075404c72e536316a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38445cdb2a18671a7c73112ce3337acb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a38445cdb2a18671a7c73112ce3337acb">statevec_initStateDebug</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr class="memdesc:a38445cdb2a18671a7c73112ce3337acb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the state vector of probability amplitudes to an (unphysical) state with each component of each probability amplitude a unique floating point value.  <a href="#a38445cdb2a18671a7c73112ce3337acb">More...</a><br /></td></tr>
<tr class="separator:a38445cdb2a18671a7c73112ce3337acb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05756b45f10135bb2eeb07380f806c20"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a05756b45f10135bb2eeb07380f806c20">statevec_initStateFromSingleFile</a> (<a class="el" href="structQureg.html">Qureg</a> *qureg, char filename[200], <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr class="separator:a05756b45f10135bb2eeb07380f806c20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a923906770cac0da9e3459bae58de9e64"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a923906770cac0da9e3459bae58de9e64">statevec_initStateOfSingleQubit</a> (<a class="el" href="structQureg.html">Qureg</a> *qureg, int qubitId, int outcome)</td></tr>
<tr class="memdesc:a923906770cac0da9e3459bae58de9e64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the state vector of probability amplitudes such that one qubit is set to 'outcome' and all other qubits are in an equal superposition of zero and one.  <a href="#a923906770cac0da9e3459bae58de9e64">More...</a><br /></td></tr>
<tr class="separator:a923906770cac0da9e3459bae58de9e64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ca0c6ba07ab2b4b437321bf17efc966"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a2ca0c6ba07ab2b4b437321bf17efc966">statevec_initZeroState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr class="separator:a2ca0c6ba07ab2b4b437321bf17efc966"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2eb81c71d0e0fbec7be5b45b1db1448"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ac2eb81c71d0e0fbec7be5b45b1db1448">statevec_measureWithStats</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int measureQubit, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *outcomeProb)</td></tr>
<tr class="separator:ac2eb81c71d0e0fbec7be5b45b1db1448"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4ee5979d475e8c729294b8ef7e0270d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ac4ee5979d475e8c729294b8ef7e0270d">statevec_multiControlledPhaseFlip</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int *controlQubits, int numControlQubits)</td></tr>
<tr class="separator:ac4ee5979d475e8c729294b8ef7e0270d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa662796ea6e0f471143c53becae8c12c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#aa662796ea6e0f471143c53becae8c12c">statevec_multiControlledPhaseShift</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int *controlQubits, int numControlQubits, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> angle)</td></tr>
<tr class="separator:aa662796ea6e0f471143c53becae8c12c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cc288d53df484516cde923c8a3b561a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a2cc288d53df484516cde923c8a3b561a">statevec_multiControlledUnitary</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int *controlQubits, const int numControlQubits, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr class="separator:a2cc288d53df484516cde923c8a3b561a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdb6e0ee1e407755e1b944086cedd90e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#abdb6e0ee1e407755e1b944086cedd90e">statevec_pauliX</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit)</td></tr>
<tr class="separator:abdb6e0ee1e407755e1b944086cedd90e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73b56fbac6e464a37805fa9d9657a8f9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a73b56fbac6e464a37805fa9d9657a8f9">statevec_pauliY</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit)</td></tr>
<tr class="separator:a73b56fbac6e464a37805fa9d9657a8f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee97816cfabeea7874cd837a8d105412"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#aee97816cfabeea7874cd837a8d105412">statevec_pauliYConj</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit)</td></tr>
<tr class="separator:aee97816cfabeea7874cd837a8d105412"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad711cac41adb0fea1ad4797ce14953e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ad711cac41adb0fea1ad4797ce14953e0">statevec_pauliZ</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit)</td></tr>
<tr class="separator:ad711cac41adb0fea1ad4797ce14953e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37bcd16fc0bbc8e665585ba9b99f382b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a37bcd16fc0bbc8e665585ba9b99f382b">statevec_phaseShift</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> angle)</td></tr>
<tr class="separator:a37bcd16fc0bbc8e665585ba9b99f382b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8972669148af60d7e1c09687f69673d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a8972669148af60d7e1c09687f69673d4">statevec_phaseShiftByTerm</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> term)</td></tr>
<tr class="separator:a8972669148af60d7e1c09687f69673d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e57230c7995447039e62a84c0a36524"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a1e57230c7995447039e62a84c0a36524">statevec_reportStateToScreen</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env, int reportRank)</td></tr>
<tr class="memdesc:a1e57230c7995447039e62a84c0a36524"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the current state vector of probability amplitudes for a set of qubits to standard out.  <a href="#a1e57230c7995447039e62a84c0a36524">More...</a><br /></td></tr>
<tr class="separator:a1e57230c7995447039e62a84c0a36524"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65b9087ca37c096caa5c6e8586b67946"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a65b9087ca37c096caa5c6e8586b67946">statevec_rotateAroundAxis</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int rotQubit, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> angle, <a class="el" href="structVector.html">Vector</a> axis)</td></tr>
<tr class="separator:a65b9087ca37c096caa5c6e8586b67946"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9839c40de8df0cecc72a0258a20d979"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#af9839c40de8df0cecc72a0258a20d979">statevec_rotateAroundAxisConj</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int rotQubit, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> angle, <a class="el" href="structVector.html">Vector</a> axis)</td></tr>
<tr class="separator:af9839c40de8df0cecc72a0258a20d979"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca123cc22e13a2cb819ef6c2f455b9e4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#aca123cc22e13a2cb819ef6c2f455b9e4">statevec_rotateX</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int rotQubit, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> angle)</td></tr>
<tr class="separator:aca123cc22e13a2cb819ef6c2f455b9e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a62c8c00dc4adf74b982ad8a9049170"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a4a62c8c00dc4adf74b982ad8a9049170">statevec_rotateY</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int rotQubit, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> angle)</td></tr>
<tr class="separator:a4a62c8c00dc4adf74b982ad8a9049170"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab96ee09e32e297629a481c3ba6d7eaf7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ab96ee09e32e297629a481c3ba6d7eaf7">statevec_rotateZ</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int rotQubit, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> angle)</td></tr>
<tr class="separator:ab96ee09e32e297629a481c3ba6d7eaf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa121d55f2ca09c06a96ddcd433c60b0f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#aa121d55f2ca09c06a96ddcd433c60b0f">statevec_setAmps</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int startInd, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *reals, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *imags, long long int numAmps)</td></tr>
<tr class="separator:aa121d55f2ca09c06a96ddcd433c60b0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea5b9ea10791217a793a8040c36e4efc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#aea5b9ea10791217a793a8040c36e4efc">statevec_sGate</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit)</td></tr>
<tr class="separator:aea5b9ea10791217a793a8040c36e4efc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78bfeb90f0c1812e726ec3092056bb52"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a78bfeb90f0c1812e726ec3092056bb52">statevec_sGateConj</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit)</td></tr>
<tr class="separator:a78bfeb90f0c1812e726ec3092056bb52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bd738cb7e7cdea8f1ce1e640d427d4c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a0bd738cb7e7cdea8f1ce1e640d427d4c">statevec_tGate</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit)</td></tr>
<tr class="separator:a0bd738cb7e7cdea8f1ce1e640d427d4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ce1b05fee70d930791513fec378d229"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a3ce1b05fee70d930791513fec378d229">statevec_tGateConj</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit)</td></tr>
<tr class="separator:a3ce1b05fee70d930791513fec378d229"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bea7ed7967083cbabd8a8e5acdd48c0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a4bea7ed7967083cbabd8a8e5acdd48c0">statevec_unitary</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr class="separator:a4bea7ed7967083cbabd8a8e5acdd48c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions used internally, supplied by QuEST_common or by hardware-specific backends. </p>

<p class="definition">Definition in file <a class="el" href="QuEST__internal_8h_source.html">QuEST_internal.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a7c14b7f97aac42f390383893e703841f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c14b7f97aac42f390383893e703841f">&#9670;&nbsp;</a></span>densmatr_addDensityMatrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_addDensityMatrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>combineQureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>otherProb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>otherQureg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00739">739</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00585">addDensityMatrix()</a>.</p>
<div class="fragment"><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                                                                                      {</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    </div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="comment">/* corresponding amplitudes live on the same node (same dimensions) */</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    </div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="comment">// unpack vars for OpenMP</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* combineVecRe = combineQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* combineVecIm = combineQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* otherVecRe = otherQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* otherVecIm = otherQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = combineQureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    </div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="preprocessor">    default (none) \</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="preprocessor">    shared  (combineVecRe,combineVecIm,otherVecRe,otherVecIm, otherProb, numAmps) \</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="preprocessor">    private (index)</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="preprocessor"># endif </span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    {</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="preprocessor"># pragma omp for schedule  (static)</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="keywordflow">for</span> (index=0; index &lt; numAmps; index++) {</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            combineVecRe[index] *= 1-otherProb;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            combineVecIm[index] *= 1-otherProb;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            </div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            combineVecRe[index] += otherProb * otherVecRe[index];</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            combineVecIm[index] += otherProb * otherVecIm[index];</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        }</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    }</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa6c3f86010ad398f42b0577ea3bb5bcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6c3f86010ad398f42b0577ea3bb5bcf">&#9670;&nbsp;</a></span>densmatr_calcFidelity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> densmatr_calcFidelity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>pureState</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00413">413</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__gpu_8cu_source.html#l01353">copySharedReduceBlock()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00379">copyVecIntoMatrixPairState()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00772">densmatr_calcFidelityLocal()</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::firstLevelReduction</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST__gpu_8cu_source.html#l00015">REDUCE_SHARED_SIZE</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::secondLevelReduction</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, and <a class="el" href="QuEST__gpu_8cu_source.html#l01459">swapDouble()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00630">calcFidelity()</a>.</p>
<div class="fragment"><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                                                          {</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    </div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="comment">// set qureg&#39;s pairState is to be the full pureState (on every node)</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <a class="code" href="QuEST__cpu__distributed_8c.html#a95af772d87c461fc8abfd6d47b752ac2">copyVecIntoMatrixPairState</a>(qureg, pureState);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">// collect calcFidelityLocal by every machine</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> localSum = <a class="code" href="QuEST__cpu_8c.html#a7772f97cb4d92a9825bf3b7c82c3230c">densmatr_calcFidelityLocal</a>(qureg, pureState);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    </div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">// sum each localSum</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> globalSum;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    MPI_Allreduce(&amp;localSum, &amp;globalSum, 1, MPI_QuEST_REAL, MPI_SUM, MPI_COMM_WORLD);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    </div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">return</span> globalSum;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;}</div><div class="ttc" id="QuEST__cpu_8c_html_a7772f97cb4d92a9825bf3b7c82c3230c"><div class="ttname"><a href="QuEST__cpu_8c.html#a7772f97cb4d92a9825bf3b7c82c3230c">densmatr_calcFidelityLocal</a></div><div class="ttdeci">qreal densmatr_calcFidelityLocal(Qureg qureg, Qureg pureState)</div><div class="ttdoc">computes a few dens-columns-worth of (vec^*T) dens * vec </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00772">QuEST_cpu.c:772</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a95af772d87c461fc8abfd6d47b752ac2"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a95af772d87c461fc8abfd6d47b752ac2">copyVecIntoMatrixPairState</a></div><div class="ttdeci">void copyVecIntoMatrixPairState(Qureg matr, Qureg vec)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00379">QuEST_cpu_distributed.c:379</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad405e3fac20997043e0236b751e44270"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad405e3fac20997043e0236b751e44270">&#9670;&nbsp;</a></span>densmatr_calcProbOfOutcome()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> densmatr_calcProbOfOutcome </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>outcome</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01231">1231</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__gpu_8cu_source.html#l01466">densmatr_findProbabilityOfZero()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02637">densmatr_findProbabilityOfZeroLocal()</a>, and <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00614">calcProbOfOutcome()</a>, <a class="el" href="QuEST_8c_source.html#l00539">collapseToOutcome()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00320">densmatr_measureWithStats()</a>.</p>
<div class="fragment"><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                                                                                   {</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        </div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> zeroProb = <a class="code" href="QuEST__cpu_8c.html#a101e7ef38c5d654a697dafe14562dcee">densmatr_findProbabilityOfZeroLocal</a>(qureg, measureQubit);</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        </div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> outcomeProb;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        MPI_Allreduce(&amp;zeroProb, &amp;outcomeProb, 1, MPI_QuEST_REAL, MPI_SUM, MPI_COMM_WORLD);</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        <span class="keywordflow">if</span> (outcome == 1)</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                outcomeProb = 1.0 - outcomeProb;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        </div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        <span class="keywordflow">return</span> outcomeProb;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;}</div><div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a101e7ef38c5d654a697dafe14562dcee"><div class="ttname"><a href="QuEST__cpu_8c.html#a101e7ef38c5d654a697dafe14562dcee">densmatr_findProbabilityOfZeroLocal</a></div><div class="ttdeci">qreal densmatr_findProbabilityOfZeroLocal(Qureg qureg, const int measureQubit)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02637">QuEST_cpu.c:2637</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae45eefa65f4ecd37bab84fade7cf7f1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae45eefa65f4ecd37bab84fade7cf7f1f">&#9670;&nbsp;</a></span>densmatr_calcPurity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> densmatr_calcPurity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the trace of the density matrix squared. </p>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01243">1243</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__gpu_8cu_source.html#l01353">copySharedReduceBlock()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00710">densmatr_calcPurityLocal()</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::firstLevelReduction</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST__gpu_8cu_source.html#l00015">REDUCE_SHARED_SIZE</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::secondLevelReduction</a>, and <a class="el" href="QuEST__gpu_8cu_source.html#l01459">swapDouble()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00624">calcPurity()</a>.</p>
<div class="fragment"><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                                       {</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    </div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> localPurity = <a class="code" href="QuEST__cpu_8c.html#af910c7cf2b85bdc2c399cfe8dbfb8b9c">densmatr_calcPurityLocal</a>(qureg);</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        </div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> globalPurity;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    MPI_Allreduce(&amp;localPurity, &amp;globalPurity, 1, MPI_QuEST_REAL, MPI_SUM, MPI_COMM_WORLD);</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    </div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="keywordflow">return</span> globalPurity;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;}</div><div class="ttc" id="QuEST__cpu_8c_html_af910c7cf2b85bdc2c399cfe8dbfb8b9c"><div class="ttname"><a href="QuEST__cpu_8c.html#af910c7cf2b85bdc2c399cfe8dbfb8b9c">densmatr_calcPurityLocal</a></div><div class="ttdeci">qreal densmatr_calcPurityLocal(Qureg qureg)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00710">QuEST_cpu.c:710</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6153547f245c05874161a105e9a2f02c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6153547f245c05874161a105e9a2f02c">&#9670;&nbsp;</a></span>densmatr_calcTotalProb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> densmatr_calcTotalProb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00059">59</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__gpu_8cu_source.html#l00291">copyStateFromGPU()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00097">Qureg::numChunks</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00599">calcTotalProb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                                          {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        </div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="comment">// computes the trace by summing every element (&quot;diag&quot;) with global index (2^n + 1)i for i in [0, 2^n-1]</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        </div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="comment">// computes first local index containing a diagonal element</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> diagSpacing = 1LL + (1LL &lt;&lt; qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numPrevDiags = (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>&gt;0)? 1+(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>*qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>)/diagSpacing : 0;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> globalIndNextDiag = diagSpacing * numPrevDiags;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localIndNextDiag = globalIndNextDiag % qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        </div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> rankTotal = 0;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> y, t, c;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        c = 0;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        </div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="comment">// iterates every local diagonal</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keywordflow">for</span> (index=localIndNextDiag; index &lt; qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>; index += diagSpacing) {</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                </div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                <span class="comment">// Kahan summation - brackets are important</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                y = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[index] - c;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                t = rankTotal + y;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                c = ( t - rankTotal ) - y;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                rankTotal = t;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        }</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        </div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="comment">// combine each node&#39;s sum of diagonals</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> globalTotal;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a> &gt; 1)</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                MPI_Allreduce(&amp;rankTotal, &amp;globalTotal, 1, MPI_QuEST_REAL, MPI_SUM, MPI_COMM_WORLD);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                globalTotal = rankTotal;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        </div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keywordflow">return</span> globalTotal;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div><div class="ttc" id="structQureg_html_ad08dff5316b8937f4b2a1417591543dc"><div class="ttname"><a href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">Qureg::numQubitsRepresented</a></div><div class="ttdeci">int numQubitsRepresented</div><div class="ttdoc">The number of qubits represented in either the state-vector or density matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00086">QuEST.h:86</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_aa3deb7163aab90a61e755a1f200f5413"><div class="ttname"><a href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">Qureg::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into – the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00097">QuEST.h:97</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab321af37fe3490253e12b7c70b8d2a98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab321af37fe3490253e12b7c70b8d2a98">&#9670;&nbsp;</a></span>densmatr_collapseToKnownProbOutcome()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_collapseToKnownProbOutcome </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>outcome</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>outcomeProb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Renorms (/prob) every | * outcome * &gt;&lt; * outcome * | state, setting all others to zero. </p>
<p>Renorms (/prob) every | * outcome * &gt;&lt; * outcome * | state, setting all others to zero. </p>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00634">634</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__cpu_8c_source.html#l00603">alternateNormZeroingSomeAmpBlocks()</a>, <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00593">normaliseSomeAmps()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l00583">zeroSomeAmps()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00539">collapseToOutcome()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00320">densmatr_measureWithStats()</a>.</p>
<div class="fragment"><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                                                                                                                 {</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="comment">// only (global) indices (as bit sequence): &#39;* outcome *(n+q) outcome *q are spared</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="comment">// where n = measureQubit, q = qureg.numQubitsRepresented.</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="comment">// We can thus step in blocks of 2^q+n, killing every second, and inside the others,</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="comment">//  stepping in sub-blocks of 2^q, killing every second.</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="comment">// When outcome=1, we offset the start of these blocks by their size.</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerBlockSize = (1LL &lt;&lt; measureQubit);</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerBlockSize = (1LL &lt;&lt; (measureQubit + qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>));</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    </div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="comment">// Because there are 2^a number of nodes(/chunks), each node will contain 2^b number of blocks,</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="comment">// or each block will span 2^c number of nodes. Similarly for the innerblocks.</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> locNumAmps = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> globalStartInd = qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a> * locNumAmps;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keywordtype">int</span> innerBit = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(measureQubit, globalStartInd);</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordtype">int</span> outerBit = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(measureQubit + qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>, globalStartInd);</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    </div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="comment">// If this chunk&#39;s amps are entirely inside an outer block</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="keywordflow">if</span> (locNumAmps &lt;= outerBlockSize) {</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        </div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="comment">// if this is an undesired outer block, kill all elems</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="keywordflow">if</span> (outerBit != outcome)</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(qureg, 0, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>);</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        </div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        <span class="comment">// othwerwise, if this is a desired outer block, and also entirely an inner block</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="keywordflow">if</span> (locNumAmps &lt;= innerBlockSize) {</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            </div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            <span class="comment">// and that inner block is undesired, kill all elems</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            <span class="keywordflow">if</span> (innerBit != outcome)</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(qureg, 0, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            <span class="comment">// otherwise normalise all elems</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="QuEST__cpu_8c.html#a031a99b7e97779f3dc782feffe86e779">normaliseSomeAmps</a>(qureg, totalStateProb, 0, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        }</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                </div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <span class="comment">// otherwise this is a desired outer block which contains 2^a inner blocks; kill/renorm every second inner block</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="QuEST__cpu_8c.html#a0abdff5f6065f9d57065345e6d90fc94">alternateNormZeroingSomeAmpBlocks</a>(</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            qureg, totalStateProb, innerBit==outcome, 0, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, innerBlockSize);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    }</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    </div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="comment">// Otherwise, this chunk&#39;s amps contain multiple outer blocks (and hence multiple inner blocks)</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numOuterDoubleBlocks = locNumAmps / (2*outerBlockSize);</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> firstBlockInd;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    </div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="comment">// alternate norming* and zeroing the outer blocks (with order based on the desired outcome)</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="comment">// These loops aren&#39;t parallelised, since they could have 1 or 2 iterations and will prevent</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="comment">// inner parallelisation</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordflow">if</span> (outerBit == outcome) {</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerDubBlockInd = 0; outerDubBlockInd &lt; numOuterDoubleBlocks; outerDubBlockInd++) {</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            firstBlockInd = outerDubBlockInd*2*outerBlockSize;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            </div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <span class="comment">// *norm only the desired inner blocks in the desired outer block</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a0abdff5f6065f9d57065345e6d90fc94">alternateNormZeroingSomeAmpBlocks</a>(</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                qureg, totalStateProb, innerBit==outcome, </div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                firstBlockInd, outerBlockSize, innerBlockSize);</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            </div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            <span class="comment">// zero the undesired outer block</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(qureg, firstBlockInd + outerBlockSize, outerBlockSize);</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        }</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerDubBlockInd = 0; outerDubBlockInd &lt; numOuterDoubleBlocks; outerDubBlockInd++) {</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            firstBlockInd = outerDubBlockInd*2*outerBlockSize;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            </div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            <span class="comment">// same thing but undesired outer blocks come first</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(qureg, firstBlockInd, outerBlockSize);</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a0abdff5f6065f9d57065345e6d90fc94">alternateNormZeroingSomeAmpBlocks</a>(</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                qureg, totalStateProb, innerBit==outcome, </div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                firstBlockInd + outerBlockSize, outerBlockSize, innerBlockSize);</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        }</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    }</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    </div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;}</div><div class="ttc" id="structQureg_html_ad08dff5316b8937f4b2a1417591543dc"><div class="ttname"><a href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">Qureg::numQubitsRepresented</a></div><div class="ttdeci">int numQubitsRepresented</div><div class="ttdoc">The number of qubits represented in either the state-vector or density matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00086">QuEST.h:86</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a031a99b7e97779f3dc782feffe86e779"><div class="ttname"><a href="QuEST__cpu_8c.html#a031a99b7e97779f3dc782feffe86e779">normaliseSomeAmps</a></div><div class="ttdeci">void normaliseSomeAmps(Qureg qureg, qreal norm, long long int startInd, long long int numAmps)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00593">QuEST_cpu.c:593</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a100463f6ec212c76a5fad99579000505"><div class="ttname"><a href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a></div><div class="ttdeci">static int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdoc">Get the value of the bit at a particular index in a number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00031">QuEST_cpu.c:31</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_ac5168399122f7f53977dcc9ceda4f458"><div class="ttname"><a href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a></div><div class="ttdeci">void zeroSomeAmps(Qureg qureg, long long int startInd, long long int numAmps)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00583">QuEST_cpu.c:583</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a0abdff5f6065f9d57065345e6d90fc94"><div class="ttname"><a href="QuEST__cpu_8c.html#a0abdff5f6065f9d57065345e6d90fc94">alternateNormZeroingSomeAmpBlocks</a></div><div class="ttdeci">void alternateNormZeroingSomeAmpBlocks(Qureg qureg, qreal norm, int normFirst, long long int startAmpInd, long long int numAmps, long long int blockSize)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00603">QuEST_cpu.c:603</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a20a155f53efc45c16803d7539c2c199d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20a155f53efc45c16803d7539c2c199d">&#9670;&nbsp;</a></span>densmatr_initClassicalState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_initClassicalState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>stateInd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00894">894</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00107">initClassicalState()</a>.</p>
<div class="fragment"><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;{</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> densityNumElems = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="comment">// Can&#39;t use qureg-&gt;stateVec as a private OMP var</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *densityReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *densityImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="comment">// initialise the state to all zeros</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="preprocessor">    shared   (densityNumElems, densityReal, densityImag) \</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="preprocessor">    private  (index) </span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    {</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;densityNumElems; index++) {</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;            densityReal[index] = 0.0;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            densityImag[index] = 0.0;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        }</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    }</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    </div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="comment">// index of the single density matrix elem to set non-zero</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> densityDim = 1LL &lt;&lt; qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> densityInd = (densityDim + 1)*stateInd;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="comment">// give the specified classical state prob 1</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a> == densityInd / densityNumElems){</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        densityReal[densityInd % densityNumElems] = 1.0;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        densityImag[densityInd % densityNumElems] = 0.0;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    }</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;}</div><div class="ttc" id="structQureg_html_ad08dff5316b8937f4b2a1417591543dc"><div class="ttname"><a href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">Qureg::numQubitsRepresented</a></div><div class="ttdeci">int numQubitsRepresented</div><div class="ttdoc">The number of qubits represented in either the state-vector or density matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00086">QuEST.h:86</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2418bd9a6b9e6a0acf11faf5982d5d29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2418bd9a6b9e6a0acf11faf5982d5d29">&#9670;&nbsp;</a></span>densmatr_initPlusState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_initPlusState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>targetQureg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00933">933</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00098">initPlusState()</a>.</p>
<div class="fragment"><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;{</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="comment">// |+&gt;&lt;+| = sum_i 1/sqrt(2^N) |i&gt; 1/sqrt(2^N) &lt;j| = sum_ij 1/2^N |i&gt;&lt;j|</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> dim = (1LL &lt;&lt; qureg.numQubitsRepresented);</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> probFactor = 1.0/((<a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>) dim);</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="comment">// Can&#39;t use qureg-&gt;stateVec as a private OMP var</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *densityReal = qureg.stateVec.real;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *densityImag = qureg.stateVec.imag;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize = qureg.numAmpsPerChunk;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="comment">// initialise the state to |+++..+++&gt; = 1/normFactor {1, 1, 1, ...}</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="preprocessor">    shared   (chunkSize, densityReal, densityImag, probFactor) \</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="preprocessor">    private  (index) </span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    {</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;            densityReal[index] = probFactor;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            densityImag[index] = 0.0;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        }</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    }</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;}</div><div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5ad68d054875913d0f7ec654840a9ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5ad68d054875913d0f7ec654840a9ec">&#9670;&nbsp;</a></span>densmatr_initPureState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_initPureState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>targetQureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>copyQureg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00428">428</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00379">copyVecIntoMatrixPairState()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00963">densmatr_initPureStateLocal()</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00097">Qureg::numChunks</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00119">initPureState()</a>.</p>
<div class="fragment"><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                                                                {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">if</span> (targetQureg.<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a>==1){</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="comment">// local version</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="comment">// save pointers to qureg&#39;s pair state</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* quregPairRePtr = targetQureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* quregPairImPtr = targetQureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="comment">// populate qureg pair state with pure state (by repointing)</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        targetQureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real = copyQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        targetQureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag = copyQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="comment">// populate density matrix via it&#39;s pairState</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <a class="code" href="QuEST__cpu_8c.html#a1b36518c8fbbc3a5084bb4ad1fb05ea5">densmatr_initPureStateLocal</a>(targetQureg, copyQureg);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="comment">// restore pointers</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        targetQureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real = quregPairRePtr;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        targetQureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag = quregPairImPtr;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="comment">// set qureg&#39;s pairState is to be the full pure state (on every node)</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <a class="code" href="QuEST__cpu__distributed_8c.html#a95af772d87c461fc8abfd6d47b752ac2">copyVecIntoMatrixPairState</a>(targetQureg, copyQureg);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        </div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="comment">// update every density matrix chunk using pairState</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <a class="code" href="QuEST__cpu_8c.html#a1b36518c8fbbc3a5084bb4ad1fb05ea5">densmatr_initPureStateLocal</a>(targetQureg, copyQureg);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    }</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_aa3deb7163aab90a61e755a1f200f5413"><div class="ttname"><a href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">Qureg::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into – the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00097">QuEST.h:97</a></div></div>
<div class="ttc" id="structQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00102">QuEST.h:102</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a95af772d87c461fc8abfd6d47b752ac2"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a95af772d87c461fc8abfd6d47b752ac2">copyVecIntoMatrixPairState</a></div><div class="ttdeci">void copyVecIntoMatrixPairState(Qureg matr, Qureg vec)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00379">QuEST_cpu_distributed.c:379</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a1b36518c8fbbc3a5084bb4ad1fb05ea5"><div class="ttname"><a href="QuEST__cpu_8c.html#a1b36518c8fbbc3a5084bb4ad1fb05ea5">densmatr_initPureStateLocal</a></div><div class="ttdeci">void densmatr_initPureStateLocal(Qureg targetQureg, Qureg copyQureg)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00963">QuEST_cpu.c:963</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae4ebc1f4dd48922bfb30ad1692310269"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4ebc1f4dd48922bfb30ad1692310269">&#9670;&nbsp;</a></span>densmatr_measureWithStats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int densmatr_measureWithStats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>outcomeProb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00320">320</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01231">densmatr_calcProbOfOutcome()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00634">densmatr_collapseToKnownProbOutcome()</a>, <a class="el" href="QuEST__common_8c_source.html#l00105">generateMeasurementOutcome()</a>, and <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00571">measure()</a>, and <a class="el" href="QuEST_8c_source.html#l00558">measureWithStats()</a>.</p>
<div class="fragment"><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                                                                                 {</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    </div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> zeroProb = <a class="code" href="QuEST__internal_8h.html#ad405e3fac20997043e0236b751e44270">densmatr_calcProbOfOutcome</a>(qureg, measureQubit, 0);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordtype">int</span> outcome = <a class="code" href="QuEST__common_8c.html#a9d19fc690afb425d0df5feb09be567a3">generateMeasurementOutcome</a>(zeroProb, outcomeProb);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <a class="code" href="QuEST__internal_8h.html#ab321af37fe3490253e12b7c70b8d2a98">densmatr_collapseToKnownProbOutcome</a>(qureg, measureQubit, outcome, *outcomeProb);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">return</span> outcome;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;}</div><div class="ttc" id="QuEST__common_8c_html_a9d19fc690afb425d0df5feb09be567a3"><div class="ttname"><a href="QuEST__common_8c.html#a9d19fc690afb425d0df5feb09be567a3">generateMeasurementOutcome</a></div><div class="ttdeci">int generateMeasurementOutcome(qreal zeroProb, qreal *outcomeProb)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__common_8c_source.html#l00105">QuEST_common.c:105</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="QuEST__internal_8h_html_ad405e3fac20997043e0236b751e44270"><div class="ttname"><a href="QuEST__internal_8h.html#ad405e3fac20997043e0236b751e44270">densmatr_calcProbOfOutcome</a></div><div class="ttdeci">qreal densmatr_calcProbOfOutcome(Qureg qureg, const int measureQubit, int outcome)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l01231">QuEST_cpu_distributed.c:1231</a></div></div>
<div class="ttc" id="QuEST__internal_8h_html_ab321af37fe3490253e12b7c70b8d2a98"><div class="ttname"><a href="QuEST__internal_8h.html#ab321af37fe3490253e12b7c70b8d2a98">densmatr_collapseToKnownProbOutcome</a></div><div class="ttdeci">void densmatr_collapseToKnownProbOutcome(Qureg qureg, const int measureQubit, int outcome, qreal outcomeProb)</div><div class="ttdoc">Renorms (/prob) every | * outcome * &gt;&lt; * outcome * | state, setting all others to zero...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00634">QuEST_cpu.c:634</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a56b32228c24a7c4e1894d991ef4b6b99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56b32228c24a7c4e1894d991ef4b6b99">&#9670;&nbsp;</a></span>densmatr_oneQubitDephase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_oneQubitDephase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>dephase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00036">36</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00645">applyOneQubitDephaseError()</a>, <a class="el" href="QuEST__gpu_8cu_source.html#l02127">densmatr_oneQubitDepolarise()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l00159">densmatr_oneQubitDepolariseDistributed()</a>.</p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                                                                                 {</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> retain=1-dephase;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    </div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMask = 1LL &lt;&lt; targetQubit;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMask = 1LL &lt;&lt; (targetQubit + (qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>));</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    </div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisPattern;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMask = innerMask|outerMask;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor"> # ifdef _OPENMP</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">    shared   (innerMask,outerMask,totMask,qureg,retain) \</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">    private  (thisTask,thisPattern) </span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    {</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++){</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            thisPattern = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMask;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            <span class="keywordflow">if</span> ((thisPattern==innerMask) || (thisPattern==outerMask)){</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                <span class="comment">// do dephase</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                <span class="comment">// the lines below will degrade the off-diagonal terms |..0..&gt;&lt;..1..| and |..1..&gt;&lt;..0..|</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask]; </div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask]; </div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            } </div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        }  </div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    }</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;}</div><div class="ttc" id="structQureg_html_ad08dff5316b8937f4b2a1417591543dc"><div class="ttname"><a href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">Qureg::numQubitsRepresented</a></div><div class="ttdeci">int numQubitsRepresented</div><div class="ttdoc">The number of qubits represented in either the state-vector or density matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00086">QuEST.h:86</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5bf84ca607e1484e0ddb5570726848d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5bf84ca607e1484e0ddb5570726848d">&#9670;&nbsp;</a></span>densmatr_oneQubitDepolarise()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_oneQubitDepolarise </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>depolLevel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00676">676</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00246">chunkIsUpperInOuterBlock()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00521">compressPairVectorForSingleQubitDepolarise()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00373">densityMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST__gpu_8cu_source.html#l02011">densmatr_oneQubitDephase()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00159">densmatr_oneQubitDepolariseDistributed()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00110">densmatr_oneQubitDepolariseLocal()</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00487">exchangePairStateVectorHalves()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00324">getChunkOuterBlockPairId()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, and <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00662">applyOneQubitDepolariseError()</a>.</p>
<div class="fragment"><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                                                                                       {</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">if</span> (depolLevel == 0)</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    </div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordtype">int</span> rankIsUpper; <span class="comment">// rank is in the upper half of an outer block</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a076fe6125da4d6037b8bc4d912df4015">densityMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, </div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>, targetQubit);</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordflow">if</span> (useLocalDataOnly){</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <a class="code" href="QuEST__cpu_8c.html#a5a0dd013940cf2ea20c397a551d9b781">densmatr_oneQubitDepolariseLocal</a>(qureg, targetQubit, depolLevel);</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <span class="comment">// pack data to send to my pair process into the first half of pairStateVec</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        <a class="code" href="QuEST__cpu__distributed_8c.html#a2ebf115d3bdd88f4b290b5218a5399d3">compressPairVectorForSingleQubitDepolarise</a>(qureg, targetQubit);</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#aa3c2d644a2be7f0d3aa9f757527d306f">chunkIsUpperInOuterBlock</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit, </div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#ae66dc6569c6e4008c33d6739db422c08">getChunkOuterBlockPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, </div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                targetQubit, qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        <a class="code" href="QuEST__cpu__distributed_8c.html#a37dae401754961c9100b3c0907913c3e">exchangePairStateVectorHalves</a>(qureg, pairRank);</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <a class="code" href="QuEST__cpu_8c.html#a48e0715ee615f2ce44477521ab760627">densmatr_oneQubitDepolariseDistributed</a>(qureg, targetQubit, depolLevel);</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    }</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;}</div><div class="ttc" id="structQureg_html_ad08dff5316b8937f4b2a1417591543dc"><div class="ttname"><a href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">Qureg::numQubitsRepresented</a></div><div class="ttdeci">int numQubitsRepresented</div><div class="ttdoc">The number of qubits represented in either the state-vector or density matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00086">QuEST.h:86</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a076fe6125da4d6037b8bc4d912df4015"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a076fe6125da4d6037b8bc4d912df4015">densityMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int densityMatrixBlockFitsInChunk(long long int chunkSize, int numQubits, int targetQubit)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00373">QuEST_cpu_distributed.c:373</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_ae66dc6569c6e4008c33d6739db422c08"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#ae66dc6569c6e4008c33d6739db422c08">getChunkOuterBlockPairId</a></div><div class="ttdeci">static int getChunkOuterBlockPairId(int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit, int numQubits)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00324">QuEST_cpu_distributed.c:324</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a48e0715ee615f2ce44477521ab760627"><div class="ttname"><a href="QuEST__cpu_8c.html#a48e0715ee615f2ce44477521ab760627">densmatr_oneQubitDepolariseDistributed</a></div><div class="ttdeci">void densmatr_oneQubitDepolariseDistributed(Qureg qureg, const int targetQubit, qreal depolLevel)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00159">QuEST_cpu.c:159</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a2ebf115d3bdd88f4b290b5218a5399d3"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a2ebf115d3bdd88f4b290b5218a5399d3">compressPairVectorForSingleQubitDepolarise</a></div><div class="ttdeci">void compressPairVectorForSingleQubitDepolarise(Qureg qureg, const int targetQubit)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00521">QuEST_cpu_distributed.c:521</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a5a0dd013940cf2ea20c397a551d9b781"><div class="ttname"><a href="QuEST__cpu_8c.html#a5a0dd013940cf2ea20c397a551d9b781">densmatr_oneQubitDepolariseLocal</a></div><div class="ttdeci">void densmatr_oneQubitDepolariseLocal(Qureg qureg, const int targetQubit, qreal depolLevel)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00110">QuEST_cpu.c:110</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a37dae401754961c9100b3c0907913c3e"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a37dae401754961c9100b3c0907913c3e">exchangePairStateVectorHalves</a></div><div class="ttdeci">void exchangePairStateVectorHalves(Qureg qureg, int pairRank)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00487">QuEST_cpu_distributed.c:487</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_aa3c2d644a2be7f0d3aa9f757527d306f"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#aa3c2d644a2be7f0d3aa9f757527d306f">chunkIsUpperInOuterBlock</a></div><div class="ttdeci">static int chunkIsUpperInOuterBlock(int chunkId, long long int chunkSize, int targetQubit, int numQubits)</div><div class="ttdoc">fix – do with masking instead </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00246">QuEST_cpu_distributed.c:246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8fde996ce8ba014fce542549406813f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fde996ce8ba014fce542549406813f9">&#9670;&nbsp;</a></span>densmatr_twoQubitDephase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_twoQubitDephase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>qubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>qubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>dephase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00069">69</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00653">applyTwoQubitDephaseError()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00703">densmatr_twoQubitDepolarise()</a>.</p>
<div class="fragment"><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                                                                                              {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> retain=1-dephase;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMaskQubit1 = 1LL &lt;&lt; qubit1;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMaskQubit1 = 1LL &lt;&lt; (qubit1 + (qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>));</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMaskQubit2 = 1LL &lt;&lt; qubit2;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMaskQubit2 = 1LL &lt;&lt; (qubit2 + (qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>));</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMaskQubit1 = innerMaskQubit1|outerMaskQubit1;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMaskQubit2 = innerMaskQubit2|outerMaskQubit2;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisPatternQubit1, thisPatternQubit2;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">    shared   (innerMaskQubit1,outerMaskQubit1,totMaskQubit1,innerMaskQubit2,outerMaskQubit2, \</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">                totMaskQubit2,qureg,retain) \</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">    private  (thisTask,thisPatternQubit1,thisPatternQubit2) </span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    {</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++){</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            thisPatternQubit1 = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMaskQubit1;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            thisPatternQubit2 = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMaskQubit2;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            </div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <span class="comment">// any mismatch |...0...&gt;&lt;...1...| etc</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <span class="keywordflow">if</span> ( (thisPatternQubit1==innerMaskQubit1) || (thisPatternQubit1==outerMaskQubit1) || </div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                    (thisPatternQubit2==innerMaskQubit2) || (thisPatternQubit2==outerMaskQubit2) ){ </div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                <span class="comment">// do dephase</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                <span class="comment">// the lines below will degrade the off-diagonal terms |..0..&gt;&lt;..1..| and |..1..&gt;&lt;..0..|</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask]; </div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask]; </div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            } </div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        }  </div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;}</div><div class="ttc" id="structQureg_html_ad08dff5316b8937f4b2a1417591543dc"><div class="ttname"><a href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">Qureg::numQubitsRepresented</a></div><div class="ttdeci">int numQubitsRepresented</div><div class="ttdoc">The number of qubits represented in either the state-vector or density matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00086">QuEST.h:86</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa500e14a9ed1683f9c056f03f4c24cea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa500e14a9ed1683f9c056f03f4c24cea">&#9670;&nbsp;</a></span>densmatr_twoQubitDepolarise()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_twoQubitDepolarise </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>depolLevel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00703">703</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00246">chunkIsUpperInOuterBlock()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00587">compressPairVectorForTwoQubitDepolarise()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00373">densityMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00069">densmatr_twoQubitDephase()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00390">densmatr_twoQubitDepolariseDistributed()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00235">densmatr_twoQubitDepolariseLocal()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00337">densmatr_twoQubitDepolariseLocalPart1()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00481">densmatr_twoQubitDepolariseQ1LocalQ2DistributedPart3()</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00487">exchangePairStateVectorHalves()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00324">getChunkOuterBlockPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00335">getChunkOuterBlockPairIdForPart3()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, and <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00670">applyTwoQubitDepolariseError()</a>.</p>
<div class="fragment"><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                                                                                       {</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordflow">if</span> (depolLevel == 0)</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keywordtype">int</span> rankIsUpperBiggerQubit, rankIsUpperSmallerQubit;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordtype">int</span> biggerQubit, smallerQubit;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <a class="code" href="QuEST__internal_8h.html#a8fde996ce8ba014fce542549406813f9">densmatr_twoQubitDephase</a>(qureg, qubit1, qubit2, depolLevel);</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    </div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> eta = 2/depolLevel;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> delta = eta - 1 - sqrt( (eta-1)*(eta-1) - 1 ); </div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> gamma = 1+delta;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    gamma = 1/(gamma*gamma*gamma);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> GAMMA_PARTS_1_OR_2 = 1.0;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="comment">// TODO -- test delta too small</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="comment">/*   </span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">    if (fabs(4*delta*(1+delta)*gamma-depolLevel)&gt;1e-5){</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">        printf(&quot;Numerical error in delta; for small error rates try Taylor expansion.\n&quot;);</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">        exit(1);</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">    }</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    </div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    biggerQubit = qubit1 &gt; qubit2 ? qubit1 : qubit2;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    smallerQubit = qubit1 &lt; qubit2 ? qubit1 : qubit2;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keywordtype">int</span> useLocalDataOnlyBigQubit, useLocalDataOnlySmallQubit;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    useLocalDataOnlyBigQubit = <a class="code" href="QuEST__cpu__distributed_8c.html#a076fe6125da4d6037b8bc4d912df4015">densityMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, </div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>, biggerQubit);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordflow">if</span> (useLocalDataOnlyBigQubit){</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="comment">// does parts 1, 2 and 3 locally in one go</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <a class="code" href="QuEST__cpu_8c.html#a63a1b6169f59e86988aa519b71c496fb">densmatr_twoQubitDepolariseLocal</a>(qureg, qubit1, qubit2, delta, gamma);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        useLocalDataOnlySmallQubit = <a class="code" href="QuEST__cpu__distributed_8c.html#a076fe6125da4d6037b8bc4d912df4015">densityMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, </div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>, smallerQubit);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        <span class="keywordflow">if</span> (useLocalDataOnlySmallQubit){</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            <span class="comment">// do part 1 locally</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a7f8192d6f93ea1565a27a8556d48878b">densmatr_twoQubitDepolariseLocalPart1</a>(qureg, smallerQubit, biggerQubit, delta);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            </div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            <span class="comment">// do parts 2 and 3 distributed (if part 2 is distributed part 3 is also distributed)</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            <span class="comment">// part 2 will be distributed and the value of the small qubit won&#39;t matter</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            <a class="code" href="QuEST__cpu__distributed_8c.html#a13a7c39357ba9a30339d7a6171aeda8d">compressPairVectorForTwoQubitDepolarise</a>(qureg, smallerQubit, biggerQubit);</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            rankIsUpperBiggerQubit = <a class="code" href="QuEST__cpu__distributed_8c.html#aa3c2d644a2be7f0d3aa9f757527d306f">chunkIsUpperInOuterBlock</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, biggerQubit, </div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                    qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#ae66dc6569c6e4008c33d6739db422c08">getChunkOuterBlockPairId</a>(rankIsUpperBiggerQubit, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, </div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                    biggerQubit, qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            <a class="code" href="QuEST__cpu__distributed_8c.html#a37dae401754961c9100b3c0907913c3e">exchangePairStateVectorHalves</a>(qureg, pairRank);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a4a51a641ea15f95481375ff76791e023">densmatr_twoQubitDepolariseDistributed</a>(qureg, smallerQubit, biggerQubit, delta, GAMMA_PARTS_1_OR_2);</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            </div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            <span class="comment">// part 3 will be distributed but involve rearranging for the smaller qubit</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            <a class="code" href="QuEST__cpu__distributed_8c.html#a13a7c39357ba9a30339d7a6171aeda8d">compressPairVectorForTwoQubitDepolarise</a>(qureg, smallerQubit, biggerQubit);</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            rankIsUpperBiggerQubit = <a class="code" href="QuEST__cpu__distributed_8c.html#aa3c2d644a2be7f0d3aa9f757527d306f">chunkIsUpperInOuterBlock</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, biggerQubit, </div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                    qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#ae66dc6569c6e4008c33d6739db422c08">getChunkOuterBlockPairId</a>(rankIsUpperBiggerQubit, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, </div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                    biggerQubit, qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            <a class="code" href="QuEST__cpu__distributed_8c.html#a37dae401754961c9100b3c0907913c3e">exchangePairStateVectorHalves</a>(qureg, pairRank);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#ae6946456e9b7814fc565f20622b9d2e5">densmatr_twoQubitDepolariseQ1LocalQ2DistributedPart3</a>(qureg, smallerQubit, biggerQubit, delta, gamma);</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            <span class="comment">// do part 1, 2 and 3 distributed</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            <span class="comment">// part 1</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            <a class="code" href="QuEST__cpu__distributed_8c.html#a13a7c39357ba9a30339d7a6171aeda8d">compressPairVectorForTwoQubitDepolarise</a>(qureg, smallerQubit, biggerQubit);</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            rankIsUpperSmallerQubit = <a class="code" href="QuEST__cpu__distributed_8c.html#aa3c2d644a2be7f0d3aa9f757527d306f">chunkIsUpperInOuterBlock</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, smallerQubit, </div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                    qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#ae66dc6569c6e4008c33d6739db422c08">getChunkOuterBlockPairId</a>(rankIsUpperSmallerQubit, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, </div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                    smallerQubit, qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            <a class="code" href="QuEST__cpu__distributed_8c.html#a37dae401754961c9100b3c0907913c3e">exchangePairStateVectorHalves</a>(qureg, pairRank);</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a4a51a641ea15f95481375ff76791e023">densmatr_twoQubitDepolariseDistributed</a>(qureg, smallerQubit, biggerQubit, delta, GAMMA_PARTS_1_OR_2);</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            <span class="comment">// part 2</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            <a class="code" href="QuEST__cpu__distributed_8c.html#a13a7c39357ba9a30339d7a6171aeda8d">compressPairVectorForTwoQubitDepolarise</a>(qureg, smallerQubit, biggerQubit);</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            rankIsUpperBiggerQubit = <a class="code" href="QuEST__cpu__distributed_8c.html#aa3c2d644a2be7f0d3aa9f757527d306f">chunkIsUpperInOuterBlock</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, biggerQubit, </div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                    qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#ae66dc6569c6e4008c33d6739db422c08">getChunkOuterBlockPairId</a>(rankIsUpperBiggerQubit, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, </div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                    biggerQubit, qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <a class="code" href="QuEST__cpu__distributed_8c.html#a37dae401754961c9100b3c0907913c3e">exchangePairStateVectorHalves</a>(qureg, pairRank);</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a4a51a641ea15f95481375ff76791e023">densmatr_twoQubitDepolariseDistributed</a>(qureg, smallerQubit, biggerQubit, delta, GAMMA_PARTS_1_OR_2);</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            <span class="comment">// part 3</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            <a class="code" href="QuEST__cpu__distributed_8c.html#a13a7c39357ba9a30339d7a6171aeda8d">compressPairVectorForTwoQubitDepolarise</a>(qureg, smallerQubit, biggerQubit);</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#ab1ec7f241b68b079c8e316d190af49ce">getChunkOuterBlockPairIdForPart3</a>(rankIsUpperSmallerQubit, rankIsUpperBiggerQubit, </div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                    qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, smallerQubit, biggerQubit, qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            <a class="code" href="QuEST__cpu__distributed_8c.html#a37dae401754961c9100b3c0907913c3e">exchangePairStateVectorHalves</a>(qureg, pairRank);</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a4a51a641ea15f95481375ff76791e023">densmatr_twoQubitDepolariseDistributed</a>(qureg, smallerQubit, biggerQubit, delta, gamma);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        }</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    }</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;}</div><div class="ttc" id="structQureg_html_ad08dff5316b8937f4b2a1417591543dc"><div class="ttname"><a href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">Qureg::numQubitsRepresented</a></div><div class="ttdeci">int numQubitsRepresented</div><div class="ttdoc">The number of qubits represented in either the state-vector or density matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00086">QuEST.h:86</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a076fe6125da4d6037b8bc4d912df4015"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a076fe6125da4d6037b8bc4d912df4015">densityMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int densityMatrixBlockFitsInChunk(long long int chunkSize, int numQubits, int targetQubit)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00373">QuEST_cpu_distributed.c:373</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_ae66dc6569c6e4008c33d6739db422c08"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#ae66dc6569c6e4008c33d6739db422c08">getChunkOuterBlockPairId</a></div><div class="ttdeci">static int getChunkOuterBlockPairId(int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit, int numQubits)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00324">QuEST_cpu_distributed.c:324</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a13a7c39357ba9a30339d7a6171aeda8d"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a13a7c39357ba9a30339d7a6171aeda8d">compressPairVectorForTwoQubitDepolarise</a></div><div class="ttdeci">void compressPairVectorForTwoQubitDepolarise(Qureg qureg, const int targetQubit, const int qubit2)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00587">QuEST_cpu_distributed.c:587</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_ab1ec7f241b68b079c8e316d190af49ce"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#ab1ec7f241b68b079c8e316d190af49ce">getChunkOuterBlockPairIdForPart3</a></div><div class="ttdeci">static int getChunkOuterBlockPairIdForPart3(int chunkIsUpperSmallerQubit, int chunkIsUpperBiggerQubit, int chunkId, long long int chunkSize, int smallerQubit, int biggerQubit, int numQubits)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00335">QuEST_cpu_distributed.c:335</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a4a51a641ea15f95481375ff76791e023"><div class="ttname"><a href="QuEST__cpu_8c.html#a4a51a641ea15f95481375ff76791e023">densmatr_twoQubitDepolariseDistributed</a></div><div class="ttdeci">void densmatr_twoQubitDepolariseDistributed(Qureg qureg, const int targetQubit, const int qubit2, qreal delta, qreal gamma)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00390">QuEST_cpu.c:390</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="QuEST__internal_8h_html_a8fde996ce8ba014fce542549406813f9"><div class="ttname"><a href="QuEST__internal_8h.html#a8fde996ce8ba014fce542549406813f9">densmatr_twoQubitDephase</a></div><div class="ttdeci">void densmatr_twoQubitDephase(Qureg qureg, const int qubit1, const int qubit2, qreal dephase)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00069">QuEST_cpu.c:69</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a7f8192d6f93ea1565a27a8556d48878b"><div class="ttname"><a href="QuEST__cpu_8c.html#a7f8192d6f93ea1565a27a8556d48878b">densmatr_twoQubitDepolariseLocalPart1</a></div><div class="ttdeci">void densmatr_twoQubitDepolariseLocalPart1(Qureg qureg, int qubit1, int qubit2, qreal delta)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00337">QuEST_cpu.c:337</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_ae6946456e9b7814fc565f20622b9d2e5"><div class="ttname"><a href="QuEST__cpu_8c.html#ae6946456e9b7814fc565f20622b9d2e5">densmatr_twoQubitDepolariseQ1LocalQ2DistributedPart3</a></div><div class="ttdeci">void densmatr_twoQubitDepolariseQ1LocalQ2DistributedPart3(Qureg qureg, const int targetQubit, const int qubit2, qreal delta, qreal gamma)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00481">QuEST_cpu.c:481</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a37dae401754961c9100b3c0907913c3e"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a37dae401754961c9100b3c0907913c3e">exchangePairStateVectorHalves</a></div><div class="ttdeci">void exchangePairStateVectorHalves(Qureg qureg, int pairRank)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00487">QuEST_cpu_distributed.c:487</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a63a1b6169f59e86988aa519b71c496fb"><div class="ttname"><a href="QuEST__cpu_8c.html#a63a1b6169f59e86988aa519b71c496fb">densmatr_twoQubitDepolariseLocal</a></div><div class="ttdeci">void densmatr_twoQubitDepolariseLocal(Qureg qureg, int qubit1, int qubit2, qreal delta, qreal gamma)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00235">QuEST_cpu.c:235</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_aa3c2d644a2be7f0d3aa9f757527d306f"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#aa3c2d644a2be7f0d3aa9f757527d306f">chunkIsUpperInOuterBlock</a></div><div class="ttdeci">static int chunkIsUpperInOuterBlock(int chunkId, long long int chunkSize, int targetQubit, int numQubits)</div><div class="ttdoc">fix – do with masking instead </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00246">QuEST_cpu_distributed.c:246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac8ea84dd85eca525daeeb30b3c96b673"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8ea84dd85eca525daeeb30b3c96b673">&#9670;&nbsp;</a></span>ensureIndsIncrease()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ensureIndsIncrease </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ind1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ind2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00027">27</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00653">applyTwoQubitDephaseError()</a>, and <a class="el" href="QuEST_8c_source.html#l00670">applyTwoQubitDepolariseError()</a>.</p>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                                              {</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordflow">if</span> (*ind1 &gt; *ind2) {</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="keywordtype">int</span> copy = *ind1;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        *ind1 = *ind2;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        *ind2 = copy;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    }</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a73300e3cdca56a7615980274905ba097"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73300e3cdca56a7615980274905ba097">&#9670;&nbsp;</a></span>getComplexPairAndPhaseFromUnitary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getComplexPairAndPhaseFromUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a> *&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a> *&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>globalPhase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>maps U(r0c0, r0c1, r1c0, r1c1) to exp(i globalPhase) U(alpha, beta) </p>

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00086">86</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00067">ComplexMatrix2::r0c0</a>, <a class="el" href="QuEST_8h_source.html#l00068">ComplexMatrix2::r1c0</a>, <a class="el" href="QuEST_8h_source.html#l00068">ComplexMatrix2::r1c1</a>, and <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__qasm_8c_source.html#l00265">qasm_recordControlledUnitary()</a>, <a class="el" href="QuEST__qasm_8c_source.html#l00328">qasm_recordMultiControlledUnitary()</a>, and <a class="el" href="QuEST__qasm_8c_source.html#l00194">qasm_recordUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                                                                                                            {</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    </div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> r0c0Phase = atan2(u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>, u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> r1c1Phase = atan2(u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>, u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    *globalPhase = (r0c0Phase + r1c1Phase)/2.0;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    </div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> cosPhase = cos(*globalPhase);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> sinPhase = sin(*globalPhase);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    alpha-&gt;<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*cosPhase + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*sinPhase;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    alpha-&gt;<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*cosPhase - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*sinPhase;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    beta-&gt;<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*cosPhase + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*sinPhase;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    beta-&gt;<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*cosPhase - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*sinPhase;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div><div class="ttc" id="structComplexMatrix2_html_a763007c3070802373549ba0350f83c8a"><div class="ttname"><a href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">ComplexMatrix2::r1c1</a></div><div class="ttdeci">Complex r1c1</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00068">QuEST.h:68</a></div></div>
<div class="ttc" id="structComplex_html_ab5b2e2eca02131fc74b289a83636cbe3"><div class="ttname"><a href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">Complex::real</a></div><div class="ttdeci">qreal real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00059">QuEST.h:59</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structComplexMatrix2_html_ae72b4458233b077a636beee1892e81ff"><div class="ttname"><a href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">ComplexMatrix2::r0c0</a></div><div class="ttdeci">Complex r0c0</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_ab98282015ed2065e53fbc9638e2583ab"><div class="ttname"><a href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">ComplexMatrix2::r1c0</a></div><div class="ttdeci">Complex r1c0</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00068">QuEST.h:68</a></div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00060">QuEST.h:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a71b3ae4402c1c5039d3086ca0e47a522"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71b3ae4402c1c5039d3086ca0e47a522">&#9670;&nbsp;</a></span>getComplexPairFromRotation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getComplexPairFromRotation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structVector.html">Vector</a>&#160;</td>
          <td class="paramname"><em>axis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a> *&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a> *&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00064">64</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__common_8c_source.html#l00039">getUnitVector()</a>, <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, <a class="el" href="QuEST_8h_source.html#l00075">Vector::x</a>, <a class="el" href="QuEST_8h_source.html#l00075">Vector::y</a>, and <a class="el" href="QuEST_8h_source.html#l00075">Vector::z</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__qasm_8c_source.html#l00210">qasm_recordAxisRotation()</a>, <a class="el" href="QuEST__qasm_8c_source.html#l00287">qasm_recordControlledAxisRotation()</a>, <a class="el" href="QuEST__common_8c_source.html#l00278">statevec_controlledRotateAroundAxis()</a>, <a class="el" href="QuEST__common_8c_source.html#l00285">statevec_controlledRotateAroundAxisConj()</a>, <a class="el" href="QuEST__common_8c_source.html#l00262">statevec_rotateAroundAxis()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00269">statevec_rotateAroundAxisConj()</a>.</p>
<div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                                                                                         {</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    </div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="structVector.html">Vector</a> unitAxis = <a class="code" href="QuEST__common_8c.html#a041bb75200ee316de7b90667a4fe04f3">getUnitVector</a>(axis);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    alpha-&gt;<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> =   cos(angle/2.0);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    alpha-&gt;<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = - sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#ab33976d8fda2e44b770f71269d698a25">z</a>;  </div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    beta-&gt;<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>  =   sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#abc3cfc6c8e297b1153a373d84b981e6b">y</a>;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    beta-&gt;<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>  = - sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#a0d0459a5b731ac5fb3dff2c6134e6e88">x</a>;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;}</div><div class="ttc" id="structVector_html_a0d0459a5b731ac5fb3dff2c6134e6e88"><div class="ttname"><a href="structVector.html#a0d0459a5b731ac5fb3dff2c6134e6e88">Vector::x</a></div><div class="ttdeci">qreal x</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00075">QuEST.h:75</a></div></div>
<div class="ttc" id="structComplex_html_ab5b2e2eca02131fc74b289a83636cbe3"><div class="ttname"><a href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">Complex::real</a></div><div class="ttdeci">qreal real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00059">QuEST.h:59</a></div></div>
<div class="ttc" id="structVector_html"><div class="ttname"><a href="structVector.html">Vector</a></div><div class="ttdoc">Represents a 3-vector of real numbers. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00073">QuEST.h:73</a></div></div>
<div class="ttc" id="QuEST__common_8c_html_a041bb75200ee316de7b90667a4fe04f3"><div class="ttname"><a href="QuEST__common_8c.html#a041bb75200ee316de7b90667a4fe04f3">getUnitVector</a></div><div class="ttdeci">Vector getUnitVector(Vector vec)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__common_8c_source.html#l00039">QuEST_common.c:39</a></div></div>
<div class="ttc" id="structVector_html_ab33976d8fda2e44b770f71269d698a25"><div class="ttname"><a href="structVector.html#ab33976d8fda2e44b770f71269d698a25">Vector::z</a></div><div class="ttdeci">qreal z</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00075">QuEST.h:75</a></div></div>
<div class="ttc" id="structVector_html_abc3cfc6c8e297b1153a373d84b981e6b"><div class="ttname"><a href="structVector.html#abc3cfc6c8e297b1153a373d84b981e6b">Vector::y</a></div><div class="ttdeci">qreal y</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00075">QuEST.h:75</a></div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00060">QuEST.h:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac711ba2f44edc3f4f286ba9e9a7d6288"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac711ba2f44edc3f4f286ba9e9a7d6288">&#9670;&nbsp;</a></span>getConjugateMatrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> getConjugateMatrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&#160;</td>
          <td class="paramname"><em>matr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00054">54</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__common_8c_source.html#l00046">getConjugateScalar()</a>, <a class="el" href="QuEST_8h_source.html#l00067">ComplexMatrix2::r0c0</a>, <a class="el" href="QuEST_8h_source.html#l00067">ComplexMatrix2::r0c1</a>, <a class="el" href="QuEST_8h_source.html#l00068">ComplexMatrix2::r1c0</a>, and <a class="el" href="QuEST_8h_source.html#l00068">ComplexMatrix2::r1c1</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00252">controlledUnitary()</a>, <a class="el" href="QuEST_8c_source.html#l00265">multiControlledUnitary()</a>, and <a class="el" href="QuEST_8c_source.html#l00240">unitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                                                         {</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    </div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="structComplexMatrix2.html">ComplexMatrix2</a> conjMatrix;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    conjMatrix.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a> = <a class="code" href="QuEST__common_8c.html#af92fa737f4491324408b3d15543dced4">getConjugateScalar</a>(matrix.r0c0);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    conjMatrix.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a> = <a class="code" href="QuEST__common_8c.html#af92fa737f4491324408b3d15543dced4">getConjugateScalar</a>(matrix.r0c1);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    conjMatrix.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a> = <a class="code" href="QuEST__common_8c.html#af92fa737f4491324408b3d15543dced4">getConjugateScalar</a>(matrix.r1c0);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    conjMatrix.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a> = <a class="code" href="QuEST__common_8c.html#af92fa737f4491324408b3d15543dced4">getConjugateScalar</a>(matrix.r1c1);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">return</span> conjMatrix;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;}</div><div class="ttc" id="QuEST__common_8c_html_af92fa737f4491324408b3d15543dced4"><div class="ttname"><a href="QuEST__common_8c.html#af92fa737f4491324408b3d15543dced4">getConjugateScalar</a></div><div class="ttdeci">Complex getConjugateScalar(Complex scalar)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__common_8c_source.html#l00046">QuEST_common.c:46</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_a763007c3070802373549ba0350f83c8a"><div class="ttname"><a href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">ComplexMatrix2::r1c1</a></div><div class="ttdeci">Complex r1c1</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00068">QuEST.h:68</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_ae72b4458233b077a636beee1892e81ff"><div class="ttname"><a href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">ComplexMatrix2::r0c0</a></div><div class="ttdeci">Complex r0c0</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_ab98282015ed2065e53fbc9638e2583ab"><div class="ttname"><a href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">ComplexMatrix2::r1c0</a></div><div class="ttdeci">Complex r1c0</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00068">QuEST.h:68</a></div></div>
<div class="ttc" id="structComplexMatrix2_html"><div class="ttname"><a href="structComplexMatrix2.html">ComplexMatrix2</a></div><div class="ttdoc">Represents a 2x2 matrix of complex numbers. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_a0f3932f055a8b05cef361bce25d51172"><div class="ttname"><a href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">ComplexMatrix2::r0c1</a></div><div class="ttdeci">Complex r0c1</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af92fa737f4491324408b3d15543dced4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af92fa737f4491324408b3d15543dced4">&#9670;&nbsp;</a></span>getConjugateScalar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structComplex.html">Complex</a> getConjugateScalar </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>scalar</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00046">46</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, and <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00280">compactUnitary()</a>, <a class="el" href="QuEST_8c_source.html#l00293">controlledCompactUnitary()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00054">getConjugateMatrix()</a>.</p>
<div class="fragment"><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                                           {</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    </div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="structComplex.html">Complex</a> conjScalar;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    conjScalar.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> =   scalar.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    conjScalar.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = - scalar.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">return</span> conjScalar;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;}</div><div class="ttc" id="structComplex_html_ab5b2e2eca02131fc74b289a83636cbe3"><div class="ttname"><a href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">Complex::real</a></div><div class="ttdeci">qreal real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00059">QuEST.h:59</a></div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00060">QuEST.h:60</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00057">QuEST.h:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3cf54148e2162b04aeb634badb90826c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cf54148e2162b04aeb634badb90826c">&#9670;&nbsp;</a></span>getVectorMagnitude()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> getVectorMagnitude </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structVector.html">Vector</a>&#160;</td>
          <td class="paramname"><em>vec</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00035">35</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00075">Vector::x</a>, <a class="el" href="QuEST_8h_source.html#l00075">Vector::y</a>, and <a class="el" href="QuEST_8h_source.html#l00075">Vector::z</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__common_8c_source.html#l00039">getUnitVector()</a>, and <a class="el" href="QuEST__validation_8c_source.html#l00192">validateVector()</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                                     {</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">return</span> sqrt(vec.<a class="code" href="structVector.html#a0d0459a5b731ac5fb3dff2c6134e6e88">x</a>*vec.<a class="code" href="structVector.html#a0d0459a5b731ac5fb3dff2c6134e6e88">x</a> + vec.<a class="code" href="structVector.html#abc3cfc6c8e297b1153a373d84b981e6b">y</a>*vec.<a class="code" href="structVector.html#abc3cfc6c8e297b1153a373d84b981e6b">y</a> + vec.<a class="code" href="structVector.html#ab33976d8fda2e44b770f71269d698a25">z</a>*vec.<a class="code" href="structVector.html#ab33976d8fda2e44b770f71269d698a25">z</a>);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;}</div><div class="ttc" id="structVector_html_a0d0459a5b731ac5fb3dff2c6134e6e88"><div class="ttname"><a href="structVector.html#a0d0459a5b731ac5fb3dff2c6134e6e88">Vector::x</a></div><div class="ttdeci">qreal x</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00075">QuEST.h:75</a></div></div>
<div class="ttc" id="structVector_html_ab33976d8fda2e44b770f71269d698a25"><div class="ttname"><a href="structVector.html#ab33976d8fda2e44b770f71269d698a25">Vector::z</a></div><div class="ttdeci">qreal z</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00075">QuEST.h:75</a></div></div>
<div class="ttc" id="structVector_html_abc3cfc6c8e297b1153a373d84b981e6b"><div class="ttname"><a href="structVector.html#abc3cfc6c8e297b1153a373d84b981e6b">Vector::y</a></div><div class="ttdeci">qreal y</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00075">QuEST.h:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a404d177b894ce008289e44a599ad77d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a404d177b894ce008289e44a599ad77d6">&#9670;&nbsp;</a></span>getZYZRotAnglesFromComplexPair()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getZYZRotAnglesFromComplexPair </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>rz2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>ry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>rz1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>maps U(alpha, beta) to Rz(rz2) Ry(ry) Rz(rz1) </p>

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00074">74</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__qasm_8c_source.html#l00210">qasm_recordAxisRotation()</a>, <a class="el" href="QuEST__qasm_8c_source.html#l00182">qasm_recordCompactUnitary()</a>, <a class="el" href="QuEST__qasm_8c_source.html#l00287">qasm_recordControlledAxisRotation()</a>, <a class="el" href="QuEST__qasm_8c_source.html#l00251">qasm_recordControlledCompactUnitary()</a>, <a class="el" href="QuEST__qasm_8c_source.html#l00265">qasm_recordControlledUnitary()</a>, <a class="el" href="QuEST__qasm_8c_source.html#l00328">qasm_recordMultiControlledUnitary()</a>, and <a class="el" href="QuEST__qasm_8c_source.html#l00194">qasm_recordUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                                                                                                    {</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    </div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> alphaMag = sqrt(alpha.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*alpha.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> + alpha.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*alpha.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    *ry = 2.0 * acos(alphaMag);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    </div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> alphaPhase = atan2(alpha.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>, alpha.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> betaPhase  = atan2(beta.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>,  beta.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    *rz2 = - alphaPhase + betaPhase;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    *rz1 = - alphaPhase - betaPhase;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;}</div><div class="ttc" id="structComplex_html_ab5b2e2eca02131fc74b289a83636cbe3"><div class="ttname"><a href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">Complex::real</a></div><div class="ttdeci">qreal real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00059">QuEST.h:59</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00060">QuEST.h:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab76254cfde16f0808476649507a1a2fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab76254cfde16f0808476649507a1a2fc">&#9670;&nbsp;</a></span>hashString()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long int hashString </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>str</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00125">125</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__common_8c_source.html#l00135">seedQuESTDefault()</a>.</p>
<div class="fragment"><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                       {</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> hash = 5381;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordtype">int</span> c;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">while</span> ((c = *str++))</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        hash = ((hash &lt;&lt; 5) + hash) + c; <span class="comment">/* hash * 33 + c */</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">return</span> hash;    </div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="acf1c651a4359a370a2d9b3e1e1ebd430"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf1c651a4359a370a2d9b3e1e1ebd430">&#9670;&nbsp;</a></span>shiftIndices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void shiftIndices </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>indices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>shift</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00100">100</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00436">multiControlledPhaseFlip()</a>, <a class="el" href="QuEST_8c_source.html#l00386">multiControlledPhaseShift()</a>, and <a class="el" href="QuEST_8c_source.html#l00265">multiControlledUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                                                           {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; numIndices; j++)</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        indices[j] += shift;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="aeeec9fe1501e25930adf6c38763a158e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeeec9fe1501e25930adf6c38763a158e">&#9670;&nbsp;</a></span>statevec_calcFidelity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> statevec_calcFidelity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>pureState</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00328">328</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00041">statevec_calcInnerProduct()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00630">calcFidelity()</a>.</p>
<div class="fragment"><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                                                          {</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    </div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="structComplex.html">Complex</a> innerProd = <a class="code" href="QuEST__internal_8h.html#a7ebd3198a198f4cd20840f64fd8b84d0">statevec_calcInnerProduct</a>(qureg, pureState);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> innerProdMag = innerProd.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*innerProd.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> + innerProd.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*innerProd.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">return</span> innerProdMag;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;}</div><div class="ttc" id="QuEST__internal_8h_html_a7ebd3198a198f4cd20840f64fd8b84d0"><div class="ttname"><a href="QuEST__internal_8h.html#a7ebd3198a198f4cd20840f64fd8b84d0">statevec_calcInnerProduct</a></div><div class="ttdeci">Complex statevec_calcInnerProduct(Qureg bra, Qureg ket)</div><div class="ttdoc">Terrible code which unnecessarily individually computes and sums the real and imaginary components of...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00041">QuEST_cpu_distributed.c:41</a></div></div>
<div class="ttc" id="structComplex_html_ab5b2e2eca02131fc74b289a83636cbe3"><div class="ttname"><a href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">Complex::real</a></div><div class="ttdeci">qreal real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00059">QuEST.h:59</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00060">QuEST.h:60</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00057">QuEST.h:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7ebd3198a198f4cd20840f64fd8b84d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ebd3198a198f4cd20840f64fd8b84d0">&#9670;&nbsp;</a></span>statevec_calcInnerProduct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structComplex.html">Complex</a> statevec_calcInnerProduct </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>bra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>ket</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Terrible code which unnecessarily individually computes and sums the real and imaginary components of the inner product, so as to not have to worry about keeping the sums separated during reduction. </p>
<p>Truly disgusting, probably doubles runtime, please fix.  could even do the kernel twice, storing real in bra.reduc and imag in ket.reduc? </p>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00041">41</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__gpu_8cu_source.html#l01353">copySharedReduceBlock()</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::firstLevelReduction</a>, <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00097">Qureg::numChunks</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, <a class="el" href="QuEST__gpu_8cu_source.html#l00015">REDUCE_SHARED_SIZE</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::secondLevelReduction</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00850">statevec_calcInnerProductLocal()</a>, and <a class="el" href="QuEST__gpu_8cu_source.html#l01459">swapDouble()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00606">calcInnerProduct()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00328">statevec_calcFidelity()</a>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                                                        {</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    </div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="structComplex.html">Complex</a> localInnerProd = <a class="code" href="QuEST__cpu_8c.html#a6fbb3b693f25dde1e9e3dc87dc1984f7">statevec_calcInnerProductLocal</a>(bra, ket);</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">if</span> (bra.<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a> == 1)</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordflow">return</span> localInnerProd;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    </div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> localReal = localInnerProd.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> localImag = localInnerProd.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> globalReal, globalImag;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    MPI_Allreduce(&amp;localReal, &amp;globalReal, 1, MPI_QuEST_REAL, MPI_SUM, MPI_COMM_WORLD);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    MPI_Allreduce(&amp;localImag, &amp;globalImag, 1, MPI_QuEST_REAL, MPI_SUM, MPI_COMM_WORLD);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    </div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="structComplex.html">Complex</a> globalInnerProd;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    globalInnerProd.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> = globalReal;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    globalInnerProd.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = globalImag;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">return</span> globalInnerProd;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;}</div><div class="ttc" id="QuEST__cpu_8c_html_a6fbb3b693f25dde1e9e3dc87dc1984f7"><div class="ttname"><a href="QuEST__cpu_8c.html#a6fbb3b693f25dde1e9e3dc87dc1984f7">statevec_calcInnerProductLocal</a></div><div class="ttdeci">Complex statevec_calcInnerProductLocal(Qureg bra, Qureg ket)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00850">QuEST_cpu.c:850</a></div></div>
<div class="ttc" id="structComplex_html_ab5b2e2eca02131fc74b289a83636cbe3"><div class="ttname"><a href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">Complex::real</a></div><div class="ttdeci">qreal real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00059">QuEST.h:59</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_aa3deb7163aab90a61e755a1f200f5413"><div class="ttname"><a href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">Qureg::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into – the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00097">QuEST.h:97</a></div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00060">QuEST.h:60</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00057">QuEST.h:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab33cdf01831c4545e51299178acf7f27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab33cdf01831c4545e51299178acf7f27">&#9670;&nbsp;</a></span>statevec_calcProbOfOutcome()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> statevec_calcProbOfOutcome </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>outcome</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01215">1215</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01206">isChunkToSkipInFindPZero()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST__gpu_8cu_source.html#l01514">statevec_findProbabilityOfZero()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02749">statevec_findProbabilityOfZeroDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02692">statevec_findProbabilityOfZeroLocal()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00614">calcProbOfOutcome()</a>, <a class="el" href="QuEST_8c_source.html#l00539">collapseToOutcome()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00312">statevec_measureWithStats()</a>.</p>
<div class="fragment"><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;{</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateProb=0, totalStateProb=0;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="keywordtype">int</span> skipValuesWithinRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, measureQubit);</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="keywordflow">if</span> (skipValuesWithinRank) {</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        stateProb = <a class="code" href="QuEST__cpu_8c.html#afa06d0143cea46f1e425c61ac6f6f9a2">statevec_findProbabilityOfZeroLocal</a>(qureg, measureQubit);</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="QuEST__cpu__distributed_8c.html#af0ea25f00987af4c53f17c9cca62ab41">isChunkToSkipInFindPZero</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, measureQubit)){</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;            stateProb = <a class="code" href="QuEST__cpu_8c.html#aa2e838d65b214d266cd51ad0091ad827">statevec_findProbabilityOfZeroDistributed</a>(qureg, measureQubit);</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        } <span class="keywordflow">else</span> stateProb = 0;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    }</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    MPI_Allreduce(&amp;stateProb, &amp;totalStateProb, 1, MPI_QuEST_REAL, MPI_SUM, MPI_COMM_WORLD);</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordflow">if</span> (outcome==1) totalStateProb = 1.0 - totalStateProb;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <span class="keywordflow">return</span> totalStateProb;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;}</div><div class="ttc" id="QuEST__cpu__distributed_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00366">QuEST_cpu_distributed.c:366</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_aa2e838d65b214d266cd51ad0091ad827"><div class="ttname"><a href="QuEST__cpu_8c.html#aa2e838d65b214d266cd51ad0091ad827">statevec_findProbabilityOfZeroDistributed</a></div><div class="ttdeci">qreal statevec_findProbabilityOfZeroDistributed(Qureg qureg, const int measureQubit)</div><div class="ttdoc">Measure the probability of a specified qubit being in the zero state across all amplitudes held in th...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02749">QuEST_cpu.c:2749</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_af0ea25f00987af4c53f17c9cca62ab41"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#af0ea25f00987af4c53f17c9cca62ab41">isChunkToSkipInFindPZero</a></div><div class="ttdeci">static int isChunkToSkipInFindPZero(int chunkId, long long int chunkSize, int measureQubit)</div><div class="ttdoc">Find chunks to skip when calculating probability of qubit being zero. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l01206">QuEST_cpu_distributed.c:1206</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_afa06d0143cea46f1e425c61ac6f6f9a2"><div class="ttname"><a href="QuEST__cpu_8c.html#afa06d0143cea46f1e425c61ac6f6f9a2">statevec_findProbabilityOfZeroLocal</a></div><div class="ttdeci">qreal statevec_findProbabilityOfZeroLocal(Qureg qureg, const int measureQubit)</div><div class="ttdoc">Measure the total probability of a specified qubit being in the zero state across all amplitudes in t...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02692">QuEST_cpu.c:2692</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad65ad1b5ea6f30b0c6b4ffda96e1a8e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad65ad1b5ea6f30b0c6b4ffda96e1a8e6">&#9670;&nbsp;</a></span>statevec_calcTotalProb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> statevec_calcTotalProb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00094">94</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00246">chunkIsUpperInOuterBlock()</a>, <a class="el" href="QuEST__gpu_8cu_source.html#l00291">copyStateFromGPU()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00204">getChunkIdFromIndex()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00324">getChunkOuterBlockPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00268">getRotAngle()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01206">isChunkToSkipInFindPZero()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00097">Qureg::numChunks</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00599">calcTotalProb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                                         {</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">// Implemented using Kahan summation for greater accuracy at a slight floating</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">//   point operation overhead. For more details see https://en.wikipedia.org/wiki/Kahan_summation_algorithm</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> pTotal=0; </div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> y, t, c;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> allRankTotals=0;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmpsPerRank = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    c = 0.0;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">for</span> (index=0; index&lt;numAmpsPerRank; index++){ </div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="comment">// Perform pTotal+=qureg.stateVec.real[index]*qureg.stateVec.real[index]; by Kahan</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        y = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[index]*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[index] - c;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        t = pTotal + y;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="comment">// Don&#39;t change the bracketing on the following line</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        c = ( t - pTotal ) - y;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        pTotal = t;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="comment">// Perform pTotal+=qureg.stateVec.imag[index]*qureg.stateVec.imag[index]; by Kahan</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        y = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[index]*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[index] - c;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        t = pTotal + y;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="comment">// Don&#39;t change the bracketing on the following line</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        c = ( t - pTotal ) - y;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        pTotal = t;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    } </div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a>&gt;1)</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                MPI_Allreduce(&amp;pTotal, &amp;allRankTotals, 1, MPI_QuEST_REAL, MPI_SUM, MPI_COMM_WORLD);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">else</span> </div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                allRankTotals=pTotal;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">return</span> allRankTotals;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_aa3deb7163aab90a61e755a1f200f5413"><div class="ttname"><a href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">Qureg::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into – the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00097">QuEST.h:97</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa4b77089145184d990848cd66993aa8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4b77089145184d990848cd66993aa8b">&#9670;&nbsp;</a></span>statevec_cloneQureg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_cloneQureg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>targetQureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>copyQureg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>works for both statevectors and density matrices </p>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01236">1236</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00148">cloneQureg()</a>, and <a class="el" href="QuEST_8c_source.html#l00119">initPureState()</a>.</p>
<div class="fragment"><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                                                             {</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    </div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="comment">// registers are equal sized, so nodes hold the same state-vector partitions</span></div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    stateVecSize = targetQureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="comment">// Can&#39;t use qureg-&gt;stateVec as a private OMP var</span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *targetStateVecReal = targetQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *targetStateVecImag = targetQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *copyStateVecReal = copyQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *copyStateVecImag = copyQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="comment">// initialise the state to |0000..0000&gt;</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="preprocessor">    shared   (stateVecSize, targetStateVecReal, targetStateVecImag, copyStateVecReal, copyStateVecImag) \</span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="preprocessor">    private  (index) </span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    {</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;            targetStateVecReal[index] = copyStateVecReal[index];</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;            targetStateVecImag[index] = copyStateVecImag[index];</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        }</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    }</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae7f25bb40734e18a992403b17355893b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7f25bb40734e18a992403b17355893b">&#9670;&nbsp;</a></span>statevec_collapseToKnownProbOutcome()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_collapseToKnownProbOutcome </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>outcome</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>outcomeProb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01253">1253</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01206">isChunkToSkipInFindPZero()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02953">statevec_collapseToKnownProbOutcomeDistributedRenorm()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02871">statevec_collapseToKnownProbOutcomeLocal()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02992">statevec_collapseToOutcomeDistributedSetZero()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00539">collapseToOutcome()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00312">statevec_measureWithStats()</a>.</p>
<div class="fragment"><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;{</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <span class="keywordtype">int</span> skipValuesWithinRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, measureQubit);</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="keywordflow">if</span> (skipValuesWithinRank) {</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        <a class="code" href="QuEST__cpu_8c.html#ab02bce0ebbb8f624e8ced8b09b99cdef">statevec_collapseToKnownProbOutcomeLocal</a>(qureg, measureQubit, outcome, totalStateProb);</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="QuEST__cpu__distributed_8c.html#af0ea25f00987af4c53f17c9cca62ab41">isChunkToSkipInFindPZero</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, measureQubit)){</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;            <span class="comment">// chunk has amps for q=0</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;            <span class="keywordflow">if</span> (outcome==0) <a class="code" href="QuEST__cpu_8c.html#acd82c94cfac89eacb901348ff0d06af8">statevec_collapseToKnownProbOutcomeDistributedRenorm</a>(qureg, measureQubit, </div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                    totalStateProb);</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;            <span class="keywordflow">else</span> <a class="code" href="QuEST__cpu_8c.html#a7ea68e9132ed9db9c242353a33dba2f0">statevec_collapseToOutcomeDistributedSetZero</a>(qureg);</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;            <span class="comment">// chunk has amps for q=1</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;            <span class="keywordflow">if</span> (outcome==1) <a class="code" href="QuEST__cpu_8c.html#acd82c94cfac89eacb901348ff0d06af8">statevec_collapseToKnownProbOutcomeDistributedRenorm</a>(qureg, measureQubit, </div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                    totalStateProb);</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            <span class="keywordflow">else</span> <a class="code" href="QuEST__cpu_8c.html#a7ea68e9132ed9db9c242353a33dba2f0">statevec_collapseToOutcomeDistributedSetZero</a>(qureg);</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        }</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    }</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;}</div><div class="ttc" id="QuEST__cpu__distributed_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00366">QuEST_cpu_distributed.c:366</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a7ea68e9132ed9db9c242353a33dba2f0"><div class="ttname"><a href="QuEST__cpu_8c.html#a7ea68e9132ed9db9c242353a33dba2f0">statevec_collapseToOutcomeDistributedSetZero</a></div><div class="ttdeci">void statevec_collapseToOutcomeDistributedSetZero(Qureg qureg)</div><div class="ttdoc">Set all amplitudes in one chunk to 0. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02992">QuEST_cpu.c:2992</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_ab02bce0ebbb8f624e8ced8b09b99cdef"><div class="ttname"><a href="QuEST__cpu_8c.html#ab02bce0ebbb8f624e8ced8b09b99cdef">statevec_collapseToKnownProbOutcomeLocal</a></div><div class="ttdeci">void statevec_collapseToKnownProbOutcomeLocal(Qureg qureg, int measureQubit, int outcome, qreal totalProbability)</div><div class="ttdoc">Update the state vector to be consistent with measuring measureQubit=0 if outcome=0 and measureQubit=...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02871">QuEST_cpu.c:2871</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_acd82c94cfac89eacb901348ff0d06af8"><div class="ttname"><a href="QuEST__cpu_8c.html#acd82c94cfac89eacb901348ff0d06af8">statevec_collapseToKnownProbOutcomeDistributedRenorm</a></div><div class="ttdeci">void statevec_collapseToKnownProbOutcomeDistributedRenorm(Qureg qureg, const int measureQubit, const qreal totalProbability)</div><div class="ttdoc">Renormalise parts of the state vector where measureQubit=0 or 1, based on the total probability of th...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02953">QuEST_cpu.c:2953</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_af0ea25f00987af4c53f17c9cca62ab41"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#af0ea25f00987af4c53f17c9cca62ab41">isChunkToSkipInFindPZero</a></div><div class="ttdeci">static int isChunkToSkipInFindPZero(int chunkId, long long int chunkSize, int measureQubit)</div><div class="ttdoc">Find chunks to skip when calculating probability of qubit being zero. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l01206">QuEST_cpu_distributed.c:1206</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a94ee4df9faba286ad7a5bc829ef5174d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94ee4df9faba286ad7a5bc829ef5174d">&#9670;&nbsp;</a></span>statevec_compactUnitary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_compactUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00795">795</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">exchangeStateVectors()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00268">getRotAngle()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l01547">statevec_compactUnitaryDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l01418">statevec_compactUnitaryLocal()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00280">compactUnitary()</a>, <a class="el" href="QuEST__common_8c_source.html#l00262">statevec_rotateAroundAxis()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00269">statevec_rotateAroundAxisConj()</a>.</p>
<div class="fragment"><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;{</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <a class="code" href="structComplex.html">Complex</a> rot1, rot2;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="comment">// rank&#39;s chunk is in upper half of block </span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keywordtype">int</span> rankIsUpper;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keywordflow">if</span> (useLocalDataOnly){</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <span class="comment">// all values required to update state vector lie in this rank</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <a class="code" href="QuEST__cpu_8c.html#aa5865e66a6e0993ae17d400c9ee0eb43">statevec_compactUnitaryLocal</a>(qureg, targetQubit, alpha, beta);</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="comment">// need to get corresponding chunk of state vector from other rank</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <a class="code" href="QuEST__cpu__distributed_8c.html#adb4b0373425b282abed27742d0ce0872">getRotAngle</a>(rankIsUpper, &amp;rot1, &amp;rot2, alpha, beta);</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <span class="comment">// get corresponding values from my pair</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <a class="code" href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a>(qureg, pairRank);</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        <span class="comment">// this rank&#39;s values are either in the upper of lower half of the block. </span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <span class="comment">// send values to compactUnitaryDistributed in the correct order</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        <span class="keywordflow">if</span> (rankIsUpper){</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#aede1ba1fc2d189001745ee6f76f8caa7">statevec_compactUnitaryDistributed</a>(qureg,targetQubit,rot1,rot2,</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>, <span class="comment">//upper</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                    qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>, <span class="comment">//lower</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>); <span class="comment">//output</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#aede1ba1fc2d189001745ee6f76f8caa7">statevec_compactUnitaryDistributed</a>(qureg,targetQubit,rot1,rot2,</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                    qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>, <span class="comment">//upper</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>, <span class="comment">//lower</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>); <span class="comment">//output</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        }</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    }</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00366">QuEST_cpu_distributed.c:366</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a7dba097f23f5d48dfdc9f3250444e2e4"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a></div><div class="ttdeci">static int getChunkPairId(int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">get position of corresponding chunk, holding values required to update values in my chunk (with chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00313">QuEST_cpu_distributed.c:313</a></div></div>
<div class="ttc" id="structQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00102">QuEST.h:102</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_adb4b0373425b282abed27742d0ce0872"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#adb4b0373425b282abed27742d0ce0872">getRotAngle</a></div><div class="ttdeci">static void getRotAngle(int chunkIsUpper, Complex *rot1, Complex *rot2, Complex alpha, Complex beta)</div><div class="ttdoc">Get rotation values for a given chunk. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00268">QuEST_cpu_distributed.c:268</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00237">QuEST_cpu_distributed.c:237</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_aede1ba1fc2d189001745ee6f76f8caa7"><div class="ttname"><a href="QuEST__cpu_8c.html#aede1ba1fc2d189001745ee6f76f8caa7">statevec_compactUnitaryDistributed</a></div><div class="ttdeci">void statevec_compactUnitaryDistributed(Qureg qureg, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</div><div class="ttdoc">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha ...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l01547">QuEST_cpu.c:1547</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_ae01c3eb75fd32de1a7e1dbc7a33a21e3"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a></div><div class="ttdeci">void exchangeStateVectors(Qureg qureg, int pairRank)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00457">QuEST_cpu_distributed.c:457</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_aa5865e66a6e0993ae17d400c9ee0eb43"><div class="ttname"><a href="QuEST__cpu_8c.html#aa5865e66a6e0993ae17d400c9ee0eb43">statevec_compactUnitaryLocal</a></div><div class="ttdeci">void statevec_compactUnitaryLocal(Qureg qureg, const int targetQubit, Complex alpha, Complex beta)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l01418">QuEST_cpu.c:1418</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00057">QuEST.h:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6cecbad32a03416138b321cdc1a2c33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6cecbad32a03416138b321cdc1a2c33">&#9670;&nbsp;</a></span>statevec_compareStates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int statevec_compareStates </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>mq1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>mq2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>precision</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01405">1405</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__gpu_8cu_source.html#l00291">copyStateFromGPU()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00684">compareStates()</a>.</p>
<div class="fragment"><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                                                                 {</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> diff;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="keywordtype">int</span> chunkSize = mq1.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    </div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;chunkSize; i++){</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;        diff = absReal(mq1.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[i] - mq2.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[i]);</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;        <span class="keywordflow">if</span> (diff&gt;precision) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        diff = absReal(mq1.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[i] - mq2.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[i]);</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        <span class="keywordflow">if</span> (diff&gt;precision) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    }</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a47b467a5445c7f15d1a8b0b2ec0ef2de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47b467a5445c7f15d1a8b0b2ec0ef2de">&#9670;&nbsp;</a></span>statevec_controlledCompactUnitary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledCompactUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00871">871</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">exchangeStateVectors()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00268">getRotAngle()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l01857">statevec_controlledCompactUnitaryDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l01648">statevec_controlledCompactUnitaryLocal()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00293">controlledCompactUnitary()</a>, <a class="el" href="QuEST__common_8c_source.html#l00278">statevec_controlledRotateAroundAxis()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00285">statevec_controlledRotateAroundAxisConj()</a>.</p>
<div class="fragment"><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;{</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <a class="code" href="structComplex.html">Complex</a> rot1, rot2;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="comment">// rank&#39;s chunk is in upper half of block </span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keywordtype">int</span> rankIsUpper;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="keywordflow">if</span> (useLocalDataOnly){</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <span class="comment">// all values required to update state vector lie in this rank</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <a class="code" href="QuEST__cpu_8c.html#a0e5527c6e144fab8062ea5296e8bdf2a">statevec_controlledCompactUnitaryLocal</a>(qureg, controlQubit, targetQubit, alpha, beta);</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        <span class="comment">// need to get corresponding chunk of state vector from other rank</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        <a class="code" href="QuEST__cpu__distributed_8c.html#adb4b0373425b282abed27742d0ce0872">getRotAngle</a>(rankIsUpper, &amp;rot1, &amp;rot2, alpha, beta);</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        <span class="comment">//printf(&quot;%d rank has pair rank: %d\n&quot;, qureg.rank, pairRank);</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="comment">// get corresponding values from my pair</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <a class="code" href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a>(qureg, pairRank);</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        <span class="comment">// this rank&#39;s values are either in the upper of lower half of the block. send values to controlledCompactUnitaryDistributed</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="comment">// in the correct order</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <span class="keywordflow">if</span> (rankIsUpper){</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a5837db2f736dce21fb28dad168a23130">statevec_controlledCompactUnitaryDistributed</a>(qureg,controlQubit,targetQubit,rot1,rot2,</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>, <span class="comment">//upper</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                    qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>, <span class="comment">//lower</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>); <span class="comment">//output</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a5837db2f736dce21fb28dad168a23130">statevec_controlledCompactUnitaryDistributed</a>(qureg,controlQubit,targetQubit,rot1,rot2,</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                    qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>, <span class="comment">//upper</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>, <span class="comment">//lower</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>); <span class="comment">//output</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        }</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    }</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;}</div><div class="ttc" id="QuEST__cpu_8c_html_a5837db2f736dce21fb28dad168a23130"><div class="ttname"><a href="QuEST__cpu_8c.html#a5837db2f736dce21fb28dad168a23130">statevec_controlledCompactUnitaryDistributed</a></div><div class="ttdeci">void statevec_controlledCompactUnitaryDistributed(Qureg qureg, const int controlQubit, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</div><div class="ttdoc">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha ...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l01857">QuEST_cpu.c:1857</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00366">QuEST_cpu_distributed.c:366</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a0e5527c6e144fab8062ea5296e8bdf2a"><div class="ttname"><a href="QuEST__cpu_8c.html#a0e5527c6e144fab8062ea5296e8bdf2a">statevec_controlledCompactUnitaryLocal</a></div><div class="ttdeci">void statevec_controlledCompactUnitaryLocal(Qureg qureg, const int controlQubit, const int targetQubit, Complex alpha, Complex beta)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l01648">QuEST_cpu.c:1648</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a7dba097f23f5d48dfdc9f3250444e2e4"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a></div><div class="ttdeci">static int getChunkPairId(int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">get position of corresponding chunk, holding values required to update values in my chunk (with chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00313">QuEST_cpu_distributed.c:313</a></div></div>
<div class="ttc" id="structQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00102">QuEST.h:102</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_adb4b0373425b282abed27742d0ce0872"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#adb4b0373425b282abed27742d0ce0872">getRotAngle</a></div><div class="ttdeci">static void getRotAngle(int chunkIsUpper, Complex *rot1, Complex *rot2, Complex alpha, Complex beta)</div><div class="ttdoc">Get rotation values for a given chunk. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00268">QuEST_cpu_distributed.c:268</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00237">QuEST_cpu_distributed.c:237</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_ae01c3eb75fd32de1a7e1dbc7a33a21e3"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a></div><div class="ttdeci">void exchangeStateVectors(Qureg qureg, int pairRank)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00457">QuEST_cpu_distributed.c:457</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00057">QuEST.h:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a114038296eb404b9b8a66aaad7b48800"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a114038296eb404b9b8a66aaad7b48800">&#9670;&nbsp;</a></span>statevec_controlledNot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledNot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01015">1015</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">exchangeStateVectors()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02184">statevec_controlledNotDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02121">statevec_controlledNotLocal()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00400">controlledNot()</a>.</p>
<div class="fragment"><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;{</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordtype">int</span> rankIsUpper;    <span class="comment">// rank&#39;s chunk is in upper half of block </span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="keywordtype">int</span> pairRank;               <span class="comment">// rank of corresponding chunk</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="keywordflow">if</span> (useLocalDataOnly){</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        <span class="comment">// all values required to update state vector lie in this rank</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        <a class="code" href="QuEST__cpu_8c.html#a11c9685e4ad1f44cfd6243e0c4435893">statevec_controlledNotLocal</a>(qureg, controlQubit, targetQubit);</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        <span class="comment">// need to get corresponding chunk of state vector from other rank</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        <span class="comment">// get corresponding values from my pair</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <a class="code" href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a>(qureg, pairRank);</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        <span class="comment">// this rank&#39;s values are either in the upper of lower half of the block</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        <span class="keywordflow">if</span> (rankIsUpper){</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#afa036cb8b502ef9a0977885ea74e41bc">statevec_controlledNotDistributed</a>(qureg,controlQubit,targetQubit,</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                    qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>, <span class="comment">//in</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>); <span class="comment">//out</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#afa036cb8b502ef9a0977885ea74e41bc">statevec_controlledNotDistributed</a>(qureg,controlQubit,targetQubit,</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                    qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>, <span class="comment">//in</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>); <span class="comment">//out</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        }</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    }</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;}</div><div class="ttc" id="QuEST__cpu_8c_html_a11c9685e4ad1f44cfd6243e0c4435893"><div class="ttname"><a href="QuEST__cpu_8c.html#a11c9685e4ad1f44cfd6243e0c4435893">statevec_controlledNotLocal</a></div><div class="ttdeci">void statevec_controlledNotLocal(Qureg qureg, const int controlQubit, const int targetQubit)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02121">QuEST_cpu.c:2121</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_afa036cb8b502ef9a0977885ea74e41bc"><div class="ttname"><a href="QuEST__cpu_8c.html#afa036cb8b502ef9a0977885ea74e41bc">statevec_controlledNotDistributed</a></div><div class="ttdeci">void statevec_controlledNotDistributed(Qureg qureg, const int controlQubit, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut)</div><div class="ttdoc">Rotate a single qubit by {{0,1},{1,0}. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02184">QuEST_cpu.c:2184</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00366">QuEST_cpu_distributed.c:366</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a7dba097f23f5d48dfdc9f3250444e2e4"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a></div><div class="ttdeci">static int getChunkPairId(int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">get position of corresponding chunk, holding values required to update values in my chunk (with chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00313">QuEST_cpu_distributed.c:313</a></div></div>
<div class="ttc" id="structQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00102">QuEST.h:102</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00237">QuEST_cpu_distributed.c:237</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_ae01c3eb75fd32de1a7e1dbc7a33a21e3"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a></div><div class="ttdeci">void exchangeStateVectors(Qureg qureg, int pairRank)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00457">QuEST_cpu_distributed.c:457</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a708246b16236c492094c2633da0c08ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a708246b16236c492094c2633da0c08ff">&#9670;&nbsp;</a></span>statevec_controlledPauliY()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledPauliY </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01094">1094</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">exchangeStateVectors()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02366">statevec_controlledPauliYDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02313">statevec_controlledPauliYLocal()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00412">controlledPauliY()</a>.</p>
<div class="fragment"><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;{</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        <span class="keywordtype">int</span> conjFac = 1;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keywordtype">int</span> rankIsUpper;    <span class="comment">// rank&#39;s chunk is in upper half of block </span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="keywordtype">int</span> pairRank;               <span class="comment">// rank of corresponding chunk</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="keywordflow">if</span> (useLocalDataOnly){</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        <span class="comment">// all values required to update state vector lie in this rank</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        <a class="code" href="QuEST__cpu_8c.html#a9028deac63419d71d523f73229a7bd84">statevec_controlledPauliYLocal</a>(qureg, controlQubit, targetQubit, conjFac);</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        <span class="comment">// need to get corresponding chunk of state vector from other rank</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        <span class="comment">// get corresponding values from my pair</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        <a class="code" href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a>(qureg, pairRank);</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        <span class="comment">// this rank&#39;s values are either in the upper of lower half of the block</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        <span class="keywordflow">if</span> (rankIsUpper){</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a85014e8266bebf037bc2d66f80ca5936">statevec_controlledPauliYDistributed</a>(qureg,controlQubit,targetQubit,</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                    qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>, <span class="comment">//in</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>,</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                                        conjFac); <span class="comment">//out</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a85014e8266bebf037bc2d66f80ca5936">statevec_controlledPauliYDistributed</a>(qureg,controlQubit,targetQubit,</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                    qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>, <span class="comment">//in</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>,</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                                        conjFac); <span class="comment">//out</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        }</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    }</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00366">QuEST_cpu_distributed.c:366</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a85014e8266bebf037bc2d66f80ca5936"><div class="ttname"><a href="QuEST__cpu_8c.html#a85014e8266bebf037bc2d66f80ca5936">statevec_controlledPauliYDistributed</a></div><div class="ttdeci">void statevec_controlledPauliYDistributed(Qureg qureg, const int controlQubit, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut, const int conjFac)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02366">QuEST_cpu.c:2366</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a9028deac63419d71d523f73229a7bd84"><div class="ttname"><a href="QuEST__cpu_8c.html#a9028deac63419d71d523f73229a7bd84">statevec_controlledPauliYLocal</a></div><div class="ttdeci">void statevec_controlledPauliYLocal(Qureg qureg, const int controlQubit, const int targetQubit, const int conjFac)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02313">QuEST_cpu.c:2313</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a7dba097f23f5d48dfdc9f3250444e2e4"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a></div><div class="ttdeci">static int getChunkPairId(int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">get position of corresponding chunk, holding values required to update values in my chunk (with chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00313">QuEST_cpu_distributed.c:313</a></div></div>
<div class="ttc" id="structQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00102">QuEST.h:102</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00237">QuEST_cpu_distributed.c:237</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_ae01c3eb75fd32de1a7e1dbc7a33a21e3"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a></div><div class="ttdeci">void exchangeStateVectors(Qureg qureg, int pairRank)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00457">QuEST_cpu_distributed.c:457</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9e647339720bf82b30c6331fad544ec5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e647339720bf82b30c6331fad544ec5">&#9670;&nbsp;</a></span>statevec_controlledPauliYConj()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledPauliYConj </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01127">1127</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">exchangeStateVectors()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02366">statevec_controlledPauliYDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02313">statevec_controlledPauliYLocal()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00412">controlledPauliY()</a>.</p>
<div class="fragment"><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;{</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        <span class="keywordtype">int</span> conjFac = -1;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="keywordtype">int</span> rankIsUpper;    <span class="comment">// rank&#39;s chunk is in upper half of block </span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="keywordtype">int</span> pairRank;               <span class="comment">// rank of corresponding chunk</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="keywordflow">if</span> (useLocalDataOnly){</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        <span class="comment">// all values required to update state vector lie in this rank</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        <a class="code" href="QuEST__cpu_8c.html#a9028deac63419d71d523f73229a7bd84">statevec_controlledPauliYLocal</a>(qureg, controlQubit, targetQubit, conjFac);</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        <span class="comment">// need to get corresponding chunk of state vector from other rank</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        <span class="comment">// get corresponding values from my pair</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        <a class="code" href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a>(qureg, pairRank);</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        <span class="comment">// this rank&#39;s values are either in the upper of lower half of the block</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="keywordflow">if</span> (rankIsUpper){</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a85014e8266bebf037bc2d66f80ca5936">statevec_controlledPauliYDistributed</a>(qureg,controlQubit,targetQubit,</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                    qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>, <span class="comment">//in</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>,</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                                        conjFac); <span class="comment">//out</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a85014e8266bebf037bc2d66f80ca5936">statevec_controlledPauliYDistributed</a>(qureg,controlQubit,targetQubit,</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                    qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>, <span class="comment">//in</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>,</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                                        conjFac); <span class="comment">//out</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        }</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    }</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00366">QuEST_cpu_distributed.c:366</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a85014e8266bebf037bc2d66f80ca5936"><div class="ttname"><a href="QuEST__cpu_8c.html#a85014e8266bebf037bc2d66f80ca5936">statevec_controlledPauliYDistributed</a></div><div class="ttdeci">void statevec_controlledPauliYDistributed(Qureg qureg, const int controlQubit, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut, const int conjFac)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02366">QuEST_cpu.c:2366</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a9028deac63419d71d523f73229a7bd84"><div class="ttname"><a href="QuEST__cpu_8c.html#a9028deac63419d71d523f73229a7bd84">statevec_controlledPauliYLocal</a></div><div class="ttdeci">void statevec_controlledPauliYLocal(Qureg qureg, const int controlQubit, const int targetQubit, const int conjFac)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02313">QuEST_cpu.c:2313</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a7dba097f23f5d48dfdc9f3250444e2e4"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a></div><div class="ttdeci">static int getChunkPairId(int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">get position of corresponding chunk, holding values required to update values in my chunk (with chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00313">QuEST_cpu_distributed.c:313</a></div></div>
<div class="ttc" id="structQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00102">QuEST.h:102</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00237">QuEST_cpu_distributed.c:237</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_ae01c3eb75fd32de1a7e1dbc7a33a21e3"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a></div><div class="ttdeci">void exchangeStateVectors(Qureg qureg, int pairRank)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00457">QuEST_cpu_distributed.c:457</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c0067cb9f243ead20de7392aea328bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c0067cb9f243ead20de7392aea328bc">&#9670;&nbsp;</a></span>statevec_controlledPhaseFlip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledPhaseFlip </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>idQubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>idQubit2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02789">2789</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00424">controlledPhaseFlip()</a>.</p>
<div class="fragment"><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;{</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;    <span class="keywordtype">int</span> bit1, bit2;</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;    </div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;    stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;<span class="preprocessor"># pragma omp parallel for \</span></div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;<span class="preprocessor">    default  (none)              \</span></div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;<span class="preprocessor">    shared   (stateVecSize, stateVecReal,stateVecImag ) \</span></div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;<span class="preprocessor">    private  (index,bit1,bit2)             \</span></div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;<span class="preprocessor">    schedule (static)</span></div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;    <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;        bit1 = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (idQubit1, index+chunkId*chunkSize);</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;        bit2 = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (idQubit2, index+chunkId*chunkSize);</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;        <span class="keywordflow">if</span> (bit1 &amp;&amp; bit2) {</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;            stateVecReal [index] = - stateVecReal [index];</div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;            stateVecImag [index] = - stateVecImag [index];</div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;        }</div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;    }</div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a100463f6ec212c76a5fad99579000505"><div class="ttname"><a href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a></div><div class="ttdeci">static int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdoc">Get the value of the bit at a particular index in a number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00031">QuEST_cpu.c:31</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adeb715f3f2c167f9bfbe92b75f5988ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adeb715f3f2c167f9bfbe92b75f5988ce">&#9670;&nbsp;</a></span>statevec_controlledPhaseShift()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledPhaseShift </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>idQubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>idQubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02554">2554</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00374">controlledPhaseShift()</a>.</p>
<div class="fragment"><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;{</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;    <span class="keywordtype">int</span> bit1, bit2;</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;    </div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;    stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;    </div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealLo, stateImagLo;</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> cosAngle = cos(angle);</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;    <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> sinAngle = sin(angle);</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;<span class="preprocessor"># pragma omp parallel for \</span></div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;<span class="preprocessor">    default  (none)              \</span></div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;<span class="preprocessor">    shared   (stateVecSize, stateVecReal,stateVecImag ) \</span></div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;<span class="preprocessor">    private  (index,bit1,bit2,stateRealLo,stateImagLo)             \</span></div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;<span class="preprocessor">    schedule (static)</span></div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;    <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;        bit1 = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (idQubit1, index+chunkId*chunkSize);</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;        bit2 = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (idQubit2, index+chunkId*chunkSize);</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;        <span class="keywordflow">if</span> (bit1 &amp;&amp; bit2) {</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;            </div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;            stateRealLo = stateVecReal[index];</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;            stateImagLo = stateVecImag[index];</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;            </div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;            stateVecReal[index] = cosAngle*stateRealLo - sinAngle*stateImagLo;</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;            stateVecImag[index] = sinAngle*stateRealLo + cosAngle*stateImagLo;  </div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;        }</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;    }</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a100463f6ec212c76a5fad99579000505"><div class="ttname"><a href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a></div><div class="ttdeci">static int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdoc">Get the value of the bit at a particular index in a number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00031">QuEST_cpu.c:31</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2c489375aad6fb71203553c60bff043b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c489375aad6fb71203553c60bff043b">&#9670;&nbsp;</a></span>statevec_controlledRotateAroundAxis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledRotateAroundAxis </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structVector.html">Vector</a>&#160;</td>
          <td class="paramname"><em>axis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00278">278</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__common_8c_source.html#l00064">getComplexPairFromRotation()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00871">statevec_controlledCompactUnitary()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00463">controlledRotateAroundAxis()</a>, <a class="el" href="QuEST__common_8c_source.html#l00294">statevec_controlledRotateX()</a>, <a class="el" href="QuEST__common_8c_source.html#l00300">statevec_controlledRotateY()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00306">statevec_controlledRotateZ()</a>.</p>
<div class="fragment"><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                                                                                                                              {</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <a class="code" href="structComplex.html">Complex</a> alpha, beta;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <a class="code" href="QuEST__common_8c.html#a71b3ae4402c1c5039d3086ca0e47a522">getComplexPairFromRotation</a>(angle, axis, &amp;alpha, &amp;beta);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="QuEST__internal_8h.html#a47b467a5445c7f15d1a8b0b2ec0ef2de">statevec_controlledCompactUnitary</a>(qureg, controlQubit, targetQubit, alpha, beta);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div><div class="ttc" id="QuEST__common_8c_html_a71b3ae4402c1c5039d3086ca0e47a522"><div class="ttname"><a href="QuEST__common_8c.html#a71b3ae4402c1c5039d3086ca0e47a522">getComplexPairFromRotation</a></div><div class="ttdeci">void getComplexPairFromRotation(qreal angle, Vector axis, Complex *alpha, Complex *beta)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__common_8c_source.html#l00064">QuEST_common.c:64</a></div></div>
<div class="ttc" id="QuEST__internal_8h_html_a47b467a5445c7f15d1a8b0b2ec0ef2de"><div class="ttname"><a href="QuEST__internal_8h.html#a47b467a5445c7f15d1a8b0b2ec0ef2de">statevec_controlledCompactUnitary</a></div><div class="ttdeci">void statevec_controlledCompactUnitary(Qureg qureg, const int controlQubit, const int targetQubit, Complex alpha, Complex beta)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00871">QuEST_cpu_distributed.c:871</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00057">QuEST.h:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeb4ddeb09a3c0fa39ac33984bd5ca0ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb4ddeb09a3c0fa39ac33984bd5ca0ea">&#9670;&nbsp;</a></span>statevec_controlledRotateAroundAxisConj()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledRotateAroundAxisConj </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structVector.html">Vector</a>&#160;</td>
          <td class="paramname"><em>axis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00285">285</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__common_8c_source.html#l00064">getComplexPairFromRotation()</a>, <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00871">statevec_controlledCompactUnitary()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00463">controlledRotateAroundAxis()</a>.</p>
<div class="fragment"><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                                                                                                                                  {</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="structComplex.html">Complex</a> alpha, beta;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="QuEST__common_8c.html#a71b3ae4402c1c5039d3086ca0e47a522">getComplexPairFromRotation</a>(angle, axis, &amp;alpha, &amp;beta);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    alpha.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> *= -1; </div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    beta.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> *= -1;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="QuEST__internal_8h.html#a47b467a5445c7f15d1a8b0b2ec0ef2de">statevec_controlledCompactUnitary</a>(qureg, controlQubit, targetQubit, alpha, beta);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;}</div><div class="ttc" id="QuEST__common_8c_html_a71b3ae4402c1c5039d3086ca0e47a522"><div class="ttname"><a href="QuEST__common_8c.html#a71b3ae4402c1c5039d3086ca0e47a522">getComplexPairFromRotation</a></div><div class="ttdeci">void getComplexPairFromRotation(qreal angle, Vector axis, Complex *alpha, Complex *beta)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__common_8c_source.html#l00064">QuEST_common.c:64</a></div></div>
<div class="ttc" id="QuEST__internal_8h_html_a47b467a5445c7f15d1a8b0b2ec0ef2de"><div class="ttname"><a href="QuEST__internal_8h.html#a47b467a5445c7f15d1a8b0b2ec0ef2de">statevec_controlledCompactUnitary</a></div><div class="ttdeci">void statevec_controlledCompactUnitary(Qureg qureg, const int controlQubit, const int targetQubit, Complex alpha, Complex beta)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00871">QuEST_cpu_distributed.c:871</a></div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00060">QuEST.h:60</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00057">QuEST.h:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af59bc61f97d42cdceaf7fc0257a387d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af59bc61f97d42cdceaf7fc0257a387d6">&#9670;&nbsp;</a></span>statevec_controlledRotateX()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledRotateX </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00294">294</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__common_8c_source.html#l00278">statevec_controlledRotateAroundAxis()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00204">controlledRotateX()</a>.</p>
<div class="fragment"><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                                                                                                        {</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="structVector.html">Vector</a> unitAxis = {1, 0, 0};</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="QuEST__common_8c.html#a2c489375aad6fb71203553c60bff043b">statevec_controlledRotateAroundAxis</a>(qureg, controlQubit, targetQubit, angle, unitAxis);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;}</div><div class="ttc" id="structVector_html"><div class="ttname"><a href="structVector.html">Vector</a></div><div class="ttdoc">Represents a 3-vector of real numbers. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00073">QuEST.h:73</a></div></div>
<div class="ttc" id="QuEST__common_8c_html_a2c489375aad6fb71203553c60bff043b"><div class="ttname"><a href="QuEST__common_8c.html#a2c489375aad6fb71203553c60bff043b">statevec_controlledRotateAroundAxis</a></div><div class="ttdeci">void statevec_controlledRotateAroundAxis(Qureg qureg, const int controlQubit, const int targetQubit, qreal angle, Vector axis)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__common_8c_source.html#l00278">QuEST_common.c:278</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad2dc0754043172e0449c78569d27fd4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2dc0754043172e0449c78569d27fd4a">&#9670;&nbsp;</a></span>statevec_controlledRotateY()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledRotateY </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00300">300</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__common_8c_source.html#l00278">statevec_controlledRotateAroundAxis()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00216">controlledRotateY()</a>.</p>
<div class="fragment"><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                                                                                                        {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="structVector.html">Vector</a> unitAxis = {0, 1, 0};</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="QuEST__common_8c.html#a2c489375aad6fb71203553c60bff043b">statevec_controlledRotateAroundAxis</a>(qureg, controlQubit, targetQubit, angle, unitAxis);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;}</div><div class="ttc" id="structVector_html"><div class="ttname"><a href="structVector.html">Vector</a></div><div class="ttdoc">Represents a 3-vector of real numbers. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00073">QuEST.h:73</a></div></div>
<div class="ttc" id="QuEST__common_8c_html_a2c489375aad6fb71203553c60bff043b"><div class="ttname"><a href="QuEST__common_8c.html#a2c489375aad6fb71203553c60bff043b">statevec_controlledRotateAroundAxis</a></div><div class="ttdeci">void statevec_controlledRotateAroundAxis(Qureg qureg, const int controlQubit, const int targetQubit, qreal angle, Vector axis)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__common_8c_source.html#l00278">QuEST_common.c:278</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a06bffb653fa42a67254d034b6cce6d7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06bffb653fa42a67254d034b6cce6d7d">&#9670;&nbsp;</a></span>statevec_controlledRotateZ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledRotateZ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00306">306</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__common_8c_source.html#l00278">statevec_controlledRotateAroundAxis()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00228">controlledRotateZ()</a>.</p>
<div class="fragment"><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                                                                                        {</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <a class="code" href="structVector.html">Vector</a> unitAxis = {0, 0, 1};</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="QuEST__common_8c.html#a2c489375aad6fb71203553c60bff043b">statevec_controlledRotateAroundAxis</a>(qureg, controlQubit, targetQubit, angle, unitAxis);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;}</div><div class="ttc" id="structVector_html"><div class="ttname"><a href="structVector.html">Vector</a></div><div class="ttdoc">Represents a 3-vector of real numbers. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00073">QuEST.h:73</a></div></div>
<div class="ttc" id="QuEST__common_8c_html_a2c489375aad6fb71203553c60bff043b"><div class="ttname"><a href="QuEST__common_8c.html#a2c489375aad6fb71203553c60bff043b">statevec_controlledRotateAroundAxis</a></div><div class="ttdeci">void statevec_controlledRotateAroundAxis(Qureg qureg, const int controlQubit, const int targetQubit, qreal angle, Vector axis)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__common_8c_source.html#l00278">QuEST_common.c:278</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2600999a19c817bfcf7ca14779e33b9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2600999a19c817bfcf7ca14779e33b9a">&#9670;&nbsp;</a></span>statevec_controlledUnitary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00909">909</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">exchangeStateVectors()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00293">getRotAngleFromUnitaryMatrix()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l01920">statevec_controlledUnitaryDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l01778">statevec_controlledUnitaryLocal()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00252">controlledUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;{</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <a class="code" href="structComplex.html">Complex</a> rot1, rot2;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="comment">// rank&#39;s chunk is in upper half of block </span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="keywordtype">int</span> rankIsUpper;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="keywordflow">if</span> (useLocalDataOnly){</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <span class="comment">// all values required to update state vector lie in this rank</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <a class="code" href="QuEST__cpu_8c.html#ac0c120ac374b402c576c4b38bcda9992">statevec_controlledUnitaryLocal</a>(qureg, controlQubit, targetQubit, u);</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        <span class="comment">// need to get corresponding chunk of state vector from other rank</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        <a class="code" href="QuEST__cpu__distributed_8c.html#a5c9b2f129bdffaaba9857f6eddecbb17">getRotAngleFromUnitaryMatrix</a>(rankIsUpper, &amp;rot1, &amp;rot2, u);</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="comment">//printf(&quot;%d rank has pair rank: %d\n&quot;, qureg.rank, pairRank);</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="comment">// get corresponding values from my pair</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <a class="code" href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a>(qureg, pairRank);</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <span class="comment">// this rank&#39;s values are either in the upper of lower half of the block. send values to controlledUnitaryDistributed</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        <span class="comment">// in the correct order</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        <span class="keywordflow">if</span> (rankIsUpper){</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a4f77ef0be5137ed64321c2d6d14d8035">statevec_controlledUnitaryDistributed</a>(qureg,controlQubit,targetQubit,rot1,rot2,</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>, <span class="comment">//upper</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                    qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>, <span class="comment">//lower</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>); <span class="comment">//output</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a4f77ef0be5137ed64321c2d6d14d8035">statevec_controlledUnitaryDistributed</a>(qureg,controlQubit,targetQubit,rot1,rot2,</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                    qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>, <span class="comment">//upper</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>, <span class="comment">//lower</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>); <span class="comment">//output</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        }</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    }</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_ac0c120ac374b402c576c4b38bcda9992"><div class="ttname"><a href="QuEST__cpu_8c.html#ac0c120ac374b402c576c4b38bcda9992">statevec_controlledUnitaryLocal</a></div><div class="ttdeci">void statevec_controlledUnitaryLocal(Qureg qureg, const int controlQubit, const int targetQubit, ComplexMatrix2 u)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l01778">QuEST_cpu.c:1778</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00366">QuEST_cpu_distributed.c:366</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a5c9b2f129bdffaaba9857f6eddecbb17"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a5c9b2f129bdffaaba9857f6eddecbb17">getRotAngleFromUnitaryMatrix</a></div><div class="ttdeci">static void getRotAngleFromUnitaryMatrix(int chunkIsUpper, Complex *rot1, Complex *rot2, ComplexMatrix2 u)</div><div class="ttdoc">Get rotation values for a given chunk given a unitary matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00293">QuEST_cpu_distributed.c:293</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a7dba097f23f5d48dfdc9f3250444e2e4"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a></div><div class="ttdeci">static int getChunkPairId(int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">get position of corresponding chunk, holding values required to update values in my chunk (with chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00313">QuEST_cpu_distributed.c:313</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a4f77ef0be5137ed64321c2d6d14d8035"><div class="ttname"><a href="QuEST__cpu_8c.html#a4f77ef0be5137ed64321c2d6d14d8035">statevec_controlledUnitaryDistributed</a></div><div class="ttdeci">void statevec_controlledUnitaryDistributed(Qureg qureg, const int controlQubit, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</div><div class="ttdoc">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha ...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l01920">QuEST_cpu.c:1920</a></div></div>
<div class="ttc" id="structQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00102">QuEST.h:102</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00237">QuEST_cpu_distributed.c:237</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_ae01c3eb75fd32de1a7e1dbc7a33a21e3"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a></div><div class="ttdeci">void exchangeStateVectors(Qureg qureg, int pairRank)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00457">QuEST_cpu_distributed.c:457</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00057">QuEST.h:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a365bbb1b80cb00405c8bf1a4fa1ea8e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a365bbb1b80cb00405c8bf1a4fa1ea8e5">&#9670;&nbsp;</a></span>statevec_createQureg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_createQureg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a> *&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01058">1058</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::firstLevelReduction</a>, <a class="el" href="QuEST_8h_source.html#l00084">Qureg::isDensityMatrix</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00093">Qureg::numAmpsTotal</a>, <a class="el" href="QuEST_8h_source.html#l00097">Qureg::numChunks</a>, <a class="el" href="QuEST_8h_source.html#l00088">Qureg::numQubitsInStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00120">QuESTEnv::numRanks</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00119">QuESTEnv::rank</a>, <a class="el" href="QuEST__gpu_8cu_source.html#l00015">REDUCE_SHARED_SIZE</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::secondLevelReduction</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00042">createDensityQureg()</a>, and <a class="el" href="QuEST_8c_source.html#l00028">createQureg()</a>.</p>
<div class="fragment"><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;{</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = 1L &lt;&lt; numQubits;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmpsPerRank = numAmps/env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real)));</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag)));</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <span class="keywordflow">if</span> (env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1){</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        qureg-&gt;<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(qureg-&gt;<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real)));</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        qureg-&gt;<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(qureg-&gt;<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag)));</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    }</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="keywordflow">if</span> ( (!(qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real) || !(qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag))</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;            &amp;&amp; numAmpsPerRank ) {</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        printf(<span class="stringliteral">&quot;Could not allocate memory!&quot;</span>);</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        exit (EXIT_FAILURE);</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    }</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="keywordflow">if</span> ( env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1 &amp;&amp; (!(qureg-&gt;<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real) || !(qureg-&gt;<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag))</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;            &amp;&amp; numAmpsPerRank ) {</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        printf(<span class="stringliteral">&quot;Could not allocate memory!&quot;</span>);</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        exit (EXIT_FAILURE);</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    }</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    qureg-&gt;<a class="code" href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218">numQubitsInStateVec</a> = numQubits;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    qureg-&gt;<a class="code" href="structQureg.html#adef4935cac95763c29164cf99b144ed4">numAmpsTotal</a> = numAmps;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    qureg-&gt;<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a> = numAmpsPerRank;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    qureg-&gt;<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a> = env.<a class="code" href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">rank</a>;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    qureg-&gt;<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a> = env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    qureg-&gt;<a class="code" href="structQureg.html#acf78445e9435d09f44f0cc832c6aee79">isDensityMatrix</a> = 0;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;}</div><div class="ttc" id="structQuESTEnv_html_af22aacd7c9905accae28484785c193b4"><div class="ttname"><a href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">QuESTEnv::numRanks</a></div><div class="ttdeci">int numRanks</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00120">QuEST.h:120</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="structQureg_html_acf78445e9435d09f44f0cc832c6aee79"><div class="ttname"><a href="structQureg.html#acf78445e9435d09f44f0cc832c6aee79">Qureg::isDensityMatrix</a></div><div class="ttdeci">int isDensityMatrix</div><div class="ttdoc">Whether this instance is a density-state representation. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00084">QuEST.h:84</a></div></div>
<div class="ttc" id="structQureg_html_aa3deb7163aab90a61e755a1f200f5413"><div class="ttname"><a href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">Qureg::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into – the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00097">QuEST.h:97</a></div></div>
<div class="ttc" id="structQureg_html_adef4935cac95763c29164cf99b144ed4"><div class="ttname"><a href="structQureg.html#adef4935cac95763c29164cf99b144ed4">Qureg::numAmpsTotal</a></div><div class="ttdeci">long long int numAmpsTotal</div><div class="ttdoc">Total number of amplitudes, which are possibly distributed among machines. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00093">QuEST.h:93</a></div></div>
<div class="ttc" id="structQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00102">QuEST.h:102</a></div></div>
<div class="ttc" id="structQuESTEnv_html_aa648bb336cf8598467cb62db00b9cee8"><div class="ttname"><a href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">QuESTEnv::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00119">QuEST.h:119</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
<div class="ttc" id="structQureg_html_a0a86e8a50ea8c998b4a0a6640c5a1218"><div class="ttname"><a href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218">Qureg::numQubitsInStateVec</a></div><div class="ttdeci">int numQubitsInStateVec</div><div class="ttdoc">Number of qubits in the state-vector - this is double the number represented for mixed states...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00088">QuEST.h:88</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2a52ad9f9ad9b2fd6a76f6d433b3b217"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a52ad9f9ad9b2fd6a76f6d433b3b217">&#9670;&nbsp;</a></span>statevec_destroyQureg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_destroyQureg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01090">1090</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00120">QuESTEnv::numRanks</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00056">destroyQureg()</a>.</p>
<div class="fragment"><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                                                     {</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    </div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    free(qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real);</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    free(qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag);</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordflow">if</span> (env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1){</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        free(qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real);</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        free(qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag);</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    }    </div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;}</div><div class="ttc" id="structQuESTEnv_html_af22aacd7c9905accae28484785c193b4"><div class="ttname"><a href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">QuESTEnv::numRanks</a></div><div class="ttdeci">int numRanks</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00120">QuEST.h:120</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="structQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00102">QuEST.h:102</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abd509244d57657e148e4084c5ab5d28f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd509244d57657e148e4084c5ab5d28f">&#9670;&nbsp;</a></span>statevec_getImagAmp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> statevec_getImagAmp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00218">218</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00204">getChunkIdFromIndex()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00512">getAmp()</a>, <a class="el" href="QuEST_8c_source.html#l00522">getDensityAmp()</a>, <a class="el" href="QuEST_8c_source.html#l00498">getImagAmp()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00167">statevec_getProbAmp()</a>.</p>
<div class="fragment"><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                                                           {</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">int</span> chunkId = <a class="code" href="QuEST__cpu__distributed_8c.html#a28be36627b2dd9a0da63dd6f60121b06">getChunkIdFromIndex</a>(qureg, index);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> el; </div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>==chunkId){</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        el = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[index-chunkId*qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>];</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    }</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    MPI_Bcast(&amp;el, 1, MPI_QuEST_REAL, chunkId, MPI_COMM_WORLD);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordflow">return</span> el; </div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a28be36627b2dd9a0da63dd6f60121b06"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a28be36627b2dd9a0da63dd6f60121b06">getChunkIdFromIndex</a></div><div class="ttdeci">static int getChunkIdFromIndex(Qureg qureg, long long int index)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00204">QuEST_cpu_distributed.c:204</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3afe58e49dce5536bc4c1b7caddf44a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3afe58e49dce5536bc4c1b7caddf44a6">&#9670;&nbsp;</a></span>statevec_getProbAmp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> statevec_getProbAmp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00167">167</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00218">statevec_getImagAmp()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00208">statevec_getRealAmp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00505">getProbAmp()</a>.</p>
<div class="fragment"><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                                                           {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> real = <a class="code" href="QuEST__internal_8h.html#abc9a9ef4344c7faaaf28ac25c76649b9">statevec_getRealAmp</a>(qureg, index);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> imag = <a class="code" href="QuEST__internal_8h.html#abd509244d57657e148e4084c5ab5d28f">statevec_getImagAmp</a>(qureg, index);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">return</span> real*real + imag*imag;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;}</div><div class="ttc" id="QuEST__internal_8h_html_abc9a9ef4344c7faaaf28ac25c76649b9"><div class="ttname"><a href="QuEST__internal_8h.html#abc9a9ef4344c7faaaf28ac25c76649b9">statevec_getRealAmp</a></div><div class="ttdeci">qreal statevec_getRealAmp(Qureg qureg, long long int index)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00208">QuEST_cpu_distributed.c:208</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="QuEST__internal_8h_html_abd509244d57657e148e4084c5ab5d28f"><div class="ttname"><a href="QuEST__internal_8h.html#abd509244d57657e148e4084c5ab5d28f">statevec_getImagAmp</a></div><div class="ttdeci">qreal statevec_getImagAmp(Qureg qureg, long long int index)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00218">QuEST_cpu_distributed.c:218</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abc9a9ef4344c7faaaf28ac25c76649b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc9a9ef4344c7faaaf28ac25c76649b9">&#9670;&nbsp;</a></span>statevec_getRealAmp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> statevec_getRealAmp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00208">208</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00204">getChunkIdFromIndex()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00512">getAmp()</a>, <a class="el" href="QuEST_8c_source.html#l00522">getDensityAmp()</a>, <a class="el" href="QuEST_8c_source.html#l00491">getRealAmp()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00167">statevec_getProbAmp()</a>.</p>
<div class="fragment"><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                                                           {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordtype">int</span> chunkId = <a class="code" href="QuEST__cpu__distributed_8c.html#a28be36627b2dd9a0da63dd6f60121b06">getChunkIdFromIndex</a>(qureg, index);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> el; </div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>==chunkId){</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        el = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[index-chunkId*qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>];</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    MPI_Bcast(&amp;el, 1, MPI_QuEST_REAL, chunkId, MPI_COMM_WORLD);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">return</span> el; </div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;} </div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a28be36627b2dd9a0da63dd6f60121b06"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a28be36627b2dd9a0da63dd6f60121b06">getChunkIdFromIndex</a></div><div class="ttdeci">static int getChunkIdFromIndex(Qureg qureg, long long int index)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00204">QuEST_cpu_distributed.c:204</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9226f386d010aaa85efc0e8889d341d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9226f386d010aaa85efc0e8889d341d5">&#9670;&nbsp;</a></span>statevec_hadamard()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_hadamard </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01160">1160</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">exchangeStateVectors()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02468">statevec_hadamardDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02407">statevec_hadamardLocal()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00160">hadamard()</a>.</p>
<div class="fragment"><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;{</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <span class="comment">// rank&#39;s chunk is in upper half of block </span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="keywordtype">int</span> rankIsUpper;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="keywordflow">if</span> (useLocalDataOnly){</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;        <span class="comment">// all values required to update state vector lie in this rank</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        <a class="code" href="QuEST__cpu_8c.html#a24f9ade18290c82bbb2c4a706b3d5999">statevec_hadamardLocal</a>(qureg, targetQubit);</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;        <span class="comment">// need to get corresponding chunk of state vector from other rank</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;        pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        <span class="comment">//printf(&quot;%d rank has pair rank: %d\n&quot;, qureg.rank, pairRank);</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;        <span class="comment">// get corresponding values from my pair</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        <a class="code" href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a>(qureg, pairRank);</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;        <span class="comment">// this rank&#39;s values are either in the upper of lower half of the block. send values to hadamardDistributed</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;        <span class="comment">// in the correct order</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        <span class="keywordflow">if</span> (rankIsUpper){</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a4271beeba4f1bec3556779aab318cdab">statevec_hadamardDistributed</a>(qureg,targetQubit,</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>, <span class="comment">//upper</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                    qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>, <span class="comment">//lower</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>, rankIsUpper); <span class="comment">//output</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a4271beeba4f1bec3556779aab318cdab">statevec_hadamardDistributed</a>(qureg,targetQubit,</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                    qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>, <span class="comment">//upper</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>, <span class="comment">//lower</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>, rankIsUpper); <span class="comment">//output</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        }</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    }</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00366">QuEST_cpu_distributed.c:366</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a24f9ade18290c82bbb2c4a706b3d5999"><div class="ttname"><a href="QuEST__cpu_8c.html#a24f9ade18290c82bbb2c4a706b3d5999">statevec_hadamardLocal</a></div><div class="ttdeci">void statevec_hadamardLocal(Qureg qureg, const int targetQubit)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02407">QuEST_cpu.c:2407</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a7dba097f23f5d48dfdc9f3250444e2e4"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a></div><div class="ttdeci">static int getChunkPairId(int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">get position of corresponding chunk, holding values required to update values in my chunk (with chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00313">QuEST_cpu_distributed.c:313</a></div></div>
<div class="ttc" id="structQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00102">QuEST.h:102</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00237">QuEST_cpu_distributed.c:237</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_ae01c3eb75fd32de1a7e1dbc7a33a21e3"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a></div><div class="ttdeci">void exchangeStateVectors(Qureg qureg, int pairRank)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00457">QuEST_cpu_distributed.c:457</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a4271beeba4f1bec3556779aab318cdab"><div class="ttname"><a href="QuEST__cpu_8c.html#a4271beeba4f1bec3556779aab318cdab">statevec_hadamardDistributed</a></div><div class="ttdeci">void statevec_hadamardDistributed(Qureg qureg, const int targetQubit, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut, int updateUpper)</div><div class="ttdoc">Rotate a single qubit by {{1,1},{1,-1}}/sqrt2. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02468">QuEST_cpu.c:2468</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a288dc4b46bdacd69cbf4a6fd070d26a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a288dc4b46bdacd69cbf4a6fd070d26a7">&#9670;&nbsp;</a></span>statevec_initClassicalState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initClassicalState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>stateInd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01200">1200</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00107">initClassicalState()</a>.</p>
<div class="fragment"><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;{</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="comment">// Can&#39;t use qureg-&gt;stateVec as a private OMP var</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="comment">// initialise the state to vector to all zeros</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="preprocessor">    shared   (stateVecSize, stateVecReal, stateVecImag) \</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="preprocessor">    private  (index) </span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    {</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;            stateVecReal[index] = 0.0;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;            stateVecImag[index] = 0.0;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        }</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    }</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="comment">// give the specified classical state prob 1</span></div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a> == stateInd/stateVecSize){</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        stateVecReal[stateInd % stateVecSize] = 1.0;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        stateVecImag[stateInd % stateVecSize] = 0.0;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    }</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a482fc361fd5f08075404c72e536316a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a482fc361fd5f08075404c72e536316a0">&#9670;&nbsp;</a></span>statevec_initPlusState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initPlusState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01168">1168</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00097">Qureg::numChunks</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00098">initPlusState()</a>.</p>
<div class="fragment"><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;{</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    chunkSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    stateVecSize = chunkSize*qureg.<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a>;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> normFactor = 1.0/sqrt((<a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>)stateVecSize);</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="comment">// Can&#39;t use qureg-&gt;stateVec as a private OMP var</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="comment">// initialise the state to |+++..+++&gt; = 1/normFactor {1, 1, 1, ...}</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="preprocessor">    shared   (chunkSize, stateVecReal, stateVecImag, normFactor) \</span></div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="preprocessor">    private  (index) </span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    {</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;            stateVecReal[index] = normFactor;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;            stateVecImag[index] = 0.0;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        }</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    }</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_aa3deb7163aab90a61e755a1f200f5413"><div class="ttname"><a href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">Qureg::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into – the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00097">QuEST.h:97</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a38445cdb2a18671a7c73112ce3337acb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38445cdb2a18671a7c73112ce3337acb">&#9670;&nbsp;</a></span>statevec_initStateDebug()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initStateDebug </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise the state vector of probability amplitudes to an (unphysical) state with each component of each probability amplitude a unique floating point value. </p>
<p>For debugging processes </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits to be initialised </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01321">1321</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00689">initStateDebug()</a>.</p>
<div class="fragment"><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;{</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> indexOffset;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    chunkSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <span class="comment">// Can&#39;t use qureg-&gt;stateVec as a private OMP var</span></div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    indexOffset = chunkSize * qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <span class="comment">// initialise the state to |0000..0000&gt;</span></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;<span class="preprocessor">    shared   (chunkSize, stateVecReal, stateVecImag, indexOffset) \</span></div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="preprocessor">    private  (index) </span></div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    {</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;            stateVecReal[index] = ((indexOffset + index)*2.0)/10.0;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;            stateVecImag[index] = ((indexOffset + index)*2.0+1.0)/10.0;</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        }</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    }</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a05756b45f10135bb2eeb07380f806c20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05756b45f10135bb2eeb07380f806c20">&#9670;&nbsp;</a></span>statevec_initStateFromSingleFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int statevec_initStateFromSingleFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a> *&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>filename</em>[200], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01355">1355</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__gpu_8cu_source.html#l00277">copyStateToGPU()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00097">Qureg::numChunks</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00166">syncQuESTEnv()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00693">initStateFromSingleFile()</a>.</p>
<div class="fragment"><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                                                                                    {</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> indexInChunk, totalIndex;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    chunkSize = qureg-&gt;<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    stateVecSize = chunkSize*qureg-&gt;<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a>;</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    FILE *fp;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    <span class="keywordtype">char</span> line[200];</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rank=0; rank&lt;(qureg-&gt;<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a>); rank++){</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        <span class="keywordflow">if</span> (rank==qureg-&gt;<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>){</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;            fp = fopen(filename, <span class="stringliteral">&quot;r&quot;</span>);</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;            </div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;            <span class="comment">// indicate file open failure</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;            <span class="keywordflow">if</span> (fp == NULL)</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;            </div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;            indexInChunk = 0; totalIndex = 0;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;            <span class="keywordflow">while</span> (fgets(line, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)*200, fp) != NULL &amp;&amp; totalIndex&lt;stateVecSize){</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                <span class="keywordflow">if</span> (line[0]!=<span class="charliteral">&#39;#&#39;</span>){</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                    <span class="keywordtype">int</span> chunkId = totalIndex/chunkSize;</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                    <span class="keywordflow">if</span> (chunkId==qureg-&gt;<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>){</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="preprocessor">                        # if QuEST_PREC==1</span></div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                        sscanf(line, <span class="stringliteral">&quot;%f, %f&quot;</span>, &amp;(stateVecReal[indexInChunk]), </div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                                &amp;(stateVecImag[indexInChunk])); </div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="preprocessor">                        # elif QuEST_PREC==2                    </span></div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                        sscanf(line, <span class="stringliteral">&quot;%lf, %lf&quot;</span>, &amp;(stateVecReal[indexInChunk]), </div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                                &amp;(stateVecImag[indexInChunk]));</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="preprocessor">                        # elif QuEST_PREC==4</span></div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                        sscanf(line, <span class="stringliteral">&quot;%Lf, %Lf&quot;</span>, &amp;(stateVecReal[indexInChunk]), </div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                                &amp;(stateVecImag[indexInChunk]));</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="preprocessor">                        # endif</span></div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                        indexInChunk += 1;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                    }</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                    totalIndex += 1;</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                }</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;            }   </div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;            fclose(fp);</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;        }</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        <a class="code" href="QuEST_8h.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77">syncQuESTEnv</a>(env);</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    }</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    </div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="comment">// indicate success</span></div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_aa3deb7163aab90a61e755a1f200f5413"><div class="ttname"><a href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">Qureg::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into – the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00097">QuEST.h:97</a></div></div>
<div class="ttc" id="QuEST_8h_html_a8d31fe2d1ad4d01e2a1f5f6b8bc15b77"><div class="ttname"><a href="QuEST_8h.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77">syncQuESTEnv</a></div><div class="ttdeci">void syncQuESTEnv(QuESTEnv env)</div><div class="ttdoc">Guarantees that all code up to the given point has been executed on all nodes (if running in distribu...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00166">QuEST_cpu_distributed.c:166</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a923906770cac0da9e3459bae58de9e64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a923906770cac0da9e3459bae58de9e64">&#9670;&nbsp;</a></span>statevec_initStateOfSingleQubit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initStateOfSingleQubit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a> *&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qubitId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>outcome</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise the state vector of probability amplitudes such that one qubit is set to 'outcome' and all other qubits are in an equal superposition of zero and one. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits to be initialised </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">qubitId</td><td>id of qubit to set to state 'outcome' </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">value</td><td>of qubit 'qubitId' </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01275">1275</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00097">Qureg::numChunks</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00698">initStateOfSingleQubit()</a>.</p>
<div class="fragment"><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;{</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="keywordtype">int</span> bit;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg-&gt;<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    chunkSize = qureg-&gt;<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    stateVecSize = chunkSize*qureg-&gt;<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a>;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> normFactor = 1.0/sqrt((<a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>)stateVecSize/2.0);</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="comment">// Can&#39;t use qureg-&gt;stateVec as a private OMP var</span></div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="comment">// initialise the state to |0000..0000&gt;</span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="preprocessor">    shared   (chunkSize, stateVecReal, stateVecImag, normFactor, qubitId, outcome) \</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="preprocessor">    private  (index, bit) </span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    {</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;            bit = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(qubitId, index+chunkId*chunkSize);</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;            <span class="keywordflow">if</span> (bit==outcome) {</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                stateVecReal[index] = normFactor;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                stateVecImag[index] = 0.0;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                stateVecReal[index] = 0.0;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                stateVecImag[index] = 0.0;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;            }</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        }</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    }</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a100463f6ec212c76a5fad99579000505"><div class="ttname"><a href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a></div><div class="ttdeci">static int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdoc">Get the value of the bit at a particular index in a number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00031">QuEST_cpu.c:31</a></div></div>
<div class="ttc" id="structQureg_html_aa3deb7163aab90a61e755a1f200f5413"><div class="ttname"><a href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">Qureg::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into – the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00097">QuEST.h:97</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2ca0c6ba07ab2b4b437321bf17efc966"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ca0c6ba07ab2b4b437321bf17efc966">&#9670;&nbsp;</a></span>statevec_initZeroState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initZeroState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01132">1132</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00092">initZeroState()</a>.</p>
<div class="fragment"><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;{</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <span class="comment">// Can&#39;t use qureg-&gt;stateVec as a private OMP var</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="comment">// initialise the state-vector to all-zeroes</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="preprocessor">    shared   (stateVecSize, stateVecReal, stateVecImag) \</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="preprocessor">    private  (index) </span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    {</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            stateVecReal[index] = 0.0;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;            stateVecImag[index] = 0.0;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        }</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    }</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>==0){</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        <span class="comment">// zero state |0000..0000&gt; has probability 1</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        stateVecReal[0] = 1.0;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        stateVecImag[0] = 0.0;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    }</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac2eb81c71d0e0fbec7be5b45b1db1448"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2eb81c71d0e0fbec7be5b45b1db1448">&#9670;&nbsp;</a></span>statevec_measureWithStats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int statevec_measureWithStats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>outcomeProb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00312">312</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__common_8c_source.html#l00105">generateMeasurementOutcome()</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01215">statevec_calcProbOfOutcome()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01253">statevec_collapseToKnownProbOutcome()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00571">measure()</a>, and <a class="el" href="QuEST_8c_source.html#l00558">measureWithStats()</a>.</p>
<div class="fragment"><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                                                                                 {</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    </div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> zeroProb = <a class="code" href="QuEST__internal_8h.html#ab33cdf01831c4545e51299178acf7f27">statevec_calcProbOfOutcome</a>(qureg, measureQubit, 0);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordtype">int</span> outcome = <a class="code" href="QuEST__common_8c.html#a9d19fc690afb425d0df5feb09be567a3">generateMeasurementOutcome</a>(zeroProb, outcomeProb);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <a class="code" href="QuEST__internal_8h.html#ae7f25bb40734e18a992403b17355893b">statevec_collapseToKnownProbOutcome</a>(qureg, measureQubit, outcome, *outcomeProb);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">return</span> outcome;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;}</div><div class="ttc" id="QuEST__internal_8h_html_ae7f25bb40734e18a992403b17355893b"><div class="ttname"><a href="QuEST__internal_8h.html#ae7f25bb40734e18a992403b17355893b">statevec_collapseToKnownProbOutcome</a></div><div class="ttdeci">void statevec_collapseToKnownProbOutcome(Qureg qureg, const int measureQubit, int outcome, qreal outcomeProb)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l01253">QuEST_cpu_distributed.c:1253</a></div></div>
<div class="ttc" id="QuEST__common_8c_html_a9d19fc690afb425d0df5feb09be567a3"><div class="ttname"><a href="QuEST__common_8c.html#a9d19fc690afb425d0df5feb09be567a3">generateMeasurementOutcome</a></div><div class="ttdeci">int generateMeasurementOutcome(qreal zeroProb, qreal *outcomeProb)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__common_8c_source.html#l00105">QuEST_common.c:105</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="QuEST__internal_8h_html_ab33cdf01831c4545e51299178acf7f27"><div class="ttname"><a href="QuEST__internal_8h.html#ab33cdf01831c4545e51299178acf7f27">statevec_calcProbOfOutcome</a></div><div class="ttdeci">qreal statevec_calcProbOfOutcome(Qureg qureg, const int measureQubit, int outcome)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l01215">QuEST_cpu_distributed.c:1215</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac4ee5979d475e8c729294b8ef7e0270d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4ee5979d475e8c729294b8ef7e0270d">&#9670;&nbsp;</a></span>statevec_multiControlledPhaseFlip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledPhaseFlip </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>controlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numControlQubits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02820">2820</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00436">multiControlledPhaseFlip()</a>.</p>
<div class="fragment"><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;{</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;</div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> mask=0;</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;numControlQubits; i++)</div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;        mask = mask | (1LL&lt;&lt;controlQubits[i]);</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;    stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;<span class="preprocessor">    default  (none)              \</span></div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;<span class="preprocessor">    shared   (stateVecSize, stateVecReal,stateVecImag, mask ) \</span></div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;<span class="preprocessor">    private  (index)</span></div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;    {</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;            <span class="keywordflow">if</span> (mask == (mask &amp; (index+chunkId*chunkSize)) ){</div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;                stateVecReal [index] = - stateVecReal [index];</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;                stateVecImag [index] = - stateVecImag [index];</div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;            }</div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;        }</div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;    }</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa662796ea6e0f471143c53becae8c12c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa662796ea6e0f471143c53becae8c12c">&#9670;&nbsp;</a></span>statevec_multiControlledPhaseShift()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledPhaseShift </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>controlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numControlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02593">2593</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00386">multiControlledPhaseShift()</a>.</p>
<div class="fragment"><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;{</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> mask=0;</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;numControlQubits; i++) </div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;        mask = mask | (1LL&lt;&lt;controlQubits[i]);</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;    stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;    </div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealLo, stateImagLo;</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;    <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> cosAngle = cos(angle);</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;    <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> sinAngle = sin(angle);</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;<span class="preprocessor">    default  (none)              \</span></div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;<span class="preprocessor">    shared   (stateVecSize, stateVecReal, stateVecImag, mask) \</span></div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;<span class="preprocessor">    private  (index, stateRealLo, stateImagLo)</span></div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    {</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;            <span class="keywordflow">if</span> (mask == (mask &amp; (index+chunkId*chunkSize)) ){</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;                </div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;                stateRealLo = stateVecReal[index];</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;                stateImagLo = stateVecImag[index];</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;            </div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;                stateVecReal[index] = cosAngle*stateRealLo - sinAngle*stateImagLo;</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;                stateVecImag[index] = sinAngle*stateRealLo + cosAngle*stateImagLo;  </div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;            }</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;        }</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;    }</div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2cc288d53df484516cde923c8a3b561a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cc288d53df484516cde923c8a3b561a">&#9670;&nbsp;</a></span>statevec_multiControlledUnitary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>controlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>numControlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00948">948</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">exchangeStateVectors()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00293">getRotAngleFromUnitaryMatrix()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l01984">statevec_multiControlledUnitaryDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l01715">statevec_multiControlledUnitaryLocal()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00265">multiControlledUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;{</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> mask=0;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;numControlQubits; i++) mask = mask | (1LL&lt;&lt;controlQubits[i]);</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <a class="code" href="structComplex.html">Complex</a> rot1, rot2;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="comment">// rank&#39;s chunk is in upper half of block </span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="keywordtype">int</span> rankIsUpper;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keywordflow">if</span> (useLocalDataOnly){</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        <span class="comment">// all values required to update state vector lie in this rank</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        <a class="code" href="QuEST__cpu_8c.html#ae183f44166ccfd908609c4e2207cc14b">statevec_multiControlledUnitaryLocal</a>(qureg, targetQubit, mask, u);</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        <span class="comment">// need to get corresponding chunk of state vector from other rank</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <a class="code" href="QuEST__cpu__distributed_8c.html#a5c9b2f129bdffaaba9857f6eddecbb17">getRotAngleFromUnitaryMatrix</a>(rankIsUpper, &amp;rot1, &amp;rot2, u);</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        <span class="comment">//printf(&quot;%d rank has pair rank: %d\n&quot;, qureg.rank, pairRank);</span></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        <span class="comment">// get corresponding values from my pair</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <a class="code" href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a>(qureg, pairRank);</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <span class="comment">// this rank&#39;s values are either in the upper of lower half of the block. send values to multiControlledUnitaryDistributed</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <span class="comment">// in the correct order</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <span class="keywordflow">if</span> (rankIsUpper){</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a2e6d75b454747741b2b805bf6b23194c">statevec_multiControlledUnitaryDistributed</a>(qureg,targetQubit,mask,rot1,rot2,</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>, <span class="comment">//upper</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                    qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>, <span class="comment">//lower</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>); <span class="comment">//output</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a2e6d75b454747741b2b805bf6b23194c">statevec_multiControlledUnitaryDistributed</a>(qureg,targetQubit,mask,rot1,rot2,</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                    qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>, <span class="comment">//upper</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>, <span class="comment">//lower</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>); <span class="comment">//output</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        }</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    }</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00366">QuEST_cpu_distributed.c:366</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_ae183f44166ccfd908609c4e2207cc14b"><div class="ttname"><a href="QuEST__cpu_8c.html#ae183f44166ccfd908609c4e2207cc14b">statevec_multiControlledUnitaryLocal</a></div><div class="ttdeci">void statevec_multiControlledUnitaryLocal(Qureg qureg, const int targetQubit, long long int mask, ComplexMatrix2 u)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l01715">QuEST_cpu.c:1715</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a5c9b2f129bdffaaba9857f6eddecbb17"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a5c9b2f129bdffaaba9857f6eddecbb17">getRotAngleFromUnitaryMatrix</a></div><div class="ttdeci">static void getRotAngleFromUnitaryMatrix(int chunkIsUpper, Complex *rot1, Complex *rot2, ComplexMatrix2 u)</div><div class="ttdoc">Get rotation values for a given chunk given a unitary matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00293">QuEST_cpu_distributed.c:293</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a7dba097f23f5d48dfdc9f3250444e2e4"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a></div><div class="ttdeci">static int getChunkPairId(int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">get position of corresponding chunk, holding values required to update values in my chunk (with chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00313">QuEST_cpu_distributed.c:313</a></div></div>
<div class="ttc" id="structQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00102">QuEST.h:102</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00237">QuEST_cpu_distributed.c:237</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_ae01c3eb75fd32de1a7e1dbc7a33a21e3"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a></div><div class="ttdeci">void exchangeStateVectors(Qureg qureg, int pairRank)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00457">QuEST_cpu_distributed.c:457</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00057">QuEST.h:57</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a2e6d75b454747741b2b805bf6b23194c"><div class="ttname"><a href="QuEST__cpu_8c.html#a2e6d75b454747741b2b805bf6b23194c">statevec_multiControlledUnitaryDistributed</a></div><div class="ttdeci">void statevec_multiControlledUnitaryDistributed(Qureg qureg, const int targetQubit, long long int mask, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</div><div class="ttdoc">Apply a unitary operation to a single qubit in the state vector of probability amplitudes, given a subset of the state vector with upper and lower block values stored seperately. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l01984">QuEST_cpu.c:1984</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abdb6e0ee1e407755e1b944086cedd90e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdb6e0ee1e407755e1b944086cedd90e">&#9670;&nbsp;</a></span>statevec_pauliX()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_pauliX </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00988">988</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">exchangeStateVectors()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02093">statevec_pauliXDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02034">statevec_pauliXLocal()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00308">pauliX()</a>.</p>
<div class="fragment"><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;{</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="comment">// rank&#39;s chunk is in upper half of block </span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="keywordtype">int</span> rankIsUpper;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keywordflow">if</span> (useLocalDataOnly){</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        <span class="comment">// all values required to update state vector lie in this rank</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        <a class="code" href="QuEST__cpu_8c.html#a842aaecd6d6cdc194c0b7c84623d2111">statevec_pauliXLocal</a>(qureg, targetQubit);</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        <span class="comment">// need to get corresponding chunk of state vector from other rank</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        <span class="comment">//printf(&quot;%d rank has pair rank: %d\n&quot;, qureg.rank, pairRank);</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        <span class="comment">// get corresponding values from my pair</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        <a class="code" href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a>(qureg, pairRank);</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        <span class="comment">// this rank&#39;s values are either in the upper of lower half of the block. pauliX just replaces</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        <span class="comment">// this rank&#39;s values with pair values</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        <a class="code" href="QuEST__cpu_8c.html#ac4f8a0ab089bc002fd85cd87f8c451e9">statevec_pauliXDistributed</a>(qureg, targetQubit,</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>, <span class="comment">// in</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>); <span class="comment">// out</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    }</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;}</div><div class="ttc" id="QuEST__cpu_8c_html_ac4f8a0ab089bc002fd85cd87f8c451e9"><div class="ttname"><a href="QuEST__cpu_8c.html#ac4f8a0ab089bc002fd85cd87f8c451e9">statevec_pauliXDistributed</a></div><div class="ttdeci">void statevec_pauliXDistributed(Qureg qureg, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut)</div><div class="ttdoc">Rotate a single qubit by {{0,1},{1,0}. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02093">QuEST_cpu.c:2093</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00366">QuEST_cpu_distributed.c:366</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a842aaecd6d6cdc194c0b7c84623d2111"><div class="ttname"><a href="QuEST__cpu_8c.html#a842aaecd6d6cdc194c0b7c84623d2111">statevec_pauliXLocal</a></div><div class="ttdeci">void statevec_pauliXLocal(Qureg qureg, const int targetQubit)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02034">QuEST_cpu.c:2034</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a7dba097f23f5d48dfdc9f3250444e2e4"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a></div><div class="ttdeci">static int getChunkPairId(int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">get position of corresponding chunk, holding values required to update values in my chunk (with chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00313">QuEST_cpu_distributed.c:313</a></div></div>
<div class="ttc" id="structQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00102">QuEST.h:102</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00237">QuEST_cpu_distributed.c:237</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_ae01c3eb75fd32de1a7e1dbc7a33a21e3"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a></div><div class="ttdeci">void exchangeStateVectors(Qureg qureg, int pairRank)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00457">QuEST_cpu_distributed.c:457</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a73b56fbac6e464a37805fa9d9657a8f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73b56fbac6e464a37805fa9d9657a8f9">&#9670;&nbsp;</a></span>statevec_pauliY()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_pauliY </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01044">1044</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">exchangeStateVectors()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02277">statevec_pauliYDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02219">statevec_pauliYLocal()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00319">pauliY()</a>.</p>
<div class="fragment"><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;{       </div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <span class="keywordtype">int</span> conjFac = 1;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="keywordtype">int</span> rankIsUpper;    <span class="comment">// rank&#39;s chunk is in upper half of block </span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <span class="keywordtype">int</span> pairRank;               <span class="comment">// rank of corresponding chunk</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="keywordflow">if</span> (useLocalDataOnly){</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        <a class="code" href="QuEST__cpu_8c.html#a8edf5f2066b05fb343931f45e2bec8f8">statevec_pauliYLocal</a>(qureg, targetQubit, conjFac);</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <span class="comment">// need to get corresponding chunk of state vector from other rank</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <span class="comment">// get corresponding values from my pair</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        <a class="code" href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a>(qureg, pairRank);</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        <span class="comment">// this rank&#39;s values are either in the upper of lower half of the block</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <a class="code" href="QuEST__cpu_8c.html#a04cdf71c5862ab2bf3a98cd0b3ea0c26">statevec_pauliYDistributed</a>(qureg,targetQubit,</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>, <span class="comment">// in</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>, <span class="comment">// out</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                rankIsUpper, conjFac);</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    }</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00366">QuEST_cpu_distributed.c:366</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a04cdf71c5862ab2bf3a98cd0b3ea0c26"><div class="ttname"><a href="QuEST__cpu_8c.html#a04cdf71c5862ab2bf3a98cd0b3ea0c26">statevec_pauliYDistributed</a></div><div class="ttdeci">void statevec_pauliYDistributed(Qureg qureg, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut, int updateUpper, const int conjFac)</div><div class="ttdoc">Rotate a single qubit by +-{{0,-i},{i,0}. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02277">QuEST_cpu.c:2277</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a7dba097f23f5d48dfdc9f3250444e2e4"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a></div><div class="ttdeci">static int getChunkPairId(int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">get position of corresponding chunk, holding values required to update values in my chunk (with chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00313">QuEST_cpu_distributed.c:313</a></div></div>
<div class="ttc" id="structQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00102">QuEST.h:102</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00237">QuEST_cpu_distributed.c:237</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_ae01c3eb75fd32de1a7e1dbc7a33a21e3"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a></div><div class="ttdeci">void exchangeStateVectors(Qureg qureg, int pairRank)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00457">QuEST_cpu_distributed.c:457</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a8edf5f2066b05fb343931f45e2bec8f8"><div class="ttname"><a href="QuEST__cpu_8c.html#a8edf5f2066b05fb343931f45e2bec8f8">statevec_pauliYLocal</a></div><div class="ttdeci">void statevec_pauliYLocal(Qureg qureg, const int targetQubit, const int conjFac)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02219">QuEST_cpu.c:2219</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aee97816cfabeea7874cd837a8d105412"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee97816cfabeea7874cd837a8d105412">&#9670;&nbsp;</a></span>statevec_pauliYConj()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_pauliYConj </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01069">1069</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">exchangeStateVectors()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02277">statevec_pauliYDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02219">statevec_pauliYLocal()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00319">pauliY()</a>.</p>
<div class="fragment"><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;{       </div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <span class="keywordtype">int</span> conjFac = -1;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="keywordtype">int</span> rankIsUpper;    <span class="comment">// rank&#39;s chunk is in upper half of block </span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="keywordtype">int</span> pairRank;               <span class="comment">// rank of corresponding chunk</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="keywordflow">if</span> (useLocalDataOnly){</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        <a class="code" href="QuEST__cpu_8c.html#a8edf5f2066b05fb343931f45e2bec8f8">statevec_pauliYLocal</a>(qureg, targetQubit, conjFac);</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        <span class="comment">// need to get corresponding chunk of state vector from other rank</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        <span class="comment">// get corresponding values from my pair</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        <a class="code" href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a>(qureg, pairRank);</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        <span class="comment">// this rank&#39;s values are either in the upper of lower half of the block</span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        <a class="code" href="QuEST__cpu_8c.html#a04cdf71c5862ab2bf3a98cd0b3ea0c26">statevec_pauliYDistributed</a>(qureg,targetQubit,</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>, <span class="comment">// in</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>, <span class="comment">// out</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                rankIsUpper, conjFac);</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    }</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00366">QuEST_cpu_distributed.c:366</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a04cdf71c5862ab2bf3a98cd0b3ea0c26"><div class="ttname"><a href="QuEST__cpu_8c.html#a04cdf71c5862ab2bf3a98cd0b3ea0c26">statevec_pauliYDistributed</a></div><div class="ttdeci">void statevec_pauliYDistributed(Qureg qureg, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut, int updateUpper, const int conjFac)</div><div class="ttdoc">Rotate a single qubit by +-{{0,-i},{i,0}. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02277">QuEST_cpu.c:2277</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a7dba097f23f5d48dfdc9f3250444e2e4"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a></div><div class="ttdeci">static int getChunkPairId(int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">get position of corresponding chunk, holding values required to update values in my chunk (with chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00313">QuEST_cpu_distributed.c:313</a></div></div>
<div class="ttc" id="structQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00102">QuEST.h:102</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00237">QuEST_cpu_distributed.c:237</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_ae01c3eb75fd32de1a7e1dbc7a33a21e3"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a></div><div class="ttdeci">void exchangeStateVectors(Qureg qureg, int pairRank)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00457">QuEST_cpu_distributed.c:457</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a8edf5f2066b05fb343931f45e2bec8f8"><div class="ttname"><a href="QuEST__cpu_8c.html#a8edf5f2066b05fb343931f45e2bec8f8">statevec_pauliYLocal</a></div><div class="ttdeci">void statevec_pauliYLocal(Qureg qureg, const int targetQubit, const int conjFac)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02219">QuEST_cpu.c:2219</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad711cac41adb0fea1ad4797ce14953e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad711cac41adb0fea1ad4797ce14953e0">&#9670;&nbsp;</a></span>statevec_pauliZ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_pauliZ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00209">209</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02514">statevec_phaseShiftByTerm()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00330">pauliZ()</a>.</p>
<div class="fragment"><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                                                         {</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="structComplex.html">Complex</a> term; </div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    term.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> = -1;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    term.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> =  0;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="QuEST__internal_8h.html#a8972669148af60d7e1c09687f69673d4">statevec_phaseShiftByTerm</a>(qureg, targetQubit, term);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;}</div><div class="ttc" id="QuEST__internal_8h_html_a8972669148af60d7e1c09687f69673d4"><div class="ttname"><a href="QuEST__internal_8h.html#a8972669148af60d7e1c09687f69673d4">statevec_phaseShiftByTerm</a></div><div class="ttdeci">void statevec_phaseShiftByTerm(Qureg qureg, const int targetQubit, Complex term)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02514">QuEST_cpu.c:2514</a></div></div>
<div class="ttc" id="structComplex_html_ab5b2e2eca02131fc74b289a83636cbe3"><div class="ttname"><a href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">Complex::real</a></div><div class="ttdeci">qreal real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00059">QuEST.h:59</a></div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00060">QuEST.h:60</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00057">QuEST.h:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a37bcd16fc0bbc8e665585ba9b99f382b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37bcd16fc0bbc8e665585ba9b99f382b">&#9670;&nbsp;</a></span>statevec_phaseShift()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_phaseShift </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00202">202</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02514">statevec_phaseShiftByTerm()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00363">phaseShift()</a>.</p>
<div class="fragment"><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                                                                          {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="structComplex.html">Complex</a> term; </div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    term.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> = cos(angle); </div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    term.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = sin(angle);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="QuEST__internal_8h.html#a8972669148af60d7e1c09687f69673d4">statevec_phaseShiftByTerm</a>(qureg, targetQubit, term);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;}</div><div class="ttc" id="QuEST__internal_8h_html_a8972669148af60d7e1c09687f69673d4"><div class="ttname"><a href="QuEST__internal_8h.html#a8972669148af60d7e1c09687f69673d4">statevec_phaseShiftByTerm</a></div><div class="ttdeci">void statevec_phaseShiftByTerm(Qureg qureg, const int targetQubit, Complex term)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02514">QuEST_cpu.c:2514</a></div></div>
<div class="ttc" id="structComplex_html_ab5b2e2eca02131fc74b289a83636cbe3"><div class="ttname"><a href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">Complex::real</a></div><div class="ttdeci">qreal real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00059">QuEST.h:59</a></div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00060">QuEST.h:60</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00057">QuEST.h:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8972669148af60d7e1c09687f69673d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8972669148af60d7e1c09687f69673d4">&#9670;&nbsp;</a></span>statevec_phaseShiftByTerm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_phaseShiftByTerm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>term</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02514">2514</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__common_8c_source.html#l00209">statevec_pauliZ()</a>, <a class="el" href="QuEST__common_8c_source.html#l00202">statevec_phaseShift()</a>, <a class="el" href="QuEST__common_8c_source.html#l00216">statevec_sGate()</a>, <a class="el" href="QuEST__common_8c_source.html#l00230">statevec_sGateConj()</a>, <a class="el" href="QuEST__common_8c_source.html#l00223">statevec_tGate()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00237">statevec_tGateConj()</a>.</p>
<div class="fragment"><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;{       </div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;    <span class="keywordtype">int</span> targetBit;</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    </div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;    stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;    </div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealLo, stateImagLo;</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;    <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> cosAngle = term.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;    <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> sinAngle = term.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;<span class="preprocessor"># pragma omp parallel for \</span></div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;<span class="preprocessor">    default  (none)              \</span></div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;<span class="preprocessor">    shared   (stateVecSize, stateVecReal,stateVecImag ) \</span></div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;<span class="preprocessor">    private  (index,targetBit,stateRealLo,stateImagLo)             \</span></div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;<span class="preprocessor">    schedule (static)</span></div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;    <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;        </div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;        <span class="comment">// update the coeff of the |1&gt; state of the target qubit</span></div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;        targetBit = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (targetQubit, index+chunkId*chunkSize);</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;        <span class="keywordflow">if</span> (targetBit) {</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;            </div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;            stateRealLo = stateVecReal[index];</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;            stateImagLo = stateVecImag[index];</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;            </div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;            stateVecReal[index] = cosAngle*stateRealLo - sinAngle*stateImagLo;</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;            stateVecImag[index] = sinAngle*stateRealLo + cosAngle*stateImagLo;  </div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;        }</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;    }</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="structComplex_html_ab5b2e2eca02131fc74b289a83636cbe3"><div class="ttname"><a href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">Complex::real</a></div><div class="ttdeci">qreal real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00059">QuEST.h:59</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a100463f6ec212c76a5fad99579000505"><div class="ttname"><a href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a></div><div class="ttdeci">static int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdoc">Get the value of the bit at a particular index in a number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00031">QuEST_cpu.c:31</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00060">QuEST.h:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1e57230c7995447039e62a84c0a36524"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e57230c7995447039e62a84c0a36524">&#9670;&nbsp;</a></span>statevec_reportStateToScreen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_reportStateToScreen </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reportRank</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print the current state vector of probability amplitudes for a set of qubits to standard out. </p>
<p>For debugging purposes. Each rank should print output serially. Only print output for systems &lt;= 5 qubits </p>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01100">1100</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__gpu_8cu_source.html#l00291">copyStateFromGPU()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00097">Qureg::numChunks</a>, <a class="el" href="QuEST_8h_source.html#l00088">Qureg::numQubitsInStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00166">syncQuESTEnv()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00705">reportStateToScreen()</a>.</p>
<div class="fragment"><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                                                                            {</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="keywordtype">int</span> rank;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218">numQubitsInStateVec</a>&lt;=5){</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        <span class="keywordflow">for</span> (rank=0; rank&lt;qureg.<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a>; rank++){</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;            <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>==rank){</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                <span class="keywordflow">if</span> (reportRank) {</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                    printf(<span class="stringliteral">&quot;Reporting state from rank %d [\n&quot;</span>, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>);</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                    printf(<span class="stringliteral">&quot;real, imag\n&quot;</span>);</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rank==0) {</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                    printf(<span class="stringliteral">&quot;Reporting state [\n&quot;</span>);</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                    printf(<span class="stringliteral">&quot;real, imag\n&quot;</span>);</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                }</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                <span class="keywordflow">for</span>(index=0; index&lt;qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>; index++){</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                    <span class="comment">//printf(REAL_STRING_FORMAT &quot;, &quot; REAL_STRING_FORMAT &quot;\n&quot;, qureg.pairStateVec.real[index], qureg.pairStateVec.imag[index]);</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                    printf(REAL_STRING_FORMAT <span class="stringliteral">&quot;, &quot;</span> REAL_STRING_FORMAT <span class="stringliteral">&quot;\n&quot;</span>, qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[index], qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[index]);</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                }</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                <span class="keywordflow">if</span> (reportRank || rank==qureg.<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a>-1) printf(<span class="stringliteral">&quot;]\n&quot;</span>);</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;            }</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;            <a class="code" href="QuEST_8h.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77">syncQuESTEnv</a>(env);</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        }</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Error: reportStateToScreen will not print output for systems of more than 5 qubits.\n&quot;</span>);</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="structQureg_html_aa3deb7163aab90a61e755a1f200f5413"><div class="ttname"><a href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">Qureg::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into – the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00097">QuEST.h:97</a></div></div>
<div class="ttc" id="QuEST_8h_html_a8d31fe2d1ad4d01e2a1f5f6b8bc15b77"><div class="ttname"><a href="QuEST_8h.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77">syncQuESTEnv</a></div><div class="ttdeci">void syncQuESTEnv(QuESTEnv env)</div><div class="ttdoc">Guarantees that all code up to the given point has been executed on all nodes (if running in distribu...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00166">QuEST_cpu_distributed.c:166</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
<div class="ttc" id="structQureg_html_a0a86e8a50ea8c998b4a0a6640c5a1218"><div class="ttname"><a href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218">Qureg::numQubitsInStateVec</a></div><div class="ttdeci">int numQubitsInStateVec</div><div class="ttdoc">Number of qubits in the state-vector - this is double the number represented for mixed states...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00088">QuEST.h:88</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a65b9087ca37c096caa5c6e8586b67946"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65b9087ca37c096caa5c6e8586b67946">&#9670;&nbsp;</a></span>statevec_rotateAroundAxis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_rotateAroundAxis </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structVector.html">Vector</a>&#160;</td>
          <td class="paramname"><em>axis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00262">262</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__common_8c_source.html#l00064">getComplexPairFromRotation()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00795">statevec_compactUnitary()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00450">rotateAroundAxis()</a>, <a class="el" href="QuEST__common_8c_source.html#l00244">statevec_rotateX()</a>, <a class="el" href="QuEST__common_8c_source.html#l00250">statevec_rotateY()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00256">statevec_rotateZ()</a>.</p>
<div class="fragment"><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                                                                                         {</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <a class="code" href="structComplex.html">Complex</a> alpha, beta;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="QuEST__common_8c.html#a71b3ae4402c1c5039d3086ca0e47a522">getComplexPairFromRotation</a>(angle, axis, &amp;alpha, &amp;beta);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="QuEST__internal_8h.html#a94ee4df9faba286ad7a5bc829ef5174d">statevec_compactUnitary</a>(qureg, rotQubit, alpha, beta);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;}</div><div class="ttc" id="QuEST__common_8c_html_a71b3ae4402c1c5039d3086ca0e47a522"><div class="ttname"><a href="QuEST__common_8c.html#a71b3ae4402c1c5039d3086ca0e47a522">getComplexPairFromRotation</a></div><div class="ttdeci">void getComplexPairFromRotation(qreal angle, Vector axis, Complex *alpha, Complex *beta)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__common_8c_source.html#l00064">QuEST_common.c:64</a></div></div>
<div class="ttc" id="QuEST__internal_8h_html_a94ee4df9faba286ad7a5bc829ef5174d"><div class="ttname"><a href="QuEST__internal_8h.html#a94ee4df9faba286ad7a5bc829ef5174d">statevec_compactUnitary</a></div><div class="ttdeci">void statevec_compactUnitary(Qureg qureg, const int targetQubit, Complex alpha, Complex beta)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00795">QuEST_cpu_distributed.c:795</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00057">QuEST.h:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af9839c40de8df0cecc72a0258a20d979"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9839c40de8df0cecc72a0258a20d979">&#9670;&nbsp;</a></span>statevec_rotateAroundAxisConj()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_rotateAroundAxisConj </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structVector.html">Vector</a>&#160;</td>
          <td class="paramname"><em>axis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00269">269</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__common_8c_source.html#l00064">getComplexPairFromRotation()</a>, <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00795">statevec_compactUnitary()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00450">rotateAroundAxis()</a>.</p>
<div class="fragment"><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                                                                             {</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <a class="code" href="structComplex.html">Complex</a> alpha, beta;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="QuEST__common_8c.html#a71b3ae4402c1c5039d3086ca0e47a522">getComplexPairFromRotation</a>(angle, axis, &amp;alpha, &amp;beta);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    alpha.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> *= -1; </div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    beta.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> *= -1;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="QuEST__internal_8h.html#a94ee4df9faba286ad7a5bc829ef5174d">statevec_compactUnitary</a>(qureg, rotQubit, alpha, beta);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;}</div><div class="ttc" id="QuEST__common_8c_html_a71b3ae4402c1c5039d3086ca0e47a522"><div class="ttname"><a href="QuEST__common_8c.html#a71b3ae4402c1c5039d3086ca0e47a522">getComplexPairFromRotation</a></div><div class="ttdeci">void getComplexPairFromRotation(qreal angle, Vector axis, Complex *alpha, Complex *beta)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__common_8c_source.html#l00064">QuEST_common.c:64</a></div></div>
<div class="ttc" id="QuEST__internal_8h_html_a94ee4df9faba286ad7a5bc829ef5174d"><div class="ttname"><a href="QuEST__internal_8h.html#a94ee4df9faba286ad7a5bc829ef5174d">statevec_compactUnitary</a></div><div class="ttdeci">void statevec_compactUnitary(Qureg qureg, const int targetQubit, Complex alpha, Complex beta)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00795">QuEST_cpu_distributed.c:795</a></div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00060">QuEST.h:60</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00057">QuEST.h:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aca123cc22e13a2cb819ef6c2f455b9e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca123cc22e13a2cb819ef6c2f455b9e4">&#9670;&nbsp;</a></span>statevec_rotateX()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_rotateX </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00244">244</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__common_8c_source.html#l00262">statevec_rotateAroundAxis()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00171">rotateX()</a>.</p>
<div class="fragment"><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                                                                   {</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="structVector.html">Vector</a> unitAxis = {1, 0, 0};</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="QuEST__common_8c.html#a65b9087ca37c096caa5c6e8586b67946">statevec_rotateAroundAxis</a>(qureg, rotQubit, angle, unitAxis);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;}</div><div class="ttc" id="QuEST__common_8c_html_a65b9087ca37c096caa5c6e8586b67946"><div class="ttname"><a href="QuEST__common_8c.html#a65b9087ca37c096caa5c6e8586b67946">statevec_rotateAroundAxis</a></div><div class="ttdeci">void statevec_rotateAroundAxis(Qureg qureg, const int rotQubit, qreal angle, Vector axis)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__common_8c_source.html#l00262">QuEST_common.c:262</a></div></div>
<div class="ttc" id="structVector_html"><div class="ttname"><a href="structVector.html">Vector</a></div><div class="ttdoc">Represents a 3-vector of real numbers. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00073">QuEST.h:73</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4a62c8c00dc4adf74b982ad8a9049170"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a62c8c00dc4adf74b982ad8a9049170">&#9670;&nbsp;</a></span>statevec_rotateY()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_rotateY </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00250">250</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__common_8c_source.html#l00262">statevec_rotateAroundAxis()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00182">rotateY()</a>.</p>
<div class="fragment"><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                                                                   {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="structVector.html">Vector</a> unitAxis = {0, 1, 0};</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="QuEST__common_8c.html#a65b9087ca37c096caa5c6e8586b67946">statevec_rotateAroundAxis</a>(qureg, rotQubit, angle, unitAxis);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;}</div><div class="ttc" id="QuEST__common_8c_html_a65b9087ca37c096caa5c6e8586b67946"><div class="ttname"><a href="QuEST__common_8c.html#a65b9087ca37c096caa5c6e8586b67946">statevec_rotateAroundAxis</a></div><div class="ttdeci">void statevec_rotateAroundAxis(Qureg qureg, const int rotQubit, qreal angle, Vector axis)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__common_8c_source.html#l00262">QuEST_common.c:262</a></div></div>
<div class="ttc" id="structVector_html"><div class="ttname"><a href="structVector.html">Vector</a></div><div class="ttdoc">Represents a 3-vector of real numbers. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00073">QuEST.h:73</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab96ee09e32e297629a481c3ba6d7eaf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab96ee09e32e297629a481c3ba6d7eaf7">&#9670;&nbsp;</a></span>statevec_rotateZ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_rotateZ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00256">256</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__common_8c_source.html#l00262">statevec_rotateAroundAxis()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00193">rotateZ()</a>.</p>
<div class="fragment"><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                                                                   {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <a class="code" href="structVector.html">Vector</a> unitAxis = {0, 0, 1};</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="QuEST__common_8c.html#a65b9087ca37c096caa5c6e8586b67946">statevec_rotateAroundAxis</a>(qureg, rotQubit, angle, unitAxis);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;}</div><div class="ttc" id="QuEST__common_8c_html_a65b9087ca37c096caa5c6e8586b67946"><div class="ttname"><a href="QuEST__common_8c.html#a65b9087ca37c096caa5c6e8586b67946">statevec_rotateAroundAxis</a></div><div class="ttdeci">void statevec_rotateAroundAxis(Qureg qureg, const int rotQubit, qreal angle, Vector axis)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__common_8c_source.html#l00262">QuEST_common.c:262</a></div></div>
<div class="ttc" id="structVector_html"><div class="ttname"><a href="structVector.html">Vector</a></div><div class="ttdoc">Represents a 3-vector of real numbers. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00073">QuEST.h:73</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa121d55f2ca09c06a96ddcd433c60b0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa121d55f2ca09c06a96ddcd433c60b0f">&#9670;&nbsp;</a></span>statevec_setAmps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_setAmps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>startInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>reals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>imags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>numAmps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01016">1016</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00131">initStateFromAmps()</a>, and <a class="el" href="QuEST_8c_source.html#l00139">setAmps()</a>.</p>
<div class="fragment"><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                                                                                                              {</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    </div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="comment">/* this is actually distributed, since the user&#39;s code runs on every node */</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    </div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="comment">// local start/end indices of the given amplitudes, assuming they fit in this chunk</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <span class="comment">// these may be negative or above qureg.numAmpsPerChunk</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localStartInd = startInd - qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>*qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localEndInd = localStartInd + numAmps; <span class="comment">// exclusive</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    </div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="comment">// add this to a local index to get corresponding elem in reals &amp; imags</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> offset = qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>*qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a> - startInd;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    </div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="comment">// restrict these indices to fit into this chunk</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="keywordflow">if</span> (localStartInd &lt; 0)</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        localStartInd = 0;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="keywordflow">if</span> (localEndInd &gt; qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>)</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        localEndInd = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="comment">// they may now be out of order = no iterations</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    </div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="comment">// unpacking OpenMP vars</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* vecRe = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>* vecIm = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    </div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="preprocessor">    shared   (localStartInd,localEndInd, vecRe,vecIm, reals,imags, offset) \</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="preprocessor">    private  (index) </span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    {</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        <span class="comment">// iterate these local inds - this might involve no iterations</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="keywordflow">for</span> (index=localStartInd; index &lt; localEndInd; index++) {</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;            vecRe[index] = reals[index + offset];</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;            vecIm[index] = imags[index + offset];</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        }</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    }</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;}</div><div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC. </div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aea5b9ea10791217a793a8040c36e4efc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea5b9ea10791217a793a8040c36e4efc">&#9670;&nbsp;</a></span>statevec_sGate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_sGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00216">216</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02514">statevec_phaseShiftByTerm()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00341">sGate()</a>.</p>
<div class="fragment"><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                                        {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="structComplex.html">Complex</a> term; </div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    term.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> = 0;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    term.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = 1;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="QuEST__internal_8h.html#a8972669148af60d7e1c09687f69673d4">statevec_phaseShiftByTerm</a>(qureg, targetQubit, term);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;} </div><div class="ttc" id="QuEST__internal_8h_html_a8972669148af60d7e1c09687f69673d4"><div class="ttname"><a href="QuEST__internal_8h.html#a8972669148af60d7e1c09687f69673d4">statevec_phaseShiftByTerm</a></div><div class="ttdeci">void statevec_phaseShiftByTerm(Qureg qureg, const int targetQubit, Complex term)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02514">QuEST_cpu.c:2514</a></div></div>
<div class="ttc" id="structComplex_html_ab5b2e2eca02131fc74b289a83636cbe3"><div class="ttname"><a href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">Complex::real</a></div><div class="ttdeci">qreal real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00059">QuEST.h:59</a></div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00060">QuEST.h:60</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00057">QuEST.h:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a78bfeb90f0c1812e726ec3092056bb52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78bfeb90f0c1812e726ec3092056bb52">&#9670;&nbsp;</a></span>statevec_sGateConj()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_sGateConj </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00230">230</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02514">statevec_phaseShiftByTerm()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00341">sGate()</a>.</p>
<div class="fragment"><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                                            {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <a class="code" href="structComplex.html">Complex</a> term; </div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    term.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> =  0;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    term.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = -1;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <a class="code" href="QuEST__internal_8h.html#a8972669148af60d7e1c09687f69673d4">statevec_phaseShiftByTerm</a>(qureg, targetQubit, term);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;} </div><div class="ttc" id="QuEST__internal_8h_html_a8972669148af60d7e1c09687f69673d4"><div class="ttname"><a href="QuEST__internal_8h.html#a8972669148af60d7e1c09687f69673d4">statevec_phaseShiftByTerm</a></div><div class="ttdeci">void statevec_phaseShiftByTerm(Qureg qureg, const int targetQubit, Complex term)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02514">QuEST_cpu.c:2514</a></div></div>
<div class="ttc" id="structComplex_html_ab5b2e2eca02131fc74b289a83636cbe3"><div class="ttname"><a href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">Complex::real</a></div><div class="ttdeci">qreal real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00059">QuEST.h:59</a></div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00060">QuEST.h:60</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00057">QuEST.h:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0bd738cb7e7cdea8f1ce1e640d427d4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bd738cb7e7cdea8f1ce1e640d427d4c">&#9670;&nbsp;</a></span>statevec_tGate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_tGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00223">223</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02514">statevec_phaseShiftByTerm()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00352">tGate()</a>.</p>
<div class="fragment"><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                                                        {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="structComplex.html">Complex</a> term; </div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    term.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> = 1/sqrt(2);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    term.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = 1/sqrt(2);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="QuEST__internal_8h.html#a8972669148af60d7e1c09687f69673d4">statevec_phaseShiftByTerm</a>(qureg, targetQubit, term);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;}</div><div class="ttc" id="QuEST__internal_8h_html_a8972669148af60d7e1c09687f69673d4"><div class="ttname"><a href="QuEST__internal_8h.html#a8972669148af60d7e1c09687f69673d4">statevec_phaseShiftByTerm</a></div><div class="ttdeci">void statevec_phaseShiftByTerm(Qureg qureg, const int targetQubit, Complex term)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02514">QuEST_cpu.c:2514</a></div></div>
<div class="ttc" id="structComplex_html_ab5b2e2eca02131fc74b289a83636cbe3"><div class="ttname"><a href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">Complex::real</a></div><div class="ttdeci">qreal real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00059">QuEST.h:59</a></div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00060">QuEST.h:60</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00057">QuEST.h:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3ce1b05fee70d930791513fec378d229"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ce1b05fee70d930791513fec378d229">&#9670;&nbsp;</a></span>statevec_tGateConj()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_tGateConj </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__common_8c_source.html#l00237">237</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02514">statevec_phaseShiftByTerm()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00352">tGate()</a>.</p>
<div class="fragment"><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                                                            {</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="structComplex.html">Complex</a> term; </div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    term.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> =  1/sqrt(2);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    term.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = -1/sqrt(2);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="QuEST__internal_8h.html#a8972669148af60d7e1c09687f69673d4">statevec_phaseShiftByTerm</a>(qureg, targetQubit, term);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;}</div><div class="ttc" id="QuEST__internal_8h_html_a8972669148af60d7e1c09687f69673d4"><div class="ttname"><a href="QuEST__internal_8h.html#a8972669148af60d7e1c09687f69673d4">statevec_phaseShiftByTerm</a></div><div class="ttdeci">void statevec_phaseShiftByTerm(Qureg qureg, const int targetQubit, Complex term)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l02514">QuEST_cpu.c:2514</a></div></div>
<div class="ttc" id="structComplex_html_ab5b2e2eca02131fc74b289a83636cbe3"><div class="ttname"><a href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">Complex::real</a></div><div class="ttdeci">qreal real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00059">QuEST.h:59</a></div></div>
<div class="ttc" id="structComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00060">QuEST.h:60</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00057">QuEST.h:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4bea7ed7967083cbabd8a8e5acdd48c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bea7ed7967083cbabd8a8e5acdd48c0">&#9670;&nbsp;</a></span>statevec_unitary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_unitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00832">832</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">exchangeStateVectors()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00293">getRotAngleFromUnitaryMatrix()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l01603">statevec_unitaryDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l01477">statevec_unitaryLocal()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST_8c_source.html#l00240">unitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;{</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <a class="code" href="structComplex.html">Complex</a> rot1, rot2;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="comment">// rank&#39;s chunk is in upper half of block </span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordtype">int</span> rankIsUpper;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="keywordflow">if</span> (useLocalDataOnly){</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <span class="comment">// all values required to update state vector lie in this rank</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <a class="code" href="QuEST__cpu_8c.html#a9f62ff38deae8ef012024d416d749c00">statevec_unitaryLocal</a>(qureg, targetQubit, u);</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <span class="comment">// need to get corresponding chunk of state vector from other rank</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <a class="code" href="QuEST__cpu__distributed_8c.html#a5c9b2f129bdffaaba9857f6eddecbb17">getRotAngleFromUnitaryMatrix</a>(rankIsUpper, &amp;rot1, &amp;rot2, u);</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        <span class="comment">// get corresponding values from my pair</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <a class="code" href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a>(qureg, pairRank);</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <span class="comment">// this rank&#39;s values are either in the upper of lower half of the block. </span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        <span class="comment">// send values to compactUnitaryDistributed in the correct order</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        <span class="keywordflow">if</span> (rankIsUpper){</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a62c5d85e323f2c3eea2b7fa6d8c193ea">statevec_unitaryDistributed</a>(qureg,targetQubit,rot1,rot2,</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>, <span class="comment">//upper</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                    qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>, <span class="comment">//lower</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>); <span class="comment">//output</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            <a class="code" href="QuEST__cpu_8c.html#a62c5d85e323f2c3eea2b7fa6d8c193ea">statevec_unitaryDistributed</a>(qureg,targetQubit,rot1,rot2,</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                    qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>, <span class="comment">//upper</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>, <span class="comment">//lower</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                    qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>); <span class="comment">//output</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        }</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    }</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;}</div><div class="ttc" id="QuEST__cpu_8c_html_a62c5d85e323f2c3eea2b7fa6d8c193ea"><div class="ttname"><a href="QuEST__cpu_8c.html#a62c5d85e323f2c3eea2b7fa6d8c193ea">statevec_unitaryDistributed</a></div><div class="ttdeci">void statevec_unitaryDistributed(Qureg qureg, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</div><div class="ttdoc">Apply a unitary operation to a single qubit given a subset of the state vector with upper and lower b...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l01603">QuEST_cpu.c:1603</a></div></div>
<div class="ttc" id="structQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00100">QuEST.h:100</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00366">QuEST_cpu_distributed.c:366</a></div></div>
<div class="ttc" id="QuEST__cpu_8c_html_a9f62ff38deae8ef012024d416d749c00"><div class="ttname"><a href="QuEST__cpu_8c.html#a9f62ff38deae8ef012024d416d749c00">statevec_unitaryLocal</a></div><div class="ttdeci">void statevec_unitaryLocal(Qureg qureg, const int targetQubit, ComplexMatrix2 u)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l01477">QuEST_cpu.c:1477</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a5c9b2f129bdffaaba9857f6eddecbb17"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a5c9b2f129bdffaaba9857f6eddecbb17">getRotAngleFromUnitaryMatrix</a></div><div class="ttdeci">static void getRotAngleFromUnitaryMatrix(int chunkIsUpper, Complex *rot1, Complex *rot2, ComplexMatrix2 u)</div><div class="ttdoc">Get rotation values for a given chunk given a unitary matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00293">QuEST_cpu_distributed.c:293</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a7dba097f23f5d48dfdc9f3250444e2e4"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a></div><div class="ttdeci">static int getChunkPairId(int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">get position of corresponding chunk, holding values required to update values in my chunk (with chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00313">QuEST_cpu_distributed.c:313</a></div></div>
<div class="ttc" id="structQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00102">QuEST.h:102</a></div></div>
<div class="ttc" id="structQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00091">QuEST.h:91</a></div></div>
<div class="ttc" id="structQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00095">QuEST.h:95</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00237">QuEST_cpu_distributed.c:237</a></div></div>
<div class="ttc" id="QuEST__cpu__distributed_8c_html_ae01c3eb75fd32de1a7e1dbc7a33a21e3"><div class="ttname"><a href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a></div><div class="ttdeci">void exchangeStateVectors(Qureg qureg, int pairRank)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00457">QuEST_cpu_distributed.c:457</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00057">QuEST.h:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jan 8 2019 16:56:29 for Quantum Exact Simulation Toolkit by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
