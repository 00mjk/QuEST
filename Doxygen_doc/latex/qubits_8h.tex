\hypertarget{qubits_8h}{}\subsection{qubits.\+h File Reference}
\label{qubits_8h}\index{qubits.\+h@{qubits.\+h}}


The Qu\+E\+ST library A\+PI and objects.  


{\ttfamily \#include \char`\"{}precision.\+h\char`\"{}}\newline
\subsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structComplexArray}{Complex\+Array}
\begin{DoxyCompactList}\small\item\em Represents an array of complex numbers grouped into an array of real components and an array of coressponding complex components. \end{DoxyCompactList}\item 
struct \hyperlink{structComplex}{Complex}
\begin{DoxyCompactList}\small\item\em Represents one complex number. \end{DoxyCompactList}\item 
struct \hyperlink{structVector}{Vector}
\item 
struct \hyperlink{structMultiQubit}{Multi\+Qubit}
\begin{DoxyCompactList}\small\item\em Represents a system of qubits. \end{DoxyCompactList}\item 
struct \hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}
\begin{DoxyCompactList}\small\item\em Information about the environment the program is running in. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{structComplexArray}{Complex\+Array} \hyperlink{qubits_8h_a19e00739fde70a851d068f322cf915c8}{Complex\+Array}
\begin{DoxyCompactList}\small\item\em Represents an array of complex numbers grouped into an array of real components and an array of coressponding complex components. \end{DoxyCompactList}\item 
typedef struct \hyperlink{structComplex}{Complex} \hyperlink{qubits_8h_ad59c9e471673c07782e6c403277ffd8d}{Complex}
\begin{DoxyCompactList}\small\item\em Represents one complex number. \end{DoxyCompactList}\item 
typedef struct \hyperlink{structVector}{Vector} \hyperlink{qubits_8h_a6ded2cf071c127e518317e3c451af3ef}{Vector}
\item 
typedef struct \hyperlink{structMultiQubit}{Multi\+Qubit} \hyperlink{qubits_8h_af4123a681074068eeeee1562758eef61}{Multi\+Qubit}
\begin{DoxyCompactList}\small\item\em Represents a system of qubits. \end{DoxyCompactList}\item 
typedef struct \hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env} \hyperlink{qubits_8h_aedfe2bb713c31d6133e53b1bd72d7a2c}{Qu\+E\+S\+T\+Env}
\begin{DoxyCompactList}\small\item\em Information about the environment the program is running in. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{qubits_8h_a5739021c733cecc49647956b2f7338ea}{phase\+Gate\+Type} \{ \hyperlink{qubits_8h_a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac}{S\+I\+G\+M\+A\+\_\+Z} =0, 
\hyperlink{qubits_8h_a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f}{S\+\_\+\+G\+A\+TE} =1, 
\hyperlink{qubits_8h_a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab}{T\+\_\+\+G\+A\+TE} =2
 \}
\end{DoxyCompactItemize}
\subsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{qubits_8h_a9c02591bc64c2918503afa231d90d83f}{create\+Multi\+Qubit} (\hyperlink{structMultiQubit}{Multi\+Qubit} $\ast$multi\+Qubit, int num\+Qubits, \hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env} env)
\begin{DoxyCompactList}\small\item\em Create a \hyperlink{structMultiQubit}{Multi\+Qubit} object representing a set of qubits. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_ae5d6acc322314d7a3d8a2eccf00d3b19}{destroy\+Multi\+Qubit} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, \hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env} env)
\begin{DoxyCompactList}\small\item\em Deallocate a \hyperlink{structMultiQubit}{Multi\+Qubit} object representing a set of qubits Free memory allocated to state vector of probability amplitudes, including temporary vector for values copied from another chunk if running the distributed version. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a96f4de9ce7fefc7680a44d601fc3d894}{report\+State} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit)
\begin{DoxyCompactList}\small\item\em Print the current state vector of probability amplitudes for a set of qubits to file. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a842d6884e063a5865a2232cba56b65ac}{report\+State\+To\+Screen} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, \hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env} env, int report\+Rank)
\begin{DoxyCompactList}\small\item\em Print the current state vector of probability amplitudes for a set of qubits to standard out. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_aa5e77e0e64f3a4a3d3f5cc7382bffcd9}{report\+Multi\+Qubit\+Params} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit)
\begin{DoxyCompactList}\small\item\em Report metainformation about a set of qubits\+: number of qubits, number of probability amplitudes. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_acb5b2eff794339090004d29f02a70d9a}{init\+State\+Zero} (\hyperlink{structMultiQubit}{Multi\+Qubit} $\ast$multi\+Qubit)
\begin{DoxyCompactList}\small\item\em Initialise the state vector of probability amplitudes for a set of qubits to the zero state\+: $\vert$000...00$>$ \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a43bcb279fc9717fbd06a19cdef48b9d8}{init\+State\+Plus} (\hyperlink{structMultiQubit}{Multi\+Qubit} $\ast$multi\+Qubit)
\begin{DoxyCompactList}\small\item\em Initialise the state vector of probability amplitudes for a set of qubits to an equal real superposition of all amplitudes\+: $\vert$+++...++$>$ \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_aca7765bd500718f98700a172351748cc}{quad\+C\+Phase\+Gate} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int id\+Qubit1, const int id\+Qubit2, const int id\+Qubit3, const int id\+Qubit4)
\begin{DoxyCompactList}\small\item\em The control not gate. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a0ad4584e44f567c140b653ed36d26ccf}{control\+Phase\+Gate} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int id\+Qubit1, const int id\+Qubit2)
\begin{DoxyCompactList}\small\item\em The control phase (the two qubit phase gate). \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a9c90f8302e4f1d8fda23def8753e50fe}{sigmaZ} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int rot\+Qubit)
\begin{DoxyCompactList}\small\item\em Rotate a single qubit by \{\{1,0\},\{\{0,-\/1\}\} -- apply a phase of -\/1 to $\vert$1$>$. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a1086d84d6a3d5b79137e2f27f18e67e0}{s\+Gate} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int rot\+Qubit)
\item 
void \hyperlink{qubits_8h_a5f33ddd690383fd09cc79bf143e383fb}{t\+Gate} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int rot\+Qubit)
\item 
void \hyperlink{qubits_8h_ad84a3ce68d1ca02b4e3f741ea45b6054}{init\+Qu\+E\+S\+T\+Env} (\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env} $\ast$env)
\begin{DoxyCompactList}\small\item\em Initialize Qu\+E\+ST environment. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_abd4bc926cd3f9b65610bb228d0c59fe0}{close\+Qu\+E\+S\+T\+Env} (\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env} env)
\begin{DoxyCompactList}\small\item\em Close Qu\+E\+ST environment. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a8d31fe2d1ad4d01e2a1f5f6b8bc15b77}{sync\+Qu\+E\+S\+T\+Env} (\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env} env)
\begin{DoxyCompactList}\small\item\em Guarantees that all code up to the given point has been executed on all nodes. \end{DoxyCompactList}\item 
int \hyperlink{qubits_8h_a877396e10f0e9aeead078664c51bb0e3}{sync\+Qu\+E\+S\+T\+Success} (\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env} env, int success\+Code)
\begin{DoxyCompactList}\small\item\em Performs a logical A\+ND on all success\+Codes held by all processes. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_af8a14ae79c3fb2c0b5f6255cc37bebf9}{report\+Qu\+E\+S\+T\+Env} (\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env} env)
\begin{DoxyCompactList}\small\item\em Report information about the Qu\+E\+ST environment. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a8f10aabf9f607f19093aee54630caa21}{get\+Environment\+String} (\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env} env, \hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, char str\mbox{[}200\mbox{]})
\item 
\hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} \hyperlink{qubits_8h_a317b786f577fa6bc136ea7f0ee7330a7}{get\+Real\+Amp\+El} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, long long int index)
\begin{DoxyCompactList}\small\item\em Get the real component of the probability amplitude at an index in the state vector. \end{DoxyCompactList}\item 
\hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} \hyperlink{qubits_8h_a3615f76fd5f57008d9b74bbd10533dd0}{get\+Imag\+Amp\+El} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, long long int index)
\begin{DoxyCompactList}\small\item\em Get the imaginary component of the probability amplitude at an index in the state vector. \end{DoxyCompactList}\item 
\hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} \hyperlink{qubits_8h_a799b10447d6dbdaf960a4d3eedd22014}{get\+Prob\+El} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, long long int index)
\begin{DoxyCompactList}\small\item\em Get the probability of the state at an index in the state vector. \end{DoxyCompactList}\item 
\hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} \hyperlink{qubits_8h_a818a4c7cd7252d2b10b896b12fa431d3}{calc\+Total\+Probability} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit)
\begin{DoxyCompactList}\small\item\em Calculate the probability of being in any state by taking the norm of the entire state vector. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a4ba468aa69f812efd1f964e10a45ca2f}{rotate\+Qubit} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int rot\+Qubit, \hyperlink{structComplex}{Complex} alpha, \hyperlink{structComplex}{Complex} beta)
\begin{DoxyCompactList}\small\item\em Rotate a single qubit in the state vector of probability amplitudes. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a70b6649dc52a36ff2d0ed91fb443c3c4}{rotate\+Qubit\+By\+Angle} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int rot\+Qubit, \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} angle, \hyperlink{structVector}{Vector} unit\+Axis)
\begin{DoxyCompactList}\small\item\em Rotate a single qubit a certain angle about an axis. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_abac5189a14bc12e79580ba0d75de796e}{control\+Rotate\+Qubit} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int rot\+Qubit, const int control\+Qubit, \hyperlink{structComplex}{Complex} alpha, \hyperlink{structComplex}{Complex} beta)
\begin{DoxyCompactList}\small\item\em Rotate a single qubit in the state vector of probability amplitudes. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_acda82bebb0a62f419eec9c1e0575daad}{sigmaX} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int rot\+Qubit)
\begin{DoxyCompactList}\small\item\em Rotate a single qubit by \{\{0,1\},\{1,0\}\} -- swap $\vert$0$>$ and $\vert$1$>$. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a7b022c75cef77be046bd5d61e38a581e}{sigmaY} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int rot\+Qubit)
\begin{DoxyCompactList}\small\item\em Rotate a single qubit by \{\{0,-\/i\},\{i,0\}\} -- swap $\vert$0$>$ and $\vert$1$>$ and apply a phase of -\/i or i. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_ad247d084dc7150893e9051a438a5807e}{hadamard} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int rot\+Qubit)
\begin{DoxyCompactList}\small\item\em Rotate a single qubit by \{\{1,1\},\{1,-\/1\}\}/sqrt2 -- turn a $\vert$0$>$ into a $\vert$+$>$ and a $\vert$1$>$ into a $\vert$-\/$>$. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a4b3e91607bfbce06faf1d2e5dfcf2ea9}{control\+Not} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int target\+Qubit, const int control\+Qubit)
\begin{DoxyCompactList}\small\item\em Rotate a single qubit by \{\{0,-\/i\},\{i,0\}\} -- swap $\vert$0$>$ and $\vert$1$>$ and apply a phase of -\/i or i, only for elements when control qubit is 1. \end{DoxyCompactList}\item 
\hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} \hyperlink{qubits_8h_ad315c941a51bc053d39ebfa2040fd32e}{find\+Probability\+Of\+Outcome} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int measure\+Qubit, int outcome)
\begin{DoxyCompactList}\small\item\em Measure the probability of a specified qubit being in the zero or one state. \end{DoxyCompactList}\item 
\hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} \hyperlink{qubits_8h_a88605f373c2401760aab0e08719e08dd}{measure\+In\+State} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int measure\+Qubit, int outcome)
\begin{DoxyCompactList}\small\item\em Update the state vector to be consistent with measuring measure\+Qubit=0 or measure\+Qubit=1 according to the value of outcome. \end{DoxyCompactList}\item 
\hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} \hyperlink{qubits_8h_ae8fcabd3f22c6c9a9104e1807fb78f80}{filter\+Out111} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int id\+Qubit1, const int id\+Qubit2, const int id\+Qubit3)
\begin{DoxyCompactList}\small\item\em Updates the state according to this scenario\+: we ask \char`\"{}are these 3 qubits in 111\char`\"{} and the answer is \char`\"{}no\char`\"{}. \end{DoxyCompactList}\item 
\hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} \hyperlink{qubits_8h_a909ba48b5a82c9f5c3a94d17a72b1aa3}{prob\+Of\+Filter\+Out111} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int id\+Qubit1, const int id\+Qubit2, const int id\+Qubit3)
\begin{DoxyCompactList}\small\item\em Evaluates the state according to this scenario\+: we ask \char`\"{}are these 3 qubits in 111\char`\"{} and the answer is \char`\"{}no\char`\"{}. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsubsection{Detailed Description}
The Qu\+E\+ST library A\+PI and objects. 



\subsubsection{Typedef Documentation}
\mbox{\Hypertarget{qubits_8h_ad59c9e471673c07782e6c403277ffd8d}\label{qubits_8h_ad59c9e471673c07782e6c403277ffd8d}} 
\index{qubits.\+h@{qubits.\+h}!Complex@{Complex}}
\index{Complex@{Complex}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{Complex}{Complex}}
{\footnotesize\ttfamily typedef struct \hyperlink{structComplex}{Complex}  \hyperlink{structComplex}{Complex}}



Represents one complex number. 

\mbox{\Hypertarget{qubits_8h_a19e00739fde70a851d068f322cf915c8}\label{qubits_8h_a19e00739fde70a851d068f322cf915c8}} 
\index{qubits.\+h@{qubits.\+h}!Complex\+Array@{Complex\+Array}}
\index{Complex\+Array@{Complex\+Array}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{Complex\+Array}{ComplexArray}}
{\footnotesize\ttfamily typedef struct \hyperlink{structComplexArray}{Complex\+Array}  \hyperlink{structComplexArray}{Complex\+Array}}



Represents an array of complex numbers grouped into an array of real components and an array of coressponding complex components. 

\mbox{\Hypertarget{qubits_8h_af4123a681074068eeeee1562758eef61}\label{qubits_8h_af4123a681074068eeeee1562758eef61}} 
\index{qubits.\+h@{qubits.\+h}!Multi\+Qubit@{Multi\+Qubit}}
\index{Multi\+Qubit@{Multi\+Qubit}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{Multi\+Qubit}{MultiQubit}}
{\footnotesize\ttfamily typedef struct \hyperlink{structMultiQubit}{Multi\+Qubit}  \hyperlink{structMultiQubit}{Multi\+Qubit}}



Represents a system of qubits. 

Qubits are zero-\/based and the the first qubit is the rightmost \mbox{\Hypertarget{qubits_8h_aedfe2bb713c31d6133e53b1bd72d7a2c}\label{qubits_8h_aedfe2bb713c31d6133e53b1bd72d7a2c}} 
\index{qubits.\+h@{qubits.\+h}!Qu\+E\+S\+T\+Env@{Qu\+E\+S\+T\+Env}}
\index{Qu\+E\+S\+T\+Env@{Qu\+E\+S\+T\+Env}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{Qu\+E\+S\+T\+Env}{QuESTEnv}}
{\footnotesize\ttfamily typedef struct \hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}  \hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}}



Information about the environment the program is running in. 

In practice, this holds info about M\+PI ranks and helps to hide M\+PI initialization code \mbox{\Hypertarget{qubits_8h_a6ded2cf071c127e518317e3c451af3ef}\label{qubits_8h_a6ded2cf071c127e518317e3c451af3ef}} 
\index{qubits.\+h@{qubits.\+h}!Vector@{Vector}}
\index{Vector@{Vector}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{Vector}{Vector}}
{\footnotesize\ttfamily typedef struct \hyperlink{structVector}{Vector}  \hyperlink{structVector}{Vector}}



\subsubsection{Enumeration Type Documentation}
\mbox{\Hypertarget{qubits_8h_a5739021c733cecc49647956b2f7338ea}\label{qubits_8h_a5739021c733cecc49647956b2f7338ea}} 
\index{qubits.\+h@{qubits.\+h}!phase\+Gate\+Type@{phase\+Gate\+Type}}
\index{phase\+Gate\+Type@{phase\+Gate\+Type}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{phase\+Gate\+Type}{phaseGateType}}
{\footnotesize\ttfamily enum \hyperlink{qubits_8h_a5739021c733cecc49647956b2f7338ea}{phase\+Gate\+Type}}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{S\+I\+G\+M\+A\+\_\+Z@{S\+I\+G\+M\+A\+\_\+Z}!qubits.\+h@{qubits.\+h}}\index{qubits.\+h@{qubits.\+h}!S\+I\+G\+M\+A\+\_\+Z@{S\+I\+G\+M\+A\+\_\+Z}}}\mbox{\Hypertarget{qubits_8h_a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac}\label{qubits_8h_a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac}} 
S\+I\+G\+M\+A\+\_\+Z&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{S\+\_\+\+G\+A\+TE@{S\+\_\+\+G\+A\+TE}!qubits.\+h@{qubits.\+h}}\index{qubits.\+h@{qubits.\+h}!S\+\_\+\+G\+A\+TE@{S\+\_\+\+G\+A\+TE}}}\mbox{\Hypertarget{qubits_8h_a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f}\label{qubits_8h_a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f}} 
S\+\_\+\+G\+A\+TE&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{T\+\_\+\+G\+A\+TE@{T\+\_\+\+G\+A\+TE}!qubits.\+h@{qubits.\+h}}\index{qubits.\+h@{qubits.\+h}!T\+\_\+\+G\+A\+TE@{T\+\_\+\+G\+A\+TE}}}\mbox{\Hypertarget{qubits_8h_a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab}\label{qubits_8h_a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab}} 
T\+\_\+\+G\+A\+TE&\\
\hline

\end{DoxyEnumFields}


Definition at line 60 of file qubits.\+h.


\begin{DoxyCode}
60 \{\hyperlink{qubits_8h_a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac}{SIGMA\_Z}=0, \hyperlink{qubits_8h_a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f}{S\_GATE}=1, \hyperlink{qubits_8h_a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab}{T\_GATE}=2\};
\end{DoxyCode}


\subsubsection{Function Documentation}
\mbox{\Hypertarget{qubits_8h_a818a4c7cd7252d2b10b896b12fa431d3}\label{qubits_8h_a818a4c7cd7252d2b10b896b12fa431d3}} 
\index{qubits.\+h@{qubits.\+h}!calc\+Total\+Probability@{calc\+Total\+Probability}}
\index{calc\+Total\+Probability@{calc\+Total\+Probability}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{calc\+Total\+Probability()}{calcTotalProbability()}}
{\footnotesize\ttfamily \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} calc\+Total\+Probability (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit }\end{DoxyParamCaption})}



Calculate the probability of being in any state by taking the norm of the entire state vector. 

Should be equal to 1. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em multi\+Qubit} & object representing a set of qubits \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
total probability 
\end{DoxyReturn}


Definition at line 47 of file qubits\+\_\+env\+\_\+local.\+c.



References chunk\+Is\+Upper(), D\+E\+B\+UG, Complex\+Array\+::imag, M\+P\+I\+\_\+\+Qu\+E\+S\+T\+\_\+\+R\+E\+AL, Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Chunks, Complex\+Array\+::real, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
47                                                 \{
48   \textcolor{comment}{/* IJB - implemented using Kahan summation for greater accuracy at a slight floating}
49 \textcolor{comment}{     point operation overhead. For more details see https://en.wikipedia.org/wiki/Kahan\_summation\_algorithm
       */}
50   \textcolor{comment}{/* Don't change the bracketing in this routine! */}
51   \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} pTotal=0; 
52   \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} y, t, c;
53   \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
54   \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numAmpsPerRank = multiQubit.\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps};
55   c = 0.0;
56   \textcolor{keywordflow}{for} (index=0; index<numAmpsPerRank; index++)\{ 
57     \textcolor{comment}{/* Perform pTotal+=multiQubit.stateVec.real[index]*multiQubit.stateVec.real[index]; by Kahan */}
58    \textcolor{comment}{// pTotal+=multiQubit.stateVec.real[index]*multiQubit.stateVec.real[index];}
59     
60     y = multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}[index]*multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.
      \hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}[index] - c;
61     t = pTotal + y;
62     c = ( t - pTotal ) - y;
63     pTotal = t;
64     
65     \textcolor{comment}{/* Perform pTotal+=multiQubit.stateVec.imag[index]*multiQubit.stateVec.imag[index]; by Kahan */}
66     \textcolor{comment}{//pTotal+=multiQubit.stateVec.imag[index]*multiQubit.stateVec.imag[index];}
67     
68     
69     y = multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}[index]*multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.
      \hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}[index] - c;
70     t = pTotal + y;
71     c = ( t - pTotal ) - y;
72     pTotal = t;
73     
74     
75   \} 
76   \textcolor{keywordflow}{return} pTotal;
77 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_abd4bc926cd3f9b65610bb228d0c59fe0}\label{qubits_8h_abd4bc926cd3f9b65610bb228d0c59fe0}} 
\index{qubits.\+h@{qubits.\+h}!close\+Qu\+E\+S\+T\+Env@{close\+Qu\+E\+S\+T\+Env}}
\index{close\+Qu\+E\+S\+T\+Env@{close\+Qu\+E\+S\+T\+Env}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{close\+Qu\+E\+S\+T\+Env()}{closeQuESTEnv()}}
{\footnotesize\ttfamily void close\+Qu\+E\+S\+T\+Env (\begin{DoxyParamCaption}\item[{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}}]{env }\end{DoxyParamCaption})}



Close Qu\+E\+ST environment. 

If something needs to be done to clean up the execution environment, such as finalizing M\+PI when running in distributed mode, it is handled here 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em env} & object representing the execution environment. A single instance is used for each program \\
\hline
\end{DoxyParams}


Definition at line 26 of file qubits\+\_\+env\+\_\+local.\+c.


\begin{DoxyCode}
26                                 \{
27         \textcolor{comment}{// MPI finalize goes here in MPI version. Call this function anyway for consistency}
28 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a4b3e91607bfbce06faf1d2e5dfcf2ea9}\label{qubits_8h_a4b3e91607bfbce06faf1d2e5dfcf2ea9}} 
\index{qubits.\+h@{qubits.\+h}!control\+Not@{control\+Not}}
\index{control\+Not@{control\+Not}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{control\+Not()}{controlNot()}}
{\footnotesize\ttfamily void control\+Not (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{const int}]{target\+Qubit,  }\item[{const int}]{control\+Qubit }\end{DoxyParamCaption})}



Rotate a single qubit by \{\{0,-\/i\},\{i,0\}\} -- swap $\vert$0$>$ and $\vert$1$>$ and apply a phase of -\/i or i, only for elements when control qubit is 1. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em rot\+Qubit} & qubit to rotate \\
\hline
\mbox{\tt in}  & {\em control\+Qubit} & perform sigmaX rotation if this qubit is 1 \\
\hline
\end{DoxyParams}


Definition at line 118 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, chunk\+Is\+Upper(), control\+Not\+Distributed(), control\+Not\+Local(), exchange\+State\+Vectors(), get\+Chunk\+Pair\+Id(), half\+Matrix\+Block\+Fits\+In\+Chunk(), Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::pair\+State\+Vec, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
119 \{
120         \hyperlink{qubits_8c_a2901e2e5531cb77f87ea54b3fc28f51a}{controlNotLocal}(multiQubit, targetQubit, controlQubit);
121 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a0ad4584e44f567c140b653ed36d26ccf}\label{qubits_8h_a0ad4584e44f567c140b653ed36d26ccf}} 
\index{qubits.\+h@{qubits.\+h}!control\+Phase\+Gate@{control\+Phase\+Gate}}
\index{control\+Phase\+Gate@{control\+Phase\+Gate}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{control\+Phase\+Gate()}{controlPhaseGate()}}
{\footnotesize\ttfamily void control\+Phase\+Gate (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{const int}]{id\+Qubit1,  }\item[{const int}]{id\+Qubit2 }\end{DoxyParamCaption})}



The control phase (the two qubit phase gate). 

For each state, if both input qubits are equal to one, multiply the amplitude of that state by -\/1. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em id\+Qubit1,id\+Qubit2} & specified qubits \\
\hline
\end{DoxyParams}


Definition at line 1461 of file qubits.\+c.



References Multi\+Qubit\+::chunk\+Id, extract\+Bit(), Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Qubits, Complex\+Array\+::real, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
1462 \{
1463         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
1464         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} stateVecSize;
1465         \textcolor{keywordtype}{int} bit1, bit2;
1466 
1467         \textcolor{comment}{// ---------------------------------------------------------------- //}
1468         \textcolor{comment}{//            tests                                                 //}
1469         \textcolor{comment}{// ---------------------------------------------------------------- //}
1470 
1471         assert (idQubit1 >= 0 && idQubit2 >= 0 && idQubit1 < multiQubit.
      \hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits} && idQubit2 < multiQubit.\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits});
1472 
1473         \textcolor{keyword}{const} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} chunkSize=multiQubit.\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps};
1474         \textcolor{keyword}{const} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} chunkId=multiQubit.\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId};
1475 
1476         \textcolor{comment}{// ---------------------------------------------------------------- //}
1477         \textcolor{comment}{//            initialise the state to |0000..0>                     //}
1478         \textcolor{comment}{// ---------------------------------------------------------------- //}
1479 
1480         \textcolor{comment}{// dimension of the state vector}
1481         stateVecSize = multiQubit.\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps};
1482         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} *stateVecReal = multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real};
1483         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} *stateVecImag = multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag};
1484 
1485 \textcolor{preprocessor}{# ifdef \_OPENMP}
1486 \textcolor{preprocessor}{# pragma omp parallel for \(\backslash\)}
1487 \textcolor{preprocessor}{        default  (none)                      \(\backslash\)}
1488 \textcolor{preprocessor}{        shared   (stateVecSize, stateVecReal,stateVecImag ) \(\backslash\)}
1489 \textcolor{preprocessor}{        private  (index,bit1,bit2)                     \(\backslash\)}
1490 \textcolor{preprocessor}{        schedule (static)}
1491 \textcolor{preprocessor}{# endif}
1492         \textcolor{keywordflow}{for} (index=0; index<stateVecSize; index++) \{
1493                 bit1 = \hyperlink{qubits_8c_a100463f6ec212c76a5fad99579000505}{extractBit} (idQubit1, index+chunkId*chunkSize);
1494                 bit2 = \hyperlink{qubits_8c_a100463f6ec212c76a5fad99579000505}{extractBit} (idQubit2, index+chunkId*chunkSize);
1495                 \textcolor{keywordflow}{if} (bit1 && bit2) \{
1496                         stateVecReal [index] = - stateVecReal [index];
1497                         stateVecImag [index] = - stateVecImag [index];
1498                 \}
1499         \}
1500 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_abac5189a14bc12e79580ba0d75de796e}\label{qubits_8h_abac5189a14bc12e79580ba0d75de796e}} 
\index{qubits.\+h@{qubits.\+h}!control\+Rotate\+Qubit@{control\+Rotate\+Qubit}}
\index{control\+Rotate\+Qubit@{control\+Rotate\+Qubit}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{control\+Rotate\+Qubit()}{controlRotateQubit()}}
{\footnotesize\ttfamily void control\+Rotate\+Qubit (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{const int}]{rot\+Qubit,  }\item[{const int}]{control\+Qubit,  }\item[{\hyperlink{structComplex}{Complex}}]{alpha,  }\item[{\hyperlink{structComplex}{Complex}}]{beta }\end{DoxyParamCaption})}



Rotate a single qubit in the state vector of probability amplitudes. 

Given two complex numbers alpha and beta and a control qubit, applies the operation\+: ~\newline
\mbox{[}alpha, -\/beta$\ast$ ~\newline
 beta, alpha$\ast$\mbox{]} ~\newline
Only when the control qubit is one.

\begin{DoxyRemark}{Remarks}
Qubits are zero-\/based and the the first qubit is the rightmost
\end{DoxyRemark}
alpha, beta must obey $\vert$alpha$\vert$$^\wedge$2 + $\vert$beta$\vert$$^\wedge$2 = 1


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em rot\+Qubit} & qubit to rotate \\
\hline
\mbox{\tt in}  & {\em control\+Qubit} & perform rotation if this qubit is 1 \\
\hline
\mbox{\tt in}  & {\em alpha} & rotation angle \\
\hline
\mbox{\tt in}  & {\em beta} & rotation angle \\
\hline
\end{DoxyParams}


Definition at line 93 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, chunk\+Is\+Upper(), control\+Rotate\+Qubit\+Distributed(), control\+Rotate\+Qubit\+Local(), exchange\+State\+Vectors(), get\+Chunk\+Pair\+Id(), get\+Rot\+Angle(), half\+Matrix\+Block\+Fits\+In\+Chunk(), Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::pair\+State\+Vec, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
94 \{
95         \hyperlink{qubits_8c_a824d71bae93236d8a3cd43589044eaee}{controlRotateQubitLocal}(multiQubit, rotQubit, controlQubit, alpha, beta);
96 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a9c02591bc64c2918503afa231d90d83f}\label{qubits_8h_a9c02591bc64c2918503afa231d90d83f}} 
\index{qubits.\+h@{qubits.\+h}!create\+Multi\+Qubit@{create\+Multi\+Qubit}}
\index{create\+Multi\+Qubit@{create\+Multi\+Qubit}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{create\+Multi\+Qubit()}{createMultiQubit()}}
{\footnotesize\ttfamily void create\+Multi\+Qubit (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit} $\ast$}]{multi\+Qubit,  }\item[{int}]{num\+Qubits,  }\item[{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}}]{env }\end{DoxyParamCaption})}



Create a \hyperlink{structMultiQubit}{Multi\+Qubit} object representing a set of qubits. 

Allocate space for state vector of probability amplitudes, including space for temporary values to be copied from one other chunk if running the distributed version. Define properties related to the size of the set of qubits. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em num\+Qubits} & number of qubits in the system \\
\hline
\mbox{\tt in}  & {\em env} & object representing the execution environment (local, multinode etc) \\
\hline
\end{DoxyParams}


Definition at line 28 of file qubits.\+c.



References Multi\+Qubit\+::chunk\+Id, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Chunks, Multi\+Qubit\+::num\+Qubits, Qu\+E\+S\+T\+Env\+::num\+Ranks, Multi\+Qubit\+::pair\+State\+Vec, Qu\+E\+S\+T\+Env\+::rank, Complex\+Array\+::real, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
29 \{
30         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numAmps = 1L << numQubits;
31         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numAmpsPerRank = numAmps/env.\hyperlink{structQuESTEnv_af22aacd7c9905accae28484785c193b4}{numRanks};
32 
33         multiQubit->\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real} = malloc(numAmpsPerRank * \textcolor{keyword}{sizeof}(*(multiQubit->
      \hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real})));
34         multiQubit->\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag} = malloc(numAmpsPerRank * \textcolor{keyword}{sizeof}(*(multiQubit->
      \hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag})));
35         \textcolor{keywordflow}{if} (env.\hyperlink{structQuESTEnv_af22aacd7c9905accae28484785c193b4}{numRanks}>1)\{
36                 multiQubit->\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real} = malloc(numAmpsPerRank * \textcolor{keyword}{sizeof}(*(multiQubit
      ->\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real})));
37                 multiQubit->\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag} = malloc(numAmpsPerRank * \textcolor{keyword}{sizeof}(*(multiQubit
      ->\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag})));
38         \}
39 
40         \textcolor{keywordflow}{if} ( (!(multiQubit->\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}) || !(multiQubit->\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.
      \hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}))
41                  && numAmpsPerRank ) \{
42                 printf(\textcolor{stringliteral}{"Could not allocate memory!"});
43                 exit (EXIT\_FAILURE);
44         \}
45 
46         \textcolor{keywordflow}{if} ( env.\hyperlink{structQuESTEnv_af22aacd7c9905accae28484785c193b4}{numRanks}>1 && (!(multiQubit->\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}.
      \hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}) || !(multiQubit->\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}))
47                  && numAmpsPerRank ) \{
48                 printf(\textcolor{stringliteral}{"Could not allocate memory!"});
49                 exit (EXIT\_FAILURE);
50         \}
51 
52         multiQubit->\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits} = numQubits;
53         multiQubit->\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps} = numAmpsPerRank;
54         multiQubit->\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId} = env.\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank};
55         multiQubit->\hyperlink{structMultiQubit_acd43f2f57991709c9e94f73662c972b2}{numChunks} = env.\hyperlink{structQuESTEnv_af22aacd7c9905accae28484785c193b4}{numRanks};
56 
57 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_ae5d6acc322314d7a3d8a2eccf00d3b19}\label{qubits_8h_ae5d6acc322314d7a3d8a2eccf00d3b19}} 
\index{qubits.\+h@{qubits.\+h}!destroy\+Multi\+Qubit@{destroy\+Multi\+Qubit}}
\index{destroy\+Multi\+Qubit@{destroy\+Multi\+Qubit}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{destroy\+Multi\+Qubit()}{destroyMultiQubit()}}
{\footnotesize\ttfamily void destroy\+Multi\+Qubit (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}}]{env }\end{DoxyParamCaption})}



Deallocate a \hyperlink{structMultiQubit}{Multi\+Qubit} object representing a set of qubits Free memory allocated to state vector of probability amplitudes, including temporary vector for values copied from another chunk if running the distributed version. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object to be deallocated \\
\hline
\mbox{\tt in}  & {\em env} & object representing the execution environment (local, multinode etc) \\
\hline
\end{DoxyParams}


Definition at line 64 of file qubits.\+c.



References Complex\+Array\+::imag, Qu\+E\+S\+T\+Env\+::num\+Ranks, Multi\+Qubit\+::pair\+State\+Vec, Complex\+Array\+::real, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
64                                                            \{
65         free(multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real});
66         free(multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag});
67         \textcolor{keywordflow}{if} (env.\hyperlink{structQuESTEnv_af22aacd7c9905accae28484785c193b4}{numRanks}>1)\{
68                 free(multiQubit.\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real});
69                 free(multiQubit.\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag});
70         \}
71 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_ae8fcabd3f22c6c9a9104e1807fb78f80}\label{qubits_8h_ae8fcabd3f22c6c9a9104e1807fb78f80}} 
\index{qubits.\+h@{qubits.\+h}!filter\+Out111@{filter\+Out111}}
\index{filter\+Out111@{filter\+Out111}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{filter\+Out111()}{filterOut111()}}
{\footnotesize\ttfamily \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} filter\+Out111 (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{const int}]{id\+Qubit1,  }\item[{const int}]{id\+Qubit2,  }\item[{const int}]{id\+Qubit3 }\end{DoxyParamCaption})}



Updates the state according to this scenario\+: we ask \char`\"{}are these 3 qubits in 111\char`\"{} and the answer is \char`\"{}no\char`\"{}. 

The function returns the probability of this outcome (if zero, it will exit with error) 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em id\+Qubit1,id\+Qubit2,id\+Qubit3} & specified qubits \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Total probability that the 3 qubits are not all in the 1 state. 
\end{DoxyReturn}


Definition at line 139 of file qubits\+\_\+env\+\_\+local.\+c.



References filter\+Out111\+Local(), prob\+Of\+Filter\+Out111(), and R\+E\+AL.


\begin{DoxyCode}
140 \{
141         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} stateProb=0;
142         stateProb = \hyperlink{qubits__env__local_8c_a909ba48b5a82c9f5c3a94d17a72b1aa3}{probOfFilterOut111}(multiQubit, idQubit1, idQubit2, idQubit3);
143         \textcolor{keywordflow}{if} (stateProb!=0) \hyperlink{qubits_8c_a2d73fd11c1d154640dbf114da8f34c64}{filterOut111Local}(multiQubit, idQubit1, idQubit2, idQubit3, 
      stateProb);
144         \textcolor{keywordflow}{return} stateProb;
145 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_ad315c941a51bc053d39ebfa2040fd32e}\label{qubits_8h_ad315c941a51bc053d39ebfa2040fd32e}} 
\index{qubits.\+h@{qubits.\+h}!find\+Probability\+Of\+Outcome@{find\+Probability\+Of\+Outcome}}
\index{find\+Probability\+Of\+Outcome@{find\+Probability\+Of\+Outcome}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{find\+Probability\+Of\+Outcome()}{findProbabilityOfOutcome()}}
{\footnotesize\ttfamily \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} find\+Probability\+Of\+Outcome (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{const int}]{measure\+Qubit,  }\item[{int}]{outcome }\end{DoxyParamCaption})}



Measure the probability of a specified qubit being in the zero or one state. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em measure\+Qubit} & qubit to measure \\
\hline
\mbox{\tt in}  & {\em outcome} & to measure the probability of -- either zero or one \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
probability of qubit measure\+Qubit being either zero or one 
\end{DoxyReturn}


Definition at line 123 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, find\+Probability\+Of\+Zero\+Distributed(), find\+Probability\+Of\+Zero\+Local(), half\+Matrix\+Block\+Fits\+In\+Chunk(), is\+Chunk\+To\+Skip\+In\+Find\+P\+Zero(), M\+P\+I\+\_\+\+Qu\+E\+S\+T\+\_\+\+R\+E\+AL, Multi\+Qubit\+::num\+Amps, and R\+E\+AL.



Referenced by measure\+In\+State().


\begin{DoxyCode}
124 \{
125         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} stateProb=0;
126         stateProb = \hyperlink{qubits_8c_a7c02cd0e1b4eac19771a0525f023249e}{findProbabilityOfZeroLocal}(multiQubit, measureQubit);
127         \textcolor{keywordflow}{if} (outcome==1) stateProb = 1.0 - stateProb;
128         \textcolor{keywordflow}{return} stateProb;
129 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a8f10aabf9f607f19093aee54630caa21}\label{qubits_8h_a8f10aabf9f607f19093aee54630caa21}} 
\index{qubits.\+h@{qubits.\+h}!get\+Environment\+String@{get\+Environment\+String}}
\index{get\+Environment\+String@{get\+Environment\+String}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{get\+Environment\+String()}{getEnvironmentString()}}
{\footnotesize\ttfamily void get\+Environment\+String (\begin{DoxyParamCaption}\item[{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}}]{env,  }\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{char}]{str\mbox{[}200\mbox{]} }\end{DoxyParamCaption})}



Definition at line 150 of file qubits.\+c.



References Multi\+Qubit\+::num\+Qubits, and Qu\+E\+S\+T\+Env\+::num\+Ranks.


\begin{DoxyCode}
150                                                                              \{
151         \textcolor{keywordtype}{int} numThreads=1;
152 \textcolor{preprocessor}{# ifdef \_OPENMP}
153         numThreads=omp\_get\_max\_threads(); 
154 \textcolor{preprocessor}{# endif}
155         sprintf(str, \textcolor{stringliteral}{"%dqubits\_CPU\_%dranksx%dthreads"}, multiQubit.\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}, env.
      \hyperlink{structQuESTEnv_af22aacd7c9905accae28484785c193b4}{numRanks}, numThreads);
156 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a3615f76fd5f57008d9b74bbd10533dd0}\label{qubits_8h_a3615f76fd5f57008d9b74bbd10533dd0}} 
\index{qubits.\+h@{qubits.\+h}!get\+Imag\+Amp\+El@{get\+Imag\+Amp\+El}}
\index{get\+Imag\+Amp\+El@{get\+Imag\+Amp\+El}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{get\+Imag\+Amp\+El()}{getImagAmpEl()}}
{\footnotesize\ttfamily \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} get\+Imag\+Amp\+El (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{long long int}]{index }\end{DoxyParamCaption})}



Get the imaginary component of the probability amplitude at an index in the state vector. 

For debugging purposes. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em multi\+Qubit} & object representing a set of qubits \\
\hline
\mbox{\tt in}  & {\em index} & index in state vector of probability amplitudes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
imaginary component at that index 
\end{DoxyReturn}


Definition at line 83 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, get\+Chunk\+Id\+From\+Index(), Complex\+Array\+::imag, M\+P\+I\+\_\+\+Qu\+E\+S\+T\+\_\+\+R\+E\+AL, Multi\+Qubit\+::num\+Amps, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.



Referenced by get\+Prob\+El().


\begin{DoxyCode}
83                                                              \{
84         \textcolor{keywordflow}{return} multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}[index];
85 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a799b10447d6dbdaf960a4d3eedd22014}\label{qubits_8h_a799b10447d6dbdaf960a4d3eedd22014}} 
\index{qubits.\+h@{qubits.\+h}!get\+Prob\+El@{get\+Prob\+El}}
\index{get\+Prob\+El@{get\+Prob\+El}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{get\+Prob\+El()}{getProbEl()}}
{\footnotesize\ttfamily \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} get\+Prob\+El (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{long long int}]{index }\end{DoxyParamCaption})}



Get the probability of the state at an index in the state vector. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em multi\+Qubit} & object representing a set of qubits \\
\hline
\mbox{\tt in}  & {\em index} & index in state vector of probability amplitudes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
real\+El$\ast$real\+El + imag\+El$\ast$imag\+El
\end{DoxyReturn}
Get the probability of the state at an index in the state vector.

For debugging purposes. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em multi\+Qubit} & object representing a set of qubits \\
\hline
\mbox{\tt in}  & {\em index} & index in state vector of probability amplitudes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
real component $\ast$ real component + imag component $\ast$ imag component 
\end{DoxyReturn}


Definition at line 1887 of file qubits.\+c.



References get\+Imag\+Amp\+El(), get\+Real\+Amp\+El(), and R\+E\+AL.


\begin{DoxyCode}
1887                                                           \{
1888         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} real;
1889         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} imag;
1890         real = \hyperlink{qubits_8h_a317b786f577fa6bc136ea7f0ee7330a7}{getRealAmpEl}(multiQubit, index);
1891         imag = \hyperlink{qubits_8h_a3615f76fd5f57008d9b74bbd10533dd0}{getImagAmpEl}(multiQubit, index);
1892         \textcolor{keywordflow}{return} real*real + imag*imag;
1893 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a317b786f577fa6bc136ea7f0ee7330a7}\label{qubits_8h_a317b786f577fa6bc136ea7f0ee7330a7}} 
\index{qubits.\+h@{qubits.\+h}!get\+Real\+Amp\+El@{get\+Real\+Amp\+El}}
\index{get\+Real\+Amp\+El@{get\+Real\+Amp\+El}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{get\+Real\+Amp\+El()}{getRealAmpEl()}}
{\footnotesize\ttfamily \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} get\+Real\+Amp\+El (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{long long int}]{index }\end{DoxyParamCaption})}



Get the real component of the probability amplitude at an index in the state vector. 

For debugging purposes. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em multi\+Qubit} & object representing a set of qubits \\
\hline
\mbox{\tt in}  & {\em index} & index in state vector of probability amplitudes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
real component at that index 
\end{DoxyReturn}


Definition at line 79 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, get\+Chunk\+Id\+From\+Index(), M\+P\+I\+\_\+\+Qu\+E\+S\+T\+\_\+\+R\+E\+AL, Multi\+Qubit\+::num\+Amps, Complex\+Array\+::real, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.



Referenced by get\+Prob\+El().


\begin{DoxyCode}
79                                                              \{
80         \textcolor{keywordflow}{return} multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}[index];
81 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_ad247d084dc7150893e9051a438a5807e}\label{qubits_8h_ad247d084dc7150893e9051a438a5807e}} 
\index{qubits.\+h@{qubits.\+h}!hadamard@{hadamard}}
\index{hadamard@{hadamard}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{hadamard()}{hadamard()}}
{\footnotesize\ttfamily void hadamard (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{const int}]{rot\+Qubit }\end{DoxyParamCaption})}



Rotate a single qubit by \{\{1,1\},\{1,-\/1\}\}/sqrt2 -- turn a $\vert$0$>$ into a $\vert$+$>$ and a $\vert$1$>$ into a $\vert$-\/$>$. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em rot\+Qubit} & qubit to rotate \\
\hline
\end{DoxyParams}


Definition at line 113 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, chunk\+Is\+Upper(), exchange\+State\+Vectors(), get\+Chunk\+Pair\+Id(), hadamard\+Distributed(), hadamard\+Local(), half\+Matrix\+Block\+Fits\+In\+Chunk(), Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::pair\+State\+Vec, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
114 \{
115         \hyperlink{qubits_8c_a0711416fceaf63c67b496e123e845c69}{hadamardLocal}(multiQubit, rotQubit);
116 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_ad84a3ce68d1ca02b4e3f741ea45b6054}\label{qubits_8h_ad84a3ce68d1ca02b4e3f741ea45b6054}} 
\index{qubits.\+h@{qubits.\+h}!init\+Qu\+E\+S\+T\+Env@{init\+Qu\+E\+S\+T\+Env}}
\index{init\+Qu\+E\+S\+T\+Env@{init\+Qu\+E\+S\+T\+Env}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{init\+Qu\+E\+S\+T\+Env()}{initQuESTEnv()}}
{\footnotesize\ttfamily void init\+Qu\+E\+S\+T\+Env (\begin{DoxyParamCaption}\item[{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env} $\ast$}]{env }\end{DoxyParamCaption})}



Initialize Qu\+E\+ST environment. 

If something needs to be done to set up the execution environment, such as initializing M\+PI when running in distributed mode, it is handled here 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em env} & object representing the execution environment. A single instance is used for each program \\
\hline
\end{DoxyParams}


Definition at line 12 of file qubits\+\_\+env\+\_\+local.\+c.



References D\+E\+B\+UG, Qu\+E\+S\+T\+Env\+::num\+Ranks, and Qu\+E\+S\+T\+Env\+::rank.


\begin{DoxyCode}
12                                 \{
13         \textcolor{comment}{// init MPI environment}
14         env->\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank}=0;
15         env->\hyperlink{structQuESTEnv_af22aacd7c9905accae28484785c193b4}{numRanks}=1;
16 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a43bcb279fc9717fbd06a19cdef48b9d8}\label{qubits_8h_a43bcb279fc9717fbd06a19cdef48b9d8}} 
\index{qubits.\+h@{qubits.\+h}!init\+State\+Plus@{init\+State\+Plus}}
\index{init\+State\+Plus@{init\+State\+Plus}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{init\+State\+Plus()}{initStatePlus()}}
{\footnotesize\ttfamily void init\+State\+Plus (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit} $\ast$}]{multi\+Qubit }\end{DoxyParamCaption})}



Initialise the state vector of probability amplitudes for a set of qubits to an equal real superposition of all amplitudes\+: $\vert$+++...++$>$ 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits to be initialised \\
\hline
\end{DoxyParams}


Definition at line 204 of file qubits.\+c.



References D\+E\+B\+UG, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Chunks, Complex\+Array\+::real, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
205 \{
206         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} chunkSize, stateVecSize;
207         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
208 
209         \textcolor{comment}{// dimension of the state vector}
210         chunkSize = multiQubit->\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps};
211         stateVecSize = chunkSize*multiQubit->\hyperlink{structMultiQubit_acd43f2f57991709c9e94f73662c972b2}{numChunks};
212         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} normFactor = 1.0/sqrt(stateVecSize);
213 
214         \textcolor{comment}{// Can't use multiQubit->stateVec as a private OMP var}
215         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} *stateVecReal = multiQubit->\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real};
216         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} *stateVecImag = multiQubit->\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag};
217 
218         \textcolor{comment}{// initialise the state to |0000..0000>}
219 \textcolor{preprocessor}{# ifdef \_OPENMP}
220 \textcolor{preprocessor}{# pragma omp parallel \(\backslash\)}
221 \textcolor{preprocessor}{        default  (none) \(\backslash\)}
222 \textcolor{preprocessor}{        shared   (chunkSize, stateVecReal, stateVecImag, normFactor) \(\backslash\)}
223 \textcolor{preprocessor}{        private  (index) }
224 \textcolor{preprocessor}{# endif}
225         \{
226 \textcolor{preprocessor}{# ifdef \_OPENMP}
227 \textcolor{preprocessor}{                # pragma omp for schedule (static)}
228 \textcolor{preprocessor}{# endif}
229                 \textcolor{keywordflow}{for} (index=0; index<chunkSize; index++) \{
230                         stateVecReal[index] = normFactor;
231                         stateVecImag[index] = 0.0;
232                 \}
233         \}
234         \textcolor{keywordflow}{if} (\hyperlink{qubits_8c_ad72dbcf6d0153db1b8d8a58001feed83}{DEBUG}) printf(\textcolor{stringliteral}{"COMPLETED INIT\(\backslash\)n"});
235 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_acb5b2eff794339090004d29f02a70d9a}\label{qubits_8h_acb5b2eff794339090004d29f02a70d9a}} 
\index{qubits.\+h@{qubits.\+h}!init\+State\+Zero@{init\+State\+Zero}}
\index{init\+State\+Zero@{init\+State\+Zero}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{init\+State\+Zero()}{initStateZero()}}
{\footnotesize\ttfamily void init\+State\+Zero (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit} $\ast$}]{multi\+Qubit }\end{DoxyParamCaption})}



Initialise the state vector of probability amplitudes for a set of qubits to the zero state\+: $\vert$000...00$>$ 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits to be initialised \\
\hline
\end{DoxyParams}


Definition at line 162 of file qubits.\+c.



References Multi\+Qubit\+::chunk\+Id, D\+E\+B\+UG, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps, Complex\+Array\+::real, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
163 \{
164         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} stateVecSize;
165         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
166 
167         \textcolor{comment}{// dimension of the state vector}
168         stateVecSize = multiQubit->\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps};
169 
170         \textcolor{comment}{// Can't use multiQubit->stateVec as a private OMP var}
171         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} *stateVecReal = multiQubit->\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real};
172         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} *stateVecImag = multiQubit->\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag};
173 
174         \textcolor{comment}{// initialise the state to |0000..0000>}
175 \textcolor{preprocessor}{# ifdef \_OPENMP}
176 \textcolor{preprocessor}{# pragma omp parallel \(\backslash\)}
177 \textcolor{preprocessor}{        default  (none) \(\backslash\)}
178 \textcolor{preprocessor}{        shared   (stateVecSize, stateVecReal, stateVecImag) \(\backslash\)}
179 \textcolor{preprocessor}{        private  (index) }
180 \textcolor{preprocessor}{# endif}
181         \{
182 \textcolor{preprocessor}{# ifdef \_OPENMP}
183 \textcolor{preprocessor}{                # pragma omp for schedule (static)}
184 \textcolor{preprocessor}{# endif}
185                 \textcolor{keywordflow}{for} (index=0; index<stateVecSize; index++) \{
186                         stateVecReal[index] = 0.0;
187                         stateVecImag[index] = 0.0;
188                 \}
189         \}
190 
191         \textcolor{keywordflow}{if} (multiQubit->\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId}==0)\{
192                 \textcolor{comment}{// zero state |0000..0000> has probability 1}
193                 stateVecReal[0] = 1.0;
194                 stateVecImag[0] = 0.0;
195         \}
196 
197         \textcolor{keywordflow}{if} (\hyperlink{qubits_8c_ad72dbcf6d0153db1b8d8a58001feed83}{DEBUG}) printf(\textcolor{stringliteral}{"COMPLETED INIT\(\backslash\)n"});
198 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a88605f373c2401760aab0e08719e08dd}\label{qubits_8h_a88605f373c2401760aab0e08719e08dd}} 
\index{qubits.\+h@{qubits.\+h}!measure\+In\+State@{measure\+In\+State}}
\index{measure\+In\+State@{measure\+In\+State}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{measure\+In\+State()}{measureInState()}}
{\footnotesize\ttfamily \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} measure\+In\+State (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{const int}]{measure\+Qubit,  }\item[{int}]{outcome }\end{DoxyParamCaption})}



Update the state vector to be consistent with measuring measure\+Qubit=0 or measure\+Qubit=1 according to the value of outcome. 

Measure in Zero performs an irreversible change to the state vector\+: it updates the vector according to the event that an outcome has been measured on the qubit indicated by measure\+Qubit (where his label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measure\+Qubit=0 if outcome=0 or measure\+Qubit=1 if outcome=1. It then returns the probability of making this measurement.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em measure\+Qubit} & qubit to measure \\
\hline
\mbox{\tt in}  & {\em outcome} & to measure the probability of and set the state to -- either zero or one \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
probability of qubit measure\+Qubit being either zero or one 
\end{DoxyReturn}


Definition at line 131 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, find\+Probability\+Of\+Outcome(), half\+Matrix\+Block\+Fits\+In\+Chunk(), is\+Chunk\+To\+Skip\+In\+Find\+P\+Zero(), measure\+In\+State\+Distributed\+Renorm(), measure\+In\+State\+Distributed\+Set\+Zero(), measure\+In\+State\+Local(), Multi\+Qubit\+::num\+Amps, and R\+E\+AL.


\begin{DoxyCode}
132 \{
133         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} stateProb;
134         stateProb = \hyperlink{qubits__env__local_8c_ad315c941a51bc053d39ebfa2040fd32e}{findProbabilityOfOutcome}(multiQubit, measureQubit, outcome);
135         \textcolor{keywordflow}{if} (stateProb!=0) \hyperlink{qubits_8c_a53614ce19e0a4f2c41b400cf05dc5bd1}{measureInStateLocal}(multiQubit, measureQubit, stateProb, 
      outcome);
136         \textcolor{keywordflow}{return} stateProb;
137 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a909ba48b5a82c9f5c3a94d17a72b1aa3}\label{qubits_8h_a909ba48b5a82c9f5c3a94d17a72b1aa3}} 
\index{qubits.\+h@{qubits.\+h}!prob\+Of\+Filter\+Out111@{prob\+Of\+Filter\+Out111}}
\index{prob\+Of\+Filter\+Out111@{prob\+Of\+Filter\+Out111}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{prob\+Of\+Filter\+Out111()}{probOfFilterOut111()}}
{\footnotesize\ttfamily \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} prob\+Of\+Filter\+Out111 (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{const int}]{id\+Qubit1,  }\item[{const int}]{id\+Qubit2,  }\item[{const int}]{id\+Qubit3 }\end{DoxyParamCaption})}



Evaluates the state according to this scenario\+: we ask \char`\"{}are these 3 qubits in 111\char`\"{} and the answer is \char`\"{}no\char`\"{}. 

The function returns the probability of this outcome (if zero, it will exit with error) 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em id\+Qubit1,id\+Qubit2,id\+Qubit3} & specified qubits \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Total probability that the 3 qubits are not all in the 1 state. 
\end{DoxyReturn}


Definition at line 147 of file qubits\+\_\+env\+\_\+local.\+c.



References M\+P\+I\+\_\+\+Qu\+E\+S\+T\+\_\+\+R\+E\+AL, prob\+Of\+Filter\+Out111\+Local(), and R\+E\+AL.



Referenced by filter\+Out111().


\begin{DoxyCode}
148 \{
149         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} stateProb=0;
150         stateProb = \hyperlink{qubits_8c_a096cddbac961f0651a084d2ceb905d1b}{probOfFilterOut111Local}(multiQubit, idQubit1, idQubit2, idQubit3
      );
151         \textcolor{keywordflow}{return} stateProb;
152 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_aca7765bd500718f98700a172351748cc}\label{qubits_8h_aca7765bd500718f98700a172351748cc}} 
\index{qubits.\+h@{qubits.\+h}!quad\+C\+Phase\+Gate@{quad\+C\+Phase\+Gate}}
\index{quad\+C\+Phase\+Gate@{quad\+C\+Phase\+Gate}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{quad\+C\+Phase\+Gate()}{quadCPhaseGate()}}
{\footnotesize\ttfamily void quad\+C\+Phase\+Gate (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{const int}]{id\+Qubit1,  }\item[{const int}]{id\+Qubit2,  }\item[{const int}]{id\+Qubit3,  }\item[{const int}]{id\+Qubit4 }\end{DoxyParamCaption})}



The control not gate. 

The control phase (the four qubit phase gate). For each state, if all four input qubits are equal to one, multiply the amplitude of that state by -\/1. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em id\+Qubit1,id\+Qubit2,id\+Qubit3,id\+Qubit4} & specified qubits \\
\hline
\end{DoxyParams}


Definition at line 1550 of file qubits.\+c.



References Multi\+Qubit\+::chunk\+Id, extract\+Bit(), Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Qubits, Complex\+Array\+::real, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
1552 \{
1553         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
1554         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} stateVecSize;
1555         \textcolor{keywordtype}{int} bit1, bit2, bit3, bit4;
1556         
1557         \textcolor{keyword}{const} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} chunkSize=multiQubit.\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps};
1558         \textcolor{keyword}{const} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} chunkId=multiQubit.\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId};
1559 
1560         \textcolor{comment}{// ---------------------------------------------------------------- //}
1561         \textcolor{comment}{//            tests                                                 //}
1562         \textcolor{comment}{// ---------------------------------------------------------------- //}
1563         assert (idQubit1 >= 0 && idQubit2 >= 0 && idQubit1 < multiQubit.
      \hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits} && idQubit2 < multiQubit.\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits});
1564 
1565         stateVecSize = multiQubit.\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps};
1566         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} *stateVecReal = multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real};
1567         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} *stateVecImag = multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag};
1568 
1569 \textcolor{preprocessor}{# ifdef \_OPENMP}
1570 \textcolor{preprocessor}{# pragma omp parallel \(\backslash\)}
1571 \textcolor{preprocessor}{        default  (none)                      \(\backslash\)}
1572 \textcolor{preprocessor}{        shared   (stateVecSize, stateVecReal,stateVecImag ) \(\backslash\)}
1573 \textcolor{preprocessor}{        private  (index,bit1,bit2,bit3,bit4)}
1574 \textcolor{preprocessor}{# endif}
1575         \{
1576 \textcolor{preprocessor}{# ifdef \_OPENMP}
1577 \textcolor{preprocessor}{                # pragma omp for schedule (static)}
1578 \textcolor{preprocessor}{# endif}
1579                 \textcolor{keywordflow}{for} (index=0; index<stateVecSize; index++) \{
1580                         bit1 = \hyperlink{qubits_8c_a100463f6ec212c76a5fad99579000505}{extractBit} (idQubit1, index+chunkId*chunkSize);
1581                         bit2 = \hyperlink{qubits_8c_a100463f6ec212c76a5fad99579000505}{extractBit} (idQubit2, index+chunkId*chunkSize);
1582                         bit3 = \hyperlink{qubits_8c_a100463f6ec212c76a5fad99579000505}{extractBit} (idQubit3, index+chunkId*chunkSize);
1583                         bit4 = \hyperlink{qubits_8c_a100463f6ec212c76a5fad99579000505}{extractBit} (idQubit4, index+chunkId*chunkSize);
1584                         \textcolor{keywordflow}{if} (bit1 && bit2 && bit3 && bit4) \{
1585                                 stateVecReal [index] = - stateVecReal [index];
1586                                 stateVecImag [index] = - stateVecImag [index];
1587                         \}
1588                 \}
1589         \}
1590 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_aa5e77e0e64f3a4a3d3f5cc7382bffcd9}\label{qubits_8h_aa5e77e0e64f3a4a3d3f5cc7382bffcd9}} 
\index{qubits.\+h@{qubits.\+h}!report\+Multi\+Qubit\+Params@{report\+Multi\+Qubit\+Params}}
\index{report\+Multi\+Qubit\+Params@{report\+Multi\+Qubit\+Params}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{report\+Multi\+Qubit\+Params()}{reportMultiQubitParams()}}
{\footnotesize\ttfamily void report\+Multi\+Qubit\+Params (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit }\end{DoxyParamCaption})}



Report metainformation about a set of qubits\+: number of qubits, number of probability amplitudes. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em env} & object representing the execution environment (local, multinode etc) \\
\hline
\end{DoxyParams}


Definition at line 139 of file qubits.\+c.



References Multi\+Qubit\+::chunk\+Id, Multi\+Qubit\+::num\+Chunks, and Multi\+Qubit\+::num\+Qubits.


\begin{DoxyCode}
139                                                   \{
140         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numAmps = 1L << multiQubit.\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits};
141         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numAmpsPerRank = numAmps/multiQubit.\hyperlink{structMultiQubit_acd43f2f57991709c9e94f73662c972b2}{numChunks};
142         \textcolor{keywordflow}{if} (multiQubit.\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId}==0)\{
143                 printf(\textcolor{stringliteral}{"QUBITS:\(\backslash\)n"});
144                 printf(\textcolor{stringliteral}{"Number of qubits is %d.\(\backslash\)n"}, multiQubit.\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits});
145                 printf(\textcolor{stringliteral}{"Number of amps is %lld.\(\backslash\)n"}, numAmps);
146                 printf(\textcolor{stringliteral}{"Number of amps per rank is %lld.\(\backslash\)n"}, numAmpsPerRank);
147         \}
148 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_af8a14ae79c3fb2c0b5f6255cc37bebf9}\label{qubits_8h_af8a14ae79c3fb2c0b5f6255cc37bebf9}} 
\index{qubits.\+h@{qubits.\+h}!report\+Qu\+E\+S\+T\+Env@{report\+Qu\+E\+S\+T\+Env}}
\index{report\+Qu\+E\+S\+T\+Env@{report\+Qu\+E\+S\+T\+Env}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{report\+Qu\+E\+S\+T\+Env()}{reportQuESTEnv()}}
{\footnotesize\ttfamily void report\+Qu\+E\+S\+T\+Env (\begin{DoxyParamCaption}\item[{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}}]{env }\end{DoxyParamCaption})}



Report information about the Qu\+E\+ST environment. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em env} & object representing the execution environment. A single instance is used for each program \\
\hline
\end{DoxyParams}


Definition at line 30 of file qubits\+\_\+env\+\_\+local.\+c.



References Qu\+E\+S\+T\+Env\+::num\+Ranks, Qu\+E\+S\+T\+Env\+::rank, and R\+E\+AL.


\begin{DoxyCode}
30                                  \{
31         printf(\textcolor{stringliteral}{"EXECUTION ENVIRONMENT:\(\backslash\)n"});
32         printf(\textcolor{stringliteral}{"Running locally on one node\(\backslash\)n"});
33         printf(\textcolor{stringliteral}{"Number of ranks is %d\(\backslash\)n"}, env.\hyperlink{structQuESTEnv_af22aacd7c9905accae28484785c193b4}{numRanks});
34 \textcolor{preprocessor}{# ifdef \_OPENMP}
35         printf(\textcolor{stringliteral}{"OpenMP enabled\(\backslash\)n"});
36         printf(\textcolor{stringliteral}{"Number of threads available is %d\(\backslash\)n"}, omp\_get\_max\_threads());
37 \textcolor{preprocessor}{# else}
38         printf(\textcolor{stringliteral}{"OpenMP disabled\(\backslash\)n"});
39 \textcolor{preprocessor}{# endif}
40         printf(\textcolor{stringliteral}{"Precision: size of REAL is %ld bytes\(\backslash\)n"}, \textcolor{keyword}{sizeof}(\hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}));
41 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a96f4de9ce7fefc7680a44d601fc3d894}\label{qubits_8h_a96f4de9ce7fefc7680a44d601fc3d894}} 
\index{qubits.\+h@{qubits.\+h}!report\+State@{report\+State}}
\index{report\+State@{report\+State}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{report\+State()}{reportState()}}
{\footnotesize\ttfamily void report\+State (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit }\end{DoxyParamCaption})}



Print the current state vector of probability amplitudes for a set of qubits to file. 

File format\+: \begin{DoxyVerb}real, imag
realComponent1, imagComponent1
realComponent2, imagComponent2
...
realComponentN, imagComponentN
\end{DoxyVerb}


File naming convention\+:

For each node that the program runs on, a file \textquotesingle{}state\+\_\+rank\+\_\+\mbox{[}node\+\_\+rank\mbox{]}.csv\textquotesingle{} is generated. If there is more than one node, ranks after the first do not include the header \begin{DoxyVerb}real, imag
\end{DoxyVerb}
 so that files are easier to combine. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\end{DoxyParams}


Definition at line 93 of file qubits.\+c.



References Multi\+Qubit\+::chunk\+Id, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps, Complex\+Array\+::real, R\+E\+A\+L\+\_\+\+S\+T\+R\+I\+N\+G\+\_\+\+F\+O\+R\+M\+AT, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
93                                        \{
94         FILE *state;
95         \textcolor{keywordtype}{char} filename[100];
96         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
97         sprintf(filename, \textcolor{stringliteral}{"state\_rank\_%d.csv"}, multiQubit.\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId});
98         state = fopen(filename, \textcolor{stringliteral}{"w"});
99         \textcolor{keywordflow}{if} (multiQubit.\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId}==0) fprintf(state, \textcolor{stringliteral}{"real, imag\(\backslash\)n"});
100 
101         \textcolor{keywordflow}{for}(index=0; index<multiQubit.\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps}; index++)\{
102                 fprintf(state, \hyperlink{precision_8h_ad751ac7ddc8ec19f23fb33083c0da8da}{REAL\_STRING\_FORMAT} \textcolor{stringliteral}{","} 
      \hyperlink{precision_8h_ad751ac7ddc8ec19f23fb33083c0da8da}{REAL\_STRING\_FORMAT} \textcolor{stringliteral}{"\(\backslash\)n"}, multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}[index], multiQubit.
      \hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}[index]);
103         \}
104         fclose(state);
105 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a842d6884e063a5865a2232cba56b65ac}\label{qubits_8h_a842d6884e063a5865a2232cba56b65ac}} 
\index{qubits.\+h@{qubits.\+h}!report\+State\+To\+Screen@{report\+State\+To\+Screen}}
\index{report\+State\+To\+Screen@{report\+State\+To\+Screen}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{report\+State\+To\+Screen()}{reportStateToScreen()}}
{\footnotesize\ttfamily void report\+State\+To\+Screen (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}}]{env,  }\item[{int}]{report\+Rank }\end{DoxyParamCaption})}



Print the current state vector of probability amplitudes for a set of qubits to standard out. 

For debugging purposes. Each rank should print output serially. Only print output for systems $<$= 5 qubits 

Definition at line 110 of file qubits.\+c.



References Multi\+Qubit\+::chunk\+Id, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Chunks, Multi\+Qubit\+::num\+Qubits, Complex\+Array\+::real, R\+E\+A\+L\+\_\+\+S\+T\+R\+I\+N\+G\+\_\+\+F\+O\+R\+M\+AT, Multi\+Qubit\+::state\+Vec, and sync\+Qu\+E\+S\+T\+Env().


\begin{DoxyCode}
110                                                                              \{
111         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
112         \textcolor{keywordtype}{int} rank;
113         \textcolor{keywordflow}{if} (multiQubit.\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}<=5)\{
114                 \textcolor{keywordflow}{for} (rank=0; rank<multiQubit.\hyperlink{structMultiQubit_acd43f2f57991709c9e94f73662c972b2}{numChunks}; rank++)\{
115                         \textcolor{keywordflow}{if} (multiQubit.\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId}==rank)\{
116                                 \textcolor{keywordflow}{if} (reportRank) \{
117                                         printf(\textcolor{stringliteral}{"Reporting state from rank %d [\(\backslash\)n"}, multiQubit.
      \hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId});
118                                         \textcolor{comment}{//printf("\(\backslash\)trank, index, real, imag\(\backslash\)n");}
119                                         printf(\textcolor{stringliteral}{"real, imag\(\backslash\)n"});
120                                 \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (rank==0) \{
121                                         printf(\textcolor{stringliteral}{"Reporting state [\(\backslash\)n"});
122                                         printf(\textcolor{stringliteral}{"real, imag\(\backslash\)n"});
123                                 \}
124 
125                                 \textcolor{keywordflow}{for}(index=0; index<multiQubit.\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps}; index++)\{
126                                         printf(\hyperlink{precision_8h_ad751ac7ddc8ec19f23fb33083c0da8da}{REAL\_STRING\_FORMAT} \textcolor{stringliteral}{", "} 
      \hyperlink{precision_8h_ad751ac7ddc8ec19f23fb33083c0da8da}{REAL\_STRING\_FORMAT} \textcolor{stringliteral}{"\(\backslash\)n"}, multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}[index], multiQubit.
      \hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}[index]);
127                                 \}
128                                 \textcolor{keywordflow}{if} (reportRank || rank==multiQubit.\hyperlink{structMultiQubit_acd43f2f57991709c9e94f73662c972b2}{numChunks}-1) printf(\textcolor{stringliteral}{"]\(\backslash\)n"});
129                         \}
130                         \hyperlink{qubits_8h_a8d31fe2d1ad4d01e2a1f5f6b8bc15b77}{syncQuESTEnv}(env);
131                 \}
132         \}
133 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a4ba468aa69f812efd1f964e10a45ca2f}\label{qubits_8h_a4ba468aa69f812efd1f964e10a45ca2f}} 
\index{qubits.\+h@{qubits.\+h}!rotate\+Qubit@{rotate\+Qubit}}
\index{rotate\+Qubit@{rotate\+Qubit}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{rotate\+Qubit()}{rotateQubit()}}
{\footnotesize\ttfamily void rotate\+Qubit (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{const int}]{rot\+Qubit,  }\item[{\hyperlink{structComplex}{Complex}}]{alpha,  }\item[{\hyperlink{structComplex}{Complex}}]{beta }\end{DoxyParamCaption})}



Rotate a single qubit in the state vector of probability amplitudes. 

Given two complex numbers alpha and beta, applies the operation ~\newline
\mbox{[}alpha, -\/beta$\ast$ ~\newline
 beta, alpha$\ast$\mbox{]} ~\newline
 \begin{DoxyRemark}{Remarks}
Qubits are zero-\/based and the the first qubit is the rightmost
\end{DoxyRemark}
alpha, beta must obey $\vert$alpha$\vert$$^\wedge$2 + $\vert$beta$\vert$$^\wedge$2 = 1


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em rot\+Qubit} & qubit to rotate \\
\hline
\mbox{\tt in}  & {\em alpha} & rotation angle \\
\hline
\mbox{\tt in}  & {\em beta} & rotation angle \\
\hline
\end{DoxyParams}


Definition at line 87 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, chunk\+Is\+Upper(), exchange\+State\+Vectors(), get\+Chunk\+Pair\+Id(), get\+Rot\+Angle(), half\+Matrix\+Block\+Fits\+In\+Chunk(), Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::pair\+State\+Vec, rotate\+Qubit\+Distributed(), rotate\+Qubit\+Local(), and Multi\+Qubit\+::state\+Vec.



Referenced by rotate\+Qubit\+By\+Angle().


\begin{DoxyCode}
88 \{
89         \textcolor{comment}{// all values required to update state vector lie in this rank}
90         \hyperlink{qubits_8c_acb059cbcb8c7910a5fc43d21da4f5dea}{rotateQubitLocal}(multiQubit, rotQubit, alpha, beta);
91 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a70b6649dc52a36ff2d0ed91fb443c3c4}\label{qubits_8h_a70b6649dc52a36ff2d0ed91fb443c3c4}} 
\index{qubits.\+h@{qubits.\+h}!rotate\+Qubit\+By\+Angle@{rotate\+Qubit\+By\+Angle}}
\index{rotate\+Qubit\+By\+Angle@{rotate\+Qubit\+By\+Angle}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{rotate\+Qubit\+By\+Angle()}{rotateQubitByAngle()}}
{\footnotesize\ttfamily void rotate\+Qubit\+By\+Angle (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{const int}]{rot\+Qubit,  }\item[{\hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL}}]{angle,  }\item[{\hyperlink{structVector}{Vector}}]{unit\+Axis }\end{DoxyParamCaption})}



Rotate a single qubit a certain angle about an axis. 

\begin{DoxyRemark}{Remarks}
Qubits are zero-\/based and the the first qubit is the rightmost
\end{DoxyRemark}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em rot\+Qubit} & qubit to rotate \\
\hline
\mbox{\tt in}  & {\em angle} & angle by which to rotate in radians \\
\hline
\mbox{\tt in}  & {\em unit\+Axis} & unit vector pointing along the axis about which to rotate \\
\hline
\end{DoxyParams}


Definition at line 381 of file qubits.\+c.



References Complex\+::imag, Complex\+::real, rotate\+Qubit(), Vector\+::x, Vector\+::y, and Vector\+::z.


\begin{DoxyCode}
381                                                                                                \{
382         \hyperlink{structComplex}{Complex} alpha, beta;
383         alpha.\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real} = cos(angle/2.0);
384         alpha.\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag} = -sin(angle/2.0)*unitAxis.\hyperlink{structVector_ad4e863651be7d6b7e2b28cd7445a0ccf}{z};   
385         beta.\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real} = 0;
386         beta.\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag} = -sin(angle/2.0)*(unitAxis.\hyperlink{structVector_aac7abe171ba4bada50ed72acba6259fc}{x} + unitAxis.\hyperlink{structVector_a375ca805d4c808a53d7c4e0c737ae3de}{y});
387         \hyperlink{qubits_8h_a4ba468aa69f812efd1f964e10a45ca2f}{rotateQubit}(multiQubit, rotQubit, alpha, beta);
388 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a1086d84d6a3d5b79137e2f27f18e67e0}\label{qubits_8h_a1086d84d6a3d5b79137e2f27f18e67e0}} 
\index{qubits.\+h@{qubits.\+h}!s\+Gate@{s\+Gate}}
\index{s\+Gate@{s\+Gate}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{s\+Gate()}{sGate()}}
{\footnotesize\ttfamily void s\+Gate (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{const int}]{rot\+Qubit }\end{DoxyParamCaption})}



Definition at line 1291 of file qubits.\+c.



References phase\+Gate(), and S\+\_\+\+G\+A\+TE.


\begin{DoxyCode}
1292 \{
1293                 \hyperlink{qubits__env__local_8c_ae275b94c1a483dda43bf4ec947635605}{phaseGate}(multiQubit, rotQubit, \hyperlink{qubits_8h_a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f}{S\_GATE});
1294 \} 
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_acda82bebb0a62f419eec9c1e0575daad}\label{qubits_8h_acda82bebb0a62f419eec9c1e0575daad}} 
\index{qubits.\+h@{qubits.\+h}!sigmaX@{sigmaX}}
\index{sigmaX@{sigmaX}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{sigma\+X()}{sigmaX()}}
{\footnotesize\ttfamily void sigmaX (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{const int}]{rot\+Qubit }\end{DoxyParamCaption})}



Rotate a single qubit by \{\{0,1\},\{1,0\}\} -- swap $\vert$0$>$ and $\vert$1$>$. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em rot\+Qubit} & qubit to rotate \\
\hline
\end{DoxyParams}


Definition at line 98 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, chunk\+Is\+Upper(), exchange\+State\+Vectors(), get\+Chunk\+Pair\+Id(), half\+Matrix\+Block\+Fits\+In\+Chunk(), Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::pair\+State\+Vec, sigma\+X\+Distributed(), sigma\+X\+Local(), and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
99 \{
100         \hyperlink{qubits_8c_aa9e640bb2d0458c937c6a87dfeca0f23}{sigmaXLocal}(multiQubit, rotQubit);
101 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a7b022c75cef77be046bd5d61e38a581e}\label{qubits_8h_a7b022c75cef77be046bd5d61e38a581e}} 
\index{qubits.\+h@{qubits.\+h}!sigmaY@{sigmaY}}
\index{sigmaY@{sigmaY}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{sigma\+Y()}{sigmaY()}}
{\footnotesize\ttfamily void sigmaY (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{const int}]{rot\+Qubit }\end{DoxyParamCaption})}



Rotate a single qubit by \{\{0,-\/i\},\{i,0\}\} -- swap $\vert$0$>$ and $\vert$1$>$ and apply a phase of -\/i or i. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em rot\+Qubit} & qubit to rotate \\
\hline
\end{DoxyParams}
fix -- put duplicate code (sigmaX, sigmaY) in seperate function 

Definition at line 103 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, chunk\+Is\+Upper(), exchange\+State\+Vectors(), get\+Chunk\+Pair\+Id(), half\+Matrix\+Block\+Fits\+In\+Chunk(), Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::pair\+State\+Vec, sigma\+Y\+Distributed(), sigma\+Y\+Local(), and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
104 \{
105         \hyperlink{qubits_8c_afcbb1dcbe070ad0ed1a72a23251b6a83}{sigmaYLocal}(multiQubit, rotQubit);
106 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a9c90f8302e4f1d8fda23def8753e50fe}\label{qubits_8h_a9c90f8302e4f1d8fda23def8753e50fe}} 
\index{qubits.\+h@{qubits.\+h}!sigmaZ@{sigmaZ}}
\index{sigmaZ@{sigmaZ}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{sigma\+Z()}{sigmaZ()}}
{\footnotesize\ttfamily void sigmaZ (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{const int}]{rot\+Qubit }\end{DoxyParamCaption})}



Rotate a single qubit by \{\{1,0\},\{\{0,-\/1\}\} -- apply a phase of -\/1 to $\vert$1$>$. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em rot\+Qubit} & qubit to rotate \\
\hline
\end{DoxyParams}


Definition at line 1286 of file qubits.\+c.



References phase\+Gate(), and S\+I\+G\+M\+A\+\_\+Z.


\begin{DoxyCode}
1287 \{
1288                 \hyperlink{qubits__env__local_8c_ae275b94c1a483dda43bf4ec947635605}{phaseGate}(multiQubit, rotQubit, \hyperlink{qubits_8h_a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac}{SIGMA\_Z});
1289 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a8d31fe2d1ad4d01e2a1f5f6b8bc15b77}\label{qubits_8h_a8d31fe2d1ad4d01e2a1f5f6b8bc15b77}} 
\index{qubits.\+h@{qubits.\+h}!sync\+Qu\+E\+S\+T\+Env@{sync\+Qu\+E\+S\+T\+Env}}
\index{sync\+Qu\+E\+S\+T\+Env@{sync\+Qu\+E\+S\+T\+Env}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{sync\+Qu\+E\+S\+T\+Env()}{syncQuESTEnv()}}
{\footnotesize\ttfamily void sync\+Qu\+E\+S\+T\+Env (\begin{DoxyParamCaption}\item[{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}}]{env }\end{DoxyParamCaption})}



Guarantees that all code up to the given point has been executed on all nodes. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em env} & object representing the execution environment. A single instance is used for each program \\
\hline
\end{DoxyParams}


Definition at line 18 of file qubits\+\_\+env\+\_\+local.\+c.



Referenced by initialize\+State\+From\+Single\+File(), and report\+State\+To\+Screen().


\begin{DoxyCode}
18                                \{
19         \textcolor{comment}{// MPI Barrier goes here in MPI version. }
20 \} 
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a877396e10f0e9aeead078664c51bb0e3}\label{qubits_8h_a877396e10f0e9aeead078664c51bb0e3}} 
\index{qubits.\+h@{qubits.\+h}!sync\+Qu\+E\+S\+T\+Success@{sync\+Qu\+E\+S\+T\+Success}}
\index{sync\+Qu\+E\+S\+T\+Success@{sync\+Qu\+E\+S\+T\+Success}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{sync\+Qu\+E\+S\+T\+Success()}{syncQuESTSuccess()}}
{\footnotesize\ttfamily int sync\+Qu\+E\+S\+T\+Success (\begin{DoxyParamCaption}\item[{\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}}]{env,  }\item[{int}]{success\+Code }\end{DoxyParamCaption})}



Performs a logical A\+ND on all success\+Codes held by all processes. 

If any one process has a zero success\+Code all processes will return a zero success code. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em env} & object representing the execution environment. A single instance is used for each program \\
\hline
\mbox{\tt in}  & {\em success\+Code} & 1 if process task succeeded, 0 if process task failed \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if all processes succeeded, 0 if any one process failed 
\end{DoxyReturn}


Definition at line 22 of file qubits\+\_\+env\+\_\+local.\+c.


\begin{DoxyCode}
22                                                    \{
23         \textcolor{keywordflow}{return} successCode;
24 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a5f33ddd690383fd09cc79bf143e383fb}\label{qubits_8h_a5f33ddd690383fd09cc79bf143e383fb}} 
\index{qubits.\+h@{qubits.\+h}!t\+Gate@{t\+Gate}}
\index{t\+Gate@{t\+Gate}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{t\+Gate()}{tGate()}}
{\footnotesize\ttfamily void t\+Gate (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{const int}]{rot\+Qubit }\end{DoxyParamCaption})}



Definition at line 1296 of file qubits.\+c.



References phase\+Gate(), and T\+\_\+\+G\+A\+TE.


\begin{DoxyCode}
1297 \{
1298                 \hyperlink{qubits__env__local_8c_ae275b94c1a483dda43bf4ec947635605}{phaseGate}(multiQubit, rotQubit, \hyperlink{qubits_8h_a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab}{T\_GATE});
1299 \}
\end{DoxyCode}
