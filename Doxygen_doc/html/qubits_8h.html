<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Distributed QuEST: qubits.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>qubits.h File Reference</h1>
<p>The QuEST library API and objects.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="precision_8h_source.html">precision.h</a>&quot;</code><br/>

<p><a href="qubits_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structComplexArray.html">ComplexArray</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Represents an array of complex numbers grouped into an array of real components and an array of coressponding complex components.  <a href="structComplexArray.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structComplex.html">Complex</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Represents one complex number.  <a href="structComplex.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structVector.html">Vector</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMultiQubit.html">MultiQubit</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Represents a system of qubits.  <a href="structMultiQubit.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structQuESTEnv.html">QuESTEnv</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Information about the environment the program is running in.  <a href="structQuESTEnv.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a> { <a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a> = 0, 
<a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a> = 1, 
<a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a> = 2
 }</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a9c02591bc64c2918503afa231d90d83f">createMultiQubit</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> *multiQubit, int numQubits, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a <a class="el" href="structMultiQubit.html" title="Represents a system of qubits.">MultiQubit</a> object representing a set of qubits.  <a href="#a9c02591bc64c2918503afa231d90d83f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#ae5d6acc322314d7a3d8a2eccf00d3b19">destroyMultiQubit</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deallocate a <a class="el" href="structMultiQubit.html" title="Represents a system of qubits.">MultiQubit</a> object representing a set of qubits Free memory allocated to state vector of probability amplitudes, including temporary vector for values copied from another chunk if running the distributed version.  <a href="#ae5d6acc322314d7a3d8a2eccf00d3b19"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a96f4de9ce7fefc7680a44d601fc3d894">reportState</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print the current state vector of probability amplitudes for a set of qubits to file.  <a href="#a96f4de9ce7fefc7680a44d601fc3d894"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a842d6884e063a5865a2232cba56b65ac">reportStateToScreen</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>, int reportRank)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print the current state vector of probability amplitudes for a set of qubits to standard out.  <a href="#a842d6884e063a5865a2232cba56b65ac"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#aa5e77e0e64f3a4a3d3f5cc7382bffcd9">reportMultiQubitParams</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Report metainformation about a set of qubits: number of qubits, number of probability amplitudes.  <a href="#aa5e77e0e64f3a4a3d3f5cc7382bffcd9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#acb5b2eff794339090004d29f02a70d9a">initStateZero</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> *multiQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialise the state vector of probability amplitudes for a set of qubits to the zero state: |000...00&gt;.  <a href="#acb5b2eff794339090004d29f02a70d9a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a43bcb279fc9717fbd06a19cdef48b9d8">initStatePlus</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> *multiQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialise the state vector of probability amplitudes for a set of qubits to an equal real superposition of all amplitudes: |+++.  <a href="#a43bcb279fc9717fbd06a19cdef48b9d8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#afc1835c6b43b6e59ce7df7b13f274fc7">multiControlledPhaseGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, int *controlQubits, int numControlQubits)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The multiple qubit control phase gate.  <a href="#afc1835c6b43b6e59ce7df7b13f274fc7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a11a96159191cbf1b01a1080e7f045aac">controlledPhaseGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int idQubit1, const int idQubit2)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The control phase (the two qubit phase gate).  <a href="#a11a96159191cbf1b01a1080e7f045aac"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a9c90f8302e4f1d8fda23def8753e50fe">sigmaZ</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{1,0},{{0,-1}} -- apply a phase of -1 to |1&gt;.  <a href="#a9c90f8302e4f1d8fda23def8753e50fe"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a1086d84d6a3d5b79137e2f27f18e67e0">sGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a5f33ddd690383fd09cc79bf143e383fb">tGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#ad84a3ce68d1ca02b4e3f741ea45b6054">initQuESTEnv</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> *<a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize QuEST environment.  <a href="#ad84a3ce68d1ca02b4e3f741ea45b6054"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#abd4bc926cd3f9b65610bb228d0c59fe0">closeQuESTEnv</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Close QuEST environment.  <a href="#abd4bc926cd3f9b65610bb228d0c59fe0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77">syncQuESTEnv</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Guarantees that all code up to the given point has been executed on all nodes.  <a href="#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#ac7e38d768a1bd79019f88cc1e6295092">syncQuESTSuccess</a> (int successCode)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs a logical AND on all successCodes held by all processes.  <a href="#ac7e38d768a1bd79019f88cc1e6295092"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#af8a14ae79c3fb2c0b5f6255cc37bebf9">reportQuESTEnv</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Report information about the QuEST environment.  <a href="#af8a14ae79c3fb2c0b5f6255cc37bebf9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a8f10aabf9f607f19093aee54630caa21">getEnvironmentString</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>, <a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, char str[200])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a317b786f577fa6bc136ea7f0ee7330a7">getRealAmpEl</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, long long int index)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the real component of the probability amplitude at an index in the state vector.  <a href="#a317b786f577fa6bc136ea7f0ee7330a7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a3615f76fd5f57008d9b74bbd10533dd0">getImagAmpEl</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, long long int index)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the imaginary component of the probability amplitude at an index in the state vector.  <a href="#a3615f76fd5f57008d9b74bbd10533dd0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a799b10447d6dbdaf960a4d3eedd22014">getProbEl</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, long long int index)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the probability of the state at an index in the state vector.  <a href="#a799b10447d6dbdaf960a4d3eedd22014"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a818a4c7cd7252d2b10b896b12fa431d3">calcTotalProbability</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate the probability of being in any state by taking the norm of the entire state vector.  <a href="#a818a4c7cd7252d2b10b896b12fa431d3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#ad13ae1902276195d0df106116e032aff">compactUnitary</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes.  <a href="#ad13ae1902276195d0df106116e032aff"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#ae74806cf36513b6d8447439a5bc1d615">unitary</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a6cc7fa705a2f2e6b486b49c5589d5df5">rotateX</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, REAL angle)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit a certain angle about the x-axis.  <a href="#a6cc7fa705a2f2e6b486b49c5589d5df5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#ace0d3592d38a990e81a434c4e9681500">rotateY</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, REAL angle)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit a certain angle about the y-axis.  <a href="#ace0d3592d38a990e81a434c4e9681500"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#abd621412ad30c1b034f4ce153c4afe10">rotateZ</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, REAL angle)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit a certain angle about the z-axis.  <a href="#abd621412ad30c1b034f4ce153c4afe10"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a96cc5075cff975f73885b50c093ba4a0">controlledCompactUnitary</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, const int controlQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes.  <a href="#a96cc5075cff975f73885b50c093ba4a0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a7fadb225fc385db789e844c87fcba9e1">rotateAroundAxis</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, REAL angle, <a class="el" href="structVector.html">Vector</a> unitAxis)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit a certain angle about an axis.  <a href="#a7fadb225fc385db789e844c87fcba9e1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a4e135fd99abe7fa390c678937f0cebc9">controlledUnitary</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, const int controlQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a unitary operation to a single qubit given a control qubit Only perform the rotation for elements where the control qubit is one.  <a href="#a4e135fd99abe7fa390c678937f0cebc9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a1589779fdc2de60c784eabd8dd1c2a8c">multiControlledUnitary</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, int *controlQubits, const int numControlQubits, const int rotQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a unitary operation to a single qubit given an array of control qubits Only perform the rotation for elements where all control qubits equal 1.  <a href="#a1589779fdc2de60c784eabd8dd1c2a8c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#acda82bebb0a62f419eec9c1e0575daad">sigmaX</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{0,1},{1,0}} -- swap |0&gt; and |1&gt;.  <a href="#acda82bebb0a62f419eec9c1e0575daad"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a7b022c75cef77be046bd5d61e38a581e">sigmaY</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{0,-i},{i,0}} -- swap |0&gt; and |1&gt; and apply a phase of -i or i.  <a href="#a7b022c75cef77be046bd5d61e38a581e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#ad247d084dc7150893e9051a438a5807e">hadamard</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{1,1},{1,-1}}/sqrt2 -- turn a |0&gt; into a |+&gt; and a |1&gt; into a |-&gt;.  <a href="#ad247d084dc7150893e9051a438a5807e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a67576895bbc65463481a8ea24d9b1e22">controlledNot</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{0,-i},{i,0}} -- swap |0&gt; and |1&gt; and apply a phase of -i or i, only for elements when control qubit is 1.  <a href="#a67576895bbc65463481a8ea24d9b1e22"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#ad315c941a51bc053d39ebfa2040fd32e">findProbabilityOfOutcome</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit, int outcome)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find the probability of a specified qubit being in the zero or one state.  <a href="#ad315c941a51bc053d39ebfa2040fd32e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8h.html#a07418ebac70fd9ae5d051d089961631d">collapseToOutcome</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit, int outcome)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update the state vector to be consistent with measuring measureQubit=0 or measureQubit=1 according to the value of outcome.  <a href="#a07418ebac70fd9ae5d051d089961631d"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>The QuEST library API and objects. </p>

<p>Definition in file <a class="el" href="qubits_8h_source.html">qubits.h</a>.</p>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="a5739021c733cecc49647956b2f7338ea"></a><!-- doxytag: member="qubits.h::phaseGateType" ref="a5739021c733cecc49647956b2f7338ea" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac"></a><!-- doxytag: member="SIGMA_Z" ref="a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac" args="" -->SIGMA_Z</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f"></a><!-- doxytag: member="S_GATE" ref="a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f" args="" -->S_GATE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab"></a><!-- doxytag: member="T_GATE" ref="a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab" args="" -->T_GATE</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8h_source.html#l00066">66</a> of file <a class="el" href="qubits_8h_source.html">qubits.h</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00066"></a>00066 {<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a>=0, <a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a>=1, <a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a>=2};
</pre></div></p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a818a4c7cd7252d2b10b896b12fa431d3"></a><!-- doxytag: member="qubits.h::calcTotalProbability" ref="a818a4c7cd7252d2b10b896b12fa431d3" args="(MultiQubit multiQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL calcTotalProbability </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate the probability of being in any state by taking the norm of the entire state vector. </p>
<p>Should be equal to 1. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing a set of qubits </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>total probability </dd></dl>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00048">48</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>References <a class="el" href="qubits_8c_source.html#l00015">DEBUG</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="precision_8h_source.html#l00024">MPI_QuEST_REAL</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numChunks</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00341">test_compactUnitary()</a>, and <a class="el" href="runTests_8c_source.html#l00403">test_unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00048"></a>00048                                                 {
<a name="l00049"></a>00049   <span class="comment">/* IJB - implemented using Kahan summation for greater accuracy at a slight floating</span>
<a name="l00050"></a>00050 <span class="comment">     point operation overhead. For more details see https://en.wikipedia.org/wiki/Kahan_summation_algorithm */</span>
<a name="l00051"></a>00051   <span class="comment">/* Don&apos;t change the bracketing in this routine! */</span>
<a name="l00052"></a>00052   <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> pTotal=0; 
<a name="l00053"></a>00053   <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> y, t, c;
<a name="l00054"></a>00054   <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00055"></a>00055   <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmpsPerRank = multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00056"></a>00056   c = 0.0;
<a name="l00057"></a>00057   <span class="keywordflow">for</span> (index=0; index&lt;numAmpsPerRank; index++){ 
<a name="l00058"></a>00058     <span class="comment">/* Perform pTotal+=multiQubit.stateVec.real[index]*multiQubit.stateVec.real[index]; by Kahan */</span>
<a name="l00059"></a>00059    <span class="comment">// pTotal+=multiQubit.stateVec.real[index]*multiQubit.stateVec.real[index];</span>
<a name="l00060"></a>00060     
<a name="l00061"></a>00061     y = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[index]*multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[index] - c;
<a name="l00062"></a>00062     t = pTotal + y;
<a name="l00063"></a>00063     c = ( t - pTotal ) - y;
<a name="l00064"></a>00064     pTotal = t;
<a name="l00065"></a>00065     
<a name="l00066"></a>00066     <span class="comment">/* Perform pTotal+=multiQubit.stateVec.imag[index]*multiQubit.stateVec.imag[index]; by Kahan */</span>
<a name="l00067"></a>00067     <span class="comment">//pTotal+=multiQubit.stateVec.imag[index]*multiQubit.stateVec.imag[index];</span>
<a name="l00068"></a>00068     
<a name="l00069"></a>00069     
<a name="l00070"></a>00070     y = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[index]*multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[index] - c;
<a name="l00071"></a>00071     t = pTotal + y;
<a name="l00072"></a>00072     c = ( t - pTotal ) - y;
<a name="l00073"></a>00073     pTotal = t;
<a name="l00074"></a>00074     
<a name="l00075"></a>00075     
<a name="l00076"></a>00076   } 
<a name="l00077"></a>00077   <span class="keywordflow">return</span> pTotal;
<a name="l00078"></a>00078 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="abd4bc926cd3f9b65610bb228d0c59fe0"></a><!-- doxytag: member="qubits.h::closeQuESTEnv" ref="abd4bc926cd3f9b65610bb228d0c59fe0" args="(QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void closeQuESTEnv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Close QuEST environment. </p>
<p>If something needs to be done to clean up the execution environment, such as finalizing MPI when running in distributed mode, it is handled here </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00027">27</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>Referenced by <a class="el" href="3sat_8c_source.html#l00101">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00027"></a>00027                                 {
<a name="l00028"></a>00028         <span class="comment">// MPI finalize goes here in MPI version. Call this function anyway for consistency</span>
<a name="l00029"></a>00029 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a07418ebac70fd9ae5d051d089961631d"></a><!-- doxytag: member="qubits.h::collapseToOutcome" ref="a07418ebac70fd9ae5d051d089961631d" args="(MultiQubit multiQubit, const int measureQubit, int outcome)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL collapseToOutcome </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outcome</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Update the state vector to be consistent with measuring measureQubit=0 or measureQubit=1 according to the value of outcome. </p>
<p>Measure in Zero performs an irreversible change to the state vector: it updates the vector according to the event that an outcome has been measured on the qubit indicated by measureQubit (where his label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 if outcome=0 or measureQubit=1 if outcome=1. It then returns the probability of making this measurement.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>outcome</em>&nbsp;</td><td>to measure the probability of and set the state to -- either zero or one </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>probability of qubit measureQubit being either zero or one </dd></dl>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00182">182</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l02071">collapseToOutcomeDistributedRenorm()</a>, <a class="el" href="qubits_8c_source.html#l02114">collapseToOutcomeDistributedSetZero()</a>, <a class="el" href="qubits_8c_source.html#l01988">collapseToOutcomeLocal()</a>, <a class="el" href="qubits__env__local_8c_source.html#l00173">findProbabilityOfOutcome()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00232">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00650">isChunkToSkipInFindPZero()</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::numQubits</a>, <a class="el" href="qubits__env__local_8c_source.html#l00200">QuESTAssert()</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="precision_8h_source.html#l00026">REAL_EPS</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00694">test_collapseToOutcome()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00183"></a>00183 {
<a name="l00184"></a>00184     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(measureQubit &gt;= 0 &amp;&amp; measureQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 2, __func__);
<a name="l00185"></a>00185     <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateProb;
<a name="l00186"></a>00186         stateProb = <a class="code" href="qubits_8h.html#ad315c941a51bc053d39ebfa2040fd32e" title="Find the probability of a specified qubit being in the zero or one state.">findProbabilityOfOutcome</a>(multiQubit, measureQubit, outcome);
<a name="l00187"></a>00187     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(fabs(stateProb&gt;<a class="code" href="precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a>), 8, __func__);
<a name="l00188"></a>00188     <a class="code" href="qubits_8c.html#a01d9a8b7ff0e09ec399e158389783aa9" title="Update the state vector to be consistent with measuring measureQubit=0 if outcome=0...">collapseToOutcomeLocal</a>(multiQubit, measureQubit, stateProb, outcome);
<a name="l00189"></a>00189     <span class="keywordflow">return</span> stateProb;
<a name="l00190"></a>00190 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad13ae1902276195d0df106116e032aff"></a><!-- doxytag: member="qubits.h::compactUnitary" ref="ad13ae1902276195d0df106116e032aff" args="(MultiQubit multiQubit, const int rotQubit, Complex alpha, Complex beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compactUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes. </p>
<p>Given two complex numbers alpha and beta, applies the operation <br/>
 [alpha, -beta* <br/>
 beta, alpha*] <br/>
</p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<p>alpha, beta must obey |alpha|^2 + |beta|^2 = 1</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rotQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>alpha</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>beta</em>&nbsp;</td><td>rotation angle </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00088">88</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00146">chunkIsUpper()</a>, <a class="el" href="qubits_8c_source.html#l00646">compactUnitaryDistributed()</a>, <a class="el" href="qubits_8c_source.html#l00507">compactUnitaryLocal()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00239">exchangeStateVectors()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00213">getChunkPairId()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00167">getRotAngle()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00232">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00044">MultiQubit::pairStateVec</a>, <a class="el" href="qubits__env__local_8c_source.html#l00200">QuESTAssert()</a>, <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>, and <a class="el" href="qubits_8c_source.html#l00408">validateAlphaBeta()</a>.</p>

<p>Referenced by <a class="el" href="qubits_8c_source.html#l00432">rotateAroundAxis()</a>, <a class="el" href="qubits_8c_source.html#l00450">rotateX()</a>, <a class="el" href="qubits_8c_source.html#l00469">rotateY()</a>, <a class="el" href="qubits_8c_source.html#l00488">rotateZ()</a>, <a class="el" href="runTests_8c_source.html#l00341">test_compactUnitary()</a>, and <a class="el" href="runTests_8c_source.html#l00403">test_unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00089"></a>00089 {
<a name="l00090"></a>00090     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(rotQubit &gt;= 0 &amp;&amp; rotQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00091"></a>00091     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(<a class="code" href="qubits_8c.html#ae2b2c14a07dd7d50ff86032a3ca101d7">validateAlphaBeta</a>(alpha, beta), 6, __func__);
<a name="l00092"></a>00092 
<a name="l00093"></a>00093         <span class="comment">// all values required to update state vector lie in this rank</span>
<a name="l00094"></a>00094         <a class="code" href="qubits_8c.html#a33a8d60ae759d25a096c88b337db6c9f" title="Rotate a single qubit in the state vector of probability amplitudes.">compactUnitaryLocal</a>(multiQubit, rotQubit, alpha, beta);
<a name="l00095"></a>00095 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a96cc5075cff975f73885b50c093ba4a0"></a><!-- doxytag: member="qubits.h::controlledCompactUnitary" ref="a96cc5075cff975f73885b50c093ba4a0" args="(MultiQubit multiQubit, const int rotQubit, const int controlQubit, Complex alpha, Complex beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledCompactUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes. </p>
<p>Given two complex numbers alpha and beta and a control qubit, applies the operation: <br/>
 [alpha, -beta* <br/>
 beta, alpha*] <br/>
 Only when the control qubit is one.</p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<p>alpha, beta must obey |alpha|^2 + |beta|^2 = 1</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rotQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>perform rotation if this qubit is 1 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>alpha</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>beta</em>&nbsp;</td><td>rotation angle </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00106">106</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00146">chunkIsUpper()</a>, <a class="el" href="qubits_8c_source.html#l00991">controlledCompactUnitaryDistributed()</a>, <a class="el" href="qubits_8c_source.html#l00760">controlledCompactUnitaryLocal()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00239">exchangeStateVectors()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00213">getChunkPairId()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00167">getRotAngle()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00232">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00044">MultiQubit::pairStateVec</a>, <a class="el" href="qubits__env__local_8c_source.html#l00200">QuESTAssert()</a>, <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>, and <a class="el" href="qubits_8c_source.html#l00408">validateAlphaBeta()</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00470">test_controlledCompactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00515">test_controlledUnitary()</a>, and <a class="el" href="runTests_8c_source.html#l00567">test_multiControlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00107"></a>00107 {
<a name="l00108"></a>00108     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(rotQubit &gt;= 0 &amp;&amp; rotQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00109"></a>00109     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(controlQubit &gt;= 0 &amp;&amp; controlQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 2, __func__);
<a name="l00110"></a>00110     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(controlQubit != rotQubit, 3, __func__);
<a name="l00111"></a>00111     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(<a class="code" href="qubits_8c.html#ae2b2c14a07dd7d50ff86032a3ca101d7">validateAlphaBeta</a>(alpha, beta), 6, __func__);
<a name="l00112"></a>00112     
<a name="l00113"></a>00113 
<a name="l00114"></a>00114         <a class="code" href="qubits_8c.html#a2f5b808392caec4eb775bb3aabfa25d2" title="Rotate a single qubit in the state vector of probability amplitudes, given two complex...">controlledCompactUnitaryLocal</a>(multiQubit, rotQubit, controlQubit, alpha, beta);
<a name="l00115"></a>00115 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a67576895bbc65463481a8ea24d9b1e22"></a><!-- doxytag: member="qubits.h::controlledNot" ref="a67576895bbc65463481a8ea24d9b1e22" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledNot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{0,-i},{i,0}} -- swap |0&gt; and |1&gt; and apply a phase of -i or i, only for elements when control qubit is 1. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rotQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>perform sigmaX rotation if this qubit is 1 </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00165">165</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00146">chunkIsUpper()</a>, <a class="el" href="qubits_8c_source.html#l01338">controlledNotDistributed()</a>, <a class="el" href="qubits_8c_source.html#l01272">controlledNotLocal()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00239">exchangeStateVectors()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00213">getChunkPairId()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00232">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00044">MultiQubit::pairStateVec</a>, <a class="el" href="qubits__env__local_8c_source.html#l00200">QuESTAssert()</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00249">test_controlledNot()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00166"></a>00166 {
<a name="l00167"></a>00167     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00168"></a>00168     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(controlQubit &gt;= 0 &amp;&amp; controlQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 2, __func__);
<a name="l00169"></a>00169     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(controlQubit != targetQubit, 3, __func__);
<a name="l00170"></a>00170         <a class="code" href="qubits_8c.html#ad357a43e80e3baf013975b1b70942f4c" title="Rotate a single qubit by {{0,1},{1,0} for elements where controlQubit is one.">controlledNotLocal</a>(multiQubit, controlQubit, targetQubit);
<a name="l00171"></a>00171 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a11a96159191cbf1b01a1080e7f045aac"></a><!-- doxytag: member="qubits.h::controlledPhaseGate" ref="a11a96159191cbf1b01a1080e7f045aac" args="(MultiQubit multiQubit, const int idQubit1, const int idQubit2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledPhaseGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>idQubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>idQubit2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The control phase (the two qubit phase gate). </p>
<p>For each state, if both input qubits are equal to one, multiply the amplitude of that state by -1. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>idQubit1,idQubit2</em>&nbsp;</td><td>specified qubits </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01896">1896</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01885">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::numQubits</a>, <a class="el" href="qubits__env__local_8c_source.html#l00200">QuESTAssert()</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00283">test_controlledPhaseGate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01897"></a>01897 {
<a name="l01898"></a>01898         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l01899"></a>01899         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l01900"></a>01900         <span class="keywordtype">int</span> bit1, bit2;
<a name="l01901"></a>01901 
<a name="l01902"></a>01902         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01903"></a>01903         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01904"></a>01904 
<a name="l01905"></a>01905     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(idQubit1 &gt;= 0 &amp;&amp; idQubit1 &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 2, __func__);
<a name="l01906"></a>01906     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(idQubit2 &gt;= 0 &amp;&amp; idQubit2 &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l01907"></a>01907     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(idQubit1 != idQubit2, 3, __func__);
<a name="l01908"></a>01908 
<a name="l01909"></a>01909         <span class="comment">// dimension of the state vector</span>
<a name="l01910"></a>01910         stateVecSize = multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01911"></a>01911         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01912"></a>01912         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01913"></a>01913 
<a name="l01914"></a>01914 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01915"></a>01915 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel for \</span>
<a name="l01916"></a>01916 <span class="preprocessor">        default  (none)                      \</span>
<a name="l01917"></a>01917 <span class="preprocessor">        shared   (stateVecSize, stateVecReal,stateVecImag ) \</span>
<a name="l01918"></a>01918 <span class="preprocessor">        private  (index,bit1,bit2)                     \</span>
<a name="l01919"></a>01919 <span class="preprocessor">        schedule (static)</span>
<a name="l01920"></a>01920 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01921"></a>01921 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l01922"></a>01922                 bit1 = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (idQubit1, index+chunkId*chunkSize);
<a name="l01923"></a>01923                 bit2 = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (idQubit2, index+chunkId*chunkSize);
<a name="l01924"></a>01924                 <span class="keywordflow">if</span> (bit1 &amp;&amp; bit2) {
<a name="l01925"></a>01925                         stateVecReal [index] = - stateVecReal [index];
<a name="l01926"></a>01926                         stateVecImag [index] = - stateVecImag [index];
<a name="l01927"></a>01927                 }
<a name="l01928"></a>01928         }
<a name="l01929"></a>01929 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4e135fd99abe7fa390c678937f0cebc9"></a><!-- doxytag: member="qubits.h::controlledUnitary" ref="a4e135fd99abe7fa390c678937f0cebc9" args="(MultiQubit multiQubit, const int rotQubit, const int controlQubit, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply a unitary operation to a single qubit given a control qubit Only perform the rotation for elements where the control qubit is one. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rotQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>perform rotation if this qubit is 1 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>u</em>&nbsp;</td><td>unitary matrix to apply </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00117">117</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00146">chunkIsUpper()</a>, <a class="el" href="qubits_8c_source.html#l01054">controlledUnitaryDistributed()</a>, <a class="el" href="qubits_8c_source.html#l00912">controlledUnitaryLocal()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00239">exchangeStateVectors()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00213">getChunkPairId()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00192">getRotAngleFromUnitaryMatrix()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00232">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00044">MultiQubit::pairStateVec</a>, <a class="el" href="qubits__env__local_8c_source.html#l00200">QuESTAssert()</a>, <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>, and <a class="el" href="qubits_8c_source.html#l00383">validateMatrixIsUnitary()</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00515">test_controlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00118"></a>00118 {
<a name="l00119"></a>00119     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(rotQubit &gt;= 0 &amp;&amp; rotQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00120"></a>00120     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(controlQubit &gt;= 0 &amp;&amp; controlQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 2, __func__);
<a name="l00121"></a>00121     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(controlQubit != rotQubit, 3, __func__);
<a name="l00122"></a>00122     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(<a class="code" href="qubits_8c.html#ae4fea133d1a8f09ff8da03038100adb2">validateMatrixIsUnitary</a>(u), 5, __func__);
<a name="l00123"></a>00123    
<a name="l00124"></a>00124         <a class="code" href="qubits_8c.html#a0af39b13cf3a043975fce768f3507657" title="Rotate a single qubit in the state vector of probability amplitudes, given two complex...">controlledUnitaryLocal</a>(multiQubit, rotQubit, controlQubit, u);
<a name="l00125"></a>00125 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9c02591bc64c2918503afa231d90d83f"></a><!-- doxytag: member="qubits.h::createMultiQubit" ref="a9c02591bc64c2918503afa231d90d83f" args="(MultiQubit *multiQubit, int numQubits, QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void createMultiQubit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a> *&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create a <a class="el" href="structMultiQubit.html" title="Represents a system of qubits.">MultiQubit</a> object representing a set of qubits. </p>
<p>Allocate space for state vector of probability amplitudes, including space for temporary values to be copied from one other chunk if running the distributed version. Define properties related to the size of the set of qubits. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>numQubits</em>&nbsp;</td><td>number of qubits in the system </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment (local, multinode etc) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00040">40</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numChunks</a>, <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00062">QuESTEnv::numRanks</a>, <a class="el" href="qubits_8h_source.html#l00044">MultiQubit::pairStateVec</a>, <a class="el" href="qubits_8h_source.html#l00061">QuESTEnv::rank</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="3sat_8c_source.html#l00101">main()</a>, <a class="el" href="runTests_8c_source.html#l00694">test_collapseToOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00341">test_compactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00470">test_controlledCompactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00249">test_controlledNot()</a>, <a class="el" href="runTests_8c_source.html#l00283">test_controlledPhaseGate()</a>, <a class="el" href="runTests_8c_source.html#l00515">test_controlledUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00649">test_findProbabilityOfOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00165">test_hadamard()</a>, <a class="el" href="runTests_8c_source.html#l00055">test_initStatePlus()</a>, <a class="el" href="runTests_8c_source.html#l00032">test_initStateZero()</a>, <a class="el" href="runTests_8c_source.html#l00315">test_multiControlledPhaseGate()</a>, <a class="el" href="runTests_8c_source.html#l00567">test_multiControlledUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00193">test_sGate()</a>, <a class="el" href="runTests_8c_source.html#l00078">test_sigmaX()</a>, <a class="el" href="runTests_8c_source.html#l00107">test_sigmaY()</a>, <a class="el" href="runTests_8c_source.html#l00136">test_sigmaZ()</a>, <a class="el" href="runTests_8c_source.html#l00221">test_tGate()</a>, and <a class="el" href="runTests_8c_source.html#l00403">test_unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00041"></a>00041 {
<a name="l00042"></a>00042         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = 1L &lt;&lt; numQubits;
<a name="l00043"></a>00043         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmpsPerRank = numAmps/env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>;
<a name="l00044"></a>00044 
<a name="l00045"></a>00045         multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a> = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>)));
<a name="l00046"></a>00046         multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a> = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>)));
<a name="l00047"></a>00047         <span class="keywordflow">if</span> (env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1){
<a name="l00048"></a>00048                 multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a> = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>)));
<a name="l00049"></a>00049                 multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a> = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>)));
<a name="l00050"></a>00050         }
<a name="l00051"></a>00051 
<a name="l00052"></a>00052         <span class="keywordflow">if</span> ( (!(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>) || !(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>))
<a name="l00053"></a>00053                  &amp;&amp; numAmpsPerRank ) {
<a name="l00054"></a>00054                 printf(<span class="stringliteral">&quot;Could not allocate memory!&quot;</span>);
<a name="l00055"></a>00055                 exit (EXIT_FAILURE);
<a name="l00056"></a>00056         }
<a name="l00057"></a>00057 
<a name="l00058"></a>00058         <span class="keywordflow">if</span> ( env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1 &amp;&amp; (!(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>) || !(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>))
<a name="l00059"></a>00059                  &amp;&amp; numAmpsPerRank ) {
<a name="l00060"></a>00060                 printf(<span class="stringliteral">&quot;Could not allocate memory!&quot;</span>);
<a name="l00061"></a>00061                 exit (EXIT_FAILURE);
<a name="l00062"></a>00062         }
<a name="l00063"></a>00063 
<a name="l00064"></a>00064         multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a> = numQubits;
<a name="l00065"></a>00065         multiQubit-&gt;<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a> = numAmpsPerRank;
<a name="l00066"></a>00066         multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a> = env.<a class="code" href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">rank</a>;
<a name="l00067"></a>00067         multiQubit-&gt;<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a> = env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>;
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae5d6acc322314d7a3d8a2eccf00d3b19"></a><!-- doxytag: member="qubits.h::destroyMultiQubit" ref="ae5d6acc322314d7a3d8a2eccf00d3b19" args="(MultiQubit multiQubit, QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void destroyMultiQubit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deallocate a <a class="el" href="structMultiQubit.html" title="Represents a system of qubits.">MultiQubit</a> object representing a set of qubits Free memory allocated to state vector of probability amplitudes, including temporary vector for values copied from another chunk if running the distributed version. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object to be deallocated </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment (local, multinode etc) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00076">76</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00062">QuESTEnv::numRanks</a>, <a class="el" href="qubits_8h_source.html#l00044">MultiQubit::pairStateVec</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="3sat_8c_source.html#l00101">main()</a>, <a class="el" href="runTests_8c_source.html#l00694">test_collapseToOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00341">test_compactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00470">test_controlledCompactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00249">test_controlledNot()</a>, <a class="el" href="runTests_8c_source.html#l00283">test_controlledPhaseGate()</a>, <a class="el" href="runTests_8c_source.html#l00515">test_controlledUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00649">test_findProbabilityOfOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00165">test_hadamard()</a>, <a class="el" href="runTests_8c_source.html#l00055">test_initStatePlus()</a>, <a class="el" href="runTests_8c_source.html#l00032">test_initStateZero()</a>, <a class="el" href="runTests_8c_source.html#l00315">test_multiControlledPhaseGate()</a>, <a class="el" href="runTests_8c_source.html#l00567">test_multiControlledUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00193">test_sGate()</a>, <a class="el" href="runTests_8c_source.html#l00078">test_sigmaX()</a>, <a class="el" href="runTests_8c_source.html#l00107">test_sigmaY()</a>, <a class="el" href="runTests_8c_source.html#l00136">test_sigmaZ()</a>, <a class="el" href="runTests_8c_source.html#l00221">test_tGate()</a>, and <a class="el" href="runTests_8c_source.html#l00403">test_unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00076"></a>00076                                                            {
<a name="l00077"></a>00077         free(multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>);
<a name="l00078"></a>00078         free(multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>);
<a name="l00079"></a>00079         <span class="keywordflow">if</span> (env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1){
<a name="l00080"></a>00080                 free(multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>);
<a name="l00081"></a>00081                 free(multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>);
<a name="l00082"></a>00082         }
<a name="l00083"></a>00083 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad315c941a51bc053d39ebfa2040fd32e"></a><!-- doxytag: member="qubits.h::findProbabilityOfOutcome" ref="ad315c941a51bc053d39ebfa2040fd32e" args="(MultiQubit multiQubit, const int measureQubit, int outcome)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL findProbabilityOfOutcome </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outcome</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Find the probability of a specified qubit being in the zero or one state. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>outcome</em>&nbsp;</td><td>to measure the probability of -- either zero or one </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>probability of qubit measureQubit being either zero or one </dd></dl>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00173">173</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01830">findProbabilityOfZeroDistributed()</a>, <a class="el" href="qubits_8c_source.html#l01757">findProbabilityOfZeroLocal()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00232">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00650">isChunkToSkipInFindPZero()</a>, <a class="el" href="precision_8h_source.html#l00024">MPI_QuEST_REAL</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::numQubits</a>, <a class="el" href="qubits__env__local_8c_source.html#l00200">QuESTAssert()</a>, and <a class="el" href="precision_8h_source.html#l00023">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00182">collapseToOutcome()</a>, <a class="el" href="3sat_8c_source.html#l00101">main()</a>, and <a class="el" href="runTests_8c_source.html#l00649">test_findProbabilityOfOutcome()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00174"></a>00174 {
<a name="l00175"></a>00175     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(measureQubit &gt;= 0 &amp;&amp; measureQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 2, __func__);
<a name="l00176"></a>00176         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateProb=0;
<a name="l00177"></a>00177         stateProb = <a class="code" href="qubits_8c.html#a7c02cd0e1b4eac19771a0525f023249e" title="Measure the total probability of a specified qubit being in the zero state across...">findProbabilityOfZeroLocal</a>(multiQubit, measureQubit);
<a name="l00178"></a>00178         <span class="keywordflow">if</span> (outcome==1) stateProb = 1.0 - stateProb;
<a name="l00179"></a>00179         <span class="keywordflow">return</span> stateProb;
<a name="l00180"></a>00180 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8f10aabf9f607f19093aee54630caa21"></a><!-- doxytag: member="qubits.h::getEnvironmentString" ref="a8f10aabf9f607f19093aee54630caa21" args="(QuESTEnv env, MultiQubit multiQubit, char str[200])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getEnvironmentString </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>str</em>[200]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00162">162</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::numQubits</a>, and <a class="el" href="qubits_8h_source.html#l00062">QuESTEnv::numRanks</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00162"></a>00162                                                                              {
<a name="l00163"></a>00163         <span class="keywordtype">int</span> numThreads=1;
<a name="l00164"></a>00164 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00165"></a>00165 <span class="preprocessor"></span>        numThreads=omp_get_max_threads(); 
<a name="l00166"></a>00166 <span class="preprocessor"># endif</span>
<a name="l00167"></a>00167 <span class="preprocessor"></span>        sprintf(str, <span class="stringliteral">&quot;%dqubits_CPU_%dranksx%dthreads&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>, numThreads);
<a name="l00168"></a>00168 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3615f76fd5f57008d9b74bbd10533dd0"></a><!-- doxytag: member="qubits.h::getImagAmpEl" ref="a3615f76fd5f57008d9b74bbd10533dd0" args="(MultiQubit multiQubit, long long int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL getImagAmpEl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>index</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the imaginary component of the probability amplitude at an index in the state vector. </p>
<p>For debugging purposes. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing a set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>index</em>&nbsp;</td><td>index in state vector of probability amplitudes </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>imaginary component at that index </dd></dl>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00084">84</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00084">getChunkIdFromIndex()</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="precision_8h_source.html#l00024">MPI_QuEST_REAL</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits_8c_source.html#l02150">getProbEl()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00084"></a>00084                                                              {
<a name="l00085"></a>00085         <span class="keywordflow">return</span> multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[index];
<a name="l00086"></a>00086 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a799b10447d6dbdaf960a4d3eedd22014"></a><!-- doxytag: member="qubits.h::getProbEl" ref="a799b10447d6dbdaf960a4d3eedd22014" args="(MultiQubit multiQubit, long long int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL getProbEl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>index</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the probability of the state at an index in the state vector. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing a set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>index</em>&nbsp;</td><td>index in state vector of probability amplitudes </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>realEl*realEl + imagEl*imagEl</dd></dl>
<p>Get the probability of the state at an index in the state vector.</p>
<p>For debugging purposes. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing a set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>index</em>&nbsp;</td><td>index in state vector of probability amplitudes </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>real component * real component + imag component * imag component </dd></dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l02150">2150</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00084">getImagAmpEl()</a>, <a class="el" href="qubits__env__local_8c_source.html#l00080">getRealAmpEl()</a>, and <a class="el" href="precision_8h_source.html#l00023">REAL</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02150"></a>02150                                                           {
<a name="l02151"></a>02151         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> real;
<a name="l02152"></a>02152         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> imag;
<a name="l02153"></a>02153         real = <a class="code" href="qubits_8h.html#a317b786f577fa6bc136ea7f0ee7330a7" title="Get the real component of the probability amplitude at an index in the state vector...">getRealAmpEl</a>(multiQubit, index);
<a name="l02154"></a>02154         imag = <a class="code" href="qubits_8h.html#a3615f76fd5f57008d9b74bbd10533dd0" title="Get the imaginary component of the probability amplitude at an index in the state...">getImagAmpEl</a>(multiQubit, index);
<a name="l02155"></a>02155         <span class="keywordflow">return</span> real*real + imag*imag;
<a name="l02156"></a>02156 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a317b786f577fa6bc136ea7f0ee7330a7"></a><!-- doxytag: member="qubits.h::getRealAmpEl" ref="a317b786f577fa6bc136ea7f0ee7330a7" args="(MultiQubit multiQubit, long long int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL getRealAmpEl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>index</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the real component of the probability amplitude at an index in the state vector. </p>
<p>For debugging purposes. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing a set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>index</em>&nbsp;</td><td>index in state vector of probability amplitudes </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>real component at that index </dd></dl>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00080">80</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00084">getChunkIdFromIndex()</a>, <a class="el" href="precision_8h_source.html#l00024">MPI_QuEST_REAL</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits_8c_source.html#l02150">getProbEl()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00080"></a>00080                                                              {
<a name="l00081"></a>00081         <span class="keywordflow">return</span> multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[index];
<a name="l00082"></a>00082 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad247d084dc7150893e9051a438a5807e"></a><!-- doxytag: member="qubits.h::hadamard" ref="ad247d084dc7150893e9051a438a5807e" args="(MultiQubit multiQubit, const int rotQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hadamard </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{1,1},{1,-1}}/sqrt2 -- turn a |0&gt; into a |+&gt; and a |1&gt; into a |-&gt;. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rotQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00159">159</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00146">chunkIsUpper()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00239">exchangeStateVectors()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00213">getChunkPairId()</a>, <a class="el" href="qubits_8c_source.html#l01544">hadamardDistributed()</a>, <a class="el" href="qubits_8c_source.html#l01482">hadamardLocal()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00232">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00044">MultiQubit::pairStateVec</a>, <a class="el" href="qubits__env__local_8c_source.html#l00200">QuESTAssert()</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00165">test_hadamard()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00160"></a>00160 {
<a name="l00161"></a>00161     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(rotQubit &gt;= 0 &amp;&amp; rotQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00162"></a>00162         <a class="code" href="qubits_8c.html#a0711416fceaf63c67b496e123e845c69" title="Rotate a single qubit by {{1,1},{1,-1}}/sqrt2.">hadamardLocal</a>(multiQubit, rotQubit);
<a name="l00163"></a>00163 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad84a3ce68d1ca02b4e3f741ea45b6054"></a><!-- doxytag: member="qubits.h::initQuESTEnv" ref="ad84a3ce68d1ca02b4e3f741ea45b6054" args="(QuESTEnv *env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initQuESTEnv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize QuEST environment. </p>
<p>If something needs to be done to set up the execution environment, such as initializing MPI when running in distributed mode, it is handled here </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00013">13</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>References <a class="el" href="qubits_8c_source.html#l00015">DEBUG</a>, <a class="el" href="qubits_8h_source.html#l00062">QuESTEnv::numRanks</a>, and <a class="el" href="qubits_8h_source.html#l00061">QuESTEnv::rank</a>.</p>

<p>Referenced by <a class="el" href="3sat_8c_source.html#l00101">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00013"></a>00013                                 {
<a name="l00014"></a>00014         <span class="comment">// init MPI environment</span>
<a name="l00015"></a>00015         env-&gt;<a class="code" href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">rank</a>=0;
<a name="l00016"></a>00016         env-&gt;<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>=1;
<a name="l00017"></a>00017 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a43bcb279fc9717fbd06a19cdef48b9d8"></a><!-- doxytag: member="qubits.h::initStatePlus" ref="a43bcb279fc9717fbd06a19cdef48b9d8" args="(MultiQubit *multiQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initStatePlus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a> *&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialise the state vector of probability amplitudes for a set of qubits to an equal real superposition of all amplitudes: |+++. </p>
<p>..++&gt; </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits to be initialised </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00216">216</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8c_source.html#l00015">DEBUG</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numChunks</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00694">test_collapseToOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00341">test_compactUnitary()</a>, <a class="el" href="runTests_8c_source.html#l00649">test_findProbabilityOfOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00055">test_initStatePlus()</a>, and <a class="el" href="runTests_8c_source.html#l00403">test_unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00217"></a>00217 {
<a name="l00218"></a>00218         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;
<a name="l00219"></a>00219         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00220"></a>00220 
<a name="l00221"></a>00221         <span class="comment">// dimension of the state vector</span>
<a name="l00222"></a>00222         chunkSize = multiQubit-&gt;<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00223"></a>00223         stateVecSize = chunkSize*multiQubit-&gt;<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>;
<a name="l00224"></a>00224         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> normFactor = 1.0/sqrt(stateVecSize);
<a name="l00225"></a>00225 
<a name="l00226"></a>00226         <span class="comment">// Can&apos;t use multiQubit-&gt;stateVec as a private OMP var</span>
<a name="l00227"></a>00227         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00228"></a>00228         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00229"></a>00229 
<a name="l00230"></a>00230         <span class="comment">// initialise the state to |0000..0000&gt;</span>
<a name="l00231"></a>00231 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00232"></a>00232 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00233"></a>00233 <span class="preprocessor">        default  (none) \</span>
<a name="l00234"></a>00234 <span class="preprocessor">        shared   (chunkSize, stateVecReal, stateVecImag, normFactor) \</span>
<a name="l00235"></a>00235 <span class="preprocessor">        private  (index) </span>
<a name="l00236"></a>00236 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00237"></a>00237 <span class="preprocessor"></span>        {
<a name="l00238"></a>00238 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00239"></a>00239 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00240"></a>00240 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00241"></a>00241 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {
<a name="l00242"></a>00242                         stateVecReal[index] = normFactor;
<a name="l00243"></a>00243                         stateVecImag[index] = 0.0;
<a name="l00244"></a>00244                 }
<a name="l00245"></a>00245         }
<a name="l00246"></a>00246         <span class="keywordflow">if</span> (<a class="code" href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>) printf(<span class="stringliteral">&quot;COMPLETED INIT\n&quot;</span>);
<a name="l00247"></a>00247 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="acb5b2eff794339090004d29f02a70d9a"></a><!-- doxytag: member="qubits.h::initStateZero" ref="acb5b2eff794339090004d29f02a70d9a" args="(MultiQubit *multiQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initStateZero </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a> *&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialise the state vector of probability amplitudes for a set of qubits to the zero state: |000...00&gt;. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits to be initialised </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00174">174</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l00015">DEBUG</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="3sat_8c_source.html#l00101">main()</a>, <a class="el" href="runTests_8c_source.html#l00694">test_collapseToOutcome()</a>, <a class="el" href="runTests_8c_source.html#l00649">test_findProbabilityOfOutcome()</a>, and <a class="el" href="runTests_8c_source.html#l00032">test_initStateZero()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00175"></a>00175 {
<a name="l00176"></a>00176         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l00177"></a>00177         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00178"></a>00178 
<a name="l00179"></a>00179         <span class="comment">// dimension of the state vector</span>
<a name="l00180"></a>00180         stateVecSize = multiQubit-&gt;<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00181"></a>00181 
<a name="l00182"></a>00182         <span class="comment">// Can&apos;t use multiQubit-&gt;stateVec as a private OMP var</span>
<a name="l00183"></a>00183         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l00184"></a>00184         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l00185"></a>00185 
<a name="l00186"></a>00186         <span class="comment">// initialise the state to |0000..0000&gt;</span>
<a name="l00187"></a>00187 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00188"></a>00188 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00189"></a>00189 <span class="preprocessor">        default  (none) \</span>
<a name="l00190"></a>00190 <span class="preprocessor">        shared   (stateVecSize, stateVecReal, stateVecImag) \</span>
<a name="l00191"></a>00191 <span class="preprocessor">        private  (index) </span>
<a name="l00192"></a>00192 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00193"></a>00193 <span class="preprocessor"></span>        {
<a name="l00194"></a>00194 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00195"></a>00195 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l00196"></a>00196 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00197"></a>00197 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l00198"></a>00198                         stateVecReal[index] = 0.0;
<a name="l00199"></a>00199                         stateVecImag[index] = 0.0;
<a name="l00200"></a>00200                 }
<a name="l00201"></a>00201         }
<a name="l00202"></a>00202 
<a name="l00203"></a>00203         <span class="keywordflow">if</span> (multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>==0){
<a name="l00204"></a>00204                 <span class="comment">// zero state |0000..0000&gt; has probability 1</span>
<a name="l00205"></a>00205                 stateVecReal[0] = 1.0;
<a name="l00206"></a>00206                 stateVecImag[0] = 0.0;
<a name="l00207"></a>00207         }
<a name="l00208"></a>00208 
<a name="l00209"></a>00209         <span class="keywordflow">if</span> (<a class="code" href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>) printf(<span class="stringliteral">&quot;COMPLETED INIT\n&quot;</span>);
<a name="l00210"></a>00210 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="afc1835c6b43b6e59ce7df7b13f274fc7"></a><!-- doxytag: member="qubits.h::multiControlledPhaseGate" ref="afc1835c6b43b6e59ce7df7b13f274fc7" args="(MultiQubit multiQubit, int *controlQubits, int numControlQubits)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multiControlledPhaseGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>controlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numControlQubits</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The multiple qubit control phase gate. </p>
<p>For each state, if all input qubits are equal to one, multiply the amplitude of that state by -1. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubits</em>&nbsp;</td><td>array of input qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>numControlQubits</em>&nbsp;</td><td>number of input qubits </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01937">1937</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::numQubits</a>, <a class="el" href="qubits__env__local_8c_source.html#l00200">QuESTAssert()</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00315">test_multiControlledPhaseGate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01938"></a>01938 {
<a name="l01939"></a>01939         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l01940"></a>01940         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l01941"></a>01941         
<a name="l01942"></a>01942         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01943"></a>01943         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01944"></a>01944 
<a name="l01945"></a>01945     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(numControlQubits &gt;= 0 &amp;&amp; numControlQubits &lt;= multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 4, __func__);
<a name="l01946"></a>01946     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> mask=0;
<a name="l01947"></a>01947     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;numControlQubits; i++) mask = mask | (1LL&lt;&lt;controlQubits[i]);
<a name="l01948"></a>01948     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(mask &gt;=0 &amp;&amp; mask &lt;= (1LL&lt;&lt;multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>)-1, 2, __func__);
<a name="l01949"></a>01949 
<a name="l01950"></a>01950         stateVecSize = multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l01951"></a>01951         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;
<a name="l01952"></a>01952         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;
<a name="l01953"></a>01953 
<a name="l01954"></a>01954 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01955"></a>01955 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01956"></a>01956 <span class="preprocessor">        default  (none)                      \</span>
<a name="l01957"></a>01957 <span class="preprocessor">        shared   (stateVecSize, stateVecReal,stateVecImag, mask ) \</span>
<a name="l01958"></a>01958 <span class="preprocessor">        private  (index)</span>
<a name="l01959"></a>01959 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01960"></a>01960 <span class="preprocessor"></span>        {
<a name="l01961"></a>01961 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01962"></a>01962 <span class="preprocessor"></span><span class="preprocessor">                # pragma omp for schedule (static)</span>
<a name="l01963"></a>01963 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01964"></a>01964 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l01965"></a>01965                         <span class="keywordflow">if</span> (mask == (mask &amp; (index+chunkId*chunkSize)) ){
<a name="l01966"></a>01966                                 stateVecReal [index] = - stateVecReal [index];
<a name="l01967"></a>01967                                 stateVecImag [index] = - stateVecImag [index];
<a name="l01968"></a>01968                         }
<a name="l01969"></a>01969                 }
<a name="l01970"></a>01970         }
<a name="l01971"></a>01971 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1589779fdc2de60c784eabd8dd1c2a8c"></a><!-- doxytag: member="qubits.h::multiControlledUnitary" ref="a1589779fdc2de60c784eabd8dd1c2a8c" args="(MultiQubit multiQubit, int *controlQubits, const int numControlQubits, const int rotQubit, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multiControlledUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>controlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>numControlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply a unitary operation to a single qubit given an array of control qubits Only perform the rotation for elements where all control qubits equal 1. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rotQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubits</em>&nbsp;</td><td>perform rotation if all qubits in this array equal 1 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>numControlQubits</em>&nbsp;</td><td>number of control qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>u</em>&nbsp;</td><td>unitary matrix to apply </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00127">127</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00146">chunkIsUpper()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00239">exchangeStateVectors()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00213">getChunkPairId()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00192">getRotAngleFromUnitaryMatrix()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00232">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits_8c_source.html#l01118">multiControlledUnitaryDistributed()</a>, <a class="el" href="qubits_8c_source.html#l00838">multiControlledUnitaryLocal()</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00044">MultiQubit::pairStateVec</a>, <a class="el" href="qubits__env__local_8c_source.html#l00200">QuESTAssert()</a>, <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>, and <a class="el" href="qubits_8c_source.html#l00383">validateMatrixIsUnitary()</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00567">test_multiControlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00128"></a>00128 {
<a name="l00129"></a>00129     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(rotQubit &gt;= 0 &amp;&amp; rotQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00130"></a>00130     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(numControlQubits &gt;= 0 &amp;&amp; numControlQubits &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 4, __func__);
<a name="l00131"></a>00131     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(<a class="code" href="qubits_8c.html#ae4fea133d1a8f09ff8da03038100adb2">validateMatrixIsUnitary</a>(u), 5, __func__);
<a name="l00132"></a>00132 
<a name="l00133"></a>00133     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> mask=0; 
<a name="l00134"></a>00134     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;numControlQubits; i++) mask = mask | (1LL&lt;&lt;controlQubits[i]);
<a name="l00135"></a>00135     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(mask &gt;=0 &amp;&amp; mask &lt;= (1LL&lt;&lt;multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>)-1, 2, __func__);
<a name="l00136"></a>00136     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>((mask &amp; (1LL&lt;&lt;rotQubit)) != (1LL&lt;&lt;rotQubit), 3, __func__);
<a name="l00137"></a>00137         
<a name="l00138"></a>00138     <a class="code" href="qubits_8c.html#a32cb91618b5fcd79b54be8d8760b713d" title="Rotate a single qubit in the state vector of probability amplitudes, given two complex...">multiControlledUnitaryLocal</a>(multiQubit, rotQubit, mask, u);
<a name="l00139"></a>00139 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa5e77e0e64f3a4a3d3f5cc7382bffcd9"></a><!-- doxytag: member="qubits.h::reportMultiQubitParams" ref="aa5e77e0e64f3a4a3d3f5cc7382bffcd9" args="(MultiQubit multiQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportMultiQubitParams </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Report metainformation about a set of qubits: number of qubits, number of probability amplitudes. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment (local, multinode etc) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00151">151</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numChunks</a>, and <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::numQubits</a>.</p>

<p>Referenced by <a class="el" href="3sat_8c_source.html#l00101">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00151"></a>00151                                                   {
<a name="l00152"></a>00152         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = 1L &lt;&lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>;
<a name="l00153"></a>00153         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmpsPerRank = numAmps/multiQubit.<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>;
<a name="l00154"></a>00154         <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>==0){
<a name="l00155"></a>00155                 printf(<span class="stringliteral">&quot;QUBITS:\n&quot;</span>);
<a name="l00156"></a>00156                 printf(<span class="stringliteral">&quot;Number of qubits is %d.\n&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>);
<a name="l00157"></a>00157                 printf(<span class="stringliteral">&quot;Number of amps is %lld.\n&quot;</span>, numAmps);
<a name="l00158"></a>00158                 printf(<span class="stringliteral">&quot;Number of amps per rank is %lld.\n&quot;</span>, numAmpsPerRank);
<a name="l00159"></a>00159         }
<a name="l00160"></a>00160 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af8a14ae79c3fb2c0b5f6255cc37bebf9"></a><!-- doxytag: member="qubits.h::reportQuESTEnv" ref="af8a14ae79c3fb2c0b5f6255cc37bebf9" args="(QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportQuESTEnv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Report information about the QuEST environment. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00031">31</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00062">QuESTEnv::numRanks</a>, <a class="el" href="qubits_8h_source.html#l00061">QuESTEnv::rank</a>, and <a class="el" href="precision_8h_source.html#l00023">REAL</a>.</p>

<p>Referenced by <a class="el" href="3sat_8c_source.html#l00101">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00031"></a>00031                                  {
<a name="l00032"></a>00032         printf(<span class="stringliteral">&quot;EXECUTION ENVIRONMENT:\n&quot;</span>);
<a name="l00033"></a>00033         printf(<span class="stringliteral">&quot;Running locally on one node\n&quot;</span>);
<a name="l00034"></a>00034         printf(<span class="stringliteral">&quot;Number of ranks is %d\n&quot;</span>, env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>);
<a name="l00035"></a>00035 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00036"></a>00036 <span class="preprocessor"></span>        printf(<span class="stringliteral">&quot;OpenMP enabled\n&quot;</span>);
<a name="l00037"></a>00037         printf(<span class="stringliteral">&quot;Number of threads available is %d\n&quot;</span>, omp_get_max_threads());
<a name="l00038"></a>00038 <span class="preprocessor"># else</span>
<a name="l00039"></a>00039 <span class="preprocessor"></span>        printf(<span class="stringliteral">&quot;OpenMP disabled\n&quot;</span>);
<a name="l00040"></a>00040 <span class="preprocessor"># endif</span>
<a name="l00041"></a>00041 <span class="preprocessor"></span>        printf(<span class="stringliteral">&quot;Precision: size of REAL is %ld bytes\n&quot;</span>, <span class="keyword">sizeof</span>(<a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>));
<a name="l00042"></a>00042 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a96f4de9ce7fefc7680a44d601fc3d894"></a><!-- doxytag: member="qubits.h::reportState" ref="a96f4de9ce7fefc7680a44d601fc3d894" args="(MultiQubit multiQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Print the current state vector of probability amplitudes for a set of qubits to file. </p>
<p>File format: </p>
<div class="fragment"><pre class="fragment">
real, imag
realComponent1, imagComponent1
realComponent2, imagComponent2
...
realComponentN, imagComponentN
</pre></div><p>File naming convention:</p>
<p>For each node that the program runs on, a file 'state_rank_[node_rank].csv' is generated. If there is more than one node, ranks after the first do not include the header </p>
<div class="fragment"><pre class="fragment">
real, imag
</pre></div><p> so that files are easier to combine. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00105">105</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL_STRING_FORMAT</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00105"></a>00105                                        {
<a name="l00106"></a>00106         FILE *state;
<a name="l00107"></a>00107         <span class="keywordtype">char</span> filename[100];
<a name="l00108"></a>00108         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00109"></a>00109         sprintf(filename, <span class="stringliteral">&quot;state_rank_%d.csv&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>);
<a name="l00110"></a>00110         state = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>);
<a name="l00111"></a>00111         <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>==0) fprintf(state, <span class="stringliteral">&quot;real, imag\n&quot;</span>);
<a name="l00112"></a>00112 
<a name="l00113"></a>00113         <span class="keywordflow">for</span>(index=0; index&lt;multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>; index++){
<a name="l00114"></a>00114                 fprintf(state, <a class="code" href="precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a> <span class="stringliteral">&quot;,&quot;</span> <a class="code" href="precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a> <span class="stringliteral">&quot;\n&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[index], multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[index]);
<a name="l00115"></a>00115         }
<a name="l00116"></a>00116         fclose(state);
<a name="l00117"></a>00117 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a842d6884e063a5865a2232cba56b65ac"></a><!-- doxytag: member="qubits.h::reportStateToScreen" ref="a842d6884e063a5865a2232cba56b65ac" args="(MultiQubit multiQubit, QuESTEnv env, int reportRank)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportStateToScreen </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>reportRank</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Print the current state vector of probability amplitudes for a set of qubits to standard out. </p>
<p>For debugging purposes. Each rank should print output serially. Only print output for systems &lt;= 5 qubits </p>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00122">122</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numChunks</a>, <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL_STRING_FORMAT</a>, <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>, and <a class="el" href="qubits__env__local_8c_source.html#l00019">syncQuESTEnv()</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00020">reportTest()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00122"></a>00122                                                                              {
<a name="l00123"></a>00123         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00124"></a>00124         <span class="keywordtype">int</span> rank;
<a name="l00125"></a>00125         <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>&lt;=5){
<a name="l00126"></a>00126                 <span class="keywordflow">for</span> (rank=0; rank&lt;multiQubit.<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>; rank++){
<a name="l00127"></a>00127                         <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>==rank){
<a name="l00128"></a>00128                                 <span class="keywordflow">if</span> (reportRank) {
<a name="l00129"></a>00129                                         printf(<span class="stringliteral">&quot;Reporting state from rank %d [\n&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>);
<a name="l00130"></a>00130                                         <span class="comment">//printf(&quot;\trank, index, real, imag\n&quot;);</span>
<a name="l00131"></a>00131                                         printf(<span class="stringliteral">&quot;real, imag\n&quot;</span>);
<a name="l00132"></a>00132                                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rank==0) {
<a name="l00133"></a>00133                                         printf(<span class="stringliteral">&quot;Reporting state [\n&quot;</span>);
<a name="l00134"></a>00134                                         printf(<span class="stringliteral">&quot;real, imag\n&quot;</span>);
<a name="l00135"></a>00135                                 }
<a name="l00136"></a>00136 
<a name="l00137"></a>00137                                 <span class="keywordflow">for</span>(index=0; index&lt;multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>; index++){
<a name="l00138"></a>00138                                         printf(<a class="code" href="precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a> <span class="stringliteral">&quot;, &quot;</span> <a class="code" href="precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a> <span class="stringliteral">&quot;\n&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[index], multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[index]);
<a name="l00139"></a>00139                                 }
<a name="l00140"></a>00140                                 <span class="keywordflow">if</span> (reportRank || rank==multiQubit.<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>-1) printf(<span class="stringliteral">&quot;]\n&quot;</span>);
<a name="l00141"></a>00141                         }
<a name="l00142"></a>00142                         <a class="code" href="qubits_8h.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77" title="Guarantees that all code up to the given point has been executed on all nodes.">syncQuESTEnv</a>(env);
<a name="l00143"></a>00143                 }
<a name="l00144"></a>00144         } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Error: reportStateToScreen will not print output for systems of more than 5 qubits.\n&quot;</span>);
<a name="l00145"></a>00145 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7fadb225fc385db789e844c87fcba9e1"></a><!-- doxytag: member="qubits.h::rotateAroundAxis" ref="a7fadb225fc385db789e844c87fcba9e1" args="(MultiQubit multiQubit, const int rotQubit, REAL angle, Vector unitAxis)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotateAroundAxis </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structVector.html">Vector</a>&nbsp;</td>
          <td class="paramname"> <em>unitAxis</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit a certain angle about an axis. </p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rotQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>angle</em>&nbsp;</td><td>angle by which to rotate in radians </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>unitAxis</em>&nbsp;</td><td>unit vector pointing along the axis about which to rotate. Does not need to be normalised </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00432">432</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00088">compactUnitary()</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00033">Vector::x</a>, <a class="el" href="qubits_8h_source.html#l00033">Vector::y</a>, and <a class="el" href="qubits_8h_source.html#l00033">Vector::z</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00432"></a>00432                                                                                              {
<a name="l00433"></a>00433         <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> alpha, beta;
<a name="l00434"></a>00434         alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> = cos(angle/2.0);
<a name="l00435"></a>00435         alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> = -sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#ad4e863651be7d6b7e2b28cd7445a0ccf">z</a>;        
<a name="l00436"></a>00436         beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> = 0;
<a name="l00437"></a>00437         beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> = -sin(angle/2.0)*(unitAxis.<a class="code" href="structVector.html#aac7abe171ba4bada50ed72acba6259fc">x</a> + unitAxis.<a class="code" href="structVector.html#a375ca805d4c808a53d7c4e0c737ae3de">y</a>);
<a name="l00438"></a>00438         <a class="code" href="qubits_8h.html#ad13ae1902276195d0df106116e032aff" title="Rotate a single qubit in the state vector of probability amplitudes.">compactUnitary</a>(multiQubit, rotQubit, alpha, beta);
<a name="l00439"></a>00439 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6cc7fa705a2f2e6b486b49c5589d5df5"></a><!-- doxytag: member="qubits.h::rotateX" ref="a6cc7fa705a2f2e6b486b49c5589d5df5" args="(MultiQubit multiQubit, const int rotQubit, REAL angle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotateX </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>angle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit a certain angle about the x-axis. </p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rotQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>angle</em>&nbsp;</td><td>angle by which to rotate in radians </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00450">450</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00088">compactUnitary()</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00033">Vector::x</a>, <a class="el" href="qubits_8h_source.html#l00033">Vector::y</a>, and <a class="el" href="qubits_8h_source.html#l00033">Vector::z</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00450"></a>00450                                                                    {
<a name="l00451"></a>00451         <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> alpha, beta;
<a name="l00452"></a>00452     <a class="code" href="structVector.html">Vector</a> unitAxis = {1, 0, 0};
<a name="l00453"></a>00453         alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> = cos(angle/2.0);
<a name="l00454"></a>00454         alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> = -sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#ad4e863651be7d6b7e2b28cd7445a0ccf">z</a>;        
<a name="l00455"></a>00455         beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> = 0;
<a name="l00456"></a>00456         beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> = -sin(angle/2.0)*(unitAxis.<a class="code" href="structVector.html#aac7abe171ba4bada50ed72acba6259fc">x</a> + unitAxis.<a class="code" href="structVector.html#a375ca805d4c808a53d7c4e0c737ae3de">y</a>);
<a name="l00457"></a>00457         <a class="code" href="qubits_8h.html#ad13ae1902276195d0df106116e032aff" title="Rotate a single qubit in the state vector of probability amplitudes.">compactUnitary</a>(multiQubit, rotQubit, alpha, beta);
<a name="l00458"></a>00458 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ace0d3592d38a990e81a434c4e9681500"></a><!-- doxytag: member="qubits.h::rotateY" ref="ace0d3592d38a990e81a434c4e9681500" args="(MultiQubit multiQubit, const int rotQubit, REAL angle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotateY </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>angle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit a certain angle about the y-axis. </p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rotQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>angle</em>&nbsp;</td><td>angle by which to rotate in radians </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00469">469</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00088">compactUnitary()</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00033">Vector::x</a>, <a class="el" href="qubits_8h_source.html#l00033">Vector::y</a>, and <a class="el" href="qubits_8h_source.html#l00033">Vector::z</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00469"></a>00469                                                                    {
<a name="l00470"></a>00470         <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> alpha, beta;
<a name="l00471"></a>00471     <a class="code" href="structVector.html">Vector</a> unitAxis = {0, 1, 0};
<a name="l00472"></a>00472         alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> = cos(angle/2.0);
<a name="l00473"></a>00473         alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> = -sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#ad4e863651be7d6b7e2b28cd7445a0ccf">z</a>;        
<a name="l00474"></a>00474         beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> = 0;
<a name="l00475"></a>00475         beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> = -sin(angle/2.0)*(unitAxis.<a class="code" href="structVector.html#aac7abe171ba4bada50ed72acba6259fc">x</a> + unitAxis.<a class="code" href="structVector.html#a375ca805d4c808a53d7c4e0c737ae3de">y</a>);
<a name="l00476"></a>00476         <a class="code" href="qubits_8h.html#ad13ae1902276195d0df106116e032aff" title="Rotate a single qubit in the state vector of probability amplitudes.">compactUnitary</a>(multiQubit, rotQubit, alpha, beta);
<a name="l00477"></a>00477 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="abd621412ad30c1b034f4ce153c4afe10"></a><!-- doxytag: member="qubits.h::rotateZ" ref="abd621412ad30c1b034f4ce153c4afe10" args="(MultiQubit multiQubit, const int rotQubit, REAL angle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotateZ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL&nbsp;</td>
          <td class="paramname"> <em>angle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit a certain angle about the z-axis. </p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rotQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>angle</em>&nbsp;</td><td>angle by which to rotate in radians </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l00488">488</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00088">compactUnitary()</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, <a class="el" href="qubits_8h_source.html#l00033">Vector::x</a>, <a class="el" href="qubits_8h_source.html#l00033">Vector::y</a>, and <a class="el" href="qubits_8h_source.html#l00033">Vector::z</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00488"></a>00488                                                                    {
<a name="l00489"></a>00489         <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> alpha, beta;
<a name="l00490"></a>00490     <a class="code" href="structVector.html">Vector</a> unitAxis = {0, 0, 1};
<a name="l00491"></a>00491         alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> = cos(angle/2.0);
<a name="l00492"></a>00492         alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> = -sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#ad4e863651be7d6b7e2b28cd7445a0ccf">z</a>;        
<a name="l00493"></a>00493         beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a> = 0;
<a name="l00494"></a>00494         beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a> = -sin(angle/2.0)*(unitAxis.<a class="code" href="structVector.html#aac7abe171ba4bada50ed72acba6259fc">x</a> + unitAxis.<a class="code" href="structVector.html#a375ca805d4c808a53d7c4e0c737ae3de">y</a>);
<a name="l00495"></a>00495         <a class="code" href="qubits_8h.html#ad13ae1902276195d0df106116e032aff" title="Rotate a single qubit in the state vector of probability amplitudes.">compactUnitary</a>(multiQubit, rotQubit, alpha, beta);
<a name="l00496"></a>00496 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1086d84d6a3d5b79137e2f27f18e67e0"></a><!-- doxytag: member="qubits.h::sGate" ref="a1086d84d6a3d5b79137e2f27f18e67e0" args="(MultiQubit multiQubit, const int rotQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01738">1738</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00153">phaseGate()</a>, and <a class="el" href="qubits_8h_source.html#l00066">S_GATE</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00193">test_sGate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01739"></a>01739 {
<a name="l01740"></a>01740                 <a class="code" href="qubits__env__local_8c.html#ae275b94c1a483dda43bf4ec947635605" title="Rotate a single qubit by {{1,0},{0,p}} where p is a phase term determined by the...">phaseGate</a>(multiQubit, rotQubit, <a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a>);
<a name="l01741"></a>01741 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="acda82bebb0a62f419eec9c1e0575daad"></a><!-- doxytag: member="qubits.h::sigmaX" ref="acda82bebb0a62f419eec9c1e0575daad" args="(MultiQubit multiQubit, const int rotQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaX </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{0,1},{1,0}} -- swap |0&gt; and |1&gt;. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rotQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00141">141</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00146">chunkIsUpper()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00239">exchangeStateVectors()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00213">getChunkPairId()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00232">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00044">MultiQubit::pairStateVec</a>, <a class="el" href="qubits__env__local_8c_source.html#l00200">QuESTAssert()</a>, <a class="el" href="qubits_8c_source.html#l01235">sigmaXDistributed()</a>, <a class="el" href="qubits_8c_source.html#l01175">sigmaXLocal()</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00078">test_sigmaX()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00142"></a>00142 {
<a name="l00143"></a>00143     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(rotQubit &gt;= 0 &amp;&amp; rotQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00144"></a>00144         <a class="code" href="qubits_8c.html#aa9e640bb2d0458c937c6a87dfeca0f23" title="Rotate a single qubit by {{0,1},{1,0}.">sigmaXLocal</a>(multiQubit, rotQubit);
<a name="l00145"></a>00145 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7b022c75cef77be046bd5d61e38a581e"></a><!-- doxytag: member="qubits.h::sigmaY" ref="a7b022c75cef77be046bd5d61e38a581e" args="(MultiQubit multiQubit, const int rotQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaY </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{0,-i},{i,0}} -- swap |0&gt; and |1&gt; and apply a phase of -i or i. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rotQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
  </table>
  </dd>
</dl>

<p><p>fix -- put duplicate code (sigmaX, sigmaY) in seperate function </p>
</p>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00147">147</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00146">chunkIsUpper()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00239">exchangeStateVectors()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00213">getChunkPairId()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00232">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00044">MultiQubit::pairStateVec</a>, <a class="el" href="qubits__env__local_8c_source.html#l00200">QuESTAssert()</a>, <a class="el" href="qubits_8c_source.html#l01442">sigmaYDistributed()</a>, <a class="el" href="qubits_8c_source.html#l01382">sigmaYLocal()</a>, and <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00107">test_sigmaY()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00148"></a>00148 {
<a name="l00149"></a>00149     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(rotQubit &gt;= 0 &amp;&amp; rotQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00150"></a>00150         <a class="code" href="qubits_8c.html#afcbb1dcbe070ad0ed1a72a23251b6a83" title="Rotate a single qubit by {{0,-i},{i,0}.">sigmaYLocal</a>(multiQubit, rotQubit);
<a name="l00151"></a>00151 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9c90f8302e4f1d8fda23def8753e50fe"></a><!-- doxytag: member="qubits.h::sigmaZ" ref="a9c90f8302e4f1d8fda23def8753e50fe" args="(MultiQubit multiQubit, const int rotQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaZ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{1,0},{{0,-1}} -- apply a phase of -1 to |1&gt;. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rotQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01733">1733</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00153">phaseGate()</a>, and <a class="el" href="qubits_8h_source.html#l00066">SIGMA_Z</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00136">test_sigmaZ()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01734"></a>01734 {
<a name="l01735"></a>01735                 <a class="code" href="qubits__env__local_8c.html#ae275b94c1a483dda43bf4ec947635605" title="Rotate a single qubit by {{1,0},{0,p}} where p is a phase term determined by the...">phaseGate</a>(multiQubit, rotQubit, <a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a>);
<a name="l01736"></a>01736 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8d31fe2d1ad4d01e2a1f5f6b8bc15b77"></a><!-- doxytag: member="qubits.h::syncQuESTEnv" ref="a8d31fe2d1ad4d01e2a1f5f6b8bc15b77" args="(QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void syncQuESTEnv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Guarantees that all code up to the given point has been executed on all nodes. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00019">19</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>Referenced by <a class="el" href="qubits_8c_source.html#l00334">initializeStateFromSingleFile()</a>, <a class="el" href="3sat_8c_source.html#l00101">main()</a>, <a class="el" href="qubits_8c_source.html#l00122">reportStateToScreen()</a>, and <a class="el" href="runTests_8c_source.html#l00249">test_controlledNot()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00019"></a>00019                                {
<a name="l00020"></a>00020         <span class="comment">// MPI Barrier goes here in MPI version. </span>
<a name="l00021"></a>00021 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac7e38d768a1bd79019f88cc1e6295092"></a><!-- doxytag: member="qubits.h::syncQuESTSuccess" ref="ac7e38d768a1bd79019f88cc1e6295092" args="(int successCode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int syncQuESTSuccess </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>successCode</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Performs a logical AND on all successCodes held by all processes. </p>
<p>If any one process has a zero successCode all processes will return a zero success code. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>successCode</em>&nbsp;</td><td>1 if process task succeeded, 0 if process task failed </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>1 if all processes succeeded, 0 if any one process failed </dd></dl>

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00023">23</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00760">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00023"></a>00023                                      {
<a name="l00024"></a>00024         <span class="keywordflow">return</span> successCode;
<a name="l00025"></a>00025 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5f33ddd690383fd09cc79bf143e383fb"></a><!-- doxytag: member="qubits.h::tGate" ref="a5f33ddd690383fd09cc79bf143e383fb" args="(MultiQubit multiQubit, const int rotQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits_8c_source.html#l01743">1743</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00153">phaseGate()</a>, and <a class="el" href="qubits_8h_source.html#l00066">T_GATE</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00221">test_tGate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01744"></a>01744 {
<a name="l01745"></a>01745                 <a class="code" href="qubits__env__local_8c.html#ae275b94c1a483dda43bf4ec947635605" title="Rotate a single qubit by {{1,0},{0,p}} where p is a phase term determined by the...">phaseGate</a>(multiQubit, rotQubit, <a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a>);
<a name="l01746"></a>01746 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae74806cf36513b6d8447439a5bc1d615"></a><!-- doxytag: member="qubits.h::unitary" ref="ae74806cf36513b6d8447439a5bc1d615" args="(MultiQubit multiQubit, const int rotQubit, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void unitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits__env__local_8c_source.html#l00097">97</a> of file <a class="el" href="qubits__env__local_8c_source.html">qubits_env_local.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00146">chunkIsUpper()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00239">exchangeStateVectors()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00213">getChunkPairId()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00192">getRotAngleFromUnitaryMatrix()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00232">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00046">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00044">MultiQubit::pairStateVec</a>, <a class="el" href="qubits__env__local_8c_source.html#l00200">QuESTAssert()</a>, <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::stateVec</a>, <a class="el" href="qubits_8c_source.html#l00704">unitaryDistributed()</a>, <a class="el" href="qubits_8c_source.html#l00575">unitaryLocal()</a>, and <a class="el" href="qubits_8c_source.html#l00383">validateMatrixIsUnitary()</a>.</p>

<p>Referenced by <a class="el" href="runTests_8c_source.html#l00403">test_unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00098"></a>00098 {
<a name="l00099"></a>00099     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(rotQubit &gt;= 0 &amp;&amp; rotQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00100"></a>00100     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(<a class="code" href="qubits_8c.html#ae4fea133d1a8f09ff8da03038100adb2">validateMatrixIsUnitary</a>(u), 5, __func__);
<a name="l00101"></a>00101 
<a name="l00102"></a>00102         <span class="comment">// all values required to update state vector lie in this rank</span>
<a name="l00103"></a>00103         <a class="code" href="qubits_8c.html#a5fd78353771c9a34832e7a3b1e90f4db">unitaryLocal</a>(multiQubit, rotQubit, u);
<a name="l00104"></a>00104 }
</pre></div></p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 5 Feb 2018 for Distributed QuEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
