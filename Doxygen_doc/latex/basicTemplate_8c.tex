\hypertarget{basicTemplate_8c}{}\subsection{basic\+Template.\+c File Reference}
\label{basicTemplate_8c}\index{basic\+Template.\+c@{basic\+Template.\+c}}


Basic template for using the Qu\+E\+ST library.  


{\ttfamily \#include $<$stdio.\+h$>$}\\*
{\ttfamily \#include $<$stdlib.\+h$>$}\\*
{\ttfamily \#include $<$time.\+h$>$}\\*
{\ttfamily \#include $<$math.\+h$>$}\\*
{\ttfamily \#include $<$unistd.\+h$>$}\\*
{\ttfamily \#include $<$string.\+h$>$}\\*
{\ttfamily \#include $<$omp.\+h$>$}\\*
{\ttfamily \#include \char`\"{}Qu\+E\+S\+T/qubits.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}Qu\+E\+S\+T/precision.\+h\char`\"{}}\\*
\subsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{basicTemplate_8c_a353abace49aefb52015b80290cf26d77}{Max\+Angles}~10
\begin{DoxyCompactList}\small\item\em Max number of angles used to define qubit rotation. \end{DoxyCompactList}\item 
\#define \hyperlink{basicTemplate_8c_a8e2ba5722f048e5a9cd58d09085f6cb1}{max\+Num\+Qubits}~40
\begin{DoxyCompactList}\small\item\em Max number of qubits in the system. \end{DoxyCompactList}\item 
\#define \hyperlink{basicTemplate_8c_a64394210bc1694536cbb8411d2bab5ed}{R\+E\+P\+O\+R\+T\+\_\+\+S\+T\+A\+TE}~1
\begin{DoxyCompactList}\small\item\em 1\+: print end qubit state to file, 0\+: don\textquotesingle{}t print \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{basicTemplate_8c_a0b1907e3d123f469a739aa425bd05574}{main} (int narg, char $\ast$$\ast$varg)
\end{DoxyCompactItemize}
\subsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const long double \hyperlink{basicTemplate_8c_a00c9db5f4f80636d4da765f0893743f6}{Pi} = 3.\+14159265358979323846264338327950288419716939937510
\end{DoxyCompactItemize}


\subsubsection{Detailed Description}
Basic template for using the Qu\+E\+ST library. 

In general, leave the initialisation and cleanup sections as they are and edit the rotations, measurement and phase gate sections. 

\subsubsection{Macro Definition Documentation}
\index{basic\+Template.\+c@{basic\+Template.\+c}!Max\+Angles@{Max\+Angles}}
\index{Max\+Angles@{Max\+Angles}!basic\+Template.\+c@{basic\+Template.\+c}}
\paragraph[{\texorpdfstring{Max\+Angles}{MaxAngles}}]{\setlength{\rightskip}{0pt plus 5cm}\#define Max\+Angles~10}\hypertarget{basicTemplate_8c_a353abace49aefb52015b80290cf26d77}{}\label{basicTemplate_8c_a353abace49aefb52015b80290cf26d77}


Max number of angles used to define qubit rotation. 



Definition at line 19 of file basic\+Template.\+c.



Referenced by main().

\index{basic\+Template.\+c@{basic\+Template.\+c}!max\+Num\+Qubits@{max\+Num\+Qubits}}
\index{max\+Num\+Qubits@{max\+Num\+Qubits}!basic\+Template.\+c@{basic\+Template.\+c}}
\paragraph[{\texorpdfstring{max\+Num\+Qubits}{maxNumQubits}}]{\setlength{\rightskip}{0pt plus 5cm}\#define max\+Num\+Qubits~40}\hypertarget{basicTemplate_8c_a8e2ba5722f048e5a9cd58d09085f6cb1}{}\label{basicTemplate_8c_a8e2ba5722f048e5a9cd58d09085f6cb1}


Max number of qubits in the system. 



Definition at line 21 of file basic\+Template.\+c.



Referenced by main().

\index{basic\+Template.\+c@{basic\+Template.\+c}!R\+E\+P\+O\+R\+T\+\_\+\+S\+T\+A\+TE@{R\+E\+P\+O\+R\+T\+\_\+\+S\+T\+A\+TE}}
\index{R\+E\+P\+O\+R\+T\+\_\+\+S\+T\+A\+TE@{R\+E\+P\+O\+R\+T\+\_\+\+S\+T\+A\+TE}!basic\+Template.\+c@{basic\+Template.\+c}}
\paragraph[{\texorpdfstring{R\+E\+P\+O\+R\+T\+\_\+\+S\+T\+A\+TE}{REPORT_STATE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define R\+E\+P\+O\+R\+T\+\_\+\+S\+T\+A\+TE~1}\hypertarget{basicTemplate_8c_a64394210bc1694536cbb8411d2bab5ed}{}\label{basicTemplate_8c_a64394210bc1694536cbb8411d2bab5ed}


1\+: print end qubit state to file, 0\+: don\textquotesingle{}t print 



Definition at line 23 of file basic\+Template.\+c.



Referenced by main().



\subsubsection{Function Documentation}
\index{basic\+Template.\+c@{basic\+Template.\+c}!main@{main}}
\index{main@{main}!basic\+Template.\+c@{basic\+Template.\+c}}
\paragraph[{\texorpdfstring{main(int narg, char $\ast$$\ast$varg)}{main(int narg, char **varg)}}]{\setlength{\rightskip}{0pt plus 5cm}int main (
\begin{DoxyParamCaption}
\item[{int}]{narg, }
\item[{char $\ast$$\ast$}]{varg}
\end{DoxyParamCaption}
)}\hypertarget{basicTemplate_8c_a0b1907e3d123f469a739aa425bd05574}{}\label{basicTemplate_8c_a0b1907e3d123f469a739aa425bd05574}


Definition at line 31 of file basic\+Template.\+c.



References calc\+Total\+Probability(), close\+Qu\+E\+S\+T\+Env(), control\+Phase\+Gate(), create\+Multi\+Qubit(), destroy\+Multi\+Qubit(), env, filter\+Out111(), find\+Probability\+Of\+Outcome(), Complex\+::imag, init\+Qu\+E\+S\+T\+Env(), init\+State\+Debug(), init\+State\+Zero(), Max\+Angles, max\+Num\+Qubits, measure\+In\+State(), prob\+Of\+Filter\+Out111(), quad\+C\+Phase\+Gate(), Qu\+E\+S\+T\+Env\+::rank, Complex\+::real, R\+E\+P\+O\+R\+T\+\_\+\+S\+T\+A\+TE, report\+Multi\+Qubit\+Params(), report\+Qu\+E\+S\+T\+Env(), report\+State(), report\+State\+To\+Screen(), and rotate\+Qubit().


\begin{DoxyCode}
31                                  \{
32 
33         \textcolor{comment}{//}
34         \textcolor{comment}{// ===== INITIALISATION}
35         \textcolor{comment}{//}
36         
37         \textcolor{comment}{// INIT ENVIRONMENT: ALWAYS REQUIRED ONCE AT BEGINNING OF PROGRAM}
38         \textcolor{comment}{// These two lines will automatically set up the environment (multinode,}
39         \textcolor{comment}{// openMP only etc)  }
40         \hyperlink{structQuESTEnv}{QuESTEnv} \hyperlink{runTests_8c_a5fd8ba97fcae3408ae6221dfc3cc1f93}{env};
41         \hyperlink{qubits_8h_ad84a3ce68d1ca02b4e3f741ea45b6054}{initQuESTEnv}(&env);
42 
43         \textcolor{comment}{// model vars}
44         \textcolor{keywordtype}{int} numQubits;
45         
46         \textcolor{comment}{// get number of qubits from command line argument}
47         \textcolor{keywordflow}{if} (narg >= 2) \{
48                 numQubits = atoi(varg[1]);
49                 \textcolor{keywordflow}{if} (numQubits < 1 || numQubits > \hyperlink{basicTemplate_8c_a8e2ba5722f048e5a9cd58d09085f6cb1}{maxNumQubits}) \{
50                         printf(\textcolor{stringliteral}{" *** error: argument %d out of range (1 -- %d)\(\backslash\)n"}, numQubits,maxNumQubits);
51                         exit (EXIT\_FAILURE);
52                 \}
53         \} \textcolor{keywordflow}{else} \{
54                 printf(\textcolor{stringliteral}{" *** error: too few arguments, number of qubits expected\(\backslash\)n"});
55                 exit (EXIT\_FAILURE);
56         \}
57 
58         \textcolor{comment}{// CREATE QUBIT OBJECT: REQUIRED ONCE PER MULTIQUBIT OBJECT     }
59         \textcolor{comment}{// Before doing any operations on a set of qubits, create the MultiQubit object that will be used
       to }
60         \textcolor{comment}{// represent the qubits}
61         \hyperlink{structMultiQubit}{MultiQubit} multiQubit; 
62         \hyperlink{qubits_8c_a9c02591bc64c2918503afa231d90d83f}{createMultiQubit}(&multiQubit, numQubits, env);
63         
64         \textcolor{comment}{// Reporting}
65         \textcolor{keywordflow}{if} (env.\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank}==0) \{
66                 printf(\textcolor{stringliteral}{"Demo of single qubit rotations.\(\backslash\)n"});
67         \}
68         \hyperlink{qubits_8c_aa5e77e0e64f3a4a3d3f5cc7382bffcd9}{reportMultiQubitParams}(multiQubit);
69         \hyperlink{qubits_8h_af8a14ae79c3fb2c0b5f6255cc37bebf9}{reportQuESTEnv}(env);
70 
71         \textcolor{comment}{// initialise the state to |0000..0>}
72         \hyperlink{qubits_8c_acb5b2eff794339090004d29f02a70d9a}{initStateZero} (&multiQubit);
73 
74 
75         \textcolor{comment}{//}
76         \textcolor{comment}{// ===== ROTATIONS}
77         \textcolor{comment}{//}
78 
79         \textcolor{comment}{// INITIALISE QUBIT ROTATION}
80         \textcolor{comment}{// Edit these lines to change rotation angle}
81         \textcolor{keywordtype}{double} ang1,ang2,ang3;
82         \hyperlink{structComplex}{Complex} alpha, beta;
83 
84         \textcolor{comment}{// define rotation angles}
85         \textcolor{keywordtype}{double} angles[\hyperlink{basicTemplate_8c_a353abace49aefb52015b80290cf26d77}{MaxAngles}][3] = \{
86                 \{ 1.2320,  0.4230, -0.6523\},
87                 \{ 2.1213,  0.0000,  3.6520\},
88                 \{-3.1213,  5.0230,  0.1230\},
89                 \{ 5.2341, -3.1001, -1.2340\},
90                 \{-0.1234, -0.9876,  4.1234\}
91         \};
92 
93         \textcolor{comment}{// rotate}
94         ang1 = angles[0][0];
95         ang2 = angles[0][1];
96         ang3 = angles[0][2];
97 
98         alpha.\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real} = cos(ang1) * cos(ang2);
99         alpha.\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag} = cos(ang1) * sin(ang2);
100         beta.\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real}  = sin(ang1) * cos(ang3);
101         beta.\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag}  = sin(ang1) * sin(ang3);
102 
103         \textcolor{keywordtype}{int} rotQubit;
104 
105         \textcolor{comment}{// DO QUBIT ROTATION}
106         \textcolor{keywordflow}{if} (env.\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank}==0) printf(\textcolor{stringliteral}{"\(\backslash\)nPerforming qubit rotation\(\backslash\)n"});
107         \textcolor{comment}{// Edit these lines to perform rotations as required}
108         \textcolor{keywordflow}{for} (rotQubit=0; rotQubit<numQubits; rotQubit++) \{
109                 \textcolor{comment}{// do rotation of each qubit}
110                 \hyperlink{qubits_8h_a4ba468aa69f812efd1f964e10a45ca2f}{rotateQubit}(multiQubit,rotQubit,alpha,beta);
111         \}
112         \textcolor{comment}{// END QUBIT ROTATION}
113 
114         \textcolor{comment}{// Verification: check vector size is unchanged}
115         \textcolor{keywordtype}{double} totalProbability;
116         totalProbability = \hyperlink{qubits_8h_a818a4c7cd7252d2b10b896b12fa431d3}{calcTotalProbability}(multiQubit);
117         \textcolor{keywordflow}{if} (env.\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank}==0) printf(\textcolor{stringliteral}{"VERIFICATION: total probability=%.14f\(\backslash\)n"}, totalProbability);
118 
119         \textcolor{comment}{// report state vector to file}
120         \textcolor{keywordflow}{if} (\hyperlink{basicTemplate_8c_a64394210bc1694536cbb8411d2bab5ed}{REPORT\_STATE})\{
121                 \hyperlink{qubits_8c_a96f4de9ce7fefc7680a44d601fc3d894}{reportState}(multiQubit);
122         \}
123 
124         \textcolor{comment}{//}
125         \textcolor{comment}{// ===== perform a measurement}
126         \textcolor{comment}{//}
127         \textcolor{keywordtype}{int} measureQubit;
128         \textcolor{keywordtype}{double} qProbability;
129 
130         \textcolor{comment}{// Do measurement on rotated qubits}
131         \textcolor{keywordflow}{if} (env.\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank}==0) printf(\textcolor{stringliteral}{"\(\backslash\)nPerforming single qubit measurement\(\backslash\)n"});
132         \textcolor{keywordflow}{for} (measureQubit=0; measureQubit<numQubits; measureQubit++) \{
133                 qProbability = \hyperlink{qubits_8h_ad315c941a51bc053d39ebfa2040fd32e}{findProbabilityOfOutcome}(multiQubit, measureQubit, 0
      );
134                 \textcolor{keywordflow}{if} (env.\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank}==0) printf(\textcolor{stringliteral}{"Probability of 0 for qubit %d = %.14f\(\backslash\)n"}, measureQubit, 
      qProbability);
135         \}
136         \textcolor{keywordflow}{if} (env.\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank}==0) printf(\textcolor{stringliteral}{"Measuring probability of qubit 0 to be in state 0 and then setting
       that qubit to 0\(\backslash\)n"});
137         qProbability = \hyperlink{qubits_8h_a88605f373c2401760aab0e08719e08dd}{measureInState}(multiQubit, 0, 0);
138         \textcolor{keywordflow}{if} (env.\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank}==0) printf(\textcolor{stringliteral}{"Probability of 0 for qubit %d = %.14f\(\backslash\)n"}, 0, qProbability);
139 
140         \textcolor{keywordflow}{if} (env.\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank}==0) printf(\textcolor{stringliteral}{"Performing single qubit measurement\(\backslash\)n"});
141         \textcolor{comment}{// Do measurement on state with q0=0}
142         \textcolor{keywordflow}{for} (measureQubit=0; measureQubit<numQubits; measureQubit++) \{
143                 qProbability = \hyperlink{qubits_8h_ad315c941a51bc053d39ebfa2040fd32e}{findProbabilityOfOutcome}(multiQubit, measureQubit, 0
      );
144                 \textcolor{keywordflow}{if} (env.\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank}==0) printf(\textcolor{stringliteral}{"Probability of 0 for qubit %d = %.14f\(\backslash\)n"}, measureQubit, 
      qProbability);
145         \}
146         totalProbability = \hyperlink{qubits_8h_a818a4c7cd7252d2b10b896b12fa431d3}{calcTotalProbability}(multiQubit);
147         \textcolor{keywordflow}{if} (env.\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank}==0) printf(\textcolor{stringliteral}{"VERIFICATION: total probability=%.14f\(\backslash\)n"}, totalProbability);
148         \textcolor{comment}{// filter out qubits}
149         qProbability = \hyperlink{qubits_8h_a909ba48b5a82c9f5c3a94d17a72b1aa3}{probOfFilterOut111}(multiQubit, 0, 1, 2);
150         \textcolor{keywordflow}{if} (env.\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank}==0) printf(\textcolor{stringliteral}{"Probability that !(q0=1 & q1=1 & q2=1) = %.14f\(\backslash\)n"}, qProbability);
151         totalProbability = \hyperlink{qubits_8h_a818a4c7cd7252d2b10b896b12fa431d3}{calcTotalProbability}(multiQubit);
152         \textcolor{keywordflow}{if} (env.\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank}==0) printf(\textcolor{stringliteral}{"VERIFICATION: total probability=%.14f\(\backslash\)n"}, totalProbability);
153 
154         qProbability = \hyperlink{qubits_8h_ae8fcabd3f22c6c9a9104e1807fb78f80}{filterOut111}(multiQubit, 1, 2, 3);
155         \textcolor{keywordflow}{if} (env.\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank}==0) printf(\textcolor{stringliteral}{"Probability that !(q1=1 & q2=1 & q3=1) = %.14f. Also filter out those
       states\(\backslash\)n"}, qProbability);
156         totalProbability = \hyperlink{qubits_8h_a818a4c7cd7252d2b10b896b12fa431d3}{calcTotalProbability}(multiQubit);
157         \textcolor{keywordflow}{if} (env.\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank}==0) printf(\textcolor{stringliteral}{"VERIFICATION: total probability=%.14f\(\backslash\)n"}, totalProbability);
158 
159         qProbability = \hyperlink{qubits_8h_a909ba48b5a82c9f5c3a94d17a72b1aa3}{probOfFilterOut111}(multiQubit, 1, 2, 3);
160         \textcolor{keywordflow}{if} (env.\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank}==0) printf(\textcolor{stringliteral}{"Probability that !(q1=1 & q2=1 & q3=1) = %.14f\(\backslash\)n"}, qProbability);
161         totalProbability = \hyperlink{qubits_8h_a818a4c7cd7252d2b10b896b12fa431d3}{calcTotalProbability}(multiQubit);
162         \textcolor{keywordflow}{if} (env.\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank}==0) printf(\textcolor{stringliteral}{"VERIFICATION: total probability=%.14f\(\backslash\)n"}, totalProbability);
163 
164 
165         \textcolor{comment}{//}
166         \textcolor{comment}{// ===== two qubit phase gate}
167         \textcolor{comment}{//}
168 
169         \textcolor{keywordflow}{if} (env.\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank}==0) printf(\textcolor{stringliteral}{"\(\backslash\)nPerforming 2 qubit phase gate\(\backslash\)n"});       
170         \hyperlink{qubits_8c_a03b3577a891731d505bc4b879fcca9d3}{initStateDebug}(&multiQubit);
171         \hyperlink{qubits_8c_a0ad4584e44f567c140b653ed36d26ccf}{controlPhaseGate}(multiQubit, 0, 2);
172         \hyperlink{qubits_8c_a842d6884e063a5865a2232cba56b65ac}{reportStateToScreen}(multiQubit, env, 0);
173         totalProbability = \hyperlink{qubits_8h_a818a4c7cd7252d2b10b896b12fa431d3}{calcTotalProbability}(multiQubit);
174         \textcolor{keywordflow}{if} (env.\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank}==0) printf(\textcolor{stringliteral}{"VERIFICATION: total probability=%.14f\(\backslash\)n"}, totalProbability);
175         \textcolor{keywordflow}{if} (env.\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank}==0) printf(\textcolor{stringliteral}{"Performing 4 qubit phase gate\(\backslash\)n"}); 
176         \hyperlink{qubits_8c_aca7765bd500718f98700a172351748cc}{quadCPhaseGate}(multiQubit, 0, 2, 3, 4);
177         totalProbability = \hyperlink{qubits_8h_a818a4c7cd7252d2b10b896b12fa431d3}{calcTotalProbability}(multiQubit);
178         \textcolor{keywordflow}{if} (env.\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank}==0) printf(\textcolor{stringliteral}{"VERIFICATION: total probability=%.14f\(\backslash\)n"}, totalProbability);
179         
180 
181         \textcolor{comment}{//}
182         \textcolor{comment}{// ======== CLEANUP}
183         \textcolor{comment}{//}
184         
185         \textcolor{comment}{// free memory}
186 
187         \textcolor{comment}{// REQUIRED ONCE PER MULTIQUBIT OBJECT  }
188         \textcolor{comment}{// When all operations on a set of qubits are completed, destroy the object}
189         \hyperlink{qubits_8c_ae5d6acc322314d7a3d8a2eccf00d3b19}{destroyMultiQubit}(multiQubit, env);
190 
191 
192         \textcolor{comment}{// ALWAYS REQUIRED ONCE AT END OF PROGRAM: }
193         \textcolor{comment}{// These two lines will perform any necessary cleanup of the environment (multinode,}
194         \textcolor{comment}{// openMP only etc)  }
195         \hyperlink{qubits_8h_abd4bc926cd3f9b65610bb228d0c59fe0}{closeQuESTEnv}(env);
196 
197         \textcolor{keywordflow}{return} EXIT\_SUCCESS;
198 \}
\end{DoxyCode}


\subsubsection{Variable Documentation}
\index{basic\+Template.\+c@{basic\+Template.\+c}!Pi@{Pi}}
\index{Pi@{Pi}!basic\+Template.\+c@{basic\+Template.\+c}}
\paragraph[{\texorpdfstring{Pi}{Pi}}]{\setlength{\rightskip}{0pt plus 5cm}const long double Pi = 3.\+14159265358979323846264338327950288419716939937510}\hypertarget{basicTemplate_8c_a00c9db5f4f80636d4da765f0893743f6}{}\label{basicTemplate_8c_a00c9db5f4f80636d4da765f0893743f6}


Definition at line 25 of file basic\+Template.\+c.

