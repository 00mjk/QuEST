\hypertarget{qubits_8h}{}\subsection{qubits.\+h File Reference}
\label{qubits_8h}\index{qubits.\+h@{qubits.\+h}}


The Q\+U\+E\+ST library A\+PI and objects.  


\subsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structComplexArray}{Complex\+Array}
\begin{DoxyCompactList}\small\item\em Represents an array of complex numbers grouped into an array of real components and an array of coressponding complex components. \end{DoxyCompactList}\item 
struct \hyperlink{structComplex}{Complex}
\begin{DoxyCompactList}\small\item\em Represents one complex number. \end{DoxyCompactList}\item 
struct \hyperlink{structMultiQubit}{Multi\+Qubit}
\begin{DoxyCompactList}\small\item\em Represents a system of qubits. \end{DoxyCompactList}\item 
struct \hyperlink{structQUESTEnv}{Q\+U\+E\+S\+T\+Env}
\begin{DoxyCompactList}\small\item\em Information about the environment the program is running in. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{structComplexArray}{Complex\+Array} \hyperlink{qubits_8h_a19e00739fde70a851d068f322cf915c8}{Complex\+Array}
\begin{DoxyCompactList}\small\item\em Represents an array of complex numbers grouped into an array of real components and an array of coressponding complex components. \end{DoxyCompactList}\item 
typedef struct \hyperlink{structComplex}{Complex} \hyperlink{qubits_8h_ad59c9e471673c07782e6c403277ffd8d}{Complex}
\begin{DoxyCompactList}\small\item\em Represents one complex number. \end{DoxyCompactList}\item 
typedef struct \hyperlink{structMultiQubit}{Multi\+Qubit} \hyperlink{qubits_8h_af4123a681074068eeeee1562758eef61}{Multi\+Qubit}
\begin{DoxyCompactList}\small\item\em Represents a system of qubits. \end{DoxyCompactList}\item 
typedef struct \hyperlink{structQUESTEnv}{Q\+U\+E\+S\+T\+Env} \hyperlink{qubits_8h_adac9ca7891d3939c6f722f2f4e347f69}{Q\+U\+E\+S\+T\+Env}
\begin{DoxyCompactList}\small\item\em Information about the environment the program is running in. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{qubits_8h_ae729f311efd2a426ce5161df3e017a16}{create\+Multi\+Qubit} (\hyperlink{structMultiQubit}{Multi\+Qubit} $\ast$multi\+Qubit, int num\+Qubits, \hyperlink{structQUESTEnv}{Q\+U\+E\+S\+T\+Env} env)
\begin{DoxyCompactList}\small\item\em Create a \hyperlink{structMultiQubit}{Multi\+Qubit} object representing a set of qubits. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_ab796aea79288b974f63474db650be878}{destroy\+Multi\+Qubit} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, \hyperlink{structQUESTEnv}{Q\+U\+E\+S\+T\+Env} env)
\begin{DoxyCompactList}\small\item\em Deallocate a \hyperlink{structMultiQubit}{Multi\+Qubit} object representing a set of qubits Free memory allocated to state vector of probability amplitudes, including temporary vector for values copied from another chunk if running the distributed version. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a96f4de9ce7fefc7680a44d601fc3d894}{report\+State} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit)
\begin{DoxyCompactList}\small\item\em Print the current state vector of probability amplitudes for a set of qubits to file. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_aa5e77e0e64f3a4a3d3f5cc7382bffcd9}{report\+Multi\+Qubit\+Params} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit)
\begin{DoxyCompactList}\small\item\em Report metainformation about a set of qubits\+: number of qubits, number of probability amplitudes. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a492d10377278f685c7a1fabc3ee60623}{init\+State\+Vec} (\hyperlink{structMultiQubit}{Multi\+Qubit} $\ast$multi\+Qubit)
\begin{DoxyCompactList}\small\item\em Initialise the state vector of probability amplitudes for a set of qubits to the zero state\+: $\vert$000...00$>$ \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_aca7765bd500718f98700a172351748cc}{quad\+C\+Phase\+Gate} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int id\+Qubit1, const int id\+Qubit2, const int id\+Qubit3, const int id\+Qubit4)
\begin{DoxyCompactList}\small\item\em The control phase (the four qubit phase gate). \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a0ad4584e44f567c140b653ed36d26ccf}{control\+Phase\+Gate} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int id\+Qubit1, const int id\+Qubit2)
\begin{DoxyCompactList}\small\item\em The control phase (the two qubit phase gate). \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a652d8c53f8f1cfb096133791de2b219d}{init\+Q\+U\+E\+S\+T\+Env} (\hyperlink{structQUESTEnv}{Q\+U\+E\+S\+T\+Env} $\ast$env)
\begin{DoxyCompactList}\small\item\em Initialize Q\+U\+E\+ST environment. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_ad7494473d827399d7fd9c327ea3a23e6}{close\+Q\+U\+E\+S\+T\+Env} (\hyperlink{structQUESTEnv}{Q\+U\+E\+S\+T\+Env} env)
\begin{DoxyCompactList}\small\item\em Close Q\+U\+E\+ST environment. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a83dffc500bf5b4e41dd63ba1ea9422ae}{sync\+Q\+U\+E\+S\+T\+Env} (\hyperlink{structQUESTEnv}{Q\+U\+E\+S\+T\+Env} env)
\begin{DoxyCompactList}\small\item\em Guarantees that all code up to the given point has been executed on all nodes. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_aa5d0566a6ef6519ff7b5241915fbf170}{report\+Q\+U\+E\+S\+T\+Env} (\hyperlink{structQUESTEnv}{Q\+U\+E\+S\+T\+Env} env)
\begin{DoxyCompactList}\small\item\em Report information about the Q\+U\+E\+ST environment. \end{DoxyCompactList}\item 
double \hyperlink{qubits_8h_a2205c8fde15213df52040dc3df233090}{calc\+Total\+Probability} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit)
\begin{DoxyCompactList}\small\item\em Calculate the probability of being in any state by taking the norm of the entire state vector. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a4ba468aa69f812efd1f964e10a45ca2f}{rotate\+Qubit} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int rot\+Qubit, \hyperlink{structComplex}{Complex} alpha, \hyperlink{structComplex}{Complex} beta)
\begin{DoxyCompactList}\small\item\em Rotate a single qubit in the state vector of probability amplitudes, given the angle rotation arguments. \end{DoxyCompactList}\item 
double \hyperlink{qubits_8h_af31016680d01044cee9321d4cae32703}{find\+Probability\+Of\+Zero} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int measure\+Qubit)
\begin{DoxyCompactList}\small\item\em Measure the probability of a specified qubit being in the zero state. \end{DoxyCompactList}\item 
double \hyperlink{qubits_8h_a766a8279a2d5c44fc7b98b412cea9858}{measure\+In\+Zero} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int measure\+Qubit)
\begin{DoxyCompactList}\small\item\em Update the state vector to be consistent with measuring measure\+Qubit=0. \end{DoxyCompactList}\item 
double \hyperlink{qubits_8h_a87e1ab604b0a2a3661d56f65b6d7cfdf}{filter\+Out111} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int id\+Qubit1, const int id\+Qubit2, const int id\+Qubit3)
\begin{DoxyCompactList}\small\item\em Updates the state according to this scenario\+: we ask \char`\"{}are these 3 qubits in 111\char`\"{} and the answer is \char`\"{}no\char`\"{}. \end{DoxyCompactList}\item 
double \hyperlink{qubits_8h_aa8d131d4bb4c696feb14107dad9e0611}{prob\+Of\+Filter\+Out111} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int id\+Qubit1, const int id\+Qubit2, const int id\+Qubit3)
\begin{DoxyCompactList}\small\item\em Evaluates the state according to this scenario\+: we ask \char`\"{}are these 3 qubits in 111\char`\"{} and the answer is \char`\"{}no\char`\"{}. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsubsection{Detailed Description}
The Q\+U\+E\+ST library A\+PI and objects. 



\subsubsection{Typedef Documentation}
\mbox{\Hypertarget{qubits_8h_ad59c9e471673c07782e6c403277ffd8d}\label{qubits_8h_ad59c9e471673c07782e6c403277ffd8d}} 
\index{qubits.\+h@{qubits.\+h}!Complex@{Complex}}
\index{Complex@{Complex}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{Complex}{Complex}}
{\footnotesize\ttfamily typedef struct \hyperlink{structComplex}{Complex}  \hyperlink{structComplex}{Complex}}



Represents one complex number. 

\mbox{\Hypertarget{qubits_8h_a19e00739fde70a851d068f322cf915c8}\label{qubits_8h_a19e00739fde70a851d068f322cf915c8}} 
\index{qubits.\+h@{qubits.\+h}!Complex\+Array@{Complex\+Array}}
\index{Complex\+Array@{Complex\+Array}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{Complex\+Array}{ComplexArray}}
{\footnotesize\ttfamily typedef struct \hyperlink{structComplexArray}{Complex\+Array}  \hyperlink{structComplexArray}{Complex\+Array}}



Represents an array of complex numbers grouped into an array of real components and an array of coressponding complex components. 

\mbox{\Hypertarget{qubits_8h_af4123a681074068eeeee1562758eef61}\label{qubits_8h_af4123a681074068eeeee1562758eef61}} 
\index{qubits.\+h@{qubits.\+h}!Multi\+Qubit@{Multi\+Qubit}}
\index{Multi\+Qubit@{Multi\+Qubit}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{Multi\+Qubit}{MultiQubit}}
{\footnotesize\ttfamily typedef struct \hyperlink{structMultiQubit}{Multi\+Qubit}  \hyperlink{structMultiQubit}{Multi\+Qubit}}



Represents a system of qubits. 

Qubits are zero-\/based and the the first qubit is the rightmost \mbox{\Hypertarget{qubits_8h_adac9ca7891d3939c6f722f2f4e347f69}\label{qubits_8h_adac9ca7891d3939c6f722f2f4e347f69}} 
\index{qubits.\+h@{qubits.\+h}!Q\+U\+E\+S\+T\+Env@{Q\+U\+E\+S\+T\+Env}}
\index{Q\+U\+E\+S\+T\+Env@{Q\+U\+E\+S\+T\+Env}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{Q\+U\+E\+S\+T\+Env}{QUESTEnv}}
{\footnotesize\ttfamily typedef struct \hyperlink{structQUESTEnv}{Q\+U\+E\+S\+T\+Env}  \hyperlink{structQUESTEnv}{Q\+U\+E\+S\+T\+Env}}



Information about the environment the program is running in. 

In practice, this holds info about M\+PI ranks and helps to hide M\+PI initialization code 

\subsubsection{Function Documentation}
\mbox{\Hypertarget{qubits_8h_a2205c8fde15213df52040dc3df233090}\label{qubits_8h_a2205c8fde15213df52040dc3df233090}} 
\index{qubits.\+h@{qubits.\+h}!calc\+Total\+Probability@{calc\+Total\+Probability}}
\index{calc\+Total\+Probability@{calc\+Total\+Probability}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{calc\+Total\+Probability()}{calcTotalProbability()}}
{\footnotesize\ttfamily double calc\+Total\+Probability (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit }\end{DoxyParamCaption})}



Calculate the probability of being in any state by taking the norm of the entire state vector. 

Should be equal to 1. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em multi\+Qubit} & object representing a set of qubits \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
total probability 
\end{DoxyReturn}


Definition at line 37 of file qubits\+\_\+env\+\_\+local.\+c.



References D\+E\+B\+UG, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Chunks, Complex\+Array\+::real, and Multi\+Qubit\+::state\+Vec.



Referenced by main().


\begin{DoxyCode}
37                                                   \{
38         \textcolor{keywordtype}{double} pTotal=0; 
39         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
40         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numAmpsPerRank = multiQubit.\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps};
41         \textcolor{keywordflow}{for} (index=0; index<numAmpsPerRank; index++)\{ 
42                 pTotal+=multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a1cf9fd31d6dce5ef618d2bcf3e4f8b69}{real}[index]*multiQubit.
      \hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a1cf9fd31d6dce5ef618d2bcf3e4f8b69}{real}[index];      
43                 pTotal+=multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_aa409fd14e1ff3e1fdcc53cc4eb77a7a8}{imag}[index]*multiQubit.
      \hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_aa409fd14e1ff3e1fdcc53cc4eb77a7a8}{imag}[index];      
44         \} 
45         \textcolor{keywordflow}{return} pTotal;
46 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_ad7494473d827399d7fd9c327ea3a23e6}\label{qubits_8h_ad7494473d827399d7fd9c327ea3a23e6}} 
\index{qubits.\+h@{qubits.\+h}!close\+Q\+U\+E\+S\+T\+Env@{close\+Q\+U\+E\+S\+T\+Env}}
\index{close\+Q\+U\+E\+S\+T\+Env@{close\+Q\+U\+E\+S\+T\+Env}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{close\+Q\+U\+E\+S\+T\+Env()}{closeQUESTEnv()}}
{\footnotesize\ttfamily void close\+Q\+U\+E\+S\+T\+Env (\begin{DoxyParamCaption}\item[{\hyperlink{structQUESTEnv}{Q\+U\+E\+S\+T\+Env}}]{env }\end{DoxyParamCaption})}



Close Q\+U\+E\+ST environment. 

If something needs to be done to clean up the execution environment, such as finalizing M\+PI when running in distributed mode, it is handled here 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em env} & object representing the execution environment. A single instance is used for each program \\
\hline
\end{DoxyParams}


Definition at line 21 of file qubits\+\_\+env\+\_\+local.\+c.



Referenced by main().


\begin{DoxyCode}
21                                 \{
22         \textcolor{comment}{// MPI finalize goes here in MPI version. Call this function anyway for consistency}
23 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a0ad4584e44f567c140b653ed36d26ccf}\label{qubits_8h_a0ad4584e44f567c140b653ed36d26ccf}} 
\index{qubits.\+h@{qubits.\+h}!control\+Phase\+Gate@{control\+Phase\+Gate}}
\index{control\+Phase\+Gate@{control\+Phase\+Gate}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{control\+Phase\+Gate()}{controlPhaseGate()}}
{\footnotesize\ttfamily void control\+Phase\+Gate (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{const int}]{id\+Qubit1,  }\item[{const int}]{id\+Qubit2 }\end{DoxyParamCaption})}



The control phase (the two qubit phase gate). 

For each state, if both input qubits are equal to zero, multiply the amplitude of that state by -\/1. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em id\+Qubit1,id\+Qubit2} & specified qubits \\
\hline
\end{DoxyParams}


Definition at line 505 of file qubits.\+c.



References extract\+Bit(), Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Qubits, Complex\+Array\+::real, and Multi\+Qubit\+::state\+Vec.



Referenced by main().


\begin{DoxyCode}
506 \{
507         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
508         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} stateVecSize;
509         \textcolor{keywordtype}{int} bit1, bit2;
510 
511         \textcolor{comment}{// ---------------------------------------------------------------- //}
512         \textcolor{comment}{//            tests                                                 //}
513         \textcolor{comment}{// ---------------------------------------------------------------- //}
514 
515         assert (idQubit1 >= 0 && idQubit2 >= 0 && idQubit1 < multiQubit.
      \hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits} && idQubit2 < multiQubit.\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits});
516 
517 
518         \textcolor{comment}{// ---------------------------------------------------------------- //}
519         \textcolor{comment}{//            initialise the state to |0000..0>                     //}
520         \textcolor{comment}{// ---------------------------------------------------------------- //}
521 
522         \textcolor{comment}{// dimension of the state vector}
523         stateVecSize = multiQubit.\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps};
524         \textcolor{keywordtype}{double} *stateVecReal = multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a1cf9fd31d6dce5ef618d2bcf3e4f8b69}{real};
525         \textcolor{keywordtype}{double} *stateVecImag = multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_aa409fd14e1ff3e1fdcc53cc4eb77a7a8}{imag};
526 
527 \textcolor{preprocessor}{# ifdef \_OPENMP}
528 \textcolor{preprocessor}{# pragma omp parallel for \(\backslash\)}
529 \textcolor{preprocessor}{        default  (none)                      \(\backslash\)}
530 \textcolor{preprocessor}{        shared   (stateVecSize, stateVecReal,stateVecImag ) \(\backslash\)}
531 \textcolor{preprocessor}{        private  (index,bit1,bit2)                     \(\backslash\)}
532 \textcolor{preprocessor}{        schedule (static)}
533 \textcolor{preprocessor}{# endif}
534         \textcolor{keywordflow}{for} (index=0; index<stateVecSize; index++) \{
535                 bit1 = \hyperlink{qubits_8c_a100463f6ec212c76a5fad99579000505}{extractBit} (idQubit1, index);
536                 bit2 = \hyperlink{qubits_8c_a100463f6ec212c76a5fad99579000505}{extractBit} (idQubit2, index);
537                 \textcolor{keywordflow}{if} (bit1 && bit2) \{
538                         stateVecReal [index] = - stateVecReal [index];
539                         stateVecImag [index] = - stateVecImag [index];
540                 \}
541         \}
542 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_ae729f311efd2a426ce5161df3e017a16}\label{qubits_8h_ae729f311efd2a426ce5161df3e017a16}} 
\index{qubits.\+h@{qubits.\+h}!create\+Multi\+Qubit@{create\+Multi\+Qubit}}
\index{create\+Multi\+Qubit@{create\+Multi\+Qubit}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{create\+Multi\+Qubit()}{createMultiQubit()}}
{\footnotesize\ttfamily void create\+Multi\+Qubit (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit} $\ast$}]{multi\+Qubit,  }\item[{int}]{num\+Qubits,  }\item[{\hyperlink{structQUESTEnv}{Q\+U\+E\+S\+T\+Env}}]{env }\end{DoxyParamCaption})}



Create a \hyperlink{structMultiQubit}{Multi\+Qubit} object representing a set of qubits. 

Allocate space for state vector of probability amplitudes, including space for temporary values to be copied from one other chunk if running the distributed version. Define properties related to the size of the set of qubits. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em num\+Qubits} & number of qubits in the system \\
\hline
\mbox{\tt in}  & {\em env} & object representing the execution environment (local, multinode etc) \\
\hline
\end{DoxyParams}


Definition at line 24 of file qubits.\+c.



References Multi\+Qubit\+::chunk\+Id, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Chunks, Multi\+Qubit\+::num\+Qubits, Q\+U\+E\+S\+T\+Env\+::num\+Ranks, Multi\+Qubit\+::pair\+State\+Vec, Q\+U\+E\+S\+T\+Env\+::rank, Complex\+Array\+::real, and Multi\+Qubit\+::state\+Vec.



Referenced by main().


\begin{DoxyCode}
25 \{
26         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numAmps = 1L << numQubits;
27         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numAmpsPerRank = numAmps/env.\hyperlink{structQUESTEnv_ab9d9ce82e2d5f1b39aa9efc3accb3742}{numRanks};
28 
29         multiQubit->\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a1cf9fd31d6dce5ef618d2bcf3e4f8b69}{real} = malloc(numAmpsPerRank * \textcolor{keyword}{sizeof}(multiQubit->
      \hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a1cf9fd31d6dce5ef618d2bcf3e4f8b69}{real}));
30         multiQubit->\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_aa409fd14e1ff3e1fdcc53cc4eb77a7a8}{imag} = malloc(numAmpsPerRank * \textcolor{keyword}{sizeof}(multiQubit->
      \hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_aa409fd14e1ff3e1fdcc53cc4eb77a7a8}{imag}));
31         \textcolor{keywordflow}{if} (env.\hyperlink{structQUESTEnv_ab9d9ce82e2d5f1b39aa9efc3accb3742}{numRanks}>1)\{
32                 multiQubit->\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}.\hyperlink{structComplexArray_a1cf9fd31d6dce5ef618d2bcf3e4f8b69}{real} = malloc(numAmpsPerRank * \textcolor{keyword}{sizeof}(multiQubit->
      \hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}.\hyperlink{structComplexArray_a1cf9fd31d6dce5ef618d2bcf3e4f8b69}{real}));
33                 multiQubit->\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}.\hyperlink{structComplexArray_aa409fd14e1ff3e1fdcc53cc4eb77a7a8}{imag} = malloc(numAmpsPerRank * \textcolor{keyword}{sizeof}(multiQubit->
      \hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}.\hyperlink{structComplexArray_aa409fd14e1ff3e1fdcc53cc4eb77a7a8}{imag}));
34         \}
35 
36         \textcolor{keywordflow}{if} ( (!(multiQubit->\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a1cf9fd31d6dce5ef618d2bcf3e4f8b69}{real}) || !(multiQubit->\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.
      \hyperlink{structComplexArray_aa409fd14e1ff3e1fdcc53cc4eb77a7a8}{imag}))
37                  && numAmpsPerRank ) \{
38                 printf(\textcolor{stringliteral}{"Could not allocate memory!"});
39                 exit (EXIT\_FAILURE);
40         \}
41 
42         \textcolor{keywordflow}{if} ( env.\hyperlink{structQUESTEnv_ab9d9ce82e2d5f1b39aa9efc3accb3742}{numRanks}>1 && (!(multiQubit->\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}.
      \hyperlink{structComplexArray_a1cf9fd31d6dce5ef618d2bcf3e4f8b69}{real}) || !(multiQubit->\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}.\hyperlink{structComplexArray_aa409fd14e1ff3e1fdcc53cc4eb77a7a8}{imag}))
43                  && numAmpsPerRank ) \{
44                 printf(\textcolor{stringliteral}{"Could not allocate memory!"});
45                 exit (EXIT\_FAILURE);
46         \}
47 
48         multiQubit->\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits} = numQubits;
49         multiQubit->\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps} = numAmpsPerRank;
50         multiQubit->\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId} = env.\hyperlink{structQUESTEnv_a1bdb6d425a2ce6a468f93929c0b26d73}{rank};
51         multiQubit->\hyperlink{structMultiQubit_acd43f2f57991709c9e94f73662c972b2}{numChunks} = env.\hyperlink{structQUESTEnv_ab9d9ce82e2d5f1b39aa9efc3accb3742}{numRanks};
52 
53 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_ab796aea79288b974f63474db650be878}\label{qubits_8h_ab796aea79288b974f63474db650be878}} 
\index{qubits.\+h@{qubits.\+h}!destroy\+Multi\+Qubit@{destroy\+Multi\+Qubit}}
\index{destroy\+Multi\+Qubit@{destroy\+Multi\+Qubit}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{destroy\+Multi\+Qubit()}{destroyMultiQubit()}}
{\footnotesize\ttfamily void destroy\+Multi\+Qubit (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{\hyperlink{structQUESTEnv}{Q\+U\+E\+S\+T\+Env}}]{env }\end{DoxyParamCaption})}



Deallocate a \hyperlink{structMultiQubit}{Multi\+Qubit} object representing a set of qubits Free memory allocated to state vector of probability amplitudes, including temporary vector for values copied from another chunk if running the distributed version. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object to be deallocated \\
\hline
\mbox{\tt in}  & {\em env} & object representing the execution environment (local, multinode etc) \\
\hline
\end{DoxyParams}


Definition at line 60 of file qubits.\+c.



References Complex\+Array\+::imag, Q\+U\+E\+S\+T\+Env\+::num\+Ranks, Multi\+Qubit\+::pair\+State\+Vec, Complex\+Array\+::real, and Multi\+Qubit\+::state\+Vec.



Referenced by main().


\begin{DoxyCode}
60                                                            \{
61         free(multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a1cf9fd31d6dce5ef618d2bcf3e4f8b69}{real});
62         free(multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_aa409fd14e1ff3e1fdcc53cc4eb77a7a8}{imag});
63         \textcolor{keywordflow}{if} (env.\hyperlink{structQUESTEnv_ab9d9ce82e2d5f1b39aa9efc3accb3742}{numRanks}>1)\{
64                 free(multiQubit.\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}.\hyperlink{structComplexArray_a1cf9fd31d6dce5ef618d2bcf3e4f8b69}{real});
65                 free(multiQubit.\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}.\hyperlink{structComplexArray_aa409fd14e1ff3e1fdcc53cc4eb77a7a8}{imag});
66         \}
67 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a87e1ab604b0a2a3661d56f65b6d7cfdf}\label{qubits_8h_a87e1ab604b0a2a3661d56f65b6d7cfdf}} 
\index{qubits.\+h@{qubits.\+h}!filter\+Out111@{filter\+Out111}}
\index{filter\+Out111@{filter\+Out111}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{filter\+Out111()}{filterOut111()}}
{\footnotesize\ttfamily double filter\+Out111 (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{const int}]{id\+Qubit1,  }\item[{const int}]{id\+Qubit2,  }\item[{const int}]{id\+Qubit3 }\end{DoxyParamCaption})}



Updates the state according to this scenario\+: we ask \char`\"{}are these 3 qubits in 111\char`\"{} and the answer is \char`\"{}no\char`\"{}. 

The function returns the probability of this outcome (if zero, it will exit with error) 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em id\+Qubit1,id\+Qubit2,id\+Qubit3} & specified qubits \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Total probability that the 3 qubits are not all in the 1 state. 
\end{DoxyReturn}


Definition at line 70 of file qubits\+\_\+env\+\_\+local.\+c.



References filter\+Out111\+Local(), and prob\+Of\+Filter\+Out111().


\begin{DoxyCode}
71 \{
72         \textcolor{keywordtype}{double} stateProb=0;
73         stateProb = \hyperlink{qubits__env__local_8c_aa8d131d4bb4c696feb14107dad9e0611}{probOfFilterOut111}(multiQubit, idQubit1, idQubit2, idQubit3);
74         \hyperlink{qubits_8c_a035d5fa11bf9c4d7d4aea56fd3ba1153}{filterOut111Local}(multiQubit, idQubit1, idQubit2, idQubit3, stateProb);
75         \textcolor{keywordflow}{return} stateProb;
76 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_af31016680d01044cee9321d4cae32703}\label{qubits_8h_af31016680d01044cee9321d4cae32703}} 
\index{qubits.\+h@{qubits.\+h}!find\+Probability\+Of\+Zero@{find\+Probability\+Of\+Zero}}
\index{find\+Probability\+Of\+Zero@{find\+Probability\+Of\+Zero}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{find\+Probability\+Of\+Zero()}{findProbabilityOfZero()}}
{\footnotesize\ttfamily double find\+Probability\+Of\+Zero (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{const int}]{measure\+Qubit }\end{DoxyParamCaption})}



Measure the probability of a specified qubit being in the zero state. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em measure\+Qubit} & qubit to measure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
probability of qubit measure\+Qubit being zero 
\end{DoxyReturn}


Definition at line 54 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, find\+Probability\+Of\+Zero\+Distributed(), find\+Probability\+Of\+Zero\+Local(), half\+Matrix\+Block\+Fits\+In\+Chunk(), is\+Chunk\+To\+Skip\+In\+Find\+P\+Zero(), and Multi\+Qubit\+::num\+Amps.



Referenced by main(), and measure\+In\+Zero().


\begin{DoxyCode}
56 \{
57         \textcolor{keywordtype}{double} stateProb=0;
58         stateProb = \hyperlink{qubits_8c_a1c0a25823add0bd9f925a9164dc21870}{findProbabilityOfZeroLocal}(multiQubit, measureQubit);
59         \textcolor{keywordflow}{return} stateProb;
60 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a652d8c53f8f1cfb096133791de2b219d}\label{qubits_8h_a652d8c53f8f1cfb096133791de2b219d}} 
\index{qubits.\+h@{qubits.\+h}!init\+Q\+U\+E\+S\+T\+Env@{init\+Q\+U\+E\+S\+T\+Env}}
\index{init\+Q\+U\+E\+S\+T\+Env@{init\+Q\+U\+E\+S\+T\+Env}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{init\+Q\+U\+E\+S\+T\+Env()}{initQUESTEnv()}}
{\footnotesize\ttfamily void init\+Q\+U\+E\+S\+T\+Env (\begin{DoxyParamCaption}\item[{\hyperlink{structQUESTEnv}{Q\+U\+E\+S\+T\+Env} $\ast$}]{env }\end{DoxyParamCaption})}



Initialize Q\+U\+E\+ST environment. 

If something needs to be done to set up the execution environment, such as initializing M\+PI when running in distributed mode, it is handled here 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em env} & object representing the execution environment. A single instance is used for each program \\
\hline
\end{DoxyParams}


Definition at line 11 of file qubits\+\_\+env\+\_\+local.\+c.



References D\+E\+B\+UG, Q\+U\+E\+S\+T\+Env\+::num\+Ranks, and Q\+U\+E\+S\+T\+Env\+::rank.



Referenced by main().


\begin{DoxyCode}
11                                 \{
12         \textcolor{comment}{// init MPI environment}
13         env->\hyperlink{structQUESTEnv_a1bdb6d425a2ce6a468f93929c0b26d73}{rank}=0;
14         env->\hyperlink{structQUESTEnv_ab9d9ce82e2d5f1b39aa9efc3accb3742}{numRanks}=1;
15 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a492d10377278f685c7a1fabc3ee60623}\label{qubits_8h_a492d10377278f685c7a1fabc3ee60623}} 
\index{qubits.\+h@{qubits.\+h}!init\+State\+Vec@{init\+State\+Vec}}
\index{init\+State\+Vec@{init\+State\+Vec}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{init\+State\+Vec()}{initStateVec()}}
{\footnotesize\ttfamily void init\+State\+Vec (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit} $\ast$}]{multi\+Qubit }\end{DoxyParamCaption})}



Initialise the state vector of probability amplitudes for a set of qubits to the zero state\+: $\vert$000...00$>$ 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits to be initialised \\
\hline
\end{DoxyParams}


Definition at line 122 of file qubits.\+c.



References Multi\+Qubit\+::chunk\+Id, D\+E\+B\+UG, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps, Complex\+Array\+::real, and Multi\+Qubit\+::state\+Vec.



Referenced by main().


\begin{DoxyCode}
123 \{
124         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} stateVecSize;
125         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
126 
127         \textcolor{comment}{// dimension of the state vector}
128         stateVecSize = multiQubit->\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps};
129 
130         \textcolor{comment}{// Can't use multiQubit->stateVec as a private OMP var}
131         \textcolor{keywordtype}{double} *stateVecReal = multiQubit->\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a1cf9fd31d6dce5ef618d2bcf3e4f8b69}{real};
132         \textcolor{keywordtype}{double} *stateVecImag = multiQubit->\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_aa409fd14e1ff3e1fdcc53cc4eb77a7a8}{imag};
133 
134         \textcolor{comment}{// initialise the state to |0000..0000>}
135 \textcolor{preprocessor}{# ifdef \_OPENMP}
136 \textcolor{preprocessor}{# pragma omp parallel \(\backslash\)}
137 \textcolor{preprocessor}{        default  (none) \(\backslash\)}
138 \textcolor{preprocessor}{        shared   (stateVecSize, stateVecReal, stateVecImag) \(\backslash\)}
139 \textcolor{preprocessor}{        private  (index) }
140 \textcolor{preprocessor}{# endif}
141         \{
142 \textcolor{preprocessor}{# ifdef \_OPENMP}
143 \textcolor{preprocessor}{                # pragma omp for schedule (static)}
144 \textcolor{preprocessor}{# endif}
145                 \textcolor{keywordflow}{for} (index=0; index<stateVecSize; index++) \{
146                         stateVecReal[index] = 0.0;
147                         stateVecImag[index] = 0.0;
148                 \}
149         \}
150 
151         \textcolor{keywordflow}{if} (multiQubit->\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId}==0)\{
152                 \textcolor{comment}{// zero state |0000..0000> has probability 1}
153                 stateVecReal[0] = 1.0;
154                 stateVecImag[0] = 0.0;
155         \}
156 
157         \textcolor{keywordflow}{if} (\hyperlink{qubits_8c_ad72dbcf6d0153db1b8d8a58001feed83}{DEBUG}) printf(\textcolor{stringliteral}{"COMPLETED INIT\(\backslash\)n"});
158 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a766a8279a2d5c44fc7b98b412cea9858}\label{qubits_8h_a766a8279a2d5c44fc7b98b412cea9858}} 
\index{qubits.\+h@{qubits.\+h}!measure\+In\+Zero@{measure\+In\+Zero}}
\index{measure\+In\+Zero@{measure\+In\+Zero}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{measure\+In\+Zero()}{measureInZero()}}
{\footnotesize\ttfamily double measure\+In\+Zero (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{const int}]{measure\+Qubit }\end{DoxyParamCaption})}



Update the state vector to be consistent with measuring measure\+Qubit=0. 

Measure in Zero performs an irreversible change to the state vector\+: it updates the vector according to the event that a zero have been measured on the qubit indicated by measure\+Qubit (where his label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measure\+Qubit=0. It then returns the probability of making this measurement.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em measure\+Qubit} & qubit to measure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
probability of qubit measure\+Qubit being zero 
\end{DoxyReturn}


Definition at line 62 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, find\+Probability\+Of\+Zero(), half\+Matrix\+Block\+Fits\+In\+Chunk(), is\+Chunk\+To\+Skip\+In\+Find\+P\+Zero(), measure\+In\+Zero\+Distributed\+Renorm(), measure\+In\+Zero\+Distributed\+Set\+Zero(), measure\+In\+Zero\+Local(), and Multi\+Qubit\+::num\+Amps.



Referenced by main().


\begin{DoxyCode}
63 \{
64         \textcolor{keywordtype}{double} stateProb;
65         stateProb = \hyperlink{qubits__env__local_8c_af31016680d01044cee9321d4cae32703}{findProbabilityOfZero}(multiQubit, measureQubit);
66         \hyperlink{qubits_8c_af77bdfeac8c0f5311e46fb523cbade7e}{measureInZeroLocal}(multiQubit, measureQubit, stateProb);
67         \textcolor{keywordflow}{return} stateProb;
68 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_aa8d131d4bb4c696feb14107dad9e0611}\label{qubits_8h_aa8d131d4bb4c696feb14107dad9e0611}} 
\index{qubits.\+h@{qubits.\+h}!prob\+Of\+Filter\+Out111@{prob\+Of\+Filter\+Out111}}
\index{prob\+Of\+Filter\+Out111@{prob\+Of\+Filter\+Out111}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{prob\+Of\+Filter\+Out111()}{probOfFilterOut111()}}
{\footnotesize\ttfamily double prob\+Of\+Filter\+Out111 (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{const int}]{id\+Qubit1,  }\item[{const int}]{id\+Qubit2,  }\item[{const int}]{id\+Qubit3 }\end{DoxyParamCaption})}



Evaluates the state according to this scenario\+: we ask \char`\"{}are these 3 qubits in 111\char`\"{} and the answer is \char`\"{}no\char`\"{}. 

The function returns the probability of this outcome (if zero, it will exit with error) 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em id\+Qubit1,id\+Qubit2,id\+Qubit3} & specified qubits \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Total probability that the 3 qubits are not all in the 1 state. 
\end{DoxyReturn}


Definition at line 78 of file qubits\+\_\+env\+\_\+local.\+c.



References prob\+Of\+Filter\+Out111\+Local().



Referenced by filter\+Out111().


\begin{DoxyCode}
79 \{
80         \textcolor{keywordtype}{double} stateProb=0, totalStateProb=0;
81         stateProb = \hyperlink{qubits_8c_a9a91a155770436fcf14487cd1a45585d}{probOfFilterOut111Local}(multiQubit, idQubit1, idQubit2, idQubit3
      );
82         \textcolor{keywordflow}{return} totalStateProb;
83 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_aca7765bd500718f98700a172351748cc}\label{qubits_8h_aca7765bd500718f98700a172351748cc}} 
\index{qubits.\+h@{qubits.\+h}!quad\+C\+Phase\+Gate@{quad\+C\+Phase\+Gate}}
\index{quad\+C\+Phase\+Gate@{quad\+C\+Phase\+Gate}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{quad\+C\+Phase\+Gate()}{quadCPhaseGate()}}
{\footnotesize\ttfamily void quad\+C\+Phase\+Gate (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{const int}]{id\+Qubit1,  }\item[{const int}]{id\+Qubit2,  }\item[{const int}]{id\+Qubit3,  }\item[{const int}]{id\+Qubit4 }\end{DoxyParamCaption})}



The control phase (the four qubit phase gate). 

For each state, if all four input qubits are equal to zero, multiply the amplitude of that state by -\/1. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em id\+Qubit1,id\+Qubit2,id\+Qubit3,id\+Qubit4} & specified qubits \\
\hline
\end{DoxyParams}


Definition at line 549 of file qubits.\+c.



References extract\+Bit(), Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Qubits, Complex\+Array\+::real, and Multi\+Qubit\+::state\+Vec.



Referenced by main().


\begin{DoxyCode}
551 \{
552         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
553         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} stateVecSize;
554         \textcolor{keywordtype}{int} bit1, bit2, bit3, bit4;
555 
556         \textcolor{comment}{// ---------------------------------------------------------------- //}
557         \textcolor{comment}{//            tests                                                 //}
558         \textcolor{comment}{// ---------------------------------------------------------------- //}
559         assert (idQubit1 >= 0 && idQubit2 >= 0 && idQubit1 < multiQubit.
      \hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits} && idQubit2 < multiQubit.\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits});
560 
561         stateVecSize = multiQubit.\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps};
562         \textcolor{keywordtype}{double} *stateVecReal = multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a1cf9fd31d6dce5ef618d2bcf3e4f8b69}{real};
563         \textcolor{keywordtype}{double} *stateVecImag = multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_aa409fd14e1ff3e1fdcc53cc4eb77a7a8}{imag};
564 
565 \textcolor{preprocessor}{# ifdef \_OPENMP}
566 \textcolor{preprocessor}{# pragma omp parallel \(\backslash\)}
567 \textcolor{preprocessor}{        default  (none)                      \(\backslash\)}
568 \textcolor{preprocessor}{        shared   (stateVecSize, stateVecReal,stateVecImag ) \(\backslash\)}
569 \textcolor{preprocessor}{        private  (index,bit1,bit2,bit3,bit4)}
570 \textcolor{preprocessor}{# endif}
571         \{
572 \textcolor{preprocessor}{# ifdef \_OPENMP}
573 \textcolor{preprocessor}{                # pragma omp for schedule (static)}
574 \textcolor{preprocessor}{# endif}
575                 \textcolor{keywordflow}{for} (index=0; index<stateVecSize; index++) \{
576                         bit1 = \hyperlink{qubits_8c_a100463f6ec212c76a5fad99579000505}{extractBit} (idQubit1, index);
577                         bit2 = \hyperlink{qubits_8c_a100463f6ec212c76a5fad99579000505}{extractBit} (idQubit2, index);
578                         bit3 = \hyperlink{qubits_8c_a100463f6ec212c76a5fad99579000505}{extractBit} (idQubit3, index);
579                         bit4 = \hyperlink{qubits_8c_a100463f6ec212c76a5fad99579000505}{extractBit} (idQubit4, index);
580                         \textcolor{keywordflow}{if} (bit1 && bit2 && bit3 && bit4) \{
581                                 stateVecReal [index] = - stateVecReal [index];
582                                 stateVecImag [index] = - stateVecImag [index];
583                         \}
584                 \}
585         \}
586 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_aa5e77e0e64f3a4a3d3f5cc7382bffcd9}\label{qubits_8h_aa5e77e0e64f3a4a3d3f5cc7382bffcd9}} 
\index{qubits.\+h@{qubits.\+h}!report\+Multi\+Qubit\+Params@{report\+Multi\+Qubit\+Params}}
\index{report\+Multi\+Qubit\+Params@{report\+Multi\+Qubit\+Params}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{report\+Multi\+Qubit\+Params()}{reportMultiQubitParams()}}
{\footnotesize\ttfamily void report\+Multi\+Qubit\+Params (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit }\end{DoxyParamCaption})}



Report metainformation about a set of qubits\+: number of qubits, number of probability amplitudes. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em env} & object representing the execution environment (local, multinode etc) \\
\hline
\end{DoxyParams}


Definition at line 107 of file qubits.\+c.



References Multi\+Qubit\+::chunk\+Id, Multi\+Qubit\+::num\+Chunks, and Multi\+Qubit\+::num\+Qubits.



Referenced by main().


\begin{DoxyCode}
107                                                   \{
108         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numAmps = 1L << multiQubit.\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits};
109         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numAmpsPerRank = numAmps/multiQubit.\hyperlink{structMultiQubit_acd43f2f57991709c9e94f73662c972b2}{numChunks};
110         \textcolor{keywordflow}{if} (multiQubit.\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId}==0)\{
111                 printf(\textcolor{stringliteral}{"QUBITS:\(\backslash\)n"});
112                 printf(\textcolor{stringliteral}{"Number of qubits is %d.\(\backslash\)n"}, multiQubit.\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits});
113                 printf(\textcolor{stringliteral}{"Number of amps is %lld.\(\backslash\)n"}, numAmps);
114                 printf(\textcolor{stringliteral}{"Number of amps per rank is %lld.\(\backslash\)n"}, numAmpsPerRank);
115         \}
116 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_aa5d0566a6ef6519ff7b5241915fbf170}\label{qubits_8h_aa5d0566a6ef6519ff7b5241915fbf170}} 
\index{qubits.\+h@{qubits.\+h}!report\+Q\+U\+E\+S\+T\+Env@{report\+Q\+U\+E\+S\+T\+Env}}
\index{report\+Q\+U\+E\+S\+T\+Env@{report\+Q\+U\+E\+S\+T\+Env}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{report\+Q\+U\+E\+S\+T\+Env()}{reportQUESTEnv()}}
{\footnotesize\ttfamily void report\+Q\+U\+E\+S\+T\+Env (\begin{DoxyParamCaption}\item[{\hyperlink{structQUESTEnv}{Q\+U\+E\+S\+T\+Env}}]{env }\end{DoxyParamCaption})}



Report information about the Q\+U\+E\+ST environment. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em env} & object representing the execution environment. A single instance is used for each program \\
\hline
\end{DoxyParams}


Definition at line 25 of file qubits\+\_\+env\+\_\+local.\+c.



References Q\+U\+E\+S\+T\+Env\+::num\+Ranks, and Q\+U\+E\+S\+T\+Env\+::rank.



Referenced by main().


\begin{DoxyCode}
25                                  \{
26         printf(\textcolor{stringliteral}{"EXECUTION ENVIRONMENT:\(\backslash\)n"});
27         printf(\textcolor{stringliteral}{"Running locally on one node\(\backslash\)n"});
28         printf(\textcolor{stringliteral}{"Number of ranks is %d\(\backslash\)n"}, env.\hyperlink{structQUESTEnv_ab9d9ce82e2d5f1b39aa9efc3accb3742}{numRanks});
29 \textcolor{preprocessor}{# ifdef \_OPENMP}
30         printf(\textcolor{stringliteral}{"OpenMP enabled\(\backslash\)n"});
31         printf(\textcolor{stringliteral}{"Number of threads available is %d\(\backslash\)n"}, omp\_get\_max\_threads());
32 \textcolor{preprocessor}{# else}
33         printf(\textcolor{stringliteral}{"OpenMP disabled\(\backslash\)n"});
34 \textcolor{preprocessor}{# endif}
35 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a96f4de9ce7fefc7680a44d601fc3d894}\label{qubits_8h_a96f4de9ce7fefc7680a44d601fc3d894}} 
\index{qubits.\+h@{qubits.\+h}!report\+State@{report\+State}}
\index{report\+State@{report\+State}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{report\+State()}{reportState()}}
{\footnotesize\ttfamily void report\+State (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit }\end{DoxyParamCaption})}



Print the current state vector of probability amplitudes for a set of qubits to file. 

File format\+: \begin{DoxyVerb}real, imag
realComponent1, imagComponent1
realComponent2, imagComponent2
...
realComponentN, imagComponentN
\end{DoxyVerb}


File naming convention\+:

For each node that the program runs on, a file \textquotesingle{}state\+\_\+rank\+\_\+\mbox{[}node\+\_\+rank\mbox{]}.csv\textquotesingle{} is generated. If there is more than one node, ranks after the first do not include the header \begin{DoxyVerb}real, imag
\end{DoxyVerb}
 so that files are easier to combine. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\end{DoxyParams}


Definition at line 89 of file qubits.\+c.



References Multi\+Qubit\+::chunk\+Id, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps, Complex\+Array\+::real, and Multi\+Qubit\+::state\+Vec.



Referenced by main().


\begin{DoxyCode}
89                                        \{
90         FILE *state;
91         \textcolor{keywordtype}{char} filename[100];
92         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
93         sprintf(filename, \textcolor{stringliteral}{"state\_rank\_%d.csv"}, multiQubit.\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId});
94         state = fopen(filename, \textcolor{stringliteral}{"w"});
95         \textcolor{keywordflow}{if} (multiQubit.\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId}==0) fprintf(state, \textcolor{stringliteral}{"real, imag\(\backslash\)n"});
96 
97         \textcolor{keywordflow}{for}(index=0; index<multiQubit.\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps}; index++)\{
98                 fprintf(state, \textcolor{stringliteral}{"%.12f, %.12f\(\backslash\)n"}, multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.
      \hyperlink{structComplexArray_a1cf9fd31d6dce5ef618d2bcf3e4f8b69}{real}[index], multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_aa409fd14e1ff3e1fdcc53cc4eb77a7a8}{imag}[index]);
99         \}
100         fclose(state);
101 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a4ba468aa69f812efd1f964e10a45ca2f}\label{qubits_8h_a4ba468aa69f812efd1f964e10a45ca2f}} 
\index{qubits.\+h@{qubits.\+h}!rotate\+Qubit@{rotate\+Qubit}}
\index{rotate\+Qubit@{rotate\+Qubit}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{rotate\+Qubit()}{rotateQubit()}}
{\footnotesize\ttfamily void rotate\+Qubit (\begin{DoxyParamCaption}\item[{\hyperlink{structMultiQubit}{Multi\+Qubit}}]{multi\+Qubit,  }\item[{const int}]{rot\+Qubit,  }\item[{\hyperlink{structComplex}{Complex}}]{alpha,  }\item[{\hyperlink{structComplex}{Complex}}]{beta }\end{DoxyParamCaption})}



Rotate a single qubit in the state vector of probability amplitudes, given the angle rotation arguments. 

alpha\+Re = cos(angle1) $\ast$ cos(angle2) ~\newline
alpha\+Im = cos(angle1) $\ast$ sin(angle2) ~\newline
 beta\+Re = sin(angle1) $\ast$ cos(angle3) ~\newline
 beta\+Im = sin(angle1) $\ast$ sin(angle3) ~\newline


\begin{DoxyRemark}{Remarks}
Qubits are zero-\/based and the the first qubit is the rightmost
\end{DoxyRemark}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em rot\+Qubit} & qubit to rotate \\
\hline
\mbox{\tt in}  & {\em alpha} & rotation angle \\
\hline
\mbox{\tt in}  & {\em beta} & rotation angle \\
\hline
\end{DoxyParams}


Definition at line 48 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, chunk\+Is\+Upper(), get\+Chunk\+Pair\+Id(), get\+Rot\+Angle(), half\+Matrix\+Block\+Fits\+In\+Chunk(), Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::pair\+State\+Vec, Complex\+Array\+::real, rotate\+Qubit\+Distributed(), rotate\+Qubit\+Local(), and Multi\+Qubit\+::state\+Vec.



Referenced by main().


\begin{DoxyCode}
49 \{
50         \textcolor{comment}{// all values required to update state vector lie in this rank}
51         \hyperlink{qubits_8c_acb059cbcb8c7910a5fc43d21da4f5dea}{rotateQubitLocal}(multiQubit, rotQubit, alpha, beta);
52 \}
\end{DoxyCode}
\mbox{\Hypertarget{qubits_8h_a83dffc500bf5b4e41dd63ba1ea9422ae}\label{qubits_8h_a83dffc500bf5b4e41dd63ba1ea9422ae}} 
\index{qubits.\+h@{qubits.\+h}!sync\+Q\+U\+E\+S\+T\+Env@{sync\+Q\+U\+E\+S\+T\+Env}}
\index{sync\+Q\+U\+E\+S\+T\+Env@{sync\+Q\+U\+E\+S\+T\+Env}!qubits.\+h@{qubits.\+h}}
\paragraph{\texorpdfstring{sync\+Q\+U\+E\+S\+T\+Env()}{syncQUESTEnv()}}
{\footnotesize\ttfamily void sync\+Q\+U\+E\+S\+T\+Env (\begin{DoxyParamCaption}\item[{\hyperlink{structQUESTEnv}{Q\+U\+E\+S\+T\+Env}}]{env }\end{DoxyParamCaption})}



Guarantees that all code up to the given point has been executed on all nodes. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em env} & object representing the execution environment. A single instance is used for each program \\
\hline
\end{DoxyParams}


Definition at line 17 of file qubits\+\_\+env\+\_\+local.\+c.


\begin{DoxyCode}
17                                \{
18         \textcolor{comment}{// MPI Barrier goes here in MPI version. }
19 \} 
\end{DoxyCode}
