\hypertarget{qubits__env__local_8c}{
\subsection{qubits\_\-env\_\-local.c File Reference}
\label{qubits__env__local_8c}\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}}
}


An implementation of the API in \hyperlink{qubits_8h}{qubits.h} for a local (non-\/MPI) environment.  
{\ttfamily \#include $<$stdlib.h$>$}\par
{\ttfamily \#include $<$stdio.h$>$}\par
{\ttfamily \#include $<$omp.h$>$}\par
{\ttfamily \#include \char`\"{}qubits.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}qubits\_\-internal.h\char`\"{}}\par
\subsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{qubits__env__local_8c_a652d8c53f8f1cfb096133791de2b219d}{initQUESTEnv} (\hyperlink{structQUESTEnv}{QUESTEnv} $\ast$env)
\begin{DoxyCompactList}\small\item\em Initialize QUEST environment. \item\end{DoxyCompactList}\item 
void \hyperlink{qubits__env__local_8c_a83dffc500bf5b4e41dd63ba1ea9422ae}{syncQUESTEnv} (\hyperlink{structQUESTEnv}{QUESTEnv} env)
\begin{DoxyCompactList}\small\item\em Guarantees that all code up to the given point has been executed on all nodes. \item\end{DoxyCompactList}\item 
void \hyperlink{qubits__env__local_8c_ad7494473d827399d7fd9c327ea3a23e6}{closeQUESTEnv} (\hyperlink{structQUESTEnv}{QUESTEnv} env)
\begin{DoxyCompactList}\small\item\em Close QUEST environment. \item\end{DoxyCompactList}\item 
void \hyperlink{qubits__env__local_8c_aa5d0566a6ef6519ff7b5241915fbf170}{reportQUESTEnv} (\hyperlink{structQUESTEnv}{QUESTEnv} env)
\begin{DoxyCompactList}\small\item\em Report information about the QUEST environment. \item\end{DoxyCompactList}\item 
double \hyperlink{qubits__env__local_8c_a2205c8fde15213df52040dc3df233090}{calcTotalProbability} (\hyperlink{structMultiQubit}{MultiQubit} multiQubit)
\begin{DoxyCompactList}\small\item\em Calculate the probability of being in any state by taking the norm of the entire state vector. \item\end{DoxyCompactList}\item 
void \hyperlink{qubits__env__local_8c_a4ba468aa69f812efd1f964e10a45ca2f}{rotateQubit} (\hyperlink{structMultiQubit}{MultiQubit} multiQubit, const int rotQubit, \hyperlink{structComplex}{Complex} alpha, \hyperlink{structComplex}{Complex} beta)
\begin{DoxyCompactList}\small\item\em Rotate a single qubit in the state vector of probability amplitudes, given the angle rotation arguments. \item\end{DoxyCompactList}\item 
double \hyperlink{qubits__env__local_8c_af31016680d01044cee9321d4cae32703}{findProbabilityOfZero} (\hyperlink{structMultiQubit}{MultiQubit} multiQubit, const int measureQubit)
\begin{DoxyCompactList}\small\item\em Measure the probability of a specified qubit being in the zero state. \item\end{DoxyCompactList}\end{DoxyCompactItemize}


\subsubsection{Detailed Description}
An implementation of the API in \hyperlink{qubits_8h}{qubits.h} for a local (non-\/MPI) environment. 

Definition in file \hyperlink{qubits__env__local_8c_source}{qubits\_\-env\_\-local.c}.

\subsubsection{Function Documentation}
\hypertarget{qubits__env__local_8c_a2205c8fde15213df52040dc3df233090}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!calcTotalProbability@{calcTotalProbability}}
\index{calcTotalProbability@{calcTotalProbability}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{calcTotalProbability}]{\setlength{\rightskip}{0pt plus 5cm}double calcTotalProbability ({\bf MultiQubit} {\em multiQubit})}\hfill}
\label{qubits__env__local_8c_a2205c8fde15213df52040dc3df233090}


Calculate the probability of being in any state by taking the norm of the entire state vector. Should be equal to 1. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em multiQubit}]object representing a set of qubits \end{DoxyParams}
\begin{DoxyReturn}{Returns}
total probability 
\end{DoxyReturn}


Definition at line 37 of file qubits\_\-env\_\-local.c.

References ComplexArray::imag, MultiQubit::numAmps, ComplexArray::real, and MultiQubit::stateVec.


\begin{DoxyCode}
37                                                   {
38         double pTotal=0; 
39         long long int index;
40         long long int numAmpsPerRank = multiQubit.numAmps;
41         for (index=0; index<numAmpsPerRank; index++){ 
42                 pTotal+=multiQubit.stateVec.real[index]*multiQubit.stateVec.real[
      index];      
43                 pTotal+=multiQubit.stateVec.imag[index]*multiQubit.stateVec.imag[
      index];      
44         } 
45         return pTotal;
46 }
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_ad7494473d827399d7fd9c327ea3a23e6}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!closeQUESTEnv@{closeQUESTEnv}}
\index{closeQUESTEnv@{closeQUESTEnv}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{closeQUESTEnv}]{\setlength{\rightskip}{0pt plus 5cm}void closeQUESTEnv ({\bf QUESTEnv} {\em env})}\hfill}
\label{qubits__env__local_8c_ad7494473d827399d7fd9c327ea3a23e6}


Close QUEST environment. If something needs to be done to clean up the execution environment, such as finalizing MPI when running in distributed mode, it is handled here 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em env}]object representing the execution environment. A single instance is used for each program \end{DoxyParams}


Definition at line 21 of file qubits\_\-env\_\-local.c.


\begin{DoxyCode}
21                                 {
22         // MPI finalize goes here in MPI version. Call this function anyway for c
      onsistency
23 }
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_af31016680d01044cee9321d4cae32703}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!findProbabilityOfZero@{findProbabilityOfZero}}
\index{findProbabilityOfZero@{findProbabilityOfZero}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{findProbabilityOfZero}]{\setlength{\rightskip}{0pt plus 5cm}double findProbabilityOfZero ({\bf MultiQubit} {\em multiQubit}, \/  const int {\em measureQubit})}\hfill}
\label{qubits__env__local_8c_af31016680d01044cee9321d4cae32703}


Measure the probability of a specified qubit being in the zero state. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em multiQubit}]object representing the set of qubits to be initialised \item[\mbox{$\leftarrow$} {\em measureQubit}]qubit to measure \end{DoxyParams}
\begin{DoxyReturn}{Returns}
probability of qubit measureQubit being zero 
\end{DoxyReturn}


Definition at line 55 of file qubits\_\-env\_\-local.c.

References findProbabilityOfZeroLocal().


\begin{DoxyCode}
57 {
58         double stateProb=0;
59         stateProb = findProbabilityOfZeroLocal(multiQubit, measureQubit);
60         return stateProb;
61 }
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_a652d8c53f8f1cfb096133791de2b219d}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!initQUESTEnv@{initQUESTEnv}}
\index{initQUESTEnv@{initQUESTEnv}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{initQUESTEnv}]{\setlength{\rightskip}{0pt plus 5cm}void initQUESTEnv ({\bf QUESTEnv} $\ast$ {\em env})}\hfill}
\label{qubits__env__local_8c_a652d8c53f8f1cfb096133791de2b219d}


Initialize QUEST environment. If something needs to be done to set up the execution environment, such as initializing MPI when running in distributed mode, it is handled here 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftrightarrow$} {\em env}]object representing the execution environment. A single instance is used for each program \end{DoxyParams}


Definition at line 11 of file qubits\_\-env\_\-local.c.

References QUESTEnv::numRanks, and QUESTEnv::rank.


\begin{DoxyCode}
11                                 {
12         // init MPI environment
13         env->rank=0;
14         env->numRanks=1;
15 }
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_aa5d0566a6ef6519ff7b5241915fbf170}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!reportQUESTEnv@{reportQUESTEnv}}
\index{reportQUESTEnv@{reportQUESTEnv}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{reportQUESTEnv}]{\setlength{\rightskip}{0pt plus 5cm}void reportQUESTEnv ({\bf QUESTEnv} {\em env})}\hfill}
\label{qubits__env__local_8c_aa5d0566a6ef6519ff7b5241915fbf170}


Report information about the QUEST environment. 

Definition at line 25 of file qubits\_\-env\_\-local.c.

References QUESTEnv::numRanks.


\begin{DoxyCode}
25                                  {
26         printf("EXECUTION ENVIRONMENT:\n");
27         printf("Running locally on one node\n");
28         printf("Number of ranks is %d\n", env.numRanks);
29 # ifdef _OPENMP
30         printf("OpenMP enabled\n");
31         printf("Number of threads available is %d\n", omp_get_max_threads());
32 # else
33         printf("OpenMP disabled\n");
34 # endif
35 }
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_a4ba468aa69f812efd1f964e10a45ca2f}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!rotateQubit@{rotateQubit}}
\index{rotateQubit@{rotateQubit}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{rotateQubit}]{\setlength{\rightskip}{0pt plus 5cm}void rotateQubit ({\bf MultiQubit} {\em multiQubit}, \/  const int {\em rotQubit}, \/  {\bf Complex} {\em alpha}, \/  {\bf Complex} {\em beta})}\hfill}
\label{qubits__env__local_8c_a4ba468aa69f812efd1f964e10a45ca2f}


Rotate a single qubit in the state vector of probability amplitudes, given the angle rotation arguments. alphaRe = cos(angle1) $\ast$ cos(angle2) \par
 alphaIm = cos(angle1) $\ast$ sin(angle2) \par
 betaRe = sin(angle1) $\ast$ cos(angle3) \par
 betaIm = sin(angle1) $\ast$ sin(angle3) \par


\begin{DoxyRemark}{Remarks}
Qubits are zero-\/based and the the first qubit is the rightmost
\end{DoxyRemark}

\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftrightarrow$} {\em multiQubit}]object representing the set of qubits to be initialised \item[\mbox{$\leftarrow$} {\em rotQubit}]qubit to rotate \item[\mbox{$\leftarrow$} {\em alpha}]rotation angle \item[\mbox{$\leftarrow$} {\em beta}]rotation angle \end{DoxyParams}


Definition at line 48 of file qubits\_\-env\_\-local.c.

References rotateQubitLocal().


\begin{DoxyCode}
50 {
51         // all values required to update state vector lie in this rank
52         rotateQubitLocal(multiQubit, rotQubit, alpha, beta);
53 }
\end{DoxyCode}
\hypertarget{qubits__env__local_8c_a83dffc500bf5b4e41dd63ba1ea9422ae}{
\index{qubits\_\-env\_\-local.c@{qubits\_\-env\_\-local.c}!syncQUESTEnv@{syncQUESTEnv}}
\index{syncQUESTEnv@{syncQUESTEnv}!qubits_env_local.c@{qubits\_\-env\_\-local.c}}
\paragraph[{syncQUESTEnv}]{\setlength{\rightskip}{0pt plus 5cm}void syncQUESTEnv ({\bf QUESTEnv} {\em env})}\hfill}
\label{qubits__env__local_8c_a83dffc500bf5b4e41dd63ba1ea9422ae}


Guarantees that all code up to the given point has been executed on all nodes. 

Definition at line 17 of file qubits\_\-env\_\-local.c.


\begin{DoxyCode}
17                                {
18         // MPI Barrier goes here in MPI version. 
19 } 
\end{DoxyCode}
