<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Distributed QuEST: qubits_env_mpi.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>qubits_env_mpi.c File Reference</h1>
<p>An implementation of the API in <a class="el" href="qubits_8h.html" title="The QuEST library API and objects.">qubits.h</a> for an MPI environment.  
<a href="#_details">More...</a></p>
<code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &lt;mpi.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;omp.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="precision_8h_source.html">precision.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="qubits_8h_source.html">qubits.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="qubits__internal_8h_source.html">qubits_internal.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="mt19937ar_8h_source.html">mt19937ar.h</a>&quot;</code><br/>
<code>#include &lt;time.h&gt;</code><br/>
<code>#include &lt;sys/types.h&gt;</code><br/>

<p><a href="qubits__env__mpi_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#ad3d8a3bd0c0b677acef144f2c2ef6d73">_BSD_SOURCE</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>&nbsp;&nbsp;&nbsp;0</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#af0ea25f00987af4c53f17c9cca62ab41">isChunkToSkipInFindPZero</a> (int chunkId, long long int chunkSize, int measureQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find chunks to skip when calculating probability of qubit being zero.  <a href="#af0ea25f00987af4c53f17c9cca62ab41"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a> (int chunkId, long long int chunkSize, int targetQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns whether a given chunk in position chunkId is in the upper or lower half of a block.  <a href="#a0552889d6f57d9e0ed8b209bf426482d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#adb4b0373425b282abed27742d0ce0872">getRotAngle</a> (int chunkIsUpper, <a class="el" href="structComplex.html">Complex</a> *rot1, <a class="el" href="structComplex.html">Complex</a> *rot2, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get rotation values for a given chunk.  <a href="#adb4b0373425b282abed27742d0ce0872"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a> (int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">get position of corresponding chunk, holding values required to update values in my chunk (with chunkId) when rotating targetQubit.  <a href="#a7dba097f23f5d48dfdc9f3250444e2e4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a> (long long int chunkSize, int targetQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">return whether the current qubit rotation will use blocks that fit within a single chunk.  <a href="#a4d043bb0cee54a5f94faf3ffc34a6790"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#a8605e6a6295174cb4661156eaa709ec4">getChunkIdFromIndex</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, long long int index)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#ad84a3ce68d1ca02b4e3f741ea45b6054">initQuESTEnv</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> *env)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize the QuEST environment.  <a href="#ad84a3ce68d1ca02b4e3f741ea45b6054"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77">syncQuESTEnv</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Guarantees that all code up to the given point has been executed on all nodes (if running in distributed mode).  <a href="#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#ac7e38d768a1bd79019f88cc1e6295092">syncQuESTSuccess</a> (int successCode)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs a logical AND on all successCodes held by all processes.  <a href="#ac7e38d768a1bd79019f88cc1e6295092"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#abd4bc926cd3f9b65610bb228d0c59fe0">closeQuESTEnv</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Close QuEST environment.  <a href="#abd4bc926cd3f9b65610bb228d0c59fe0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#af8a14ae79c3fb2c0b5f6255cc37bebf9">reportQuESTEnv</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Report information about the QuEST environment.  <a href="#af8a14ae79c3fb2c0b5f6255cc37bebf9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#a62da5b58d8ce84e6f4d24be1b872294e">reportNodeList</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Report a list of CPU hostnames and the rank that is running on each if running with MPI enabled and an error message otherwise.  <a href="#a62da5b58d8ce84e6f4d24be1b872294e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#a317b786f577fa6bc136ea7f0ee7330a7">getRealAmpEl</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, long long int index)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the real component of the complex probability amplitude at an index in the state vector.  <a href="#a317b786f577fa6bc136ea7f0ee7330a7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#a3615f76fd5f57008d9b74bbd10533dd0">getImagAmpEl</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, long long int index)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the imaginary component of the complex probability amplitude at an index in the state vector.  <a href="#a3615f76fd5f57008d9b74bbd10533dd0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#a818a4c7cd7252d2b10b896b12fa431d3">calcTotalProbability</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate the probability of being in any state by taking the norm of the entire state vector.  <a href="#a818a4c7cd7252d2b10b896b12fa431d3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#a5c9b2f129bdffaaba9857f6eddecbb17">getRotAngleFromUnitaryMatrix</a> (int chunkIsUpper, <a class="el" href="structComplex.html">Complex</a> *rot1, <a class="el" href="structComplex.html">Complex</a> *rot2, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get rotation values for a given chunk given a unitary matrix.  <a href="#a5c9b2f129bdffaaba9857f6eddecbb17"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, int pairRank)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#a03b13dfcabd8c59b50dbdd3af44ba8b2">compactUnitary</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a single-qubit unitary parameterised by two given complex scalars.  <a href="#a03b13dfcabd8c59b50dbdd3af44ba8b2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#a7a0877e33700f6bad48adb51b7b3fb67">unitary</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a general single-qubit unitary (including a global phase factor).  <a href="#a7a0877e33700f6bad48adb51b7b3fb67"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#ab4812953bc457405b3aa05a4c2f64f4a">controlledCompactUnitary</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a controlled unitary (single control, single target) parameterised by two given complex scalars.  <a href="#ab4812953bc457405b3aa05a4c2f64f4a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#a8a701526263392599aa21d0d0f05d9d8">controlledUnitary</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a general controlled unitary (single control, single target), which can include a global phase factor.  <a href="#a8a701526263392599aa21d0d0f05d9d8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#ae395a79690283ed81106afadd7a8cd8a">multiControlledUnitary</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, int *controlQubits, const int numControlQubits, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a general multiple-control single-target unitary, which can include a global phase factor.  <a href="#ae395a79690283ed81106afadd7a8cd8a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#a86e396e06b7d527cac20ba0108872423">sigmaX</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply the single-qubit sigma-X (also known as the X, Pauli-X, NOT or bit-flip) gate.  <a href="#a86e396e06b7d527cac20ba0108872423"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#a67576895bbc65463481a8ea24d9b1e22">controlledNot</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply the controlled not (single control, single target) gate, also known as the c-X, c-sigma-X, c-Pauli-X and c-bit-flip gate.  <a href="#a67576895bbc65463481a8ea24d9b1e22"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#a1f54d70a42403f7e1c2e2c2007332f61">sigmaY</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply the single-qubit sigma-Y (also known as the Y or Pauli-Y) gate.  <a href="#a1f54d70a42403f7e1c2e2c2007332f61"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#aae7a8a7f1ccbddb7f76b6c52b746bb43">phaseGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, enum <a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a> type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#aa09b5dd93de6df1384b8f2c0041749ab">hadamard</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply the single-qubit Hadamard gate.  <a href="#aa09b5dd93de6df1384b8f2c0041749ab"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#ad315c941a51bc053d39ebfa2040fd32e">findProbabilityOfOutcome</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit, int outcome)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gives the probability of a specified qubit being measured in the given outcome (0 or 1).  <a href="#ad315c941a51bc053d39ebfa2040fd32e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#a07418ebac70fd9ae5d051d089961631d">collapseToOutcome</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit, int outcome)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Updates the state vector to be consistent with measuring the measure qubit in the given outcome (0 or 1), and returns the probability of such a measurement outcome.  <a href="#a07418ebac70fd9ae5d051d089961631d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#ad5774247d836267175c664cd0e451bcb">measure</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, int measureQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Measures a single qubit, collapsing it randomly to 0 or 1.  <a href="#ad5774247d836267175c664cd0e451bcb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#a2ac46e470c750bf93c754e06c64b0a7a">measureWithStats</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, int measureQubit, REAL *stateProb)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Measures a single qubit, collapsing it randomly to 0 or 1, and additionally gives the probability of that outcome.  <a href="#a2ac46e470c750bf93c754e06c64b0a7a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#ae5f9019826f35e8b51b1716cfe397b45">exitWithError</a> (int errorCode, const char *func)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a> (int isValid, int errorCode, const char *func)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>An implementation of the API in <a class="el" href="qubits_8h.html" title="The QuEST library API and objects.">qubits.h</a> for an MPI environment. </p>

<p>Definition in file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="ad3d8a3bd0c0b677acef144f2c2ef6d73"></a><!-- doxytag: member="qubits_env_mpi.c::_BSD_SOURCE" ref="ad3d8a3bd0c0b677acef144f2c2ef6d73" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _BSD_SOURCE</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00008">8</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad72dbcf6d0153db1b8d8a58001feed83"></a><!-- doxytag: member="qubits_env_mpi.c::DEBUG" ref="ad72dbcf6d0153db1b8d8a58001feed83" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG&nbsp;&nbsp;&nbsp;0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00027">27</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a818a4c7cd7252d2b10b896b12fa431d3"></a><!-- doxytag: member="qubits_env_mpi.c::calcTotalProbability" ref="a818a4c7cd7252d2b10b896b12fa431d3" args="(MultiQubit multiQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL calcTotalProbability </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate the probability of being in any state by taking the norm of the entire state vector. </p>
<p>Should be equal to 1.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing a set of qubits </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>total probability </dd></dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00126">126</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits_8c_source.html#l00018">DEBUG</a>, <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="precision_8h_source.html#l00026">MPI_QuEST_REAL</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00060">MultiQubit::numChunks</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00126"></a>00126                                                 {
<a name="l00127"></a>00127   <span class="comment">/* IJB - implemented using Kahan summation for greater accuracy at a slight floating</span>
<a name="l00128"></a>00128 <span class="comment">     point operation overhead. For more details see https://en.wikipedia.org/wiki/Kahan_summation_algorithm */</span>
<a name="l00129"></a>00129   <span class="comment">/* Don&apos;t change the bracketing in this routine! */</span>
<a name="l00130"></a>00130   <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> pTotal=0; 
<a name="l00131"></a>00131   <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> y, t, c;
<a name="l00132"></a>00132   <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> allRankTotals=0;
<a name="l00133"></a>00133   <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00134"></a>00134   <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmpsPerRank = multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00135"></a>00135   c = 0.0;
<a name="l00136"></a>00136   <span class="keywordflow">for</span> (index=0; index&lt;numAmpsPerRank; index++){ 
<a name="l00137"></a>00137     <span class="comment">/* Perform pTotal+=multiQubit.stateVec.real[index]*multiQubit.stateVec.real[index]; by Kahan */</span>
<a name="l00138"></a>00138     y = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[index]*multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[index] - c;
<a name="l00139"></a>00139     t = pTotal + y;
<a name="l00140"></a>00140     c = ( t - pTotal ) - y;
<a name="l00141"></a>00141     pTotal = t;
<a name="l00142"></a>00142     <span class="comment">/* Perform pTotal+=multiQubit.stateVec.imag[index]*multiQubit.stateVec.imag[index]; by Kahan */</span>
<a name="l00143"></a>00143     y = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[index]*multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[index] - c;
<a name="l00144"></a>00144     t = pTotal + y;
<a name="l00145"></a>00145     c = ( t - pTotal ) - y;
<a name="l00146"></a>00146     pTotal = t;
<a name="l00147"></a>00147   } 
<a name="l00148"></a>00148   <span class="keywordflow">if</span> (<a class="code" href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>) printf(<span class="stringliteral">&quot;before calc prob. %d\n&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>);
<a name="l00149"></a>00149   <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>&gt;1) MPI_Allreduce(&amp;pTotal, &amp;allRankTotals, 1, <a class="code" href="precision_8h.html#a750ad290949ef7dc4afdfbd8231a5057">MPI_QuEST_REAL</a>, MPI_SUM, MPI_COMM_WORLD);
<a name="l00150"></a>00150   <span class="keywordflow">else</span> allRankTotals=pTotal;
<a name="l00151"></a>00151   
<a name="l00152"></a>00152   <span class="keywordflow">return</span> allRankTotals;
<a name="l00153"></a>00153 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0552889d6f57d9e0ed8b209bf426482d"></a><!-- doxytag: member="qubits_env_mpi.c::chunkIsUpper" ref="a0552889d6f57d9e0ed8b209bf426482d" args="(int chunkId, long long int chunkSize, int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int chunkIsUpper </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>chunkId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>chunkSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns whether a given chunk in position chunkId is in the upper or lower half of a block. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>chunkId</em>&nbsp;</td><td>id of chunk in state vector </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>chunkSize</em>&nbsp;</td><td>number of amps in chunk </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit being rotated </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>1: chunk is in upper half of block, 0: chunk is in lower half of block fix -- is this the same as isChunkToSkip? </dd></dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00164">164</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00288">compactUnitary()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00370">controlledCompactUnitary()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00532">controlledNot()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00413">controlledUnitary()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00618">hadamard()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00457">multiControlledUnitary()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00600">phaseGate()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00503">sigmaX()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00569">sigmaY()</a>, and <a class="el" href="qubits__env__mpi_8c_source.html#l00328">unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00165"></a>00165 {       
<a name="l00166"></a>00166         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeHalfBlock = 1LL &lt;&lt; (targetQubit);
<a name="l00167"></a>00167         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock = sizeHalfBlock*2;
<a name="l00168"></a>00168         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> posInBlock = (chunkId*chunkSize) % sizeBlock;
<a name="l00169"></a>00169         <span class="keywordflow">return</span> posInBlock&lt;sizeHalfBlock;
<a name="l00170"></a>00170 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="abd4bc926cd3f9b65610bb228d0c59fe0"></a><!-- doxytag: member="qubits_env_mpi.c::closeQuESTEnv" ref="abd4bc926cd3f9b65610bb228d0c59fe0" args="(QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void closeQuESTEnv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Close QuEST environment. </p>
<p>If something needs to be done to clean up the execution environment, such as finalizing MPI when running in distributed mode, it is handled here</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00074">74</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00074"></a>00074                                 {
<a name="l00075"></a>00075         <span class="keywordtype">int</span> finalized;
<a name="l00076"></a>00076         MPI_Finalized(&amp;finalized);
<a name="l00077"></a>00077         <span class="keywordflow">if</span> (!finalized) MPI_Finalize();
<a name="l00078"></a>00078         <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;ERROR: Trying to close QuESTEnv multiple times. Ignoring\n&quot;</span>);
<a name="l00079"></a>00079 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a07418ebac70fd9ae5d051d089961631d"></a><!-- doxytag: member="qubits_env_mpi.c::collapseToOutcome" ref="a07418ebac70fd9ae5d051d089961631d" args="(MultiQubit multiQubit, const int measureQubit, int outcome)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL collapseToOutcome </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outcome</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Updates the state vector to be consistent with measuring the measure qubit in the given outcome (0 or 1), and returns the probability of such a measurement outcome. </p>
<p>This is effectively performing a measurement and forcing the outcome. This is an irreversible change to the state vector, whereby incompatible states in the state vector are given zero amplitude and the remaining states are renormalised. Exits with error if the given outcome has ~zero probability, and so cannot be collapsed into.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>outcome</em>&nbsp;</td><td>to force the measure qubit to enter </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>probability of the (forced) measurement outcome </dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>measureQubit</code> is outside [0, <code>multiQubit.numQubits</code>), or if <code>outcome</code> is not in {0, 1}, or if the probability of <code>outcome</code> is zero (within machine epsilon) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00694">694</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01898">collapseToOutcomeDistributedRenorm()</a>, <a class="el" href="qubits_8c_source.html#l01940">collapseToOutcomeDistributedSetZero()</a>, <a class="el" href="qubits_8c_source.html#l01816">collapseToOutcomeLocal()</a>, <a class="el" href="qubits__env__local_8c_source.html#l00189">findProbabilityOfOutcome()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00249">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00666">isChunkToSkipInFindPZero()</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="qubits__env__local_8c_source.html#l00246">QuESTAssert()</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="precision_8h_source.html#l00028">REAL_EPS</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00695"></a>00695 {
<a name="l00696"></a>00696     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(measureQubit &gt;= 0 &amp;&amp; measureQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 2, __func__);
<a name="l00697"></a>00697     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>((outcome==0 || outcome==1), 10, __func__);
<a name="l00698"></a>00698 
<a name="l00699"></a>00699         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> totalStateProb=<a class="code" href="qubits_8h.html#ad315c941a51bc053d39ebfa2040fd32e" title="Gives the probability of a specified qubit being measured in the given outcome (0...">findProbabilityOfOutcome</a>(multiQubit, measureQubit, outcome);
<a name="l00700"></a>00700     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(fabs(totalStateProb)&gt;<a class="code" href="precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a>, 8, __func__);
<a name="l00701"></a>00701 
<a name="l00702"></a>00702         <span class="keywordtype">int</span> skipValuesWithinRank = <a class="code" href="qubits__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, measureQubit);
<a name="l00703"></a>00703     <span class="keywordflow">if</span> (skipValuesWithinRank) {
<a name="l00704"></a>00704         <a class="code" href="qubits_8c.html#a01d9a8b7ff0e09ec399e158389783aa9" title="Update the state vector to be consistent with measuring measureQubit=0 if outcome=0...">collapseToOutcomeLocal</a>(multiQubit, measureQubit, totalStateProb, outcome);
<a name="l00705"></a>00705     } <span class="keywordflow">else</span> {
<a name="l00706"></a>00706         <span class="keywordflow">if</span> (!<a class="code" href="qubits__env__mpi_8c.html#af0ea25f00987af4c53f17c9cca62ab41" title="Find chunks to skip when calculating probability of qubit being zero.">isChunkToSkipInFindPZero</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, measureQubit)){
<a name="l00707"></a>00707             <span class="comment">// chunk has amps for q=0</span>
<a name="l00708"></a>00708             <span class="keywordflow">if</span> (outcome==0) <a class="code" href="qubits_8c.html#a7a1f63ec3c42d9ad72f1f01c14a885db" title="Renormalise parts of the state vector where measureQubit=0 or 1, based on the total...">collapseToOutcomeDistributedRenorm</a>(multiQubit, measureQubit, 
<a name="l00709"></a>00709                     totalStateProb);
<a name="l00710"></a>00710             <span class="keywordflow">else</span> <a class="code" href="qubits_8c.html#a78908fe8e75a21fd4f7fa7dff05d6be1" title="Set all amplitudes in one chunk to 0.">collapseToOutcomeDistributedSetZero</a>(multiQubit, measureQubit);
<a name="l00711"></a>00711         } <span class="keywordflow">else</span> {
<a name="l00712"></a>00712             <span class="comment">// chunk has amps for q=1</span>
<a name="l00713"></a>00713             <span class="keywordflow">if</span> (outcome==1) <a class="code" href="qubits_8c.html#a7a1f63ec3c42d9ad72f1f01c14a885db" title="Renormalise parts of the state vector where measureQubit=0 or 1, based on the total...">collapseToOutcomeDistributedRenorm</a>(multiQubit, measureQubit, 
<a name="l00714"></a>00714                     totalStateProb);
<a name="l00715"></a>00715             <span class="keywordflow">else</span> <a class="code" href="qubits_8c.html#a78908fe8e75a21fd4f7fa7dff05d6be1" title="Set all amplitudes in one chunk to 0.">collapseToOutcomeDistributedSetZero</a>(multiQubit, measureQubit);
<a name="l00716"></a>00716         }
<a name="l00717"></a>00717     }
<a name="l00718"></a>00718         <span class="keywordflow">return</span> totalStateProb;
<a name="l00719"></a>00719 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a03b13dfcabd8c59b50dbdd3af44ba8b2"></a><!-- doxytag: member="qubits_env_mpi.c::compactUnitary" ref="a03b13dfcabd8c59b50dbdd3af44ba8b2" args="(MultiQubit multiQubit, const int targetQubit, Complex alpha, Complex beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compactUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply a single-qubit unitary parameterised by two given complex scalars. </p>
<p>Given valid complex numbers <img class="formulaInl" alt="$\alpha$" src="form_18.png"/> and <img class="formulaInl" alt="$\beta$" src="form_19.png"/>, applies the unitary </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ U = \begin{pmatrix} \alpha &amp; -\beta^* \\ \beta &amp; \alpha^* \end{pmatrix} \]" src="form_20.png"/>
</p>
<p> which is general up to a global phase factor. Valid <img class="formulaInl" alt="$\alpha$" src="form_18.png"/>, <img class="formulaInl" alt="$\beta$" src="form_19.png"/> satisfy <img class="formulaInl" alt="$|\alpha|^2 + |\beta|^2 = 1$" src="form_21.png"/>.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {U}; \end{tikzpicture} } \]" src="form_22.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to operate on </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>alpha</em>&nbsp;</td><td>complex unitary parameter (row 1, column 1) </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>beta</em>&nbsp;</td><td>complex unitary parameter (row 2, column 1) </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>targetQubit</code> is outside [0, <code>multiQubit.numQubits</code>), or if <code>alpha</code>, <code>beta</code> don't satisfy |<code>alpha|^2</code> + |<code>beta|^2</code> = 1. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00288">288</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00164">chunkIsUpper()</a>, <a class="el" href="qubits_8c_source.html#l00573">compactUnitaryDistributed()</a>, <a class="el" href="qubits_8c_source.html#l00444">compactUnitaryLocal()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00256">exchangeStateVectors()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00231">getChunkPairId()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00186">getRotAngle()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00249">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::pairStateVec</a>, <a class="el" href="qubits__env__local_8c_source.html#l00246">QuESTAssert()</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>, and <a class="el" href="qubits_8c_source.html#l00369">validateAlphaBeta()</a>.</p>

<p>Referenced by <a class="el" href="qubits_8c_source.html#l00382">rotateAroundAxis()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00289"></a>00289 {
<a name="l00290"></a>00290         <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00291"></a>00291         <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(<a class="code" href="qubits_8c.html#ae2b2c14a07dd7d50ff86032a3ca101d7">validateAlphaBeta</a>(alpha, beta), 6, __func__);
<a name="l00292"></a>00292 
<a name="l00293"></a>00293         <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span>
<a name="l00294"></a>00294         <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="qubits__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00295"></a>00295         <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> rot1, rot2;
<a name="l00296"></a>00296 
<a name="l00297"></a>00297         <span class="comment">// rank&apos;s chunk is in upper half of block </span>
<a name="l00298"></a>00298         <span class="keywordtype">int</span> rankIsUpper;
<a name="l00299"></a>00299         <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span>
<a name="l00300"></a>00300 
<a name="l00301"></a>00301         <span class="keywordflow">if</span> (useLocalDataOnly){
<a name="l00302"></a>00302                 <span class="comment">// all values required to update state vector lie in this rank</span>
<a name="l00303"></a>00303                 <a class="code" href="qubits_8c.html#a9cee2d8716667a3318420a3b672f5b92">compactUnitaryLocal</a>(multiQubit, targetQubit, alpha, beta);
<a name="l00304"></a>00304         } <span class="keywordflow">else</span> {
<a name="l00305"></a>00305                 <span class="comment">// need to get corresponding chunk of state vector from other rank</span>
<a name="l00306"></a>00306                 rankIsUpper = <a class="code" href="qubits__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00307"></a>00307                 <a class="code" href="qubits__env__mpi_8c.html#adb4b0373425b282abed27742d0ce0872" title="Get rotation values for a given chunk.">getRotAngle</a>(rankIsUpper, &amp;rot1, &amp;rot2, alpha, beta);
<a name="l00308"></a>00308                 pairRank = <a class="code" href="qubits__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4" title="get position of corresponding chunk, holding values required to update values in...">getChunkPairId</a>(rankIsUpper, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00309"></a>00309                 <span class="comment">// get corresponding values from my pair</span>
<a name="l00310"></a>00310                         <a class="code" href="qubits__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a>(multiQubit, pairRank);
<a name="l00311"></a>00311 
<a name="l00312"></a>00312                 <span class="comment">// this rank&apos;s values are either in the upper of lower half of the block. </span>
<a name="l00313"></a>00313                         <span class="comment">// send values to compactUnitaryDistributed in the correct order</span>
<a name="l00314"></a>00314                 <span class="keywordflow">if</span> (rankIsUpper){
<a name="l00315"></a>00315                         <a class="code" href="qubits_8c.html#a20ee1878a63ae6112e8845f4a8787592" title="Rotate a single qubit in the state vector of probability amplitudes, given two complex...">compactUnitaryDistributed</a>(multiQubit,targetQubit,rot1,rot2,
<a name="l00316"></a>00316                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>, <span class="comment">//upper</span>
<a name="l00317"></a>00317                                 multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//lower</span>
<a name="l00318"></a>00318                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>); <span class="comment">//output</span>
<a name="l00319"></a>00319                 } <span class="keywordflow">else</span> {
<a name="l00320"></a>00320                         <a class="code" href="qubits_8c.html#a20ee1878a63ae6112e8845f4a8787592" title="Rotate a single qubit in the state vector of probability amplitudes, given two complex...">compactUnitaryDistributed</a>(multiQubit,targetQubit,rot1,rot2,
<a name="l00321"></a>00321                                 multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//upper</span>
<a name="l00322"></a>00322                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>, <span class="comment">//lower</span>
<a name="l00323"></a>00323                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>); <span class="comment">//output</span>
<a name="l00324"></a>00324                 }
<a name="l00325"></a>00325         }
<a name="l00326"></a>00326 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab4812953bc457405b3aa05a4c2f64f4a"></a><!-- doxytag: member="qubits_env_mpi.c::controlledCompactUnitary" ref="ab4812953bc457405b3aa05a4c2f64f4a" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, Complex alpha, Complex beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledCompactUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply a controlled unitary (single control, single target) parameterised by two given complex scalars. </p>
<p>Given valid complex numbers <img class="formulaInl" alt="$\alpha$" src="form_18.png"/> and <img class="formulaInl" alt="$\beta$" src="form_19.png"/>, applies the two-qubit unitary </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 1 \\ &amp; 1 \\ &amp; &amp; \alpha &amp; -\beta^* \\ &amp; &amp; \beta &amp; \alpha^* \end{pmatrix} \]" src="form_30.png"/>
</p>
<p> to the control and target qubits. Valid <img class="formulaInl" alt="$\alpha$" src="form_18.png"/>, <img class="formulaInl" alt="$\beta$" src="form_19.png"/> satisfy <img class="formulaInl" alt="$|\alpha|^2 + |\beta|^2 = 1$" src="form_21.png"/>. The target unitary is general up to a global phase factor.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 1); \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$U_{\alpha, \beta}$}; \end{tikzpicture} } \]" src="form_31.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>apply the target unitary if this qubit has value 1 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit on which to apply the target unitary </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>alpha</em>&nbsp;</td><td>complex unitary parameter (row 1, column 1) </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>beta</em>&nbsp;</td><td>complex unitary parameter (row 2, column 1) </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if either <code>controlQubit</code> or <code>targetQubit</code> are outside [0, <code>multiQubit.numQubits</code>) or are equal, or if <code>alpha</code>, <code>beta</code> don't satisfy |<code>alpha|^2</code> + |<code>beta|^2</code> = 1. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00370">370</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00164">chunkIsUpper()</a>, <a class="el" href="qubits_8c_source.html#l00883">controlledCompactUnitaryDistributed()</a>, <a class="el" href="qubits_8c_source.html#l00674">controlledCompactUnitaryLocal()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00256">exchangeStateVectors()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00231">getChunkPairId()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00186">getRotAngle()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00249">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::pairStateVec</a>, <a class="el" href="qubits__env__local_8c_source.html#l00246">QuESTAssert()</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>, and <a class="el" href="qubits_8c_source.html#l00369">validateAlphaBeta()</a>.</p>

<p>Referenced by <a class="el" href="qubits_8c_source.html#l00413">controlledRotateAroundAxis()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00371"></a>00371 {
<a name="l00372"></a>00372         <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00373"></a>00373         <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(controlQubit &gt;= 0 &amp;&amp; controlQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 2, __func__);
<a name="l00374"></a>00374         <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(controlQubit != targetQubit, 3, __func__);
<a name="l00375"></a>00375         <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(<a class="code" href="qubits_8c.html#ae2b2c14a07dd7d50ff86032a3ca101d7">validateAlphaBeta</a>(alpha, beta), 6, __func__);
<a name="l00376"></a>00376 
<a name="l00377"></a>00377         <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span>
<a name="l00378"></a>00378         <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="qubits__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00379"></a>00379         <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> rot1, rot2;
<a name="l00380"></a>00380 
<a name="l00381"></a>00381         <span class="comment">// rank&apos;s chunk is in upper half of block </span>
<a name="l00382"></a>00382         <span class="keywordtype">int</span> rankIsUpper;
<a name="l00383"></a>00383         <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span>
<a name="l00384"></a>00384 
<a name="l00385"></a>00385         <span class="keywordflow">if</span> (useLocalDataOnly){
<a name="l00386"></a>00386                 <span class="comment">// all values required to update state vector lie in this rank</span>
<a name="l00387"></a>00387                 <a class="code" href="qubits_8c.html#afc77657651d52c47403b44b923a098a8">controlledCompactUnitaryLocal</a>(multiQubit, controlQubit, targetQubit, alpha, beta);
<a name="l00388"></a>00388         } <span class="keywordflow">else</span> {
<a name="l00389"></a>00389                 <span class="comment">// need to get corresponding chunk of state vector from other rank</span>
<a name="l00390"></a>00390                 rankIsUpper = <a class="code" href="qubits__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00391"></a>00391                 <a class="code" href="qubits__env__mpi_8c.html#adb4b0373425b282abed27742d0ce0872" title="Get rotation values for a given chunk.">getRotAngle</a>(rankIsUpper, &amp;rot1, &amp;rot2, alpha, beta);
<a name="l00392"></a>00392                 pairRank = <a class="code" href="qubits__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4" title="get position of corresponding chunk, holding values required to update values in...">getChunkPairId</a>(rankIsUpper, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00393"></a>00393                 <span class="comment">//printf(&quot;%d rank has pair rank: %d\n&quot;, multiQubit.rank, pairRank);</span>
<a name="l00394"></a>00394                 <span class="comment">// get corresponding values from my pair</span>
<a name="l00395"></a>00395                 <a class="code" href="qubits__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a>(multiQubit, pairRank);
<a name="l00396"></a>00396                 
<a name="l00397"></a>00397                 <span class="comment">// this rank&apos;s values are either in the upper of lower half of the block. send values to controlledCompactUnitaryDistributed</span>
<a name="l00398"></a>00398                 <span class="comment">// in the correct order</span>
<a name="l00399"></a>00399                 <span class="keywordflow">if</span> (rankIsUpper){
<a name="l00400"></a>00400                         <a class="code" href="qubits_8c.html#a717855e835e3161e08c18cdc15325d27" title="Rotate a single qubit in the state vector of probability amplitudes, given two complex...">controlledCompactUnitaryDistributed</a>(multiQubit,controlQubit,targetQubit,rot1,rot2,
<a name="l00401"></a>00401                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>, <span class="comment">//upper</span>
<a name="l00402"></a>00402                                 multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//lower</span>
<a name="l00403"></a>00403                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>); <span class="comment">//output</span>
<a name="l00404"></a>00404                 } <span class="keywordflow">else</span> {
<a name="l00405"></a>00405                         <a class="code" href="qubits_8c.html#a717855e835e3161e08c18cdc15325d27" title="Rotate a single qubit in the state vector of probability amplitudes, given two complex...">controlledCompactUnitaryDistributed</a>(multiQubit,controlQubit,targetQubit,rot1,rot2,
<a name="l00406"></a>00406                                 multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//upper</span>
<a name="l00407"></a>00407                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>, <span class="comment">//lower</span>
<a name="l00408"></a>00408                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>); <span class="comment">//output</span>
<a name="l00409"></a>00409                 }
<a name="l00410"></a>00410         }
<a name="l00411"></a>00411 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a67576895bbc65463481a8ea24d9b1e22"></a><!-- doxytag: member="qubits_env_mpi.c::controlledNot" ref="a67576895bbc65463481a8ea24d9b1e22" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledNot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply the controlled not (single control, single target) gate, also known as the c-X, c-sigma-X, c-Pauli-X and c-bit-flip gate. </p>
<p>This applies sigmaX to the target qubit if the control qubit has value 1. This effects the two-qubit unitary </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 1 \\ &amp; 1 \\\ &amp; &amp; &amp; 1 \\ &amp; &amp; 1 \end{pmatrix} \]" src="form_49.png"/>
</p>
<p> on the control and target qubits.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, -.5); \draw (-2,0) -- (2, 0); \draw (0, 0) circle (.5); \end{tikzpicture} } \]" src="form_50.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>nots the target if this qubit is 1 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to not </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if either <code>controlQubit</code> or <code>targetQubit</code> are outside [0, <code>multiQubit.numQubits</code>), or are equal. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00532">532</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00164">chunkIsUpper()</a>, <a class="el" href="qubits_8c_source.html#l01212">controlledNotDistributed()</a>, <a class="el" href="qubits_8c_source.html#l01147">controlledNotLocal()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00256">exchangeStateVectors()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00231">getChunkPairId()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00249">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::pairStateVec</a>, <a class="el" href="qubits__env__local_8c_source.html#l00246">QuESTAssert()</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00533"></a>00533 {
<a name="l00534"></a>00534         <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00535"></a>00535         <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(controlQubit &gt;= 0 &amp;&amp; controlQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 2, __func__);
<a name="l00536"></a>00536         <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(controlQubit != targetQubit, 3, __func__);
<a name="l00537"></a>00537 
<a name="l00538"></a>00538         <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span>
<a name="l00539"></a>00539         <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="qubits__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00540"></a>00540 
<a name="l00541"></a>00541         <span class="comment">// rank&apos;s chunk is in upper half of block </span>
<a name="l00542"></a>00542         <span class="keywordtype">int</span> rankIsUpper;
<a name="l00543"></a>00543         <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span>
<a name="l00544"></a>00544 
<a name="l00545"></a>00545         <span class="keywordflow">if</span> (useLocalDataOnly){
<a name="l00546"></a>00546                 <span class="comment">// all values required to update state vector lie in this rank</span>
<a name="l00547"></a>00547                 <a class="code" href="qubits_8c.html#ad357a43e80e3baf013975b1b70942f4c">controlledNotLocal</a>(multiQubit, controlQubit, targetQubit);
<a name="l00548"></a>00548         } <span class="keywordflow">else</span> {
<a name="l00549"></a>00549                 <span class="comment">// need to get corresponding chunk of state vector from other rank</span>
<a name="l00550"></a>00550                 rankIsUpper = <a class="code" href="qubits__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00551"></a>00551                 pairRank = <a class="code" href="qubits__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4" title="get position of corresponding chunk, holding values required to update values in...">getChunkPairId</a>(rankIsUpper, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00552"></a>00552                 <span class="comment">//printf(&quot;%d rank has pair rank: %d\n&quot;, multiQubit.rank, pairRank);</span>
<a name="l00553"></a>00553                 <span class="comment">// get corresponding values from my pair</span>
<a name="l00554"></a>00554                 <a class="code" href="qubits__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a>(multiQubit, pairRank);
<a name="l00555"></a>00555                 <span class="comment">// this rank&apos;s values are either in the upper of lower half of the block. send values to controlledNot</span>
<a name="l00556"></a>00556                 <span class="comment">// in the correct order</span>
<a name="l00557"></a>00557                 <span class="keywordflow">if</span> (rankIsUpper){
<a name="l00558"></a>00558                         <a class="code" href="qubits_8c.html#a05875a70b539a3efb28d027823403f34" title="Rotate a single qubit by {{0,1},{1,0}.">controlledNotDistributed</a>(multiQubit,controlQubit,targetQubit,
<a name="l00559"></a>00559                                 multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//in</span>
<a name="l00560"></a>00560                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>); <span class="comment">//out</span>
<a name="l00561"></a>00561                 } <span class="keywordflow">else</span> {
<a name="l00562"></a>00562                         <a class="code" href="qubits_8c.html#a05875a70b539a3efb28d027823403f34" title="Rotate a single qubit by {{0,1},{1,0}.">controlledNotDistributed</a>(multiQubit,controlQubit,targetQubit,
<a name="l00563"></a>00563                                 multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//in</span>
<a name="l00564"></a>00564                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>); <span class="comment">//out</span>
<a name="l00565"></a>00565                 }
<a name="l00566"></a>00566         }
<a name="l00567"></a>00567 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8a701526263392599aa21d0d0f05d9d8"></a><!-- doxytag: member="qubits_env_mpi.c::controlledUnitary" ref="a8a701526263392599aa21d0d0f05d9d8" args="(MultiQubit multiQubit, const int controlQubit, const int targetQubit, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply a general controlled unitary (single control, single target), which can include a global phase factor. </p>
<p>The given unitary is applied to the target qubit if the control qubit has value 1, effecting the two-qubit unitary </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 1 \\ &amp; 1 \\ &amp; &amp; u_{00} &amp; u_{01}\\ &amp; &amp; u_{10} &amp; u_{11} \end{pmatrix} \]" src="form_32.png"/>
</p>
<p> on the control and target qubits.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 1); \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {U}; \end{tikzpicture} } \]" src="form_33.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>apply unitary if this qubit is 1 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to operate on </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>u</em>&nbsp;</td><td>single-qubit unitary matrix to apply </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if either <code>controlQubit</code> or <code>targetQubit</code> are outside [0, <code>multiQubit.numQubits</code>) or are equal, or if <code>u</code> is not unitary. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00413">413</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00164">chunkIsUpper()</a>, <a class="el" href="qubits_8c_source.html#l00946">controlledUnitaryDistributed()</a>, <a class="el" href="qubits_8c_source.html#l00804">controlledUnitaryLocal()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00256">exchangeStateVectors()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00231">getChunkPairId()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00211">getRotAngleFromUnitaryMatrix()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00249">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::pairStateVec</a>, <a class="el" href="qubits__env__local_8c_source.html#l00246">QuESTAssert()</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>, and <a class="el" href="qubits_8c_source.html#l00344">validateMatrixIsUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00415"></a>00415 {
<a name="l00416"></a>00416         <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00417"></a>00417         <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(controlQubit &gt;= 0 &amp;&amp; controlQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 2, __func__);
<a name="l00418"></a>00418         <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(controlQubit != targetQubit, 3, __func__);
<a name="l00419"></a>00419         <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(<a class="code" href="qubits_8c.html#ae4fea133d1a8f09ff8da03038100adb2">validateMatrixIsUnitary</a>(u), 5, __func__);
<a name="l00420"></a>00420 
<a name="l00421"></a>00421         <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span>
<a name="l00422"></a>00422         <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="qubits__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00423"></a>00423         <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> rot1, rot2;
<a name="l00424"></a>00424 
<a name="l00425"></a>00425         <span class="comment">// rank&apos;s chunk is in upper half of block </span>
<a name="l00426"></a>00426         <span class="keywordtype">int</span> rankIsUpper;
<a name="l00427"></a>00427         <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span>
<a name="l00428"></a>00428 
<a name="l00429"></a>00429         <span class="keywordflow">if</span> (useLocalDataOnly){
<a name="l00430"></a>00430                 <span class="comment">// all values required to update state vector lie in this rank</span>
<a name="l00431"></a>00431                 <a class="code" href="qubits_8c.html#a8a4afcff70195a306c082b8ed8d4e09a">controlledUnitaryLocal</a>(multiQubit, controlQubit, targetQubit, u);
<a name="l00432"></a>00432         } <span class="keywordflow">else</span> {
<a name="l00433"></a>00433                 <span class="comment">// need to get corresponding chunk of state vector from other rank</span>
<a name="l00434"></a>00434                 rankIsUpper = <a class="code" href="qubits__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00435"></a>00435                 <a class="code" href="qubits__env__mpi_8c.html#a5c9b2f129bdffaaba9857f6eddecbb17" title="Get rotation values for a given chunk given a unitary matrix.">getRotAngleFromUnitaryMatrix</a>(rankIsUpper, &amp;rot1, &amp;rot2, u);
<a name="l00436"></a>00436                 pairRank = <a class="code" href="qubits__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4" title="get position of corresponding chunk, holding values required to update values in...">getChunkPairId</a>(rankIsUpper, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00437"></a>00437                 <span class="comment">//printf(&quot;%d rank has pair rank: %d\n&quot;, multiQubit.rank, pairRank);</span>
<a name="l00438"></a>00438                 <span class="comment">// get corresponding values from my pair</span>
<a name="l00439"></a>00439                 <a class="code" href="qubits__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a>(multiQubit, pairRank);
<a name="l00440"></a>00440                 
<a name="l00441"></a>00441                 <span class="comment">// this rank&apos;s values are either in the upper of lower half of the block. send values to controlledUnitaryDistributed</span>
<a name="l00442"></a>00442                 <span class="comment">// in the correct order</span>
<a name="l00443"></a>00443                 <span class="keywordflow">if</span> (rankIsUpper){
<a name="l00444"></a>00444                         <a class="code" href="qubits_8c.html#a642093063a1f889f61a1311f6d6f2d3f" title="Rotate a single qubit in the state vector of probability amplitudes, given two complex...">controlledUnitaryDistributed</a>(multiQubit,controlQubit,targetQubit,rot1,rot2,
<a name="l00445"></a>00445                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>, <span class="comment">//upper</span>
<a name="l00446"></a>00446                                 multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//lower</span>
<a name="l00447"></a>00447                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>); <span class="comment">//output</span>
<a name="l00448"></a>00448                 } <span class="keywordflow">else</span> {
<a name="l00449"></a>00449                         <a class="code" href="qubits_8c.html#a642093063a1f889f61a1311f6d6f2d3f" title="Rotate a single qubit in the state vector of probability amplitudes, given two complex...">controlledUnitaryDistributed</a>(multiQubit,controlQubit,targetQubit,rot1,rot2,
<a name="l00450"></a>00450                                 multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//upper</span>
<a name="l00451"></a>00451                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>, <span class="comment">//lower</span>
<a name="l00452"></a>00452                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>); <span class="comment">//output</span>
<a name="l00453"></a>00453                 }
<a name="l00454"></a>00454         }
<a name="l00455"></a>00455 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7682c9a3fd592d34ec15ba8fa172f104"></a><!-- doxytag: member="qubits_env_mpi.c::exchangeStateVectors" ref="a7682c9a3fd592d34ec15ba8fa172f104" args="(MultiQubit multiQubit, int pairRank)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void exchangeStateVectors </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>pairRank</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00256">256</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits_8c_source.html#l00018">DEBUG</a>, <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="precision_8h_source.html#l00026">MPI_QuEST_REAL</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::pairStateVec</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00288">compactUnitary()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00370">controlledCompactUnitary()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00532">controlledNot()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00413">controlledUnitary()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00618">hadamard()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00457">multiControlledUnitary()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00503">sigmaX()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00569">sigmaY()</a>, and <a class="el" href="qubits__env__mpi_8c_source.html#l00328">unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00256"></a>00256                                                               {
<a name="l00257"></a>00257         <span class="comment">// MPI send/receive vars</span>
<a name="l00258"></a>00258         <span class="keywordtype">int</span> TAG=100;
<a name="l00259"></a>00259         MPI_Status status;
<a name="l00260"></a>00260 
<a name="l00261"></a>00261         <span class="comment">// Multiple messages are required as MPI uses int rather than long long int for count</span>
<a name="l00262"></a>00262         <span class="comment">// For openmpi, messages are further restricted to 2GB in size -- do this for all cases</span>
<a name="l00263"></a>00263         <span class="comment">// to be safe</span>
<a name="l00264"></a>00264         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> maxMessageCount = 1LL&lt;&lt;29;
<a name="l00265"></a>00265         <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(<a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>)==8) maxMessageCount = (1LL&lt;&lt;28);
<a name="l00266"></a>00266         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(<a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>)==16) maxMessageCount = (1LL&lt;&lt;27);
<a name="l00267"></a>00267 
<a name="l00268"></a>00268         <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>&lt;maxMessageCount) maxMessageCount = multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>;
<a name="l00269"></a>00269         <span class="keywordtype">int</span> numMessages = multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>/maxMessageCount;
<a name="l00270"></a>00270         <span class="keywordtype">int</span> i;
<a name="l00271"></a>00271         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> offset;
<a name="l00272"></a>00272         <span class="keywordflow">if</span> (<a class="code" href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>) printf(<span class="stringliteral">&quot;numMessages %d maxMessageCount %lld\n&quot;</span>, numMessages, maxMessageCount);
<a name="l00273"></a>00273 
<a name="l00274"></a>00274         <span class="comment">// send my state vector to pairRank&apos;s multiQubit.pairStateVec</span>
<a name="l00275"></a>00275         <span class="comment">// receive pairRank&apos;s state vector into multiQubit.pairStateVec</span>
<a name="l00276"></a>00276         <span class="keywordflow">for</span> (i=0; i&lt;numMessages; i++){
<a name="l00277"></a>00277                 offset = i*maxMessageCount;
<a name="l00278"></a>00278                 MPI_Sendrecv(&amp;multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[offset], maxMessageCount, <a class="code" href="precision_8h.html#a750ad290949ef7dc4afdfbd8231a5057">MPI_QuEST_REAL</a>, pairRank, TAG,
<a name="l00279"></a>00279                                  &amp;multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[offset], maxMessageCount, <a class="code" href="precision_8h.html#a750ad290949ef7dc4afdfbd8231a5057">MPI_QuEST_REAL</a>,
<a name="l00280"></a>00280                                  pairRank, TAG, MPI_COMM_WORLD, &amp;status);
<a name="l00281"></a>00281                 <span class="comment">//printf(&quot;rank: %d err: %d\n&quot;, multiQubit.rank, err);</span>
<a name="l00282"></a>00282                 MPI_Sendrecv(&amp;multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[offset], maxMessageCount, <a class="code" href="precision_8h.html#a750ad290949ef7dc4afdfbd8231a5057">MPI_QuEST_REAL</a>, pairRank, TAG,
<a name="l00283"></a>00283                                 &amp;multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[offset], maxMessageCount, <a class="code" href="precision_8h.html#a750ad290949ef7dc4afdfbd8231a5057">MPI_QuEST_REAL</a>,
<a name="l00284"></a>00284                                 pairRank, TAG, MPI_COMM_WORLD, &amp;status);
<a name="l00285"></a>00285         }
<a name="l00286"></a>00286 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae5f9019826f35e8b51b1716cfe397b45"></a><!-- doxytag: member="qubits_env_mpi.c::exitWithError" ref="ae5f9019826f35e8b51b1716cfe397b45" args="(int errorCode, const char *func)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void exitWithError </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>errorCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>func</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00768">768</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits_8c_source.html#l00020">errorCodes</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00768"></a>00768                                                    {
<a name="l00769"></a>00769     printf(<span class="stringliteral">&quot;!!!\n&quot;</span>);
<a name="l00770"></a>00770     printf(<span class="stringliteral">&quot;QuEST Error in function %s: %s\n&quot;</span>, func, <a class="code" href="qubits_8c.html#aac1637696885c75b73a1ecf381cea713">errorCodes</a>[errorCode]);
<a name="l00771"></a>00771     printf(<span class="stringliteral">&quot;!!!\n&quot;</span>);
<a name="l00772"></a>00772     printf(<span class="stringliteral">&quot;exiting..\n&quot;</span>);
<a name="l00773"></a>00773     MPI_Abort(MPI_COMM_WORLD, errorCode);
<a name="l00774"></a>00774 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad315c941a51bc053d39ebfa2040fd32e"></a><!-- doxytag: member="qubits_env_mpi.c::findProbabilityOfOutcome" ref="ad315c941a51bc053d39ebfa2040fd32e" args="(MultiQubit multiQubit, const int measureQubit, int outcome)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL findProbabilityOfOutcome </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outcome</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Gives the probability of a specified qubit being measured in the given outcome (0 or 1). </p>
<p>This performs no actual measurement and does not change the state of the qubits.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to study </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>outcome</em>&nbsp;</td><td>for which to find the probability of the qubit being measured in </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>probability of qubit measureQubit being measured in the given outcome </dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>measureQubit</code> is outside [0, <code>multiQubit.numQubits</code>), or if <code>outcome</code> is not in {0, 1}. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00675">675</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01669">findProbabilityOfZeroDistributed()</a>, <a class="el" href="qubits_8c_source.html#l01597">findProbabilityOfZeroLocal()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00249">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00666">isChunkToSkipInFindPZero()</a>, <a class="el" href="precision_8h_source.html#l00026">MPI_QuEST_REAL</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="qubits__env__local_8c_source.html#l00246">QuESTAssert()</a>, and <a class="el" href="precision_8h_source.html#l00025">REAL</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00198">collapseToOutcome()</a>, and <a class="el" href="qubits__env__local_8c_source.html#l00215">measureWithStats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00676"></a>00676 {
<a name="l00677"></a>00677     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(measureQubit &gt;= 0 &amp;&amp; measureQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 2, __func__);
<a name="l00678"></a>00678 
<a name="l00679"></a>00679         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateProb=0, totalStateProb=0;
<a name="l00680"></a>00680         <span class="keywordtype">int</span> skipValuesWithinRank = <a class="code" href="qubits__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, measureQubit);
<a name="l00681"></a>00681         <span class="keywordflow">if</span> (skipValuesWithinRank) {
<a name="l00682"></a>00682                 stateProb = <a class="code" href="qubits_8c.html#a7c02cd0e1b4eac19771a0525f023249e" title="Measure the total probability of a specified qubit being in the zero state across...">findProbabilityOfZeroLocal</a>(multiQubit, measureQubit);
<a name="l00683"></a>00683         } <span class="keywordflow">else</span> {
<a name="l00684"></a>00684                 <span class="keywordflow">if</span> (!<a class="code" href="qubits__env__mpi_8c.html#af0ea25f00987af4c53f17c9cca62ab41" title="Find chunks to skip when calculating probability of qubit being zero.">isChunkToSkipInFindPZero</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, measureQubit)){
<a name="l00685"></a>00685                         stateProb = <a class="code" href="qubits_8c.html#a9ac9bb717a889f09d307eda9f0b65957" title="Measure the probability of a specified qubit being in the zero state across all amplitudes...">findProbabilityOfZeroDistributed</a>(multiQubit, measureQubit);
<a name="l00686"></a>00686                 } <span class="keywordflow">else</span> stateProb = 0;
<a name="l00687"></a>00687         }
<a name="l00688"></a>00688         MPI_Allreduce(&amp;stateProb, &amp;totalStateProb, 1, <a class="code" href="precision_8h.html#a750ad290949ef7dc4afdfbd8231a5057">MPI_QuEST_REAL</a>, MPI_SUM, MPI_COMM_WORLD);
<a name="l00689"></a>00689         <span class="keywordflow">if</span> (outcome==1) totalStateProb = 1.0 - totalStateProb;
<a name="l00690"></a>00690         <span class="keywordflow">return</span> totalStateProb;
<a name="l00691"></a>00691 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8605e6a6295174cb4661156eaa709ec4"></a><!-- doxytag: member="qubits_env_mpi.c::getChunkIdFromIndex" ref="a8605e6a6295174cb4661156eaa709ec4" args="(MultiQubit multiQubit, long long int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getChunkIdFromIndex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>index</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00102">102</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00116">getImagAmpEl()</a>, and <a class="el" href="qubits__env__mpi_8c_source.html#l00106">getRealAmpEl()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00102"></a>00102                                                                    {
<a name="l00103"></a>00103         <span class="keywordflow">return</span> index/multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>; <span class="comment">// this is numAmpsPerChunk</span>
<a name="l00104"></a>00104 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7dba097f23f5d48dfdc9f3250444e2e4"></a><!-- doxytag: member="qubits_env_mpi.c::getChunkPairId" ref="a7dba097f23f5d48dfdc9f3250444e2e4" args="(int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int getChunkPairId </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>chunkIsUpper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>chunkId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>chunkSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>get position of corresponding chunk, holding values required to update values in my chunk (with chunkId) when rotating targetQubit. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>chunkIsUpper</em>&nbsp;</td><td>1: chunk is in upper half of block, 0: chunk is in lower half </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>chunkId</em>&nbsp;</td><td>id of chunk in state vector </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>chunkSize</em>&nbsp;</td><td>number of amps in chunk </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit being rotated </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>chunkId of chunk required to rotate targetQubit </dd></dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00231">231</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00288">compactUnitary()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00370">controlledCompactUnitary()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00532">controlledNot()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00413">controlledUnitary()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00618">hadamard()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00457">multiControlledUnitary()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00503">sigmaX()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00569">sigmaY()</a>, and <a class="el" href="qubits__env__mpi_8c_source.html#l00328">unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00232"></a>00232 {
<a name="l00233"></a>00233         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeHalfBlock = 1LL &lt;&lt; (targetQubit);
<a name="l00234"></a>00234         <span class="keywordtype">int</span> chunksPerHalfBlock = sizeHalfBlock/chunkSize;
<a name="l00235"></a>00235         <span class="keywordflow">if</span> (<a class="code" href="qubits__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>){
<a name="l00236"></a>00236                 <span class="keywordflow">return</span> chunkId + chunksPerHalfBlock;
<a name="l00237"></a>00237         } <span class="keywordflow">else</span> {
<a name="l00238"></a>00238                 <span class="keywordflow">return</span> chunkId - chunksPerHalfBlock;
<a name="l00239"></a>00239         }
<a name="l00240"></a>00240 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3615f76fd5f57008d9b74bbd10533dd0"></a><!-- doxytag: member="qubits_env_mpi.c::getImagAmpEl" ref="a3615f76fd5f57008d9b74bbd10533dd0" args="(MultiQubit multiQubit, long long int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL getImagAmpEl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>index</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the imaginary component of the complex probability amplitude at an index in the state vector. </p>
<p>For debugging purposes.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing a set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>index</em>&nbsp;</td><td>index in state vector of probability amplitudes </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>imaginary component at that index </dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>index</code> is outside [0, <img class="formulaInl" alt="$2^{N}$" src="form_16.png"/>) where <img class="formulaInl" alt="$N = $" src="form_17.png"/> <code>multiQubit.numQubits</code> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00116">116</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00102">getChunkIdFromIndex()</a>, <a class="el" href="qubits_8h_source.html#l00017">ComplexArray::imag</a>, <a class="el" href="precision_8h_source.html#l00026">MPI_QuEST_REAL</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits_8c_source.html#l01971">getProbEl()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00116"></a>00116                                                              {
<a name="l00117"></a>00117         <span class="keywordtype">int</span> chunkId = <a class="code" href="qubits__env__mpi_8c.html#a8605e6a6295174cb4661156eaa709ec4">getChunkIdFromIndex</a>(multiQubit, index);
<a name="l00118"></a>00118         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> el; 
<a name="l00119"></a>00119         <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>==chunkId){
<a name="l00120"></a>00120                 el = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[index-chunkId*multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>];
<a name="l00121"></a>00121         }
<a name="l00122"></a>00122         MPI_Bcast(&amp;el, 1, <a class="code" href="precision_8h.html#a750ad290949ef7dc4afdfbd8231a5057">MPI_QuEST_REAL</a>, chunkId, MPI_COMM_WORLD);
<a name="l00123"></a>00123         <span class="keywordflow">return</span> el; 
<a name="l00124"></a>00124 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a317b786f577fa6bc136ea7f0ee7330a7"></a><!-- doxytag: member="qubits_env_mpi.c::getRealAmpEl" ref="a317b786f577fa6bc136ea7f0ee7330a7" args="(MultiQubit multiQubit, long long int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL getRealAmpEl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>index</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the real component of the complex probability amplitude at an index in the state vector. </p>
<p>For debugging purposes.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing a set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>index</em>&nbsp;</td><td>index in state vector of probability amplitudes </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>real component at that index </dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>index</code> is outside [0, <img class="formulaInl" alt="$2^{N}$" src="form_16.png"/>) where <img class="formulaInl" alt="$N = $" src="form_17.png"/> <code>multiQubit.numQubits</code> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00106">106</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00102">getChunkIdFromIndex()</a>, <a class="el" href="precision_8h_source.html#l00026">MPI_QuEST_REAL</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00016">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p>Referenced by <a class="el" href="qubits_8c_source.html#l01971">getProbEl()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00106"></a>00106                                                              {
<a name="l00107"></a>00107         <span class="keywordtype">int</span> chunkId = <a class="code" href="qubits__env__mpi_8c.html#a8605e6a6295174cb4661156eaa709ec4">getChunkIdFromIndex</a>(multiQubit, index);
<a name="l00108"></a>00108         <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> el; 
<a name="l00109"></a>00109         <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>==chunkId){
<a name="l00110"></a>00110                 el = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[index-chunkId*multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>];
<a name="l00111"></a>00111         }
<a name="l00112"></a>00112         MPI_Bcast(&amp;el, 1, <a class="code" href="precision_8h.html#a750ad290949ef7dc4afdfbd8231a5057">MPI_QuEST_REAL</a>, chunkId, MPI_COMM_WORLD);
<a name="l00113"></a>00113         <span class="keywordflow">return</span> el; 
<a name="l00114"></a>00114 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="adb4b0373425b282abed27742d0ce0872"></a><!-- doxytag: member="qubits_env_mpi.c::getRotAngle" ref="adb4b0373425b282abed27742d0ce0872" args="(int chunkIsUpper, Complex *rot1, Complex *rot2, Complex alpha, Complex beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void getRotAngle </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>chunkIsUpper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a> *&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a> *&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get rotation values for a given chunk. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>chunkIsUpper</em>&nbsp;</td><td>1: chunk is in upper half of block, 0: chunk is in lower half</td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>rot1,rot2</em>&nbsp;</td><td>rotation values to use, allocated for upper/lower such that </p>
<div class="fragment"><pre class="fragment">
stateUpper = rot1 * stateUpper + conj(rot2)  * stateLower
</pre></div><p> or </p>
<div class="fragment"><pre class="fragment">
stateLower = rot1 * stateUpper + conj(rot2)  * stateLower
</pre></div></td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>alpha,beta</em>&nbsp;</td><td>initial rotation values </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00186">186</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00025">Complex::imag</a>, and <a class="el" href="qubits_8h_source.html#l00024">Complex::real</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00288">compactUnitary()</a>, and <a class="el" href="qubits__env__mpi_8c_source.html#l00370">controlledCompactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00187"></a>00187 {
<a name="l00188"></a>00188         <span class="keywordflow">if</span> (<a class="code" href="qubits__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>){
<a name="l00189"></a>00189                 *rot1=alpha;
<a name="l00190"></a>00190                 rot2-&gt;<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>=-beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;
<a name="l00191"></a>00191                 rot2-&gt;<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>=-beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;
<a name="l00192"></a>00192         } <span class="keywordflow">else</span> {
<a name="l00193"></a>00193                 *rot1=beta;
<a name="l00194"></a>00194                 *rot2=alpha;
<a name="l00195"></a>00195         }
<a name="l00196"></a>00196 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5c9b2f129bdffaaba9857f6eddecbb17"></a><!-- doxytag: member="qubits_env_mpi.c::getRotAngleFromUnitaryMatrix" ref="a5c9b2f129bdffaaba9857f6eddecbb17" args="(int chunkIsUpper, Complex *rot1, Complex *rot2, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void getRotAngleFromUnitaryMatrix </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>chunkIsUpper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a> *&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a> *&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get rotation values for a given chunk given a unitary matrix. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>chunkIsUpper</em>&nbsp;</td><td>1: chunk is in upper half of block, 0: chunk is in lower half</td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>rot1,rot2</em>&nbsp;</td><td>rotation values to use, allocated for upper/lower such that </p>
<div class="fragment"><pre class="fragment">
stateUpper = rot1 * stateUpper + conj(rot2)  * stateLower
</pre></div><p> or </p>
<div class="fragment"><pre class="fragment">
stateLower = rot1 * stateUpper + conj(rot2)  * stateLower
</pre></div> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>u</em>&nbsp;</td><td>unitary matrix operation </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00211">211</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00032">ComplexMatrix2::r0c0</a>, <a class="el" href="qubits_8h_source.html#l00032">ComplexMatrix2::r0c1</a>, <a class="el" href="qubits_8h_source.html#l00033">ComplexMatrix2::r1c0</a>, and <a class="el" href="qubits_8h_source.html#l00033">ComplexMatrix2::r1c1</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00413">controlledUnitary()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00457">multiControlledUnitary()</a>, and <a class="el" href="qubits__env__mpi_8c_source.html#l00328">unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00212"></a>00212 {
<a name="l00213"></a>00213         <span class="keywordflow">if</span> (<a class="code" href="qubits__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>){
<a name="l00214"></a>00214                 *rot1=u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>;
<a name="l00215"></a>00215                 *rot2=u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>;
<a name="l00216"></a>00216         } <span class="keywordflow">else</span> {
<a name="l00217"></a>00217                 *rot1=u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>;
<a name="l00218"></a>00218                 *rot2=u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>;
<a name="l00219"></a>00219         }
<a name="l00220"></a>00220 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa09b5dd93de6df1384b8f2c0041749ab"></a><!-- doxytag: member="qubits_env_mpi.c::hadamard" ref="aa09b5dd93de6df1384b8f2c0041749ab" args="(MultiQubit multiQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hadamard </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply the single-qubit Hadamard gate. </p>
<p>This takes <img class="formulaInl" alt="$|0\rangle$" src="form_43.png"/> to <img class="formulaInl" alt="$|+\rangle$" src="form_44.png"/> and <img class="formulaInl" alt="$|1\rangle$" src="form_45.png"/> to <img class="formulaInl" alt="$|-\rangle$" src="form_46.png"/>, and is equivalent to a rotation of <img class="formulaInl" alt="$\pi$" src="form_36.png"/> around the x-axis then <img class="formulaInl" alt="$\pi/2$" src="form_10.png"/> about the y-axis on the Bloch-sphere. I.e. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{1}{\sqrt{2}} \begin{pmatrix} 1 &amp; 1 \\ 1 &amp; -1 \end{pmatrix} \]" src="form_47.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {H}; \end{tikzpicture} } \]" src="form_48.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to operate on </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>targetQubit</code> is outside [0, <code>multiQubit.numQubits</code>). </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00618">618</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00164">chunkIsUpper()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00256">exchangeStateVectors()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00231">getChunkPairId()</a>, <a class="el" href="qubits_8c_source.html#l01400">hadamardDistributed()</a>, <a class="el" href="qubits_8c_source.html#l01339">hadamardLocal()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00249">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::pairStateVec</a>, <a class="el" href="qubits__env__local_8c_source.html#l00246">QuESTAssert()</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00619"></a>00619 {
<a name="l00620"></a>00620         <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00621"></a>00621 
<a name="l00622"></a>00622         <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span>
<a name="l00623"></a>00623         <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="qubits__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00624"></a>00624 
<a name="l00625"></a>00625         <span class="comment">// rank&apos;s chunk is in upper half of block </span>
<a name="l00626"></a>00626         <span class="keywordtype">int</span> rankIsUpper;
<a name="l00627"></a>00627         <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span>
<a name="l00628"></a>00628 
<a name="l00629"></a>00629         <span class="keywordflow">if</span> (useLocalDataOnly){
<a name="l00630"></a>00630                 <span class="comment">// all values required to update state vector lie in this rank</span>
<a name="l00631"></a>00631                 <a class="code" href="qubits_8c.html#aa9f0718b4dd794a3e1b143e3b153bfc5">hadamardLocal</a>(multiQubit, targetQubit);
<a name="l00632"></a>00632         } <span class="keywordflow">else</span> {
<a name="l00633"></a>00633                 <span class="comment">// need to get corresponding chunk of state vector from other rank</span>
<a name="l00634"></a>00634                 rankIsUpper = <a class="code" href="qubits__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00635"></a>00635                 pairRank = <a class="code" href="qubits__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4" title="get position of corresponding chunk, holding values required to update values in...">getChunkPairId</a>(rankIsUpper, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00636"></a>00636                 <span class="comment">//printf(&quot;%d rank has pair rank: %d\n&quot;, multiQubit.rank, pairRank);</span>
<a name="l00637"></a>00637                 <span class="comment">// get corresponding values from my pair</span>
<a name="l00638"></a>00638                 <a class="code" href="qubits__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a>(multiQubit, pairRank);
<a name="l00639"></a>00639                 <span class="comment">// this rank&apos;s values are either in the upper of lower half of the block. send values to hadamardDistributed</span>
<a name="l00640"></a>00640                 <span class="comment">// in the correct order</span>
<a name="l00641"></a>00641                 <span class="keywordflow">if</span> (rankIsUpper){
<a name="l00642"></a>00642                         <a class="code" href="qubits_8c.html#ae6a897066979fc52d977007d959ca09d" title="Rotate a single qubit by {{1,1},{1,-1}}/sqrt2.">hadamardDistributed</a>(multiQubit,targetQubit,
<a name="l00643"></a>00643                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>, <span class="comment">//upper</span>
<a name="l00644"></a>00644                                 multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//lower</span>
<a name="l00645"></a>00645                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>, rankIsUpper); <span class="comment">//output</span>
<a name="l00646"></a>00646                 } <span class="keywordflow">else</span> {
<a name="l00647"></a>00647                         <a class="code" href="qubits_8c.html#ae6a897066979fc52d977007d959ca09d" title="Rotate a single qubit by {{1,1},{1,-1}}/sqrt2.">hadamardDistributed</a>(multiQubit,targetQubit,
<a name="l00648"></a>00648                                 multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//upper</span>
<a name="l00649"></a>00649                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>, <span class="comment">//lower</span>
<a name="l00650"></a>00650                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>, rankIsUpper); <span class="comment">//output</span>
<a name="l00651"></a>00651                 }
<a name="l00652"></a>00652         }
<a name="l00653"></a>00653 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4d043bb0cee54a5f94faf3ffc34a6790"></a><!-- doxytag: member="qubits_env_mpi.c::halfMatrixBlockFitsInChunk" ref="a4d043bb0cee54a5f94faf3ffc34a6790" args="(long long int chunkSize, int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int halfMatrixBlockFitsInChunk </td>
          <td>(</td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>chunkSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>return whether the current qubit rotation will use blocks that fit within a single chunk. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>chunkSize</em>&nbsp;</td><td>number of amps in chunk </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit being rotated </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>1: one chunk fits in one block 0: chunk is larger than block </dd></dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00249">249</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00694">collapseToOutcome()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00288">compactUnitary()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00370">controlledCompactUnitary()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00532">controlledNot()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00413">controlledUnitary()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00675">findProbabilityOfOutcome()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00618">hadamard()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00728">measureWithStats()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00457">multiControlledUnitary()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00600">phaseGate()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00503">sigmaX()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00569">sigmaY()</a>, and <a class="el" href="qubits__env__mpi_8c_source.html#l00328">unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00250"></a>00250 {
<a name="l00251"></a>00251         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeHalfBlock = 1LL &lt;&lt; (targetQubit);
<a name="l00252"></a>00252         <span class="keywordflow">if</span> (chunkSize &gt; sizeHalfBlock) <span class="keywordflow">return</span> 1;
<a name="l00253"></a>00253         <span class="keywordflow">else</span> <span class="keywordflow">return</span> 0;
<a name="l00254"></a>00254 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad84a3ce68d1ca02b4e3f741ea45b6054"></a><!-- doxytag: member="qubits_env_mpi.c::initQuESTEnv" ref="ad84a3ce68d1ca02b4e3f741ea45b6054" args="(QuESTEnv *env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initQuESTEnv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a> *&nbsp;</td>
          <td class="paramname"> <em>env</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize the QuEST environment. </p>
<p>If something needs to be done to set up the execution environment, such as initializing MPI when running in distributed mode, it is handled here</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00035">35</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits_8c_source.html#l00018">DEBUG</a>, <a class="el" href="mt19937ar_8c_source.html#l00076">init_by_array()</a>, <a class="el" href="qubits_8h_source.html#l00069">QuESTEnv::numRanks</a>, and <a class="el" href="qubits_8h_source.html#l00068">QuESTEnv::rank</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00035"></a>00035                                 {
<a name="l00036"></a>00036         <span class="comment">// init MPI environment</span>
<a name="l00037"></a>00037         <span class="keywordtype">int</span> rank, numRanks, initialized;
<a name="l00038"></a>00038         MPI_Initialized(&amp;initialized);
<a name="l00039"></a>00039         <span class="keywordflow">if</span> (!initialized){
<a name="l00040"></a>00040                 MPI_Init(NULL, NULL);
<a name="l00041"></a>00041                 MPI_Comm_size(MPI_COMM_WORLD, &amp;numRanks);
<a name="l00042"></a>00042                 MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);
<a name="l00043"></a>00043 
<a name="l00044"></a>00044                 <span class="keywordflow">if</span> (<a class="code" href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>) {
<a name="l00045"></a>00045                         <span class="keywordtype">char</span> hostName[256];
<a name="l00046"></a>00046                         <span class="keywordtype">int</span> hostNameLen;
<a name="l00047"></a>00047                         MPI_Get_processor_name(hostName, &amp;hostNameLen);
<a name="l00048"></a>00048                         printf(<span class="stringliteral">&quot;rank %d on host %s\n&quot;</span>, rank, hostName);
<a name="l00049"></a>00049                 }
<a name="l00050"></a>00050                 env-&gt;<a class="code" href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">rank</a>=rank;
<a name="l00051"></a>00051                 env-&gt;<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>=numRanks;
<a name="l00052"></a>00052 
<a name="l00053"></a>00053         <span class="comment">// init MT random number generator with two keys -- time and pid </span>
<a name="l00054"></a>00054         <span class="comment">// it is ok that all procs will get the same seed as random numbers will only be </span>
<a name="l00055"></a>00055         <span class="comment">// used by the master process</span>
<a name="l00056"></a>00056         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> secs = time(NULL);
<a name="l00057"></a>00057         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> pid = getpid();
<a name="l00058"></a>00058         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> key[2];
<a name="l00059"></a>00059         key[0] = secs; key[1] = pid;
<a name="l00060"></a>00060         <a class="code" href="mt19937ar_8c.html#ac1283f9b1ed571332f5ffe53545ffc16">init_by_array</a>(key, 2);
<a name="l00061"></a>00061         } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;ERROR: Trying to initialize QuESTEnv multiple times. Ignoring\n&quot;</span>);
<a name="l00062"></a>00062 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af0ea25f00987af4c53f17c9cca62ab41"></a><!-- doxytag: member="qubits_env_mpi.c::isChunkToSkipInFindPZero" ref="af0ea25f00987af4c53f17c9cca62ab41" args="(int chunkId, long long int chunkSize, int measureQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int isChunkToSkipInFindPZero </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>chunkId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>chunkSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Find chunks to skip when calculating probability of qubit being zero. </p>
<p>When calculating probability of a bit q being zero, sum up 2^q values, then skip 2^q values, etc. This function finds if an entire chunk is in the range of values to be skipped</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>chunkId</em>&nbsp;</td><td>id of chunk in state vector </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>chunkSize</em>&nbsp;</td><td>number of amps in chunk </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubi</em>&nbsp;</td><td>qubit being measured </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>int -- 1: skip, 0: don't skip </dd></dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00666">666</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00694">collapseToOutcome()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00675">findProbabilityOfOutcome()</a>, and <a class="el" href="qubits__env__mpi_8c_source.html#l00728">measureWithStats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00667"></a>00667 {
<a name="l00668"></a>00668         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeHalfBlock = 1LL &lt;&lt; (measureQubit);
<a name="l00669"></a>00669         <span class="keywordtype">int</span> numChunksToSkip = sizeHalfBlock/chunkSize;
<a name="l00670"></a>00670         <span class="comment">// calculate probability by summing over numChunksToSkip, then skipping numChunksToSkip, etc</span>
<a name="l00671"></a>00671         <span class="keywordtype">int</span> bitToCheck = chunkId &amp; numChunksToSkip;
<a name="l00672"></a>00672         <span class="keywordflow">return</span> bitToCheck;
<a name="l00673"></a>00673 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad5774247d836267175c664cd0e451bcb"></a><!-- doxytag: member="qubits_env_mpi.c::measure" ref="ad5774247d836267175c664cd0e451bcb" args="(MultiQubit multiQubit, int measureQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int measure </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Measures a single qubit, collapsing it randomly to 0 or 1. </p>
<p>Outcome probabilities are weighted by the state vector, which is irreversibly changed after collapse to be consistent with the outcome.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the measurement outcome, 0 or 1 </dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>measureQubit</code> is outside [0, <code>multiQubit.numQubits</code>) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00722">722</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00215">measureWithStats()</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="qubits__env__local_8c_source.html#l00246">QuESTAssert()</a>, and <a class="el" href="precision_8h_source.html#l00025">REAL</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00722"></a>00722                                                     {
<a name="l00723"></a>00723     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(measureQubit &gt;= 0 &amp;&amp; measureQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 2, __func__);
<a name="l00724"></a>00724     <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateProb; 
<a name="l00725"></a>00725     <span class="keywordflow">return</span> <a class="code" href="qubits_8h.html#a2ac46e470c750bf93c754e06c64b0a7a" title="Measures a single qubit, collapsing it randomly to 0 or 1, and additionally gives...">measureWithStats</a>(multiQubit, measureQubit, &amp;stateProb); 
<a name="l00726"></a>00726 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2ac46e470c750bf93c754e06c64b0a7a"></a><!-- doxytag: member="qubits_env_mpi.c::measureWithStats" ref="a2ac46e470c750bf93c754e06c64b0a7a" args="(MultiQubit multiQubit, int measureQubit, REAL *stateProb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int measureWithStats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL *&nbsp;</td>
          <td class="paramname"> <em>stateProb</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Measures a single qubit, collapsing it randomly to 0 or 1, and additionally gives the probability of that outcome. </p>
<p>Outcome probabilities are weighted by the state vector, which is irreversibly changed after collapse to be consistent with the outcome.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateProb</em>&nbsp;</td><td>a pointer to a REAL which is set to the probability of the occurred outcome </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the measurement outcome, 0 or 1 </dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>measureQubit</code> is outside [0, <code>multiQubit.numQubits</code>) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00728">728</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l01898">collapseToOutcomeDistributedRenorm()</a>, <a class="el" href="qubits_8c_source.html#l01940">collapseToOutcomeDistributedSetZero()</a>, <a class="el" href="qubits_8c_source.html#l01816">collapseToOutcomeLocal()</a>, <a class="el" href="qubits__env__local_8c_source.html#l00189">findProbabilityOfOutcome()</a>, <a class="el" href="mt19937ar_8c_source.html#l00146">genrand_real1()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00249">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00666">isChunkToSkipInFindPZero()</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="qubits__env__local_8c_source.html#l00246">QuESTAssert()</a>, <a class="el" href="precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="precision_8h_source.html#l00028">REAL_EPS</a>.</p>

<p>Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00209">measure()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00728"></a>00728                                                                               {
<a name="l00729"></a>00729     <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(measureQubit &gt;= 0 &amp;&amp; measureQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 2, __func__);
<a name="l00730"></a>00730 
<a name="l00731"></a>00731     <span class="keywordtype">int</span> outcome;
<a name="l00732"></a>00732     <span class="comment">// find probability of qubit being in state 1</span>
<a name="l00733"></a>00733     <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateProbInternal = <a class="code" href="qubits_8h.html#ad315c941a51bc053d39ebfa2040fd32e" title="Gives the probability of a specified qubit being measured in the given outcome (0...">findProbabilityOfOutcome</a>(multiQubit, measureQubit, 1);
<a name="l00734"></a>00734 
<a name="l00735"></a>00735     <span class="comment">// we can&apos;t collapse to a state that has a probability too close to zero</span>
<a name="l00736"></a>00736     <span class="keywordflow">if</span> (stateProbInternal&lt;<a class="code" href="precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a>) outcome=0;
<a name="l00737"></a>00737     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (1-stateProbInternal&lt;<a class="code" href="precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a>) outcome=1;
<a name="l00738"></a>00738     <span class="keywordflow">else</span> {
<a name="l00739"></a>00739         <span class="comment">// ok. both P(0) and P(1) are large enough to resolve</span>
<a name="l00740"></a>00740         <span class="comment">// generate random float on [0,1]</span>
<a name="l00741"></a>00741         <span class="keywordtype">float</span> randNum = <a class="code" href="mt19937ar_8c.html#ac94ab75771800274ed1a2bedeca86f04">genrand_real1</a>();
<a name="l00742"></a>00742         <span class="keywordflow">if</span> (randNum&lt;=stateProbInternal) outcome = 1;
<a name="l00743"></a>00743         <span class="keywordflow">else</span> outcome = 0;
<a name="l00744"></a>00744     } 
<a name="l00745"></a>00745     <span class="keywordflow">if</span> (outcome==0) stateProbInternal = 1-stateProbInternal;
<a name="l00746"></a>00746 
<a name="l00747"></a>00747         <span class="keywordtype">int</span> skipValuesWithinRank = <a class="code" href="qubits__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, measureQubit);
<a name="l00748"></a>00748     <span class="keywordflow">if</span> (skipValuesWithinRank) {
<a name="l00749"></a>00749         <a class="code" href="qubits_8c.html#a01d9a8b7ff0e09ec399e158389783aa9" title="Update the state vector to be consistent with measuring measureQubit=0 if outcome=0...">collapseToOutcomeLocal</a>(multiQubit, measureQubit, stateProbInternal, outcome);
<a name="l00750"></a>00750     } <span class="keywordflow">else</span> {
<a name="l00751"></a>00751         <span class="keywordflow">if</span> (!<a class="code" href="qubits__env__mpi_8c.html#af0ea25f00987af4c53f17c9cca62ab41" title="Find chunks to skip when calculating probability of qubit being zero.">isChunkToSkipInFindPZero</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, measureQubit)){
<a name="l00752"></a>00752             <span class="comment">// chunk has amps for q=0</span>
<a name="l00753"></a>00753             <span class="keywordflow">if</span> (outcome==0) <a class="code" href="qubits_8c.html#a7a1f63ec3c42d9ad72f1f01c14a885db" title="Renormalise parts of the state vector where measureQubit=0 or 1, based on the total...">collapseToOutcomeDistributedRenorm</a>(multiQubit, measureQubit, 
<a name="l00754"></a>00754                     stateProbInternal);
<a name="l00755"></a>00755             <span class="keywordflow">else</span> <a class="code" href="qubits_8c.html#a78908fe8e75a21fd4f7fa7dff05d6be1" title="Set all amplitudes in one chunk to 0.">collapseToOutcomeDistributedSetZero</a>(multiQubit, measureQubit);
<a name="l00756"></a>00756         } <span class="keywordflow">else</span> {
<a name="l00757"></a>00757             <span class="comment">// chunk has amps for q=1</span>
<a name="l00758"></a>00758             <span class="keywordflow">if</span> (outcome==1) <a class="code" href="qubits_8c.html#a7a1f63ec3c42d9ad72f1f01c14a885db" title="Renormalise parts of the state vector where measureQubit=0 or 1, based on the total...">collapseToOutcomeDistributedRenorm</a>(multiQubit, measureQubit, 
<a name="l00759"></a>00759                     stateProbInternal);
<a name="l00760"></a>00760             <span class="keywordflow">else</span> <a class="code" href="qubits_8c.html#a78908fe8e75a21fd4f7fa7dff05d6be1" title="Set all amplitudes in one chunk to 0.">collapseToOutcomeDistributedSetZero</a>(multiQubit, measureQubit);
<a name="l00761"></a>00761         }
<a name="l00762"></a>00762     }
<a name="l00763"></a>00763 
<a name="l00764"></a>00764     *stateProb = stateProbInternal;
<a name="l00765"></a>00765     <span class="keywordflow">return</span> outcome;
<a name="l00766"></a>00766 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae395a79690283ed81106afadd7a8cd8a"></a><!-- doxytag: member="qubits_env_mpi.c::multiControlledUnitary" ref="ae395a79690283ed81106afadd7a8cd8a" args="(MultiQubit multiQubit, int *controlQubits, const int numControlQubits, const int targetQubit, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multiControlledUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>controlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>numControlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply a general multiple-control single-target unitary, which can include a global phase factor. </p>
<p>Any number of control qubits can be specified, and if all have value 1, the given unitary is applied to the target qubit. This effects the many-qubit unitary </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 1 \\ &amp; 1 \\\ &amp; &amp; \ddots \\ &amp; &amp; &amp; u_{00} &amp; u_{01}\\ &amp; &amp; &amp; u_{10} &amp; u_{11} \end{pmatrix} \]" src="form_34.png"/>
</p>
<p> on the control and target qubits. The given 2x2 ComplexMatrix must be unitary, otherwise an error is thrown.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 3) {controls}; \node[draw=none] at (-3.5, 0) {target}; \node[draw=none] at (0, 6) {$\vdots$}; \draw (0, 5) -- (0, 4); \draw (-2, 4) -- (2, 4); \draw[fill=black] (0, 4) circle (.2); \draw (0, 4) -- (0, 2); \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 1); \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {U}; \end{tikzpicture} } \]" src="form_35.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubits</em>&nbsp;</td><td>applies unitary if all qubits in this array equal 1 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>numControlQubits</em>&nbsp;</td><td>number of control qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to operate on </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>u</em>&nbsp;</td><td>single-qubit unitary matrix to apply </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>numControlQubits</code> is outside [1, <code>multiQubit.numQubits</code>]), or if any qubit index (<code>targetQubit</code> or one in <code>controlQubits</code>) is outside [0, <code>multiQubit.numQubits</code>]), or if <code>controlQubits</code> contains <code>targetQubit</code>, or if <code>u</code> is not unitary. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00457">457</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00164">chunkIsUpper()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00256">exchangeStateVectors()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00231">getChunkPairId()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00211">getRotAngleFromUnitaryMatrix()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00249">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits_8c_source.html#l01010">multiControlledUnitaryDistributed()</a>, <a class="el" href="qubits_8c_source.html#l00741">multiControlledUnitaryLocal()</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::pairStateVec</a>, <a class="el" href="qubits__env__local_8c_source.html#l00246">QuESTAssert()</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>, and <a class="el" href="qubits_8c_source.html#l00344">validateMatrixIsUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00458"></a>00458 {
<a name="l00459"></a>00459         <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00460"></a>00460         <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(numControlQubits &gt; 0 &amp;&amp; numControlQubits &lt;= multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 4, __func__);
<a name="l00461"></a>00461         <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(<a class="code" href="qubits_8c.html#ae4fea133d1a8f09ff8da03038100adb2">validateMatrixIsUnitary</a>(u), 5, __func__);
<a name="l00462"></a>00462          
<a name="l00463"></a>00463         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> mask=0;
<a name="l00464"></a>00464         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;numControlQubits; i++) mask = mask | (1LL&lt;&lt;controlQubits[i]);
<a name="l00465"></a>00465         <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(mask &gt;=0 &amp;&amp; mask &lt;= (1LL&lt;&lt;multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>)-1, 2, __func__);
<a name="l00466"></a>00466         <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>((mask &amp; (1LL&lt;&lt;targetQubit)) != (1LL&lt;&lt;targetQubit), 3, __func__);
<a name="l00467"></a>00467         
<a name="l00468"></a>00468         <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span>
<a name="l00469"></a>00469         <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="qubits__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00470"></a>00470         <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> rot1, rot2;
<a name="l00471"></a>00471 
<a name="l00472"></a>00472         <span class="comment">// rank&apos;s chunk is in upper half of block </span>
<a name="l00473"></a>00473         <span class="keywordtype">int</span> rankIsUpper;
<a name="l00474"></a>00474         <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span>
<a name="l00475"></a>00475 
<a name="l00476"></a>00476         <span class="keywordflow">if</span> (useLocalDataOnly){
<a name="l00477"></a>00477                 <span class="comment">// all values required to update state vector lie in this rank</span>
<a name="l00478"></a>00478                 <a class="code" href="qubits_8c.html#a1309eabcba3cb97fbc3cd2e606d17766">multiControlledUnitaryLocal</a>(multiQubit, targetQubit, mask, u);
<a name="l00479"></a>00479         } <span class="keywordflow">else</span> {
<a name="l00480"></a>00480                 <span class="comment">// need to get corresponding chunk of state vector from other rank</span>
<a name="l00481"></a>00481                 rankIsUpper = <a class="code" href="qubits__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00482"></a>00482                 <a class="code" href="qubits__env__mpi_8c.html#a5c9b2f129bdffaaba9857f6eddecbb17" title="Get rotation values for a given chunk given a unitary matrix.">getRotAngleFromUnitaryMatrix</a>(rankIsUpper, &amp;rot1, &amp;rot2, u);
<a name="l00483"></a>00483                 pairRank = <a class="code" href="qubits__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4" title="get position of corresponding chunk, holding values required to update values in...">getChunkPairId</a>(rankIsUpper, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00484"></a>00484                 <span class="comment">//printf(&quot;%d rank has pair rank: %d\n&quot;, multiQubit.rank, pairRank);</span>
<a name="l00485"></a>00485                 <span class="comment">// get corresponding values from my pair</span>
<a name="l00486"></a>00486                 <a class="code" href="qubits__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a>(multiQubit, pairRank);
<a name="l00487"></a>00487                 
<a name="l00488"></a>00488                 <span class="comment">// this rank&apos;s values are either in the upper of lower half of the block. send values to multiControlledUnitaryDistributed</span>
<a name="l00489"></a>00489                 <span class="comment">// in the correct order</span>
<a name="l00490"></a>00490                 <span class="keywordflow">if</span> (rankIsUpper){
<a name="l00491"></a>00491                         <a class="code" href="qubits_8c.html#a9dbf856ebeea0cf0a3ee5aae6782f2d2" title="Apply a unitary operation to a single qubit in the state vector of probability amplitudes...">multiControlledUnitaryDistributed</a>(multiQubit,targetQubit,mask,rot1,rot2,
<a name="l00492"></a>00492                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>, <span class="comment">//upper</span>
<a name="l00493"></a>00493                                 multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//lower</span>
<a name="l00494"></a>00494                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>); <span class="comment">//output</span>
<a name="l00495"></a>00495                 } <span class="keywordflow">else</span> {
<a name="l00496"></a>00496                         <a class="code" href="qubits_8c.html#a9dbf856ebeea0cf0a3ee5aae6782f2d2" title="Apply a unitary operation to a single qubit in the state vector of probability amplitudes...">multiControlledUnitaryDistributed</a>(multiQubit,targetQubit,mask,rot1,rot2,
<a name="l00497"></a>00497                                 multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//upper</span>
<a name="l00498"></a>00498                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>, <span class="comment">//lower</span>
<a name="l00499"></a>00499                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>); <span class="comment">//output</span>
<a name="l00500"></a>00500                 }
<a name="l00501"></a>00501         }
<a name="l00502"></a>00502 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aae7a8a7f1ccbddb7f76b6c52b746bb43"></a><!-- doxytag: member="qubits_env_mpi.c::phaseGate" ref="aae7a8a7f1ccbddb7f76b6c52b746bb43" args="(MultiQubit multiQubit, const int targetQubit, enum phaseGateType type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void phaseGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a>&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00600">600</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00164">chunkIsUpper()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00249">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="qubits_8c_source.html#l01522">phaseGateDistributed()</a>, <a class="el" href="qubits_8c_source.html#l01446">phaseGateLocal()</a>, and <a class="el" href="qubits__env__local_8c_source.html#l00246">QuESTAssert()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00601"></a>00601 {
<a name="l00602"></a>00602         <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00603"></a>00603 
<a name="l00604"></a>00604         <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span>
<a name="l00605"></a>00605         <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="qubits__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00606"></a>00606 
<a name="l00607"></a>00607         <span class="comment">// rank&apos;s chunk is in upper half of block </span>
<a name="l00608"></a>00608         <span class="keywordtype">int</span> rankIsUpper;
<a name="l00609"></a>00609 
<a name="l00610"></a>00610         <span class="keywordflow">if</span> (useLocalDataOnly){
<a name="l00611"></a>00611                 <a class="code" href="qubits_8c.html#a3a54566b73ac84c312d7da4f56ffbc3b">phaseGateLocal</a>(multiQubit, targetQubit, type);
<a name="l00612"></a>00612         } <span class="keywordflow">else</span> {
<a name="l00613"></a>00613                 rankIsUpper = <a class="code" href="qubits__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00614"></a>00614                 <span class="keywordflow">if</span> (!rankIsUpper) <a class="code" href="qubits_8c.html#af832ed00b02a0597b7fe0b714032c54a">phaseGateDistributed</a>(multiQubit, targetQubit, type);
<a name="l00615"></a>00615         }
<a name="l00616"></a>00616 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3587b9d533e633ccf1abf9ad2ce45d8d"></a><!-- doxytag: member="qubits_env_mpi.c::QuESTAssert" ref="a3587b9d533e633ccf1abf9ad2ce45d8d" args="(int isValid, int errorCode, const char *func)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void QuESTAssert </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>isValid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>errorCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>func</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00776">776</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits__env__local_8c_source.html#l00238">exitWithError()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00776"></a>00776                                                               {
<a name="l00777"></a>00777     <span class="keywordflow">if</span> (!isValid) <a class="code" href="qubits__env__local_8c.html#ae5f9019826f35e8b51b1716cfe397b45">exitWithError</a>(errorCode, func);
<a name="l00778"></a>00778 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a62da5b58d8ce84e6f4d24be1b872294e"></a><!-- doxytag: member="qubits_env_mpi.c::reportNodeList" ref="a62da5b58d8ce84e6f4d24be1b872294e" args="(QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportNodeList </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Report a list of CPU hostnames and the rank that is running on each if running with MPI enabled and an error message otherwise. </p>
<p>For debugging purposes. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00096">96</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00068">QuESTEnv::rank</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00096"></a>00096                                  {
<a name="l00097"></a>00097         <span class="keywordtype">char</span> hostName[256];
<a name="l00098"></a>00098         gethostname(hostName, 255);
<a name="l00099"></a>00099         printf(<span class="stringliteral">&quot;hostname on rank %d: %s\n&quot;</span>, env.<a class="code" href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">rank</a>, hostName);
<a name="l00100"></a>00100 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af8a14ae79c3fb2c0b5f6255cc37bebf9"></a><!-- doxytag: member="qubits_env_mpi.c::reportQuESTEnv" ref="af8a14ae79c3fb2c0b5f6255cc37bebf9" args="(QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportQuESTEnv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Report information about the QuEST environment. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00081">81</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00069">QuESTEnv::numRanks</a>, <a class="el" href="qubits_8h_source.html#l00068">QuESTEnv::rank</a>, and <a class="el" href="precision_8h_source.html#l00025">REAL</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00081"></a>00081                                  {
<a name="l00082"></a>00082         <span class="keywordflow">if</span> (env.<a class="code" href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">rank</a>==0){
<a name="l00083"></a>00083                 printf(<span class="stringliteral">&quot;EXECUTION ENVIRONMENT:\n&quot;</span>); 
<a name="l00084"></a>00084                 printf(<span class="stringliteral">&quot;Running distributed (MPI) version\n&quot;</span>);
<a name="l00085"></a>00085                 printf(<span class="stringliteral">&quot;Number of ranks is %d\n&quot;</span>, env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>);
<a name="l00086"></a>00086 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00087"></a>00087 <span class="preprocessor"></span>                printf(<span class="stringliteral">&quot;OpenMP enabled\n&quot;</span>);
<a name="l00088"></a>00088                 printf(<span class="stringliteral">&quot;Number of threads available is %d\n&quot;</span>, omp_get_max_threads());
<a name="l00089"></a>00089 <span class="preprocessor"># else</span>
<a name="l00090"></a>00090 <span class="preprocessor"></span>                printf(<span class="stringliteral">&quot;OpenMP disabled\n&quot;</span>);
<a name="l00091"></a>00091 <span class="preprocessor"># endif </span>
<a name="l00092"></a>00092 <span class="preprocessor"></span>                printf(<span class="stringliteral">&quot;Precision: size of REAL is %ld bytes\n&quot;</span>, <span class="keyword">sizeof</span>(<a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>));
<a name="l00093"></a>00093         }
<a name="l00094"></a>00094 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a86e396e06b7d527cac20ba0108872423"></a><!-- doxytag: member="qubits_env_mpi.c::sigmaX" ref="a86e396e06b7d527cac20ba0108872423" args="(MultiQubit multiQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaX </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply the single-qubit sigma-X (also known as the X, Pauli-X, NOT or bit-flip) gate. </p>
<p>This is a rotation of <img class="formulaInl" alt="$\pi$" src="form_36.png"/> around the x-axis on the Bloch sphere. I.e. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 0 &amp; 1 \\ 1 &amp; 0 \end{pmatrix} \]" src="form_37.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (2, 0); \draw (0, 0) circle (.5); \draw (0, .5) -- (0, -.5); \end{tikzpicture} } \]" src="form_38.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to operate on </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>targetQubit</code> is outside [0, <code>multiQubit.numQubits</code>). </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00503">503</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00164">chunkIsUpper()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00256">exchangeStateVectors()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00231">getChunkPairId()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00249">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::pairStateVec</a>, <a class="el" href="qubits__env__local_8c_source.html#l00246">QuESTAssert()</a>, <a class="el" href="qubits_8c_source.html#l01119">sigmaXDistributed()</a>, <a class="el" href="qubits_8c_source.html#l01060">sigmaXLocal()</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00504"></a>00504 {
<a name="l00505"></a>00505         <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00506"></a>00506 
<a name="l00507"></a>00507         <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span>
<a name="l00508"></a>00508         <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="qubits__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00509"></a>00509 
<a name="l00510"></a>00510         <span class="comment">// rank&apos;s chunk is in upper half of block </span>
<a name="l00511"></a>00511         <span class="keywordtype">int</span> rankIsUpper;
<a name="l00512"></a>00512         <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span>
<a name="l00513"></a>00513 
<a name="l00514"></a>00514         <span class="keywordflow">if</span> (useLocalDataOnly){
<a name="l00515"></a>00515                 <span class="comment">// all values required to update state vector lie in this rank</span>
<a name="l00516"></a>00516                 <a class="code" href="qubits_8c.html#a74822fd86bb5d81766e6e8dbdcd62df1">sigmaXLocal</a>(multiQubit, targetQubit);
<a name="l00517"></a>00517         } <span class="keywordflow">else</span> {
<a name="l00518"></a>00518                 <span class="comment">// need to get corresponding chunk of state vector from other rank</span>
<a name="l00519"></a>00519                 rankIsUpper = <a class="code" href="qubits__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00520"></a>00520                 pairRank = <a class="code" href="qubits__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4" title="get position of corresponding chunk, holding values required to update values in...">getChunkPairId</a>(rankIsUpper, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00521"></a>00521                 <span class="comment">//printf(&quot;%d rank has pair rank: %d\n&quot;, multiQubit.rank, pairRank);</span>
<a name="l00522"></a>00522                 <span class="comment">// get corresponding values from my pair</span>
<a name="l00523"></a>00523                 <a class="code" href="qubits__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a>(multiQubit, pairRank);
<a name="l00524"></a>00524                 <span class="comment">// this rank&apos;s values are either in the upper of lower half of the block. sigmaX just replaces</span>
<a name="l00525"></a>00525                 <span class="comment">// this rank&apos;s values with pair values</span>
<a name="l00526"></a>00526                 <a class="code" href="qubits_8c.html#a2275fff50824fe47485890ff5a857785" title="Rotate a single qubit by {{0,1},{1,0}.">sigmaXDistributed</a>(multiQubit, targetQubit,
<a name="l00527"></a>00527                         multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">// in</span>
<a name="l00528"></a>00528                         multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>); <span class="comment">// out</span>
<a name="l00529"></a>00529         }
<a name="l00530"></a>00530 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1f54d70a42403f7e1c2e2c2007332f61"></a><!-- doxytag: member="qubits_env_mpi.c::sigmaY" ref="a1f54d70a42403f7e1c2e2c2007332f61" args="(MultiQubit multiQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaY </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply the single-qubit sigma-Y (also known as the Y or Pauli-Y) gate. </p>
<p>This is a rotation of <img class="formulaInl" alt="$\pi$" src="form_36.png"/> around the Y-axis on the Bloch sphere. I.e. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 0 &amp; -i \\ i &amp; 0 \end{pmatrix} \]" src="form_39.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$\sigma_y$}; \end{tikzpicture} } \]" src="form_40.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to operate on </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>targetQubit</code> is outside [0, <code>multiQubit.numQubits</code>). </td></tr>
  </table>
  </dd>
</dl>

<p><p>fix -- put duplicate code (sigmaX, sigmaY) in seperate function </p>
</p>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00569">569</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00164">chunkIsUpper()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00256">exchangeStateVectors()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00231">getChunkPairId()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00249">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::pairStateVec</a>, <a class="el" href="qubits__env__local_8c_source.html#l00246">QuESTAssert()</a>, <a class="el" href="qubits_8c_source.html#l01306">sigmaYDistributed()</a>, <a class="el" href="qubits_8c_source.html#l01247">sigmaYLocal()</a>, and <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00570"></a>00570 {
<a name="l00571"></a>00571         <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00572"></a>00572 
<a name="l00573"></a>00573         <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span>
<a name="l00574"></a>00574         <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="qubits__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00575"></a>00575 
<a name="l00576"></a>00576         <span class="comment">// rank&apos;s chunk is in upper half of block </span>
<a name="l00577"></a>00577         <span class="keywordtype">int</span> rankIsUpper;
<a name="l00578"></a>00578         <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span>
<a name="l00579"></a>00579 
<a name="l00580"></a>00580         <span class="keywordflow">if</span> (useLocalDataOnly){
<a name="l00581"></a>00581                 <span class="comment">// all values required to update state vector lie in this rank</span>
<a name="l00582"></a>00582                 <a class="code" href="qubits_8c.html#a81fbfaed65a742a7dfd622e17652245e">sigmaYLocal</a>(multiQubit, targetQubit);
<a name="l00583"></a>00583         } <span class="keywordflow">else</span> {
<a name="l00585"></a>00585                 <span class="comment">// need to get corresponding chunk of state vector from other rank</span>
<a name="l00586"></a>00586                 rankIsUpper = <a class="code" href="qubits__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00587"></a>00587                 pairRank = <a class="code" href="qubits__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4" title="get position of corresponding chunk, holding values required to update values in...">getChunkPairId</a>(rankIsUpper, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00588"></a>00588                 <span class="comment">//printf(&quot;%d rank has pair rank: %d\n&quot;, multiQubit.rank, pairRank);</span>
<a name="l00589"></a>00589                 <span class="comment">// get corresponding values from my pair</span>
<a name="l00590"></a>00590                 <a class="code" href="qubits__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a>(multiQubit, pairRank);
<a name="l00591"></a>00591                 <span class="comment">// this rank&apos;s values are either in the upper of lower half of the block. sigmaX just replaces</span>
<a name="l00592"></a>00592                 <span class="comment">// this rank&apos;s values with pair values</span>
<a name="l00593"></a>00593                 <a class="code" href="qubits_8c.html#af5ef5166f00c0572354b4ac53dcf40cf" title="Rotate a single qubit by {{0,-i},{i,0}.">sigmaYDistributed</a>(multiQubit,targetQubit,
<a name="l00594"></a>00594                         multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">// in</span>
<a name="l00595"></a>00595                         multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>, <span class="comment">// out</span>
<a name="l00596"></a>00596                         rankIsUpper);
<a name="l00597"></a>00597         }
<a name="l00598"></a>00598 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8d31fe2d1ad4d01e2a1f5f6b8bc15b77"></a><!-- doxytag: member="qubits_env_mpi.c::syncQuESTEnv" ref="a8d31fe2d1ad4d01e2a1f5f6b8bc15b77" args="(QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void syncQuESTEnv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Guarantees that all code up to the given point has been executed on all nodes (if running in distributed mode). </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00064">64</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>Referenced by <a class="el" href="qubits_8c_source.html#l00295">initializeStateFromSingleFile()</a>, and <a class="el" href="qubits_8c_source.html#l00095">reportStateToScreen()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00064"></a>00064                                {
<a name="l00065"></a>00065         MPI_Barrier(MPI_COMM_WORLD);
<a name="l00066"></a>00066 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac7e38d768a1bd79019f88cc1e6295092"></a><!-- doxytag: member="qubits_env_mpi.c::syncQuESTSuccess" ref="ac7e38d768a1bd79019f88cc1e6295092" args="(int successCode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int syncQuESTSuccess </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>successCode</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Performs a logical AND on all successCodes held by all processes. </p>
<p>If any one process has a zero successCode all processes will return a zero success code.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>env</em>&nbsp;</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>successCode</em>&nbsp;</td><td>1 if process task succeeded, 0 if process task failed </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>1 if all processes succeeded, 0 if any one process failed </dd></dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00068">68</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00068"></a>00068                                      {
<a name="l00069"></a>00069         <span class="keywordtype">int</span> totalSuccess;
<a name="l00070"></a>00070         MPI_Allreduce(&amp;successCode, &amp;totalSuccess, 1, MPI_INT, MPI_LAND, MPI_COMM_WORLD);
<a name="l00071"></a>00071         <span class="keywordflow">return</span> totalSuccess;
<a name="l00072"></a>00072 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7a0877e33700f6bad48adb51b7b3fb67"></a><!-- doxytag: member="qubits_env_mpi.c::unitary" ref="a7a0877e33700f6bad48adb51b7b3fb67" args="(MultiQubit multiQubit, const int targetQubit, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void unitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&nbsp;</td>
          <td class="paramname"> <em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply a general single-qubit unitary (including a global phase factor). </p>
<p>The passed 2x2 ComplexMatrix must be unitary, otherwise an error is thrown.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {U}; \end{tikzpicture} } \]" src="form_22.png"/>
</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>multiQubit</em>&nbsp;</td><td>object representing the set of all qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to operate on </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>u</em>&nbsp;</td><td>unitary matrix to apply </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>exitWithError</em>&nbsp;</td><td>if <code>targetQubit</code> is outside [0, <code>multiQubit.numQubits</code>), or matrix <code>u</code> is not unitary. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="qubits__env__mpi_8c_source.html#l00328">328</a> of file <a class="el" href="qubits__env__mpi_8c_source.html">qubits_env_mpi.c</a>.</p>

<p>References <a class="el" href="qubits_8h_source.html#l00058">MultiQubit::chunkId</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00164">chunkIsUpper()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00256">exchangeStateVectors()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00231">getChunkPairId()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00211">getRotAngleFromUnitaryMatrix()</a>, <a class="el" href="qubits__env__mpi_8c_source.html#l00249">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="qubits_8h_source.html#l00056">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00053">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00051">MultiQubit::pairStateVec</a>, <a class="el" href="qubits__env__local_8c_source.html#l00246">QuESTAssert()</a>, <a class="el" href="qubits_8h_source.html#l00049">MultiQubit::stateVec</a>, <a class="el" href="qubits_8c_source.html#l00629">unitaryDistributed()</a>, <a class="el" href="qubits_8c_source.html#l00503">unitaryLocal()</a>, and <a class="el" href="qubits_8c_source.html#l00344">validateMatrixIsUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00329"></a>00329 {
<a name="l00330"></a>00330         <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f" title="Number of qubits in the state.">numQubits</a>, 1, __func__);
<a name="l00331"></a>00331         <a class="code" href="qubits__env__local_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(<a class="code" href="qubits_8c.html#ae4fea133d1a8f09ff8da03038100adb2">validateMatrixIsUnitary</a>(u), 5, __func__);
<a name="l00332"></a>00332 
<a name="l00333"></a>00333         <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span>
<a name="l00334"></a>00334         <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="qubits__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00335"></a>00335         <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> rot1, rot2;
<a name="l00336"></a>00336 
<a name="l00337"></a>00337         <span class="comment">// rank&apos;s chunk is in upper half of block </span>
<a name="l00338"></a>00338         <span class="keywordtype">int</span> rankIsUpper;
<a name="l00339"></a>00339         <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span>
<a name="l00340"></a>00340 
<a name="l00341"></a>00341         <span class="keywordflow">if</span> (useLocalDataOnly){
<a name="l00342"></a>00342                 <span class="comment">// all values required to update state vector lie in this rank</span>
<a name="l00343"></a>00343                 <a class="code" href="qubits_8c.html#ac134fb45b0a7248c5d15e16eb7139a35">unitaryLocal</a>(multiQubit, targetQubit, u);
<a name="l00344"></a>00344         } <span class="keywordflow">else</span> {
<a name="l00345"></a>00345                 <span class="comment">// need to get corresponding chunk of state vector from other rank</span>
<a name="l00346"></a>00346                 rankIsUpper = <a class="code" href="qubits__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00347"></a>00347                 <a class="code" href="qubits__env__mpi_8c.html#a5c9b2f129bdffaaba9857f6eddecbb17" title="Get rotation values for a given chunk given a unitary matrix.">getRotAngleFromUnitaryMatrix</a>(rankIsUpper, &amp;rot1, &amp;rot2, u);
<a name="l00348"></a>00348                 pairRank = <a class="code" href="qubits__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4" title="get position of corresponding chunk, holding values required to update values in...">getChunkPairId</a>(rankIsUpper, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmps</a>, targetQubit);
<a name="l00349"></a>00349                 <span class="comment">// get corresponding values from my pair</span>
<a name="l00350"></a>00350                         <a class="code" href="qubits__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a>(multiQubit, pairRank);
<a name="l00351"></a>00351 
<a name="l00352"></a>00352                 <span class="comment">// this rank&apos;s values are either in the upper of lower half of the block. </span>
<a name="l00353"></a>00353                 <span class="comment">// send values to compactUnitaryDistributed in the correct order</span>
<a name="l00354"></a>00354                 <span class="keywordflow">if</span> (rankIsUpper){
<a name="l00355"></a>00355                         <a class="code" href="qubits_8c.html#a2343b7240118e89aa615e2c9140b770b" title="Apply a unitary operation to a single qubit given a subset of the state vector with...">unitaryDistributed</a>(multiQubit,targetQubit,rot1,rot2,
<a name="l00356"></a>00356                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>, <span class="comment">//upper</span>
<a name="l00357"></a>00357                                 multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//lower</span>
<a name="l00358"></a>00358                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>); <span class="comment">//output</span>
<a name="l00359"></a>00359                 } <span class="keywordflow">else</span> {
<a name="l00360"></a>00360                         <a class="code" href="qubits_8c.html#a2343b7240118e89aa615e2c9140b770b" title="Apply a unitary operation to a single qubit given a subset of the state vector with...">unitaryDistributed</a>(multiQubit,targetQubit,rot1,rot2,
<a name="l00361"></a>00361                                 multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//upper</span>
<a name="l00362"></a>00362                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>, <span class="comment">//lower</span>
<a name="l00363"></a>00363                                 multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f" title="Probablilty amplitudes for the multi qubit state.">stateVec</a>); <span class="comment">//output</span>
<a name="l00364"></a>00364                 }
<a name="l00365"></a>00365         }
<a name="l00366"></a>00366 
<a name="l00367"></a>00367 
<a name="l00368"></a>00368 }
</pre></div></p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 28 Mar 2018 for Distributed QuEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
