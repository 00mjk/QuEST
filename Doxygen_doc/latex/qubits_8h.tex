\hypertarget{qubits_8h}{}\subsection{qubits.\+h File Reference}
\label{qubits_8h}\index{qubits.\+h@{qubits.\+h}}


The Qu\+E\+ST library A\+PI and objects.  


{\ttfamily \#include \char`\"{}precision.\+h\char`\"{}}\\*
\subsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structComplexArray}{Complex\+Array}
\begin{DoxyCompactList}\small\item\em Represents an array of complex numbers grouped into an array of real components and an array of coressponding complex components. \end{DoxyCompactList}\item 
struct \hyperlink{structComplex}{Complex}
\begin{DoxyCompactList}\small\item\em Represents one complex number. \end{DoxyCompactList}\item 
struct \hyperlink{structComplexMatrix2}{Complex\+Matrix2}
\begin{DoxyCompactList}\small\item\em Represents a 2x2 matrix of complex numbers. \end{DoxyCompactList}\item 
struct \hyperlink{structVector}{Vector}
\begin{DoxyCompactList}\small\item\em Represents a 3-\/vector of real numbers. \end{DoxyCompactList}\item 
struct \hyperlink{structMultiQubit}{Multi\+Qubit}
\begin{DoxyCompactList}\small\item\em Represents a system of qubits. \end{DoxyCompactList}\item 
struct \hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env}
\begin{DoxyCompactList}\small\item\em Information about the environment the program is running in. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{structComplexArray}{Complex\+Array} \hyperlink{qubits_8h_a19e00739fde70a851d068f322cf915c8}{Complex\+Array}
\begin{DoxyCompactList}\small\item\em Represents an array of complex numbers grouped into an array of real components and an array of coressponding complex components. \end{DoxyCompactList}\item 
typedef struct \hyperlink{structComplex}{Complex} \hyperlink{qubits_8h_ad59c9e471673c07782e6c403277ffd8d}{Complex}
\begin{DoxyCompactList}\small\item\em Represents one complex number. \end{DoxyCompactList}\item 
typedef struct \hyperlink{structComplexMatrix2}{Complex\+Matrix2} \hyperlink{qubits_8h_aa6e00518bd2c71030c52d5955e506875}{Complex\+Matrix2}
\begin{DoxyCompactList}\small\item\em Represents a 2x2 matrix of complex numbers. \end{DoxyCompactList}\item 
typedef struct \hyperlink{structVector}{Vector} \hyperlink{qubits_8h_a6ded2cf071c127e518317e3c451af3ef}{Vector}
\begin{DoxyCompactList}\small\item\em Represents a 3-\/vector of real numbers. \end{DoxyCompactList}\item 
typedef struct \hyperlink{structMultiQubit}{Multi\+Qubit} \hyperlink{qubits_8h_af4123a681074068eeeee1562758eef61}{Multi\+Qubit}
\begin{DoxyCompactList}\small\item\em Represents a system of qubits. \end{DoxyCompactList}\item 
typedef struct \hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env} \hyperlink{qubits_8h_aedfe2bb713c31d6133e53b1bd72d7a2c}{Qu\+E\+S\+T\+Env}
\begin{DoxyCompactList}\small\item\em Information about the environment the program is running in. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{qubits_8h_a5739021c733cecc49647956b2f7338ea}{phase\+Gate\+Type} \{ \hyperlink{qubits_8h_a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac}{S\+I\+G\+M\+A\+\_\+Z} =0, 
\hyperlink{qubits_8h_a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f}{S\+\_\+\+G\+A\+TE} =1, 
\hyperlink{qubits_8h_a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab}{T\+\_\+\+G\+A\+TE} =2
 \}
\end{DoxyCompactItemize}
\subsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{qubits_8h_a9c02591bc64c2918503afa231d90d83f}{create\+Multi\+Qubit} (\hyperlink{structMultiQubit}{Multi\+Qubit} $\ast$multi\+Qubit, int num\+Qubits, \hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env} env)
\begin{DoxyCompactList}\small\item\em Create a \hyperlink{structMultiQubit}{Multi\+Qubit} object representing a set of qubits. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_ae5d6acc322314d7a3d8a2eccf00d3b19}{destroy\+Multi\+Qubit} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, \hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env} env)
\begin{DoxyCompactList}\small\item\em Deallocate a \hyperlink{structMultiQubit}{Multi\+Qubit} object representing a set of qubits. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a96f4de9ce7fefc7680a44d601fc3d894}{report\+State} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit)
\begin{DoxyCompactList}\small\item\em Print the current state vector of probability amplitudes for a set of qubits to file. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a842d6884e063a5865a2232cba56b65ac}{report\+State\+To\+Screen} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, \hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env} env, int report\+Rank)
\begin{DoxyCompactList}\small\item\em Print the current state vector of probability amplitudes for a set of qubits to standard out. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_aa5e77e0e64f3a4a3d3f5cc7382bffcd9}{report\+Multi\+Qubit\+Params} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit)
\begin{DoxyCompactList}\small\item\em Report metainformation about a set of qubits\+: number of qubits, number of probability amplitudes. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_acb5b2eff794339090004d29f02a70d9a}{init\+State\+Zero} (\hyperlink{structMultiQubit}{Multi\+Qubit} $\ast$multi\+Qubit)
\begin{DoxyCompactList}\small\item\em Initialise a set of $ N $ qubits to the classical zero state $ {| 0 \rangle}^{\otimes N} $. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a43bcb279fc9717fbd06a19cdef48b9d8}{init\+State\+Plus} (\hyperlink{structMultiQubit}{Multi\+Qubit} $\ast$multi\+Qubit)
\begin{DoxyCompactList}\small\item\em Initialise a set of $ N $ qubits to the plus state $ {| + \rangle}^{\otimes N} = \frac{1}{\sqrt{2^N}} (| 0 \rangle + | 1 \rangle)^{\otimes N} $. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_afc1835c6b43b6e59ce7df7b13f274fc7}{multi\+Controlled\+Phase\+Gate} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, int $\ast$control\+Qubits, int num\+Control\+Qubits)
\begin{DoxyCompactList}\small\item\em Apply the multiple-\/qubit controlled phase gate, also known as the multiple-\/qubit controlled sigmaZ gate. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a11a96159191cbf1b01a1080e7f045aac}{controlled\+Phase\+Gate} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int id\+Qubit1, const int id\+Qubit2)
\begin{DoxyCompactList}\small\item\em Apply the (two-\/qubit) controlled phase gate, also known as the controlled sigmaZ gate. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_adda6c47876a7676488ed0565a19eaa65}{s\+Gate} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int target\+Qubit)
\begin{DoxyCompactList}\small\item\em Apply the single-\/qubit S gate. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_af764ea63a2e870098f4e1ce08562942e}{t\+Gate} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int target\+Qubit)
\begin{DoxyCompactList}\small\item\em Apply the single-\/qubit T gate. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_ad84a3ce68d1ca02b4e3f741ea45b6054}{init\+Qu\+E\+S\+T\+Env} (\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env} $\ast$env)
\begin{DoxyCompactList}\small\item\em Initialize the Qu\+E\+ST environment. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_abd4bc926cd3f9b65610bb228d0c59fe0}{close\+Qu\+E\+S\+T\+Env} (\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env} env)
\begin{DoxyCompactList}\small\item\em Close Qu\+E\+ST environment. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a8d31fe2d1ad4d01e2a1f5f6b8bc15b77}{sync\+Qu\+E\+S\+T\+Env} (\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env} env)
\begin{DoxyCompactList}\small\item\em Guarantees that all code up to the given point has been executed on all nodes (if running in distributed mode) \end{DoxyCompactList}\item 
int \hyperlink{qubits_8h_ac7e38d768a1bd79019f88cc1e6295092}{sync\+Qu\+E\+S\+T\+Success} (int success\+Code)
\begin{DoxyCompactList}\small\item\em Performs a logical A\+ND on all success\+Codes held by all processes. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_af8a14ae79c3fb2c0b5f6255cc37bebf9}{report\+Qu\+E\+S\+T\+Env} (\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env} env)
\begin{DoxyCompactList}\small\item\em Report information about the Qu\+E\+ST environment. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a8f10aabf9f607f19093aee54630caa21}{get\+Environment\+String} (\hyperlink{structQuESTEnv}{Qu\+E\+S\+T\+Env} env, \hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, char str\mbox{[}200\mbox{]})
\item 
\hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} \hyperlink{qubits_8h_a317b786f577fa6bc136ea7f0ee7330a7}{get\+Real\+Amp\+El} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, long long int index)
\begin{DoxyCompactList}\small\item\em Get the real component of the complex probability amplitude at an index in the state vector. \end{DoxyCompactList}\item 
\hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} \hyperlink{qubits_8h_a3615f76fd5f57008d9b74bbd10533dd0}{get\+Imag\+Amp\+El} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, long long int index)
\begin{DoxyCompactList}\small\item\em Get the imaginary component of the complex probability amplitude at an index in the state vector. \end{DoxyCompactList}\item 
\hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} \hyperlink{qubits_8h_a799b10447d6dbdaf960a4d3eedd22014}{get\+Prob\+El} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, long long int index)
\begin{DoxyCompactList}\small\item\em Get the probability of the state at an index in the full state vector. \end{DoxyCompactList}\item 
\hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} \hyperlink{qubits_8h_a818a4c7cd7252d2b10b896b12fa431d3}{calc\+Total\+Probability} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit)
\begin{DoxyCompactList}\small\item\em Calculate the probability of being in any state by taking the norm of the entire state vector. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a03b13dfcabd8c59b50dbdd3af44ba8b2}{compact\+Unitary} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int target\+Qubit, \hyperlink{structComplex}{Complex} alpha, \hyperlink{structComplex}{Complex} beta)
\begin{DoxyCompactList}\small\item\em Apply a single-\/qubit unitary parameterised by two given complex scalars. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a7a0877e33700f6bad48adb51b7b3fb67}{unitary} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int target\+Qubit, \hyperlink{structComplexMatrix2}{Complex\+Matrix2} u)
\begin{DoxyCompactList}\small\item\em Apply a general single-\/qubit unitary (including a global phase factor). \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a6cc7fa705a2f2e6b486b49c5589d5df5}{rotateX} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int rot\+Qubit, \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} angle)
\begin{DoxyCompactList}\small\item\em Rotate a single qubit by a given angle around the X-\/axis of the Bloch-\/sphere. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_ace0d3592d38a990e81a434c4e9681500}{rotateY} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int rot\+Qubit, \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} angle)
\begin{DoxyCompactList}\small\item\em Rotate a single qubit by a given angle around the Y-\/axis of the Bloch-\/sphere. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_abd621412ad30c1b034f4ce153c4afe10}{rotateZ} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int rot\+Qubit, \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} angle)
\begin{DoxyCompactList}\small\item\em Rotate a single qubit by a given angle around the Z-\/axis of the Bloch-\/sphere (also known as a phase shift gate). \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_ab4812953bc457405b3aa05a4c2f64f4a}{controlled\+Compact\+Unitary} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int control\+Qubit, const int target\+Qubit, \hyperlink{structComplex}{Complex} alpha, \hyperlink{structComplex}{Complex} beta)
\begin{DoxyCompactList}\small\item\em Apply a controlled unitary (single control, single target) parameterised by two given complex scalars. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a7fadb225fc385db789e844c87fcba9e1}{rotate\+Around\+Axis} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int rot\+Qubit, \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} angle, \hyperlink{structVector}{Vector} unit\+Axis)
\begin{DoxyCompactList}\small\item\em Rotate a single qubit by a given angle around a given vector on the Bloch-\/sphere. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a8a701526263392599aa21d0d0f05d9d8}{controlled\+Unitary} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int control\+Qubit, const int target\+Qubit, \hyperlink{structComplexMatrix2}{Complex\+Matrix2} u)
\begin{DoxyCompactList}\small\item\em Apply a general controlled unitary (single control, single target), which can include a global phase factor. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_ae395a79690283ed81106afadd7a8cd8a}{multi\+Controlled\+Unitary} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, int $\ast$control\+Qubits, const int num\+Control\+Qubits, const int target\+Qubit, \hyperlink{structComplexMatrix2}{Complex\+Matrix2} u)
\begin{DoxyCompactList}\small\item\em Apply a general multiple-\/control single-\/target unitary, which can include a global phase factor. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a86e396e06b7d527cac20ba0108872423}{sigmaX} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int target\+Qubit)
\begin{DoxyCompactList}\small\item\em Apply the single-\/qubit sigma-\/X (also known as the X, Pauli-\/X, N\+OT or bit-\/flip) gate. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a1f54d70a42403f7e1c2e2c2007332f61}{sigmaY} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int target\+Qubit)
\begin{DoxyCompactList}\small\item\em Apply the single-\/qubit sigma-\/Y (also known as the Y or Pauli-\/Y) gate. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_aebaab86326779de55d335cfea3efde8f}{sigmaZ} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int target\+Qubit)
\begin{DoxyCompactList}\small\item\em Apply the single-\/qubit sigma-\/Z (also known as the Z, Pauli-\/Z or phase-\/flip) gate. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_aa09b5dd93de6df1384b8f2c0041749ab}{hadamard} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int target\+Qubit)
\begin{DoxyCompactList}\small\item\em Apply the single-\/qubit Hadamard gate. \end{DoxyCompactList}\item 
void \hyperlink{qubits_8h_a67576895bbc65463481a8ea24d9b1e22}{controlled\+Not} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int control\+Qubit, const int target\+Qubit)
\begin{DoxyCompactList}\small\item\em Apply the controlled not (single control, single target) gate, also known as the c-\/X, c-\/sigma-\/X, c-\/\+Pauli-\/X and c-\/bit-\/flip gate. \end{DoxyCompactList}\item 
\hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} \hyperlink{qubits_8h_ad315c941a51bc053d39ebfa2040fd32e}{find\+Probability\+Of\+Outcome} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int measure\+Qubit, int outcome)
\begin{DoxyCompactList}\small\item\em Gives the probability of a specified qubit being measured in the given outcome (0 or 1). \end{DoxyCompactList}\item 
\hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} \hyperlink{qubits_8h_a07418ebac70fd9ae5d051d089961631d}{collapse\+To\+Outcome} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, const int measure\+Qubit, int outcome)
\begin{DoxyCompactList}\small\item\em Updates the state vector to be consistent with measuring the measure qubit in the given outcome (0 or 1), and returns the probability of such a measurement outcome. \end{DoxyCompactList}\item 
int \hyperlink{qubits_8h_ad5774247d836267175c664cd0e451bcb}{measure} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, int measure\+Qubit)
\begin{DoxyCompactList}\small\item\em Measures a single qubit, collapsing it randomly to 0 or 1. \end{DoxyCompactList}\item 
int \hyperlink{qubits_8h_a2ac46e470c750bf93c754e06c64b0a7a}{measure\+With\+Stats} (\hyperlink{structMultiQubit}{Multi\+Qubit} multi\+Qubit, int measure\+Qubit, \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{R\+E\+AL} $\ast$state\+Prob)
\begin{DoxyCompactList}\small\item\em Measures a single qubit, collapsing it randomly to 0 or 1, and additionally gives the probability of that outcome. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsubsection{Detailed Description}
The Qu\+E\+ST library A\+PI and objects. 



\subsubsection{Typedef Documentation}
\index{qubits.\+h@{qubits.\+h}!Complex@{Complex}}
\index{Complex@{Complex}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{Complex}{Complex}}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf Complex}  {\bf Complex}}\hypertarget{qubits_8h_ad59c9e471673c07782e6c403277ffd8d}{}\label{qubits_8h_ad59c9e471673c07782e6c403277ffd8d}


Represents one complex number. 

\index{qubits.\+h@{qubits.\+h}!Complex\+Array@{Complex\+Array}}
\index{Complex\+Array@{Complex\+Array}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{Complex\+Array}{ComplexArray}}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf Complex\+Array}  {\bf Complex\+Array}}\hypertarget{qubits_8h_a19e00739fde70a851d068f322cf915c8}{}\label{qubits_8h_a19e00739fde70a851d068f322cf915c8}


Represents an array of complex numbers grouped into an array of real components and an array of coressponding complex components. 

\index{qubits.\+h@{qubits.\+h}!Complex\+Matrix2@{Complex\+Matrix2}}
\index{Complex\+Matrix2@{Complex\+Matrix2}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{Complex\+Matrix2}{ComplexMatrix2}}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf Complex\+Matrix2}  {\bf Complex\+Matrix2}}\hypertarget{qubits_8h_aa6e00518bd2c71030c52d5955e506875}{}\label{qubits_8h_aa6e00518bd2c71030c52d5955e506875}


Represents a 2x2 matrix of complex numbers. 

\index{qubits.\+h@{qubits.\+h}!Multi\+Qubit@{Multi\+Qubit}}
\index{Multi\+Qubit@{Multi\+Qubit}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{Multi\+Qubit}{MultiQubit}}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf Multi\+Qubit}  {\bf Multi\+Qubit}}\hypertarget{qubits_8h_af4123a681074068eeeee1562758eef61}{}\label{qubits_8h_af4123a681074068eeeee1562758eef61}


Represents a system of qubits. 

Qubits are zero-\/based \index{qubits.\+h@{qubits.\+h}!Qu\+E\+S\+T\+Env@{Qu\+E\+S\+T\+Env}}
\index{Qu\+E\+S\+T\+Env@{Qu\+E\+S\+T\+Env}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{Qu\+E\+S\+T\+Env}{QuESTEnv}}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf Qu\+E\+S\+T\+Env}  {\bf Qu\+E\+S\+T\+Env}}\hypertarget{qubits_8h_aedfe2bb713c31d6133e53b1bd72d7a2c}{}\label{qubits_8h_aedfe2bb713c31d6133e53b1bd72d7a2c}


Information about the environment the program is running in. 

In practice, this holds info about M\+PI ranks and helps to hide M\+PI initialization code \index{qubits.\+h@{qubits.\+h}!Vector@{Vector}}
\index{Vector@{Vector}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{Vector}{Vector}}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf Vector}  {\bf Vector}}\hypertarget{qubits_8h_a6ded2cf071c127e518317e3c451af3ef}{}\label{qubits_8h_a6ded2cf071c127e518317e3c451af3ef}


Represents a 3-\/vector of real numbers. 



\subsubsection{Enumeration Type Documentation}
\index{qubits.\+h@{qubits.\+h}!phase\+Gate\+Type@{phase\+Gate\+Type}}
\index{phase\+Gate\+Type@{phase\+Gate\+Type}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{phase\+Gate\+Type}{phaseGateType}}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf phase\+Gate\+Type}}\hypertarget{qubits_8h_a5739021c733cecc49647956b2f7338ea}{}\label{qubits_8h_a5739021c733cecc49647956b2f7338ea}
\begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{S\+I\+G\+M\+A\+\_\+Z@{S\+I\+G\+M\+A\+\_\+Z}!qubits.\+h@{qubits.\+h}}\index{qubits.\+h@{qubits.\+h}!S\+I\+G\+M\+A\+\_\+Z@{S\+I\+G\+M\+A\+\_\+Z}}\item[{\em 
S\+I\+G\+M\+A\+\_\+Z\hypertarget{qubits_8h_a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac}{}\label{qubits_8h_a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac}
}]\index{S\+\_\+\+G\+A\+TE@{S\+\_\+\+G\+A\+TE}!qubits.\+h@{qubits.\+h}}\index{qubits.\+h@{qubits.\+h}!S\+\_\+\+G\+A\+TE@{S\+\_\+\+G\+A\+TE}}\item[{\em 
S\+\_\+\+G\+A\+TE\hypertarget{qubits_8h_a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f}{}\label{qubits_8h_a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f}
}]\index{T\+\_\+\+G\+A\+TE@{T\+\_\+\+G\+A\+TE}!qubits.\+h@{qubits.\+h}}\index{qubits.\+h@{qubits.\+h}!T\+\_\+\+G\+A\+TE@{T\+\_\+\+G\+A\+TE}}\item[{\em 
T\+\_\+\+G\+A\+TE\hypertarget{qubits_8h_a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab}{}\label{qubits_8h_a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab}
}]\end{description}
\end{Desc}


Definition at line 70 of file qubits.\+h.


\begin{DoxyCode}
70 \{\hyperlink{qubits_8h_a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac}{SIGMA\_Z}=0, \hyperlink{qubits_8h_a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f}{S\_GATE}=1, \hyperlink{qubits_8h_a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab}{T\_GATE}=2\};
\end{DoxyCode}


\subsubsection{Function Documentation}
\index{qubits.\+h@{qubits.\+h}!calc\+Total\+Probability@{calc\+Total\+Probability}}
\index{calc\+Total\+Probability@{calc\+Total\+Probability}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{calc\+Total\+Probability(\+Multi\+Qubit multi\+Qubit)}{calcTotalProbability(MultiQubit multiQubit)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf R\+E\+AL} calc\+Total\+Probability (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_a818a4c7cd7252d2b10b896b12fa431d3}{}\label{qubits_8h_a818a4c7cd7252d2b10b896b12fa431d3}


Calculate the probability of being in any state by taking the norm of the entire state vector. 

Should be equal to 1.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em multi\+Qubit} & object representing a set of qubits \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
total probability 
\end{DoxyReturn}


Definition at line 61 of file qubits\+\_\+env\+\_\+local.\+c.



References chunk\+Is\+Upper(), D\+E\+B\+UG, Complex\+Array\+::imag, M\+P\+I\+\_\+\+Qu\+E\+S\+T\+\_\+\+R\+E\+AL, Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Chunks, Complex\+Array\+::real, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
61                                                 \{
62   \textcolor{comment}{/* IJB - implemented using Kahan summation for greater accuracy at a slight floating}
63 \textcolor{comment}{     point operation overhead. For more details see https://en.wikipedia.org/wiki/Kahan\_summation\_algorithm
       */}
64   \textcolor{comment}{/* Don't change the bracketing in this routine! */}
65   \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} pTotal=0; 
66   \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} y, t, c;
67   \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
68   \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numAmpsPerRank = multiQubit.\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps};
69   c = 0.0;
70   \textcolor{keywordflow}{for} (index=0; index<numAmpsPerRank; index++)\{ 
71     \textcolor{comment}{/* Perform pTotal+=multiQubit.stateVec.real[index]*multiQubit.stateVec.real[index]; by Kahan */}
72    \textcolor{comment}{// pTotal+=multiQubit.stateVec.real[index]*multiQubit.stateVec.real[index];}
73     
74     y = multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}[index]*multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.
      \hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}[index] - c;
75     t = pTotal + y;
76     c = ( t - pTotal ) - y;
77     pTotal = t;
78     
79     \textcolor{comment}{/* Perform pTotal+=multiQubit.stateVec.imag[index]*multiQubit.stateVec.imag[index]; by Kahan */}
80     \textcolor{comment}{//pTotal+=multiQubit.stateVec.imag[index]*multiQubit.stateVec.imag[index];}
81     
82     
83     y = multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}[index]*multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.
      \hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}[index] - c;
84     t = pTotal + y;
85     c = ( t - pTotal ) - y;
86     pTotal = t;
87     
88     
89   \} 
90   \textcolor{keywordflow}{return} pTotal;
91 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!close\+Qu\+E\+S\+T\+Env@{close\+Qu\+E\+S\+T\+Env}}
\index{close\+Qu\+E\+S\+T\+Env@{close\+Qu\+E\+S\+T\+Env}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{close\+Qu\+E\+S\+T\+Env(\+Qu\+E\+S\+T\+Env env)}{closeQuESTEnv(QuESTEnv env)}}]{\setlength{\rightskip}{0pt plus 5cm}void close\+Qu\+E\+S\+T\+Env (
\begin{DoxyParamCaption}
\item[{{\bf Qu\+E\+S\+T\+Env}}]{env}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_abd4bc926cd3f9b65610bb228d0c59fe0}{}\label{qubits_8h_abd4bc926cd3f9b65610bb228d0c59fe0}


Close Qu\+E\+ST environment. 

If something needs to be done to clean up the execution environment, such as finalizing M\+PI when running in distributed mode, it is handled here


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em env} & object representing the execution environment. A single instance is used for each program \\
\hline
\end{DoxyParams}


Definition at line 40 of file qubits\+\_\+env\+\_\+local.\+c.


\begin{DoxyCode}
40                                 \{
41         \textcolor{comment}{// MPI finalize goes here in MPI version. Call this function anyway for consistency}
42 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!collapse\+To\+Outcome@{collapse\+To\+Outcome}}
\index{collapse\+To\+Outcome@{collapse\+To\+Outcome}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{collapse\+To\+Outcome(\+Multi\+Qubit multi\+Qubit, const int measure\+Qubit, int outcome)}{collapseToOutcome(MultiQubit multiQubit, const int measureQubit, int outcome)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf R\+E\+AL} collapse\+To\+Outcome (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{const int}]{measure\+Qubit, }
\item[{int}]{outcome}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_a07418ebac70fd9ae5d051d089961631d}{}\label{qubits_8h_a07418ebac70fd9ae5d051d089961631d}


Updates the state vector to be consistent with measuring the measure qubit in the given outcome (0 or 1), and returns the probability of such a measurement outcome. 

This is effectively performing a measurement and forcing the outcome. This is an irreversible change to the state vector, whereby incompatible states in the state vector are given zero amplitude and the remaining states are renormalised. Exits with error if the given outcome has $\sim$zero probability, and so cannot be collapsed into.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em measure\+Qubit} & qubit to measure \\
\hline
\mbox{\tt in}  & {\em outcome} & to force the measure qubit to enter \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
probability of the (forced) measurement outcome 
\end{DoxyReturn}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily measure\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}), or if {\ttfamily outcome} is not in \{0, 1\}, or if the probability of {\ttfamily outcome} is zero (within machine epsilon) \\
\hline
\end{DoxyExceptions}


Definition at line 195 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, collapse\+To\+Outcome\+Distributed\+Renorm(), collapse\+To\+Outcome\+Distributed\+Set\+Zero(), collapse\+To\+Outcome\+Local(), find\+Probability\+Of\+Outcome(), half\+Matrix\+Block\+Fits\+In\+Chunk(), is\+Chunk\+To\+Skip\+In\+Find\+P\+Zero(), Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Qubits, Qu\+E\+S\+T\+Assert(), R\+E\+AL, and R\+E\+A\+L\+\_\+\+E\+PS.


\begin{DoxyCode}
196 \{
197     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(measureQubit >= 0 && measureQubit < multiQubit.
      \hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}, 2, \_\_func\_\_);
198     \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} stateProb;
199         stateProb = \hyperlink{qubits__env__local_8c_ad315c941a51bc053d39ebfa2040fd32e}{findProbabilityOfOutcome}(multiQubit, measureQubit, outcome);
200     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(fabs(stateProb>\hyperlink{precision_8h_aebb5e6716e06431296af4d1a71744dec}{REAL\_EPS}), 8, \_\_func\_\_);
201     \hyperlink{qubits_8c_a01d9a8b7ff0e09ec399e158389783aa9}{collapseToOutcomeLocal}(multiQubit, measureQubit, stateProb, outcome);
202     \textcolor{keywordflow}{return} stateProb;
203 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!compact\+Unitary@{compact\+Unitary}}
\index{compact\+Unitary@{compact\+Unitary}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{compact\+Unitary(\+Multi\+Qubit multi\+Qubit, const int target\+Qubit, Complex alpha, Complex beta)}{compactUnitary(MultiQubit multiQubit, const int targetQubit, Complex alpha, Complex beta)}}]{\setlength{\rightskip}{0pt plus 5cm}void compact\+Unitary (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{const int}]{target\+Qubit, }
\item[{{\bf Complex}}]{alpha, }
\item[{{\bf Complex}}]{beta}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_a03b13dfcabd8c59b50dbdd3af44ba8b2}{}\label{qubits_8h_a03b13dfcabd8c59b50dbdd3af44ba8b2}


Apply a single-\/qubit unitary parameterised by two given complex scalars. 

Given valid complex numbers $\alpha$ and $\beta$, applies the unitary \[ U = \begin{pmatrix} \alpha & -\beta^* \\ \beta & \alpha^* \end{pmatrix} \] which is general up to a global phase factor. Valid $\alpha$, $\beta$ satisfy $|\alpha|^2 + |\beta|^2 = 1$.

\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {U}; \end{tikzpicture} } \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em target\+Qubit} & qubit to operate on \\
\hline
\mbox{\tt in}  & {\em alpha} & complex unitary parameter (row 1, column 1) \\
\hline
\mbox{\tt in}  & {\em beta} & complex unitary parameter (row 2, column 1) \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily target\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}), or if {\ttfamily alpha}, {\ttfamily beta} don\textquotesingle{}t satisfy $\vert${\ttfamily alpha$\vert$$^\wedge$2} + $\vert${\ttfamily beta$\vert$$^\wedge$2} = 1. \\
\hline
\end{DoxyExceptions}


Definition at line 101 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, chunk\+Is\+Upper(), compact\+Unitary\+Distributed(), compact\+Unitary\+Local(), exchange\+State\+Vectors(), get\+Chunk\+Pair\+Id(), get\+Rot\+Angle(), half\+Matrix\+Block\+Fits\+In\+Chunk(), Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Qubits, Multi\+Qubit\+::pair\+State\+Vec, Qu\+E\+S\+T\+Assert(), Multi\+Qubit\+::state\+Vec, and validate\+Alpha\+Beta().



Referenced by rotate\+Around\+Axis(), rotate\+X(), rotate\+Y(), and rotate\+Z().


\begin{DoxyCode}
102 \{
103     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(targetQubit >= 0 && targetQubit < multiQubit.
      \hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}, 1, \_\_func\_\_);
104     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(\hyperlink{qubits_8c_ae2b2c14a07dd7d50ff86032a3ca101d7}{validateAlphaBeta}(alpha, beta), 6, \_\_func\_\_);
105 
106         \textcolor{comment}{// all values required to update state vector lie in this rank}
107         \hyperlink{qubits_8c_a9cee2d8716667a3318420a3b672f5b92}{compactUnitaryLocal}(multiQubit, targetQubit, alpha, beta);
108 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!controlled\+Compact\+Unitary@{controlled\+Compact\+Unitary}}
\index{controlled\+Compact\+Unitary@{controlled\+Compact\+Unitary}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{controlled\+Compact\+Unitary(\+Multi\+Qubit multi\+Qubit, const int control\+Qubit, const int target\+Qubit, Complex alpha, Complex beta)}{controlledCompactUnitary(MultiQubit multiQubit, const int controlQubit, const int targetQubit, Complex alpha, Complex beta)}}]{\setlength{\rightskip}{0pt plus 5cm}void controlled\+Compact\+Unitary (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{const int}]{control\+Qubit, }
\item[{const int}]{target\+Qubit, }
\item[{{\bf Complex}}]{alpha, }
\item[{{\bf Complex}}]{beta}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_ab4812953bc457405b3aa05a4c2f64f4a}{}\label{qubits_8h_ab4812953bc457405b3aa05a4c2f64f4a}


Apply a controlled unitary (single control, single target) parameterised by two given complex scalars. 

Given valid complex numbers $\alpha$ and $\beta$, applies the two-\/qubit unitary \[ \begin{pmatrix} 1 \\ & 1 \\ & & \alpha & -\beta^* \\ & & \beta & \alpha^* \end{pmatrix} \] to the control and target qubits. Valid $\alpha$, $\beta$ satisfy $|\alpha|^2 + |\beta|^2 = 1$. The target unitary is general up to a global phase factor.

\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 1); \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$U_{\alpha, \beta}$}; \end{tikzpicture} } \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em control\+Qubit} & apply the target unitary if this qubit has value 1 \\
\hline
\mbox{\tt in}  & {\em target\+Qubit} & qubit on which to apply the target unitary \\
\hline
\mbox{\tt in}  & {\em alpha} & complex unitary parameter (row 1, column 1) \\
\hline
\mbox{\tt in}  & {\em beta} & complex unitary parameter (row 2, column 1) \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if either {\ttfamily control\+Qubit} or {\ttfamily target\+Qubit} are outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}) or are equal, or if {\ttfamily alpha}, {\ttfamily beta} don\textquotesingle{}t satisfy $\vert${\ttfamily alpha$\vert$$^\wedge$2} + $\vert${\ttfamily beta$\vert$$^\wedge$2} = 1. \\
\hline
\end{DoxyExceptions}


Definition at line 119 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, chunk\+Is\+Upper(), controlled\+Compact\+Unitary\+Distributed(), controlled\+Compact\+Unitary\+Local(), exchange\+State\+Vectors(), get\+Chunk\+Pair\+Id(), get\+Rot\+Angle(), half\+Matrix\+Block\+Fits\+In\+Chunk(), Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Qubits, Multi\+Qubit\+::pair\+State\+Vec, Qu\+E\+S\+T\+Assert(), Multi\+Qubit\+::state\+Vec, and validate\+Alpha\+Beta().


\begin{DoxyCode}
120 \{
121     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(targetQubit >= 0 && targetQubit < multiQubit.
      \hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}, 1, \_\_func\_\_);
122     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(controlQubit >= 0 && controlQubit < multiQubit.
      \hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}, 2, \_\_func\_\_);
123     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(controlQubit != targetQubit, 3, \_\_func\_\_);
124     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(\hyperlink{qubits_8c_ae2b2c14a07dd7d50ff86032a3ca101d7}{validateAlphaBeta}(alpha, beta), 6, \_\_func\_\_);
125     
126 
127         \hyperlink{qubits_8c_afc77657651d52c47403b44b923a098a8}{controlledCompactUnitaryLocal}(multiQubit, controlQubit, targetQubit, 
      alpha, beta);
128 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!controlled\+Not@{controlled\+Not}}
\index{controlled\+Not@{controlled\+Not}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{controlled\+Not(\+Multi\+Qubit multi\+Qubit, const int control\+Qubit, const int target\+Qubit)}{controlledNot(MultiQubit multiQubit, const int controlQubit, const int targetQubit)}}]{\setlength{\rightskip}{0pt plus 5cm}void controlled\+Not (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{const int}]{control\+Qubit, }
\item[{const int}]{target\+Qubit}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_a67576895bbc65463481a8ea24d9b1e22}{}\label{qubits_8h_a67576895bbc65463481a8ea24d9b1e22}


Apply the controlled not (single control, single target) gate, also known as the c-\/X, c-\/sigma-\/X, c-\/\+Pauli-\/X and c-\/bit-\/flip gate. 

This applies sigmaX to the target qubit if the control qubit has value 1. This effects the two-\/qubit unitary \[ \begin{pmatrix} 1 \\ & 1 \\\ & & & 1 \\ & & 1 \end{pmatrix} \] on the control and target qubits.

\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, -.5); \draw (-2,0) -- (2, 0); \draw (0, 0) circle (.5); \end{tikzpicture} } \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em control\+Qubit} & nots the target if this qubit is 1 \\
\hline
\mbox{\tt in}  & {\em target\+Qubit} & qubit to not \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if either {\ttfamily control\+Qubit} or {\ttfamily target\+Qubit} are outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}), or are equal. \\
\hline
\end{DoxyExceptions}


Definition at line 178 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, chunk\+Is\+Upper(), controlled\+Not\+Distributed(), controlled\+Not\+Local(), exchange\+State\+Vectors(), get\+Chunk\+Pair\+Id(), half\+Matrix\+Block\+Fits\+In\+Chunk(), Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Qubits, Multi\+Qubit\+::pair\+State\+Vec, Qu\+E\+S\+T\+Assert(), and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
179 \{
180     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(targetQubit >= 0 && targetQubit < multiQubit.
      \hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}, 1, \_\_func\_\_);
181     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(controlQubit >= 0 && controlQubit < multiQubit.
      \hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}, 2, \_\_func\_\_);
182     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(controlQubit != targetQubit, 3, \_\_func\_\_);
183         \hyperlink{qubits_8c_ad357a43e80e3baf013975b1b70942f4c}{controlledNotLocal}(multiQubit, controlQubit, targetQubit);
184 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!controlled\+Phase\+Gate@{controlled\+Phase\+Gate}}
\index{controlled\+Phase\+Gate@{controlled\+Phase\+Gate}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{controlled\+Phase\+Gate(\+Multi\+Qubit multi\+Qubit, const int id\+Qubit1, const int id\+Qubit2)}{controlledPhaseGate(MultiQubit multiQubit, const int idQubit1, const int idQubit2)}}]{\setlength{\rightskip}{0pt plus 5cm}void controlled\+Phase\+Gate (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{const int}]{id\+Qubit1, }
\item[{const int}]{id\+Qubit2}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_a11a96159191cbf1b01a1080e7f045aac}{}\label{qubits_8h_a11a96159191cbf1b01a1080e7f045aac}


Apply the (two-\/qubit) controlled phase gate, also known as the controlled sigmaZ gate. 

For each state, if both input qubits have value one, multiply the amplitude of that state by -\/1. This applies the two-\/qubit unitary\+: \[ \begin{pmatrix} 1 \\ & 1 \\\ & & 1 \\ & & & -1 \end{pmatrix} \]

\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {idQubit1}; \node[draw=none] at (-3.5, 0) {idQubit2}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 0); \draw (-2,0) -- (2, 0); \draw[fill=black] (0, 0) circle (.2); \end{tikzpicture} } \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em id\+Qubit1,id\+Qubit2} & qubits to operate upon \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily id\+Qubit1} or {\ttfamily id\+Qubit2} are outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}), or are equal \\
\hline
\end{DoxyExceptions}


Definition at line 1702 of file qubits.\+c.



References Multi\+Qubit\+::chunk\+Id, extract\+Bit(), Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Qubits, Qu\+E\+S\+T\+Assert(), Complex\+Array\+::real, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
1703 \{
1704         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
1705         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} stateVecSize;
1706         \textcolor{keywordtype}{int} bit1, bit2;
1707 
1708         \textcolor{keyword}{const} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} chunkSize=multiQubit.\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps};
1709         \textcolor{keyword}{const} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} chunkId=multiQubit.\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId};
1710 
1711     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(idQubit1 >= 0 && idQubit1 < multiQubit.\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}, 2, \_\_func\_\_);
1712     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(idQubit2 >= 0 && idQubit2 < multiQubit.\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}, 1, \_\_func\_\_);
1713     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(idQubit1 != idQubit2, 3, \_\_func\_\_);
1714 
1715         \textcolor{comment}{// dimension of the state vector}
1716         stateVecSize = multiQubit.\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps};
1717         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} *stateVecReal = multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real};
1718         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} *stateVecImag = multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag};
1719 
1720 \textcolor{preprocessor}{# ifdef \_OPENMP}
1721 \textcolor{preprocessor}{# pragma omp parallel for \(\backslash\)}
1722 \textcolor{preprocessor}{        default  (none)                      \(\backslash\)}
1723 \textcolor{preprocessor}{        shared   (stateVecSize, stateVecReal,stateVecImag ) \(\backslash\)}
1724 \textcolor{preprocessor}{        private  (index,bit1,bit2)                     \(\backslash\)}
1725 \textcolor{preprocessor}{        schedule (static)}
1726 \textcolor{preprocessor}{# endif}
1727         \textcolor{keywordflow}{for} (index=0; index<stateVecSize; index++) \{
1728                 bit1 = \hyperlink{qubits_8c_a100463f6ec212c76a5fad99579000505}{extractBit} (idQubit1, index+chunkId*chunkSize);
1729                 bit2 = \hyperlink{qubits_8c_a100463f6ec212c76a5fad99579000505}{extractBit} (idQubit2, index+chunkId*chunkSize);
1730                 \textcolor{keywordflow}{if} (bit1 && bit2) \{
1731                         stateVecReal [index] = - stateVecReal [index];
1732                         stateVecImag [index] = - stateVecImag [index];
1733                 \}
1734         \}
1735 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!controlled\+Unitary@{controlled\+Unitary}}
\index{controlled\+Unitary@{controlled\+Unitary}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{controlled\+Unitary(\+Multi\+Qubit multi\+Qubit, const int control\+Qubit, const int target\+Qubit, Complex\+Matrix2 u)}{controlledUnitary(MultiQubit multiQubit, const int controlQubit, const int targetQubit, ComplexMatrix2 u)}}]{\setlength{\rightskip}{0pt plus 5cm}void controlled\+Unitary (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{const int}]{control\+Qubit, }
\item[{const int}]{target\+Qubit, }
\item[{{\bf Complex\+Matrix2}}]{u}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_a8a701526263392599aa21d0d0f05d9d8}{}\label{qubits_8h_a8a701526263392599aa21d0d0f05d9d8}


Apply a general controlled unitary (single control, single target), which can include a global phase factor. 

The given unitary is applied to the target qubit if the control qubit has value 1, effecting the two-\/qubit unitary \[ \begin{pmatrix} 1 \\ & 1 \\ & & u_{00} & u_{01}\\ & & u_{10} & u_{11} \end{pmatrix} \] on the control and target qubits.

\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 1); \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {U}; \end{tikzpicture} } \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em control\+Qubit} & apply unitary if this qubit is 1 \\
\hline
\mbox{\tt in}  & {\em target\+Qubit} & qubit to operate on \\
\hline
\mbox{\tt in}  & {\em u} & single-\/qubit unitary matrix to apply \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if either {\ttfamily control\+Qubit} or {\ttfamily target\+Qubit} are outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}) or are equal, or if {\ttfamily u} is not unitary. \\
\hline
\end{DoxyExceptions}


Definition at line 130 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, chunk\+Is\+Upper(), controlled\+Unitary\+Distributed(), controlled\+Unitary\+Local(), exchange\+State\+Vectors(), get\+Chunk\+Pair\+Id(), get\+Rot\+Angle\+From\+Unitary\+Matrix(), half\+Matrix\+Block\+Fits\+In\+Chunk(), Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Qubits, Multi\+Qubit\+::pair\+State\+Vec, Qu\+E\+S\+T\+Assert(), Multi\+Qubit\+::state\+Vec, and validate\+Matrix\+Is\+Unitary().


\begin{DoxyCode}
131 \{
132     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(targetQubit >= 0 && targetQubit < multiQubit.
      \hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}, 1, \_\_func\_\_);
133     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(controlQubit >= 0 && controlQubit < multiQubit.
      \hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}, 2, \_\_func\_\_);
134     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(controlQubit != targetQubit, 3, \_\_func\_\_);
135     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(\hyperlink{qubits_8c_ae4fea133d1a8f09ff8da03038100adb2}{validateMatrixIsUnitary}(u), 5, \_\_func\_\_);
136    
137         \hyperlink{qubits_8c_a8a4afcff70195a306c082b8ed8d4e09a}{controlledUnitaryLocal}(multiQubit, controlQubit, targetQubit, u);
138 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!create\+Multi\+Qubit@{create\+Multi\+Qubit}}
\index{create\+Multi\+Qubit@{create\+Multi\+Qubit}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{create\+Multi\+Qubit(\+Multi\+Qubit $\ast$multi\+Qubit, int num\+Qubits, Qu\+E\+S\+T\+Env env)}{createMultiQubit(MultiQubit *multiQubit, int numQubits, QuESTEnv env)}}]{\setlength{\rightskip}{0pt plus 5cm}void create\+Multi\+Qubit (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit} $\ast$}]{multi\+Qubit, }
\item[{int}]{num\+Qubits, }
\item[{{\bf Qu\+E\+S\+T\+Env}}]{env}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_a9c02591bc64c2918503afa231d90d83f}{}\label{qubits_8h_a9c02591bc64c2918503afa231d90d83f}


Create a \hyperlink{structMultiQubit}{Multi\+Qubit} object representing a set of qubits. 

Allocate space for state vector of probability amplitudes, including space for temporary values to be copied from one other chunk if running the distributed version. Define properties related to the size of the set of qubits. init\+State\+Zero should be called after this to initialise the qubits to the zero state.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & a pointer to an object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em num\+Qubits} & number of qubits in the system \\
\hline
\mbox{\tt in}  & {\em env} & object representing the execution environment (local, multinode etc) \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily num\+Qubits} $<$= 0 \\
\hline
\end{DoxyExceptions}


Definition at line 35 of file qubits.\+c.



References Multi\+Qubit\+::chunk\+Id, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Chunks, Multi\+Qubit\+::num\+Qubits, Qu\+E\+S\+T\+Env\+::num\+Ranks, Multi\+Qubit\+::pair\+State\+Vec, Qu\+E\+S\+T\+Assert(), Qu\+E\+S\+T\+Env\+::rank, Complex\+Array\+::real, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
36 \{
37     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(numQubits>0, 9, \_\_func\_\_);
38         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numAmps = 1L << numQubits;
39         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numAmpsPerRank = numAmps/env.\hyperlink{structQuESTEnv_af22aacd7c9905accae28484785c193b4}{numRanks};
40 
41         multiQubit->\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real} = malloc(numAmpsPerRank * \textcolor{keyword}{sizeof}(*(multiQubit->
      \hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real})));
42         multiQubit->\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag} = malloc(numAmpsPerRank * \textcolor{keyword}{sizeof}(*(multiQubit->
      \hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag})));
43         \textcolor{keywordflow}{if} (env.\hyperlink{structQuESTEnv_af22aacd7c9905accae28484785c193b4}{numRanks}>1)\{
44                 multiQubit->\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real} = malloc(numAmpsPerRank * \textcolor{keyword}{sizeof}(*(multiQubit
      ->\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real})));
45                 multiQubit->\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag} = malloc(numAmpsPerRank * \textcolor{keyword}{sizeof}(*(multiQubit
      ->\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag})));
46         \}
47 
48         \textcolor{keywordflow}{if} ( (!(multiQubit->\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}) || !(multiQubit->\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.
      \hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}))
49                  && numAmpsPerRank ) \{
50                 printf(\textcolor{stringliteral}{"Could not allocate memory!"});
51                 exit (EXIT\_FAILURE);
52         \}
53 
54         \textcolor{keywordflow}{if} ( env.\hyperlink{structQuESTEnv_af22aacd7c9905accae28484785c193b4}{numRanks}>1 && (!(multiQubit->\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}.
      \hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}) || !(multiQubit->\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}))
55                  && numAmpsPerRank ) \{
56                 printf(\textcolor{stringliteral}{"Could not allocate memory!"});
57                 exit (EXIT\_FAILURE);
58         \}
59 
60         multiQubit->\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits} = numQubits;
61         multiQubit->\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps} = numAmpsPerRank;
62         multiQubit->\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId} = env.\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank};
63         multiQubit->\hyperlink{structMultiQubit_acd43f2f57991709c9e94f73662c972b2}{numChunks} = env.\hyperlink{structQuESTEnv_af22aacd7c9905accae28484785c193b4}{numRanks};
64 
65 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!destroy\+Multi\+Qubit@{destroy\+Multi\+Qubit}}
\index{destroy\+Multi\+Qubit@{destroy\+Multi\+Qubit}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{destroy\+Multi\+Qubit(\+Multi\+Qubit multi\+Qubit, Qu\+E\+S\+T\+Env env)}{destroyMultiQubit(MultiQubit multiQubit, QuESTEnv env)}}]{\setlength{\rightskip}{0pt plus 5cm}void destroy\+Multi\+Qubit (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{{\bf Qu\+E\+S\+T\+Env}}]{env}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_ae5d6acc322314d7a3d8a2eccf00d3b19}{}\label{qubits_8h_ae5d6acc322314d7a3d8a2eccf00d3b19}


Deallocate a \hyperlink{structMultiQubit}{Multi\+Qubit} object representing a set of qubits. 

Free memory allocated to state vector of probability amplitudes, including temporary vector for values copied from another chunk if running the distributed version.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object to be deallocated \\
\hline
\mbox{\tt in}  & {\em env} & object representing the execution environment (local, multinode etc) \\
\hline
\end{DoxyParams}


Definition at line 67 of file qubits.\+c.



References Complex\+Array\+::imag, Qu\+E\+S\+T\+Env\+::num\+Ranks, Multi\+Qubit\+::pair\+State\+Vec, Complex\+Array\+::real, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
67                                                            \{
68         free(multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real});
69         free(multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag});
70         \textcolor{keywordflow}{if} (env.\hyperlink{structQuESTEnv_af22aacd7c9905accae28484785c193b4}{numRanks}>1)\{
71                 free(multiQubit.\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real});
72                 free(multiQubit.\hyperlink{structMultiQubit_a76f7db4eab52d2b30f58f973ada809c5}{pairStateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag});
73         \}
74 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!find\+Probability\+Of\+Outcome@{find\+Probability\+Of\+Outcome}}
\index{find\+Probability\+Of\+Outcome@{find\+Probability\+Of\+Outcome}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{find\+Probability\+Of\+Outcome(\+Multi\+Qubit multi\+Qubit, const int measure\+Qubit, int outcome)}{findProbabilityOfOutcome(MultiQubit multiQubit, const int measureQubit, int outcome)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf R\+E\+AL} find\+Probability\+Of\+Outcome (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{const int}]{measure\+Qubit, }
\item[{int}]{outcome}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_ad315c941a51bc053d39ebfa2040fd32e}{}\label{qubits_8h_ad315c941a51bc053d39ebfa2040fd32e}


Gives the probability of a specified qubit being measured in the given outcome (0 or 1). 

This performs no actual measurement and does not change the state of the qubits.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em measure\+Qubit} & qubit to study \\
\hline
\mbox{\tt in}  & {\em outcome} & for which to find the probability of the qubit being measured in \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
probability of qubit measure\+Qubit being measured in the given outcome 
\end{DoxyReturn}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily measure\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}), or if {\ttfamily outcome} is not in \{0, 1\}. \\
\hline
\end{DoxyExceptions}


Definition at line 186 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, find\+Probability\+Of\+Zero\+Distributed(), find\+Probability\+Of\+Zero\+Local(), half\+Matrix\+Block\+Fits\+In\+Chunk(), is\+Chunk\+To\+Skip\+In\+Find\+P\+Zero(), M\+P\+I\+\_\+\+Qu\+E\+S\+T\+\_\+\+R\+E\+AL, Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Qubits, Qu\+E\+S\+T\+Assert(), and R\+E\+AL.



Referenced by collapse\+To\+Outcome(), and measure\+With\+Stats().


\begin{DoxyCode}
187 \{
188     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(measureQubit >= 0 && measureQubit < multiQubit.
      \hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}, 2, \_\_func\_\_);
189         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} stateProb=0;
190         stateProb = \hyperlink{qubits_8c_a7c02cd0e1b4eac19771a0525f023249e}{findProbabilityOfZeroLocal}(multiQubit, measureQubit);
191         \textcolor{keywordflow}{if} (outcome==1) stateProb = 1.0 - stateProb;
192         \textcolor{keywordflow}{return} stateProb;
193 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!get\+Environment\+String@{get\+Environment\+String}}
\index{get\+Environment\+String@{get\+Environment\+String}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{get\+Environment\+String(\+Qu\+E\+S\+T\+Env env, Multi\+Qubit multi\+Qubit, char str[200])}{getEnvironmentString(QuESTEnv env, MultiQubit multiQubit, char str[200])}}]{\setlength{\rightskip}{0pt plus 5cm}void get\+Environment\+String (
\begin{DoxyParamCaption}
\item[{{\bf Qu\+E\+S\+T\+Env}}]{env, }
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{char}]{str\mbox{[}200\mbox{]}}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_a8f10aabf9f607f19093aee54630caa21}{}\label{qubits_8h_a8f10aabf9f607f19093aee54630caa21}


Definition at line 127 of file qubits.\+c.



References Multi\+Qubit\+::num\+Qubits, and Qu\+E\+S\+T\+Env\+::num\+Ranks.


\begin{DoxyCode}
127                                                                              \{
128         \textcolor{keywordtype}{int} numThreads=1;
129 \textcolor{preprocessor}{# ifdef \_OPENMP}
130         numThreads=omp\_get\_max\_threads(); 
131 \textcolor{preprocessor}{# endif}
132         sprintf(str, \textcolor{stringliteral}{"%dqubits\_CPU\_%dranksx%dthreads"}, multiQubit.\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}, env.
      \hyperlink{structQuESTEnv_af22aacd7c9905accae28484785c193b4}{numRanks}, numThreads);
133 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!get\+Imag\+Amp\+El@{get\+Imag\+Amp\+El}}
\index{get\+Imag\+Amp\+El@{get\+Imag\+Amp\+El}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{get\+Imag\+Amp\+El(\+Multi\+Qubit multi\+Qubit, long long int index)}{getImagAmpEl(MultiQubit multiQubit, long long int index)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf R\+E\+AL} get\+Imag\+Amp\+El (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{long long int}]{index}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_a3615f76fd5f57008d9b74bbd10533dd0}{}\label{qubits_8h_a3615f76fd5f57008d9b74bbd10533dd0}


Get the imaginary component of the complex probability amplitude at an index in the state vector. 

For debugging purposes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em multi\+Qubit} & object representing a set of qubits \\
\hline
\mbox{\tt in}  & {\em index} & index in state vector of probability amplitudes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
imaginary component at that index 
\end{DoxyReturn}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily index} is outside \mbox{[}0, $2^{N}$) where $N = $ {\ttfamily multi\+Qubit.\+num\+Qubits} \\
\hline
\end{DoxyExceptions}


Definition at line 97 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, get\+Chunk\+Id\+From\+Index(), Complex\+Array\+::imag, M\+P\+I\+\_\+\+Qu\+E\+S\+T\+\_\+\+R\+E\+AL, Multi\+Qubit\+::num\+Amps, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.



Referenced by get\+Prob\+El().


\begin{DoxyCode}
97                                                              \{
98         \textcolor{keywordflow}{return} multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}[index];
99 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!get\+Prob\+El@{get\+Prob\+El}}
\index{get\+Prob\+El@{get\+Prob\+El}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{get\+Prob\+El(\+Multi\+Qubit multi\+Qubit, long long int index)}{getProbEl(MultiQubit multiQubit, long long int index)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf R\+E\+AL} get\+Prob\+El (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{long long int}]{index}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_a799b10447d6dbdaf960a4d3eedd22014}{}\label{qubits_8h_a799b10447d6dbdaf960a4d3eedd22014}


Get the probability of the state at an index in the full state vector. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em multi\+Qubit} & object representing a set of qubits \\
\hline
\mbox{\tt in}  & {\em index} & index in state vector of probability amplitudes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
real\+El$\ast$real\+El + imag\+El$\ast$imag\+El 
\end{DoxyReturn}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily index} is outside \mbox{[}0, $2^{N}$) where $N = $ {\ttfamily multi\+Qubit.\+num\+Qubits} \\
\hline
\end{DoxyExceptions}


Definition at line 1944 of file qubits.\+c.



References get\+Imag\+Amp\+El(), get\+Real\+Amp\+El(), and R\+E\+AL.


\begin{DoxyCode}
1944                                                           \{
1945         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} real;
1946         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} imag;
1947         real = \hyperlink{qubits_8h_a317b786f577fa6bc136ea7f0ee7330a7}{getRealAmpEl}(multiQubit, index);
1948         imag = \hyperlink{qubits_8h_a3615f76fd5f57008d9b74bbd10533dd0}{getImagAmpEl}(multiQubit, index);
1949         \textcolor{keywordflow}{return} real*real + imag*imag;
1950 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!get\+Real\+Amp\+El@{get\+Real\+Amp\+El}}
\index{get\+Real\+Amp\+El@{get\+Real\+Amp\+El}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{get\+Real\+Amp\+El(\+Multi\+Qubit multi\+Qubit, long long int index)}{getRealAmpEl(MultiQubit multiQubit, long long int index)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf R\+E\+AL} get\+Real\+Amp\+El (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{long long int}]{index}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_a317b786f577fa6bc136ea7f0ee7330a7}{}\label{qubits_8h_a317b786f577fa6bc136ea7f0ee7330a7}


Get the real component of the complex probability amplitude at an index in the state vector. 

For debugging purposes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em multi\+Qubit} & object representing a set of qubits \\
\hline
\mbox{\tt in}  & {\em index} & index in state vector of probability amplitudes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
real component at that index 
\end{DoxyReturn}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily index} is outside \mbox{[}0, $2^{N}$) where $N = $ {\ttfamily multi\+Qubit.\+num\+Qubits} \\
\hline
\end{DoxyExceptions}


Definition at line 93 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, get\+Chunk\+Id\+From\+Index(), M\+P\+I\+\_\+\+Qu\+E\+S\+T\+\_\+\+R\+E\+AL, Multi\+Qubit\+::num\+Amps, Complex\+Array\+::real, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.



Referenced by get\+Prob\+El().


\begin{DoxyCode}
93                                                              \{
94         \textcolor{keywordflow}{return} multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}[index];
95 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!hadamard@{hadamard}}
\index{hadamard@{hadamard}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{hadamard(\+Multi\+Qubit multi\+Qubit, const int target\+Qubit)}{hadamard(MultiQubit multiQubit, const int targetQubit)}}]{\setlength{\rightskip}{0pt plus 5cm}void hadamard (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{const int}]{target\+Qubit}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_aa09b5dd93de6df1384b8f2c0041749ab}{}\label{qubits_8h_aa09b5dd93de6df1384b8f2c0041749ab}


Apply the single-\/qubit Hadamard gate. 

This takes $|0\rangle$ to $|+\rangle$ and $|1\rangle$ to $|-\rangle$, and is equivalent to a rotation of $\pi$ around the x-\/axis then $\pi/2$ about the y-\/axis on the Bloch-\/sphere. I.\+e. \[ \frac{1}{\sqrt{2}} \begin{pmatrix} 1 & 1 \\ 1 & -1 \end{pmatrix} \]

\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {H}; \end{tikzpicture} } \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em target\+Qubit} & qubit to operate on \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily target\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}). \\
\hline
\end{DoxyExceptions}


Definition at line 172 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, chunk\+Is\+Upper(), exchange\+State\+Vectors(), get\+Chunk\+Pair\+Id(), hadamard\+Distributed(), hadamard\+Local(), half\+Matrix\+Block\+Fits\+In\+Chunk(), Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Qubits, Multi\+Qubit\+::pair\+State\+Vec, Qu\+E\+S\+T\+Assert(), and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
173 \{
174     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(targetQubit >= 0 && targetQubit < multiQubit.
      \hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}, 1, \_\_func\_\_);
175         \hyperlink{qubits_8c_aa9f0718b4dd794a3e1b143e3b153bfc5}{hadamardLocal}(multiQubit, targetQubit);
176 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!init\+Qu\+E\+S\+T\+Env@{init\+Qu\+E\+S\+T\+Env}}
\index{init\+Qu\+E\+S\+T\+Env@{init\+Qu\+E\+S\+T\+Env}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{init\+Qu\+E\+S\+T\+Env(\+Qu\+E\+S\+T\+Env $\ast$env)}{initQuESTEnv(QuESTEnv *env)}}]{\setlength{\rightskip}{0pt plus 5cm}void init\+Qu\+E\+S\+T\+Env (
\begin{DoxyParamCaption}
\item[{{\bf Qu\+E\+S\+T\+Env} $\ast$}]{env}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_ad84a3ce68d1ca02b4e3f741ea45b6054}{}\label{qubits_8h_ad84a3ce68d1ca02b4e3f741ea45b6054}


Initialize the Qu\+E\+ST environment. 

If something needs to be done to set up the execution environment, such as initializing M\+PI when running in distributed mode, it is handled here


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em env} & object representing the execution environment. A single instance is used for each program \\
\hline
\end{DoxyParams}


Definition at line 19 of file qubits\+\_\+env\+\_\+local.\+c.



References D\+E\+B\+UG, init\+\_\+by\+\_\+array(), Qu\+E\+S\+T\+Env\+::num\+Ranks, and Qu\+E\+S\+T\+Env\+::rank.


\begin{DoxyCode}
19                                 \{
20         \textcolor{comment}{// init MPI environment}
21         env->\hyperlink{structQuESTEnv_aa648bb336cf8598467cb62db00b9cee8}{rank}=0;
22         env->\hyperlink{structQuESTEnv_af22aacd7c9905accae28484785c193b4}{numRanks}=1;
23 
24     \textcolor{comment}{// init MT random number generator with two keys -- time and pid}
25     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} secs = time(NULL);
26     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} pid = getpid();
27     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} key[2];
28     key[0] = secs; key[1] = pid;
29     \hyperlink{mt19937ar_8c_ac1283f9b1ed571332f5ffe53545ffc16}{init\_by\_array}(key, 2);
30 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!init\+State\+Plus@{init\+State\+Plus}}
\index{init\+State\+Plus@{init\+State\+Plus}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{init\+State\+Plus(\+Multi\+Qubit $\ast$multi\+Qubit)}{initStatePlus(MultiQubit *multiQubit)}}]{\setlength{\rightskip}{0pt plus 5cm}void init\+State\+Plus (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit} $\ast$}]{multi\+Qubit}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_a43bcb279fc9717fbd06a19cdef48b9d8}{}\label{qubits_8h_a43bcb279fc9717fbd06a19cdef48b9d8}


Initialise a set of $ N $ qubits to the plus state $ {| + \rangle}^{\otimes N} = \frac{1}{\sqrt{2^N}} (| 0 \rangle + | 1 \rangle)^{\otimes N} $. 

This is the product state of $N$ qubits where every classical state is uniformly populated with real coefficient $\frac{1}{\sqrt{2^N}}$. This is equivalent to applying a Hadamard to every qubit in the zero state\+: $ \hat{H}^{\otimes N} {|0\rangle}^{\otimes N} $


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & a pointer to the object representing the set of qubits to be initialised \\
\hline
\end{DoxyParams}


Definition at line 173 of file qubits.\+c.



References D\+E\+B\+UG, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Chunks, Complex\+Array\+::real, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
174 \{
175         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} chunkSize, stateVecSize;
176         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
177 
178         \textcolor{comment}{// dimension of the state vector}
179         chunkSize = multiQubit->\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps};
180         stateVecSize = chunkSize*multiQubit->\hyperlink{structMultiQubit_acd43f2f57991709c9e94f73662c972b2}{numChunks};
181         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} normFactor = 1.0/sqrt(stateVecSize);
182 
183         \textcolor{comment}{// Can't use multiQubit->stateVec as a private OMP var}
184         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} *stateVecReal = multiQubit->\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real};
185         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} *stateVecImag = multiQubit->\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag};
186 
187         \textcolor{comment}{// initialise the state to |0000..0000>}
188 \textcolor{preprocessor}{# ifdef \_OPENMP}
189 \textcolor{preprocessor}{# pragma omp parallel \(\backslash\)}
190 \textcolor{preprocessor}{        default  (none) \(\backslash\)}
191 \textcolor{preprocessor}{        shared   (chunkSize, stateVecReal, stateVecImag, normFactor) \(\backslash\)}
192 \textcolor{preprocessor}{        private  (index) }
193 \textcolor{preprocessor}{# endif}
194         \{
195 \textcolor{preprocessor}{# ifdef \_OPENMP}
196 \textcolor{preprocessor}{                # pragma omp for schedule (static)}
197 \textcolor{preprocessor}{# endif}
198                 \textcolor{keywordflow}{for} (index=0; index<chunkSize; index++) \{
199                         stateVecReal[index] = normFactor;
200                         stateVecImag[index] = 0.0;
201                 \}
202         \}
203         \textcolor{keywordflow}{if} (\hyperlink{qubits_8c_ad72dbcf6d0153db1b8d8a58001feed83}{DEBUG}) printf(\textcolor{stringliteral}{"COMPLETED INIT\(\backslash\)n"});
204 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!init\+State\+Zero@{init\+State\+Zero}}
\index{init\+State\+Zero@{init\+State\+Zero}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{init\+State\+Zero(\+Multi\+Qubit $\ast$multi\+Qubit)}{initStateZero(MultiQubit *multiQubit)}}]{\setlength{\rightskip}{0pt plus 5cm}void init\+State\+Zero (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit} $\ast$}]{multi\+Qubit}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_acb5b2eff794339090004d29f02a70d9a}{}\label{qubits_8h_acb5b2eff794339090004d29f02a70d9a}


Initialise a set of $ N $ qubits to the classical zero state $ {| 0 \rangle}^{\otimes N} $. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & a pointer to the object representing the set of all qubits to initialise \\
\hline
\end{DoxyParams}


Definition at line 135 of file qubits.\+c.



References Multi\+Qubit\+::chunk\+Id, D\+E\+B\+UG, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps, Complex\+Array\+::real, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
136 \{
137         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} stateVecSize;
138         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
139 
140         \textcolor{comment}{// dimension of the state vector}
141         stateVecSize = multiQubit->\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps};
142 
143         \textcolor{comment}{// Can't use multiQubit->stateVec as a private OMP var}
144         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} *stateVecReal = multiQubit->\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real};
145         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} *stateVecImag = multiQubit->\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag};
146 
147         \textcolor{comment}{// initialise the state to |0000..0000>}
148 \textcolor{preprocessor}{# ifdef \_OPENMP}
149 \textcolor{preprocessor}{# pragma omp parallel \(\backslash\)}
150 \textcolor{preprocessor}{        default  (none) \(\backslash\)}
151 \textcolor{preprocessor}{        shared   (stateVecSize, stateVecReal, stateVecImag) \(\backslash\)}
152 \textcolor{preprocessor}{        private  (index) }
153 \textcolor{preprocessor}{# endif}
154         \{
155 \textcolor{preprocessor}{# ifdef \_OPENMP}
156 \textcolor{preprocessor}{                # pragma omp for schedule (static)}
157 \textcolor{preprocessor}{# endif}
158                 \textcolor{keywordflow}{for} (index=0; index<stateVecSize; index++) \{
159                         stateVecReal[index] = 0.0;
160                         stateVecImag[index] = 0.0;
161                 \}
162         \}
163 
164         \textcolor{keywordflow}{if} (multiQubit->\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId}==0)\{
165                 \textcolor{comment}{// zero state |0000..0000> has probability 1}
166                 stateVecReal[0] = 1.0;
167                 stateVecImag[0] = 0.0;
168         \}
169 
170         \textcolor{keywordflow}{if} (\hyperlink{qubits_8c_ad72dbcf6d0153db1b8d8a58001feed83}{DEBUG}) printf(\textcolor{stringliteral}{"COMPLETED INIT\(\backslash\)n"});
171 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!measure@{measure}}
\index{measure@{measure}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{measure(\+Multi\+Qubit multi\+Qubit, int measure\+Qubit)}{measure(MultiQubit multiQubit, int measureQubit)}}]{\setlength{\rightskip}{0pt plus 5cm}int measure (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{int}]{measure\+Qubit}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_ad5774247d836267175c664cd0e451bcb}{}\label{qubits_8h_ad5774247d836267175c664cd0e451bcb}


Measures a single qubit, collapsing it randomly to 0 or 1. 

Outcome probabilities are weighted by the state vector, which is irreversibly changed after collapse to be consistent with the outcome.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em measure\+Qubit} & qubit to measure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the measurement outcome, 0 or 1 
\end{DoxyReturn}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily measure\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}) \\
\hline
\end{DoxyExceptions}


Definition at line 205 of file qubits\+\_\+env\+\_\+local.\+c.



References measure\+With\+Stats(), Multi\+Qubit\+::num\+Qubits, Qu\+E\+S\+T\+Assert(), and R\+E\+AL.


\begin{DoxyCode}
205                                                     \{
206     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(measureQubit >= 0 && measureQubit < multiQubit.
      \hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}, 2, \_\_func\_\_);
207     \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} stateProb;
208     \textcolor{keywordflow}{return} \hyperlink{qubits__env__local_8c_a2ac46e470c750bf93c754e06c64b0a7a}{measureWithStats}(multiQubit, measureQubit, &stateProb);
209 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!measure\+With\+Stats@{measure\+With\+Stats}}
\index{measure\+With\+Stats@{measure\+With\+Stats}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{measure\+With\+Stats(\+Multi\+Qubit multi\+Qubit, int measure\+Qubit, R\+E\+A\+L $\ast$state\+Prob)}{measureWithStats(MultiQubit multiQubit, int measureQubit, REAL *stateProb)}}]{\setlength{\rightskip}{0pt plus 5cm}int measure\+With\+Stats (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{int}]{measure\+Qubit, }
\item[{{\bf R\+E\+AL} $\ast$}]{state\+Prob}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_a2ac46e470c750bf93c754e06c64b0a7a}{}\label{qubits_8h_a2ac46e470c750bf93c754e06c64b0a7a}


Measures a single qubit, collapsing it randomly to 0 or 1, and additionally gives the probability of that outcome. 

Outcome probabilities are weighted by the state vector, which is irreversibly changed after collapse to be consistent with the outcome.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em measure\+Qubit} & qubit to measure \\
\hline
\mbox{\tt out}  & {\em state\+Prob} & a pointer to a R\+E\+AL which is set to the probability of the occurred outcome \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the measurement outcome, 0 or 1 
\end{DoxyReturn}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily measure\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}) \\
\hline
\end{DoxyExceptions}


Definition at line 211 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, collapse\+To\+Outcome\+Distributed\+Renorm(), collapse\+To\+Outcome\+Distributed\+Set\+Zero(), collapse\+To\+Outcome\+Local(), find\+Probability\+Of\+Outcome(), genrand\+\_\+real1(), half\+Matrix\+Block\+Fits\+In\+Chunk(), is\+Chunk\+To\+Skip\+In\+Find\+P\+Zero(), Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Qubits, Qu\+E\+S\+T\+Assert(), R\+E\+AL, and R\+E\+A\+L\+\_\+\+E\+PS.



Referenced by measure().


\begin{DoxyCode}
211                                                                               \{
212     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(measureQubit >= 0 && measureQubit < multiQubit.
      \hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}, 2, \_\_func\_\_);
213 
214     \textcolor{keywordtype}{int} outcome;
215     \textcolor{comment}{// find probability of qubit being in state 1}
216         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} stateProbInternal = \hyperlink{qubits__env__local_8c_ad315c941a51bc053d39ebfa2040fd32e}{findProbabilityOfOutcome}(multiQubit, 
      measureQubit, 1);
217 
218     \textcolor{comment}{// we can't collapse to a state that has a probability too close to zero}
219     \textcolor{keywordflow}{if} (stateProbInternal<\hyperlink{precision_8h_aebb5e6716e06431296af4d1a71744dec}{REAL\_EPS}) outcome=0;
220     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (1-stateProbInternal<\hyperlink{precision_8h_aebb5e6716e06431296af4d1a71744dec}{REAL\_EPS}) outcome=1;
221     \textcolor{keywordflow}{else} \{
222         \textcolor{comment}{// ok. both P(0) and P(1) are large enough to resolve}
223         \textcolor{comment}{// generate random float on [0,1]}
224         \textcolor{keywordtype}{float} randNum = \hyperlink{mt19937ar_8c_ac94ab75771800274ed1a2bedeca86f04}{genrand\_real1}();
225         \textcolor{keywordflow}{if} (randNum<=stateProbInternal) outcome = 1;
226         \textcolor{keywordflow}{else} outcome = 0;
227     \} 
228     \textcolor{keywordflow}{if} (outcome==0) stateProbInternal = 1-stateProbInternal;
229     \hyperlink{qubits_8c_a01d9a8b7ff0e09ec399e158389783aa9}{collapseToOutcomeLocal}(multiQubit, measureQubit, stateProbInternal, outcome);
230     *stateProb = stateProbInternal;
231     \textcolor{keywordflow}{return} outcome;
232 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!multi\+Controlled\+Phase\+Gate@{multi\+Controlled\+Phase\+Gate}}
\index{multi\+Controlled\+Phase\+Gate@{multi\+Controlled\+Phase\+Gate}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{multi\+Controlled\+Phase\+Gate(\+Multi\+Qubit multi\+Qubit, int $\ast$control\+Qubits, int num\+Control\+Qubits)}{multiControlledPhaseGate(MultiQubit multiQubit, int *controlQubits, int numControlQubits)}}]{\setlength{\rightskip}{0pt plus 5cm}void multi\+Controlled\+Phase\+Gate (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{int $\ast$}]{control\+Qubits, }
\item[{int}]{num\+Control\+Qubits}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_afc1835c6b43b6e59ce7df7b13f274fc7}{}\label{qubits_8h_afc1835c6b43b6e59ce7df7b13f274fc7}


Apply the multiple-\/qubit controlled phase gate, also known as the multiple-\/qubit controlled sigmaZ gate. 

For each state, if all control qubits have value one, multiply the amplitude of that state by -\/1. This applies the many-\/qubit unitary\+: \[ \begin{pmatrix} 1 \\ & 1 \\\ & & \ddots \\ & & & 1 \\ & & & & -1 \end{pmatrix} \] on the control qubits.

\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {controls}; \node[draw=none] at (0, 6) {$\vdots$}; \draw (0, 5) -- (0, 4); \draw (-2, 4) -- (2, 4); \draw[fill=black] (0, 4) circle (.2); \draw (0, 4) -- (0, 2); \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 0); \draw (-2,0) -- (2, 0); \draw[fill=black] (0, 0) circle (.2); \end{tikzpicture} } \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em control\+Qubits} & array of input qubits \\
\hline
\mbox{\tt in}  & {\em num\+Control\+Qubits} & number of input qubits \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily num\+Control\+Qubits} is outside \mbox{[}1, {\ttfamily multi\+Qubit.\+num\+Qubits}) \\
\hline
\end{DoxyExceptions}


Definition at line 1737 of file qubits.\+c.



References Multi\+Qubit\+::chunk\+Id, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Qubits, Qu\+E\+S\+T\+Assert(), Complex\+Array\+::real, R\+E\+AL, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
1738 \{
1739         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
1740         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} stateVecSize;
1741         
1742         \textcolor{keyword}{const} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} chunkSize=multiQubit.\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps};
1743         \textcolor{keyword}{const} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} chunkId=multiQubit.\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId};
1744 
1745     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(numControlQubits > 0 && numControlQubits <= multiQubit.
      \hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}, 4, \_\_func\_\_);
1746     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} mask=0;
1747     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0; i<numControlQubits; i++) mask = mask | (1LL<<controlQubits[i]);
1748     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(mask >=0 && mask <= (1LL<<multiQubit.\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits})-1, 2, \_\_func\_\_);
1749 
1750         stateVecSize = multiQubit.\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps};
1751         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} *stateVecReal = multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real};
1752         \hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL} *stateVecImag = multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag};
1753 
1754 \textcolor{preprocessor}{# ifdef \_OPENMP}
1755 \textcolor{preprocessor}{# pragma omp parallel \(\backslash\)}
1756 \textcolor{preprocessor}{        default  (none)                      \(\backslash\)}
1757 \textcolor{preprocessor}{        shared   (stateVecSize, stateVecReal,stateVecImag, mask ) \(\backslash\)}
1758 \textcolor{preprocessor}{        private  (index)}
1759 \textcolor{preprocessor}{# endif}
1760         \{
1761 \textcolor{preprocessor}{# ifdef \_OPENMP}
1762 \textcolor{preprocessor}{                # pragma omp for schedule (static)}
1763 \textcolor{preprocessor}{# endif}
1764                 \textcolor{keywordflow}{for} (index=0; index<stateVecSize; index++) \{
1765                         \textcolor{keywordflow}{if} (mask == (mask & (index+chunkId*chunkSize)) )\{
1766                                 stateVecReal [index] = - stateVecReal [index];
1767                                 stateVecImag [index] = - stateVecImag [index];
1768                         \}
1769                 \}
1770         \}
1771 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!multi\+Controlled\+Unitary@{multi\+Controlled\+Unitary}}
\index{multi\+Controlled\+Unitary@{multi\+Controlled\+Unitary}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{multi\+Controlled\+Unitary(\+Multi\+Qubit multi\+Qubit, int $\ast$control\+Qubits, const int num\+Control\+Qubits, const int target\+Qubit, Complex\+Matrix2 u)}{multiControlledUnitary(MultiQubit multiQubit, int *controlQubits, const int numControlQubits, const int targetQubit, ComplexMatrix2 u)}}]{\setlength{\rightskip}{0pt plus 5cm}void multi\+Controlled\+Unitary (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{int $\ast$}]{control\+Qubits, }
\item[{const int}]{num\+Control\+Qubits, }
\item[{const int}]{target\+Qubit, }
\item[{{\bf Complex\+Matrix2}}]{u}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_ae395a79690283ed81106afadd7a8cd8a}{}\label{qubits_8h_ae395a79690283ed81106afadd7a8cd8a}


Apply a general multiple-\/control single-\/target unitary, which can include a global phase factor. 

Any number of control qubits can be specified, and if all have value 1, the given unitary is applied to the target qubit. This effects the many-\/qubit unitary \[ \begin{pmatrix} 1 \\ & 1 \\\ & & \ddots \\ & & & u_{00} & u_{01}\\ & & & u_{10} & u_{11} \end{pmatrix} \] on the control and target qubits. The given 2x2 Complex\+Matrix must be unitary, otherwise an error is thrown.

\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 3) {controls}; \node[draw=none] at (-3.5, 0) {target}; \node[draw=none] at (0, 6) {$\vdots$}; \draw (0, 5) -- (0, 4); \draw (-2, 4) -- (2, 4); \draw[fill=black] (0, 4) circle (.2); \draw (0, 4) -- (0, 2); \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 1); \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {U}; \end{tikzpicture} } \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em control\+Qubits} & applies unitary if all qubits in this array equal 1 \\
\hline
\mbox{\tt in}  & {\em num\+Control\+Qubits} & number of control qubits \\
\hline
\mbox{\tt in}  & {\em target\+Qubit} & qubit to operate on \\
\hline
\mbox{\tt in}  & {\em u} & single-\/qubit unitary matrix to apply \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily num\+Control\+Qubits} is outside \mbox{[}1, {\ttfamily multi\+Qubit.\+num\+Qubits}\mbox{]}), or if any qubit index ({\ttfamily target\+Qubit} or one in {\ttfamily control\+Qubits}) is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}\mbox{]}), or if {\ttfamily control\+Qubits} contains {\ttfamily target\+Qubit}, or if {\ttfamily u} is not unitary. \\
\hline
\end{DoxyExceptions}


Definition at line 140 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, chunk\+Is\+Upper(), exchange\+State\+Vectors(), get\+Chunk\+Pair\+Id(), get\+Rot\+Angle\+From\+Unitary\+Matrix(), half\+Matrix\+Block\+Fits\+In\+Chunk(), multi\+Controlled\+Unitary\+Distributed(), multi\+Controlled\+Unitary\+Local(), Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Qubits, Multi\+Qubit\+::pair\+State\+Vec, Qu\+E\+S\+T\+Assert(), Multi\+Qubit\+::state\+Vec, and validate\+Matrix\+Is\+Unitary().


\begin{DoxyCode}
141 \{
142     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(targetQubit >= 0 && targetQubit < multiQubit.
      \hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}, 1, \_\_func\_\_);
143     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(numControlQubits > 0 && numControlQubits <= multiQubit.
      \hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}, 4, \_\_func\_\_);
144     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(\hyperlink{qubits_8c_ae4fea133d1a8f09ff8da03038100adb2}{validateMatrixIsUnitary}(u), 5, \_\_func\_\_);
145 
146     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} mask=0; 
147     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0; i<numControlQubits; i++) mask = mask | (1LL<<controlQubits[i]);
148     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(mask >=0 && mask <= (1LL<<multiQubit.\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits})-1, 2, \_\_func\_\_);
149     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}((mask & (1LL<<targetQubit)) != (1LL<<targetQubit), 3, \_\_func\_\_);
150         
151     \hyperlink{qubits_8c_a1309eabcba3cb97fbc3cd2e606d17766}{multiControlledUnitaryLocal}(multiQubit, targetQubit, mask, u);
152 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!report\+Multi\+Qubit\+Params@{report\+Multi\+Qubit\+Params}}
\index{report\+Multi\+Qubit\+Params@{report\+Multi\+Qubit\+Params}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{report\+Multi\+Qubit\+Params(\+Multi\+Qubit multi\+Qubit)}{reportMultiQubitParams(MultiQubit multiQubit)}}]{\setlength{\rightskip}{0pt plus 5cm}void report\+Multi\+Qubit\+Params (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_aa5e77e0e64f3a4a3d3f5cc7382bffcd9}{}\label{qubits_8h_aa5e77e0e64f3a4a3d3f5cc7382bffcd9}


Report metainformation about a set of qubits\+: number of qubits, number of probability amplitudes. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\mbox{\tt in}  & {\em env} & object representing the execution environment (local, multinode etc) \\
\hline
\end{DoxyParams}


Definition at line 116 of file qubits.\+c.



References Multi\+Qubit\+::chunk\+Id, Multi\+Qubit\+::num\+Chunks, and Multi\+Qubit\+::num\+Qubits.


\begin{DoxyCode}
116                                                   \{
117         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numAmps = 1L << multiQubit.\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits};
118         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numAmpsPerRank = numAmps/multiQubit.\hyperlink{structMultiQubit_acd43f2f57991709c9e94f73662c972b2}{numChunks};
119         \textcolor{keywordflow}{if} (multiQubit.\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId}==0)\{
120                 printf(\textcolor{stringliteral}{"QUBITS:\(\backslash\)n"});
121                 printf(\textcolor{stringliteral}{"Number of qubits is %d.\(\backslash\)n"}, multiQubit.\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits});
122                 printf(\textcolor{stringliteral}{"Number of amps is %lld.\(\backslash\)n"}, numAmps);
123                 printf(\textcolor{stringliteral}{"Number of amps per rank is %lld.\(\backslash\)n"}, numAmpsPerRank);
124         \}
125 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!report\+Qu\+E\+S\+T\+Env@{report\+Qu\+E\+S\+T\+Env}}
\index{report\+Qu\+E\+S\+T\+Env@{report\+Qu\+E\+S\+T\+Env}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{report\+Qu\+E\+S\+T\+Env(\+Qu\+E\+S\+T\+Env env)}{reportQuESTEnv(QuESTEnv env)}}]{\setlength{\rightskip}{0pt plus 5cm}void report\+Qu\+E\+S\+T\+Env (
\begin{DoxyParamCaption}
\item[{{\bf Qu\+E\+S\+T\+Env}}]{env}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_af8a14ae79c3fb2c0b5f6255cc37bebf9}{}\label{qubits_8h_af8a14ae79c3fb2c0b5f6255cc37bebf9}


Report information about the Qu\+E\+ST environment. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em env} & object representing the execution environment. A single instance is used for each program \\
\hline
\end{DoxyParams}


Definition at line 44 of file qubits\+\_\+env\+\_\+local.\+c.



References Qu\+E\+S\+T\+Env\+::num\+Ranks, Qu\+E\+S\+T\+Env\+::rank, and R\+E\+AL.


\begin{DoxyCode}
44                                  \{
45         printf(\textcolor{stringliteral}{"EXECUTION ENVIRONMENT:\(\backslash\)n"});
46         printf(\textcolor{stringliteral}{"Running locally on one node\(\backslash\)n"});
47         printf(\textcolor{stringliteral}{"Number of ranks is %d\(\backslash\)n"}, env.\hyperlink{structQuESTEnv_af22aacd7c9905accae28484785c193b4}{numRanks});
48 \textcolor{preprocessor}{# ifdef \_OPENMP}
49         printf(\textcolor{stringliteral}{"OpenMP enabled\(\backslash\)n"});
50         printf(\textcolor{stringliteral}{"Number of threads available is %d\(\backslash\)n"}, omp\_get\_max\_threads());
51 \textcolor{preprocessor}{# else}
52         printf(\textcolor{stringliteral}{"OpenMP disabled\(\backslash\)n"});
53 \textcolor{preprocessor}{# endif}
54         printf(\textcolor{stringliteral}{"Precision: size of REAL is %ld bytes\(\backslash\)n"}, \textcolor{keyword}{sizeof}(\hyperlink{precision_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}));
55 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!report\+State@{report\+State}}
\index{report\+State@{report\+State}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{report\+State(\+Multi\+Qubit multi\+Qubit)}{reportState(MultiQubit multiQubit)}}]{\setlength{\rightskip}{0pt plus 5cm}void report\+State (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_a96f4de9ce7fefc7680a44d601fc3d894}{}\label{qubits_8h_a96f4de9ce7fefc7680a44d601fc3d894}


Print the current state vector of probability amplitudes for a set of qubits to file. 

File format\+: \begin{DoxyVerb}real, imag
realComponent1, imagComponent1
realComponent2, imagComponent2
...
realComponentN, imagComponentN
\end{DoxyVerb}


File naming convention\+:

For each node that the program runs on, a file \textquotesingle{}state\+\_\+rank\+\_\+\mbox{[}node\+\_\+rank\mbox{]}.csv\textquotesingle{} is generated. If there is more than one node, ranks after the first do not include the header \begin{DoxyVerb}real, imag
\end{DoxyVerb}
 so that files are easier to combine.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of qubits \\
\hline
\end{DoxyParams}


Definition at line 77 of file qubits.\+c.



References Multi\+Qubit\+::chunk\+Id, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps, Complex\+Array\+::real, R\+E\+A\+L\+\_\+\+S\+T\+R\+I\+N\+G\+\_\+\+F\+O\+R\+M\+AT, and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
77                                        \{
78         FILE *state;
79         \textcolor{keywordtype}{char} filename[100];
80         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
81         sprintf(filename, \textcolor{stringliteral}{"state\_rank\_%d.csv"}, multiQubit.\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId});
82         state = fopen(filename, \textcolor{stringliteral}{"w"});
83         \textcolor{keywordflow}{if} (multiQubit.\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId}==0) fprintf(state, \textcolor{stringliteral}{"real, imag\(\backslash\)n"});
84 
85         \textcolor{keywordflow}{for}(index=0; index<multiQubit.\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps}; index++)\{
86                 fprintf(state, \hyperlink{precision_8h_ad751ac7ddc8ec19f23fb33083c0da8da}{REAL\_STRING\_FORMAT} \textcolor{stringliteral}{","} 
      \hyperlink{precision_8h_ad751ac7ddc8ec19f23fb33083c0da8da}{REAL\_STRING\_FORMAT} \textcolor{stringliteral}{"\(\backslash\)n"}, multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}[index], multiQubit.
      \hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}[index]);
87         \}
88         fclose(state);
89 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!report\+State\+To\+Screen@{report\+State\+To\+Screen}}
\index{report\+State\+To\+Screen@{report\+State\+To\+Screen}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{report\+State\+To\+Screen(\+Multi\+Qubit multi\+Qubit, Qu\+E\+S\+T\+Env env, int report\+Rank)}{reportStateToScreen(MultiQubit multiQubit, QuESTEnv env, int reportRank)}}]{\setlength{\rightskip}{0pt plus 5cm}void report\+State\+To\+Screen (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{{\bf Qu\+E\+S\+T\+Env}}]{env, }
\item[{int}]{report\+Rank}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_a842d6884e063a5865a2232cba56b65ac}{}\label{qubits_8h_a842d6884e063a5865a2232cba56b65ac}


Print the current state vector of probability amplitudes for a set of qubits to standard out. 

For debugging purposes. Each rank should print output serially. Only print output for systems $<$= 5 qubits 

Definition at line 91 of file qubits.\+c.



References Multi\+Qubit\+::chunk\+Id, Complex\+Array\+::imag, Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Chunks, Multi\+Qubit\+::num\+Qubits, Complex\+Array\+::real, R\+E\+A\+L\+\_\+\+S\+T\+R\+I\+N\+G\+\_\+\+F\+O\+R\+M\+AT, Multi\+Qubit\+::state\+Vec, and sync\+Qu\+E\+S\+T\+Env().


\begin{DoxyCode}
91                                                                              \{
92         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
93         \textcolor{keywordtype}{int} rank;
94         \textcolor{keywordflow}{if} (multiQubit.\hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}<=5)\{
95                 \textcolor{keywordflow}{for} (rank=0; rank<multiQubit.\hyperlink{structMultiQubit_acd43f2f57991709c9e94f73662c972b2}{numChunks}; rank++)\{
96                         \textcolor{keywordflow}{if} (multiQubit.\hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId}==rank)\{
97                                 \textcolor{keywordflow}{if} (reportRank) \{
98                                         printf(\textcolor{stringliteral}{"Reporting state from rank %d [\(\backslash\)n"}, multiQubit.
      \hyperlink{structMultiQubit_ab10c88249fa3825d6227ceec01d37e37}{chunkId});
99                                         \textcolor{comment}{//printf("\(\backslash\)trank, index, real, imag\(\backslash\)n");}
100                                         printf(\textcolor{stringliteral}{"real, imag\(\backslash\)n"});
101                                 \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (rank==0) \{
102                                         printf(\textcolor{stringliteral}{"Reporting state [\(\backslash\)n"});
103                                         printf(\textcolor{stringliteral}{"real, imag\(\backslash\)n"});
104                                 \}
105 
106                                 \textcolor{keywordflow}{for}(index=0; index<multiQubit.\hyperlink{structMultiQubit_ae16f47d8b725c914fb7f66b6498d79db}{numAmps}; index++)\{
107                                         printf(\hyperlink{precision_8h_ad751ac7ddc8ec19f23fb33083c0da8da}{REAL\_STRING\_FORMAT} \textcolor{stringliteral}{", "} 
      \hyperlink{precision_8h_ad751ac7ddc8ec19f23fb33083c0da8da}{REAL\_STRING\_FORMAT} \textcolor{stringliteral}{"\(\backslash\)n"}, multiQubit.\hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a4195cac6c784ea1b6271f1c7dba1548a}{real}[index], multiQubit.
      \hyperlink{structMultiQubit_a45483190d6b01ef6b2f98f2bec9ab94f}{stateVec}.\hyperlink{structComplexArray_a79dde47c7ae530c79cebfdf57b225968}{imag}[index]);
108                                 \}
109                                 \textcolor{keywordflow}{if} (reportRank || rank==multiQubit.\hyperlink{structMultiQubit_acd43f2f57991709c9e94f73662c972b2}{numChunks}-1) printf(\textcolor{stringliteral}{"]\(\backslash\)n"});
110                         \}
111                         \hyperlink{qubits_8h_a8d31fe2d1ad4d01e2a1f5f6b8bc15b77}{syncQuESTEnv}(env);
112                 \}
113         \} \textcolor{keywordflow}{else} printf(\textcolor{stringliteral}{"Error: reportStateToScreen will not print output for systems of more than 5 qubits.
      \(\backslash\)n"});
114 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!rotate\+Around\+Axis@{rotate\+Around\+Axis}}
\index{rotate\+Around\+Axis@{rotate\+Around\+Axis}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{rotate\+Around\+Axis(\+Multi\+Qubit multi\+Qubit, const int rot\+Qubit, R\+E\+A\+L angle, Vector unit\+Axis)}{rotateAroundAxis(MultiQubit multiQubit, const int rotQubit, REAL angle, Vector unitAxis)}}]{\setlength{\rightskip}{0pt plus 5cm}void rotate\+Around\+Axis (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{const int}]{rot\+Qubit, }
\item[{{\bf R\+E\+AL}}]{angle, }
\item[{{\bf Vector}}]{unit\+Axis}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_a7fadb225fc385db789e844c87fcba9e1}{}\label{qubits_8h_a7fadb225fc385db789e844c87fcba9e1}


Rotate a single qubit by a given angle around a given vector on the Bloch-\/sphere. 


\begin{DoxyItemize}
\item The vector must not be zero (else an error is thrown), but needn\textquotesingle{}t be unit magnitude.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em rot\+Qubit} & qubit to rotate \\
\hline
\mbox{\tt in}  & {\em angle} & angle by which to rotate in radians \\
\hline
\mbox{\tt in}  & {\em axis} & vector around which to rotate \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily rot\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}), or if {\ttfamily axis} is the zero vector \\
\hline
\end{DoxyExceptions}


Definition at line 378 of file qubits.\+c.



References compact\+Unitary(), Complex\+::imag, Complex\+::real, Vector\+::x, Vector\+::y, and Vector\+::z.


\begin{DoxyCode}
378                                                                                              \{
379         \hyperlink{structComplex}{Complex} alpha, beta;
380         alpha.\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real} = cos(angle/2.0);
381         alpha.\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag} = -sin(angle/2.0)*unitAxis.\hyperlink{structVector_ad4e863651be7d6b7e2b28cd7445a0ccf}{z};   
382         beta.\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real} = 0;
383         beta.\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag} = -sin(angle/2.0)*(unitAxis.\hyperlink{structVector_aac7abe171ba4bada50ed72acba6259fc}{x} + unitAxis.\hyperlink{structVector_a375ca805d4c808a53d7c4e0c737ae3de}{y});
384         \hyperlink{qubits_8h_a03b13dfcabd8c59b50dbdd3af44ba8b2}{compactUnitary}(multiQubit, rotQubit, alpha, beta);
385 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!rotateX@{rotateX}}
\index{rotateX@{rotateX}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{rotate\+X(\+Multi\+Qubit multi\+Qubit, const int rot\+Qubit, R\+E\+A\+L angle)}{rotateX(MultiQubit multiQubit, const int rotQubit, REAL angle)}}]{\setlength{\rightskip}{0pt plus 5cm}void rotateX (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{const int}]{rot\+Qubit, }
\item[{{\bf R\+E\+AL}}]{angle}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_a6cc7fa705a2f2e6b486b49c5589d5df5}{}\label{qubits_8h_a6cc7fa705a2f2e6b486b49c5589d5df5}


Rotate a single qubit by a given angle around the X-\/axis of the Bloch-\/sphere. 

For angle $\theta$, applies \[ \begin{pmatrix} \cos\theta/2 & -i \sin \theta/2\\ -i \sin \theta/2 & \cos \theta/2 \end{pmatrix} \]

\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {rot}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$R_x(\theta)$}; \end{tikzpicture} } \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em rot\+Qubit} & qubit to rotate \\
\hline
\mbox{\tt in}  & {\em angle} & angle by which to rotate in radians \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily rot\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}). \\
\hline
\end{DoxyExceptions}


Definition at line 387 of file qubits.\+c.



References compact\+Unitary(), Complex\+::imag, Complex\+::real, Vector\+::x, Vector\+::y, and Vector\+::z.


\begin{DoxyCode}
387                                                                    \{
388         \hyperlink{structComplex}{Complex} alpha, beta;
389     \hyperlink{structVector}{Vector} unitAxis = \{1, 0, 0\};
390         alpha.\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real} = cos(angle/2.0);
391         alpha.\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag} = -sin(angle/2.0)*unitAxis.\hyperlink{structVector_ad4e863651be7d6b7e2b28cd7445a0ccf}{z};   
392         beta.\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real} = 0;
393         beta.\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag} = -sin(angle/2.0)*(unitAxis.\hyperlink{structVector_aac7abe171ba4bada50ed72acba6259fc}{x} + unitAxis.\hyperlink{structVector_a375ca805d4c808a53d7c4e0c737ae3de}{y});
394         \hyperlink{qubits_8h_a03b13dfcabd8c59b50dbdd3af44ba8b2}{compactUnitary}(multiQubit, rotQubit, alpha, beta);
395 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!rotateY@{rotateY}}
\index{rotateY@{rotateY}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{rotate\+Y(\+Multi\+Qubit multi\+Qubit, const int rot\+Qubit, R\+E\+A\+L angle)}{rotateY(MultiQubit multiQubit, const int rotQubit, REAL angle)}}]{\setlength{\rightskip}{0pt plus 5cm}void rotateY (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{const int}]{rot\+Qubit, }
\item[{{\bf R\+E\+AL}}]{angle}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_ace0d3592d38a990e81a434c4e9681500}{}\label{qubits_8h_ace0d3592d38a990e81a434c4e9681500}


Rotate a single qubit by a given angle around the Y-\/axis of the Bloch-\/sphere. 

For angle $\theta$, applies \[ \begin{pmatrix} \cos\theta/2 & \sin \theta/2\\ \sin \theta/2 & \cos \theta/2 \end{pmatrix} \]

\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {rot}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$R_y(\theta)$}; \end{tikzpicture} } \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em rot\+Qubit} & qubit to rotate \\
\hline
\mbox{\tt in}  & {\em angle} & angle by which to rotate in radians \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily rot\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}). \\
\hline
\end{DoxyExceptions}


Definition at line 397 of file qubits.\+c.



References compact\+Unitary(), Complex\+::imag, Complex\+::real, Vector\+::x, Vector\+::y, and Vector\+::z.


\begin{DoxyCode}
397                                                                    \{
398         \hyperlink{structComplex}{Complex} alpha, beta;
399     \hyperlink{structVector}{Vector} unitAxis = \{0, 1, 0\};
400         alpha.\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real} = cos(angle/2.0);
401         alpha.\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag} = -sin(angle/2.0)*unitAxis.\hyperlink{structVector_ad4e863651be7d6b7e2b28cd7445a0ccf}{z};   
402         beta.\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real} = 0;
403         beta.\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag} = -sin(angle/2.0)*(unitAxis.\hyperlink{structVector_aac7abe171ba4bada50ed72acba6259fc}{x} + unitAxis.\hyperlink{structVector_a375ca805d4c808a53d7c4e0c737ae3de}{y});
404         \hyperlink{qubits_8h_a03b13dfcabd8c59b50dbdd3af44ba8b2}{compactUnitary}(multiQubit, rotQubit, alpha, beta);
405 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!rotateZ@{rotateZ}}
\index{rotateZ@{rotateZ}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{rotate\+Z(\+Multi\+Qubit multi\+Qubit, const int rot\+Qubit, R\+E\+A\+L angle)}{rotateZ(MultiQubit multiQubit, const int rotQubit, REAL angle)}}]{\setlength{\rightskip}{0pt plus 5cm}void rotateZ (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{const int}]{rot\+Qubit, }
\item[{{\bf R\+E\+AL}}]{angle}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_abd621412ad30c1b034f4ce153c4afe10}{}\label{qubits_8h_abd621412ad30c1b034f4ce153c4afe10}


Rotate a single qubit by a given angle around the Z-\/axis of the Bloch-\/sphere (also known as a phase shift gate). 

For angle $\theta$, applies \[ \begin{pmatrix} \exp(-i \theta/2) & 0 \\ 0 & \exp(i \theta/2) \end{pmatrix} \]

\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {rot}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$R_z(\theta)$}; \end{tikzpicture} } \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em rot\+Qubit} & qubit to rotate \\
\hline
\mbox{\tt in}  & {\em angle} & angle by which to rotate in radians \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily rot\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}). \\
\hline
\end{DoxyExceptions}


Definition at line 407 of file qubits.\+c.



References compact\+Unitary(), Complex\+::imag, Complex\+::real, Vector\+::x, Vector\+::y, and Vector\+::z.


\begin{DoxyCode}
407                                                                    \{
408         \hyperlink{structComplex}{Complex} alpha, beta;
409     \hyperlink{structVector}{Vector} unitAxis = \{0, 0, 1\};
410         alpha.\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real} = cos(angle/2.0);
411         alpha.\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag} = -sin(angle/2.0)*unitAxis.\hyperlink{structVector_ad4e863651be7d6b7e2b28cd7445a0ccf}{z};   
412         beta.\hyperlink{structComplex_a479ad939835457595fcca3ca55c06283}{real} = 0;
413         beta.\hyperlink{structComplex_a1151948284b21c0052f203f23ab931d9}{imag} = -sin(angle/2.0)*(unitAxis.\hyperlink{structVector_aac7abe171ba4bada50ed72acba6259fc}{x} + unitAxis.\hyperlink{structVector_a375ca805d4c808a53d7c4e0c737ae3de}{y});
414         \hyperlink{qubits_8h_a03b13dfcabd8c59b50dbdd3af44ba8b2}{compactUnitary}(multiQubit, rotQubit, alpha, beta);
415 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!s\+Gate@{s\+Gate}}
\index{s\+Gate@{s\+Gate}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{s\+Gate(\+Multi\+Qubit multi\+Qubit, const int target\+Qubit)}{sGate(MultiQubit multiQubit, const int targetQubit)}}]{\setlength{\rightskip}{0pt plus 5cm}void s\+Gate (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{const int}]{target\+Qubit}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_adda6c47876a7676488ed0565a19eaa65}{}\label{qubits_8h_adda6c47876a7676488ed0565a19eaa65}


Apply the single-\/qubit S gate. 

This is a rotation of $\pi/2$ around the Z-\/axis on the Bloch sphere, or the unitary\+: \[ \begin{pmatrix} 1 & 0 \\ 0 & i \end{pmatrix} \]

\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {S}; \end{tikzpicture} } \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em target\+Qubit} & qubit to operate upon \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily target\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}) \\
\hline
\end{DoxyExceptions}


Definition at line 1553 of file qubits.\+c.



References phase\+Gate(), and S\+\_\+\+G\+A\+TE.


\begin{DoxyCode}
1554 \{
1555                 \hyperlink{qubits__env__local_8c_aae7a8a7f1ccbddb7f76b6c52b746bb43}{phaseGate}(multiQubit, targetQubit, \hyperlink{qubits_8h_a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f}{S\_GATE});
1556 \} 
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!sigmaX@{sigmaX}}
\index{sigmaX@{sigmaX}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{sigma\+X(\+Multi\+Qubit multi\+Qubit, const int target\+Qubit)}{sigmaX(MultiQubit multiQubit, const int targetQubit)}}]{\setlength{\rightskip}{0pt plus 5cm}void sigmaX (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{const int}]{target\+Qubit}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_a86e396e06b7d527cac20ba0108872423}{}\label{qubits_8h_a86e396e06b7d527cac20ba0108872423}


Apply the single-\/qubit sigma-\/X (also known as the X, Pauli-\/X, N\+OT or bit-\/flip) gate. 

This is a rotation of $\pi$ around the x-\/axis on the Bloch sphere. I.\+e. \[ \begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix} \]

\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (2, 0); \draw (0, 0) circle (.5); \draw (0, .5) -- (0, -.5); \end{tikzpicture} } \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em target\+Qubit} & qubit to operate on \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily target\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}). \\
\hline
\end{DoxyExceptions}


Definition at line 154 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, chunk\+Is\+Upper(), exchange\+State\+Vectors(), get\+Chunk\+Pair\+Id(), half\+Matrix\+Block\+Fits\+In\+Chunk(), Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Qubits, Multi\+Qubit\+::pair\+State\+Vec, Qu\+E\+S\+T\+Assert(), sigma\+X\+Distributed(), sigma\+X\+Local(), and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
155 \{
156     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(targetQubit >= 0 && targetQubit < multiQubit.
      \hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}, 1, \_\_func\_\_);
157         \hyperlink{qubits_8c_a74822fd86bb5d81766e6e8dbdcd62df1}{sigmaXLocal}(multiQubit, targetQubit);
158 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!sigmaY@{sigmaY}}
\index{sigmaY@{sigmaY}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{sigma\+Y(\+Multi\+Qubit multi\+Qubit, const int target\+Qubit)}{sigmaY(MultiQubit multiQubit, const int targetQubit)}}]{\setlength{\rightskip}{0pt plus 5cm}void sigmaY (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{const int}]{target\+Qubit}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_a1f54d70a42403f7e1c2e2c2007332f61}{}\label{qubits_8h_a1f54d70a42403f7e1c2e2c2007332f61}


Apply the single-\/qubit sigma-\/Y (also known as the Y or Pauli-\/Y) gate. 

This is a rotation of $\pi$ around the Y-\/axis on the Bloch sphere. I.\+e. \[ \begin{pmatrix} 0 & -i \\ i & 0 \end{pmatrix} \]

\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$\sigma_y$}; \end{tikzpicture} } \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em target\+Qubit} & qubit to operate on \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily target\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}). \\
\hline
\end{DoxyExceptions}
fix -- put duplicate code (sigmaX, sigmaY) in seperate function 

Definition at line 160 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, chunk\+Is\+Upper(), exchange\+State\+Vectors(), get\+Chunk\+Pair\+Id(), half\+Matrix\+Block\+Fits\+In\+Chunk(), Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Qubits, Multi\+Qubit\+::pair\+State\+Vec, Qu\+E\+S\+T\+Assert(), sigma\+Y\+Distributed(), sigma\+Y\+Local(), and Multi\+Qubit\+::state\+Vec.


\begin{DoxyCode}
161 \{
162     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(targetQubit >= 0 && targetQubit < multiQubit.
      \hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}, 1, \_\_func\_\_);
163         \hyperlink{qubits_8c_a81fbfaed65a742a7dfd622e17652245e}{sigmaYLocal}(multiQubit, targetQubit);
164 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!sigmaZ@{sigmaZ}}
\index{sigmaZ@{sigmaZ}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{sigma\+Z(\+Multi\+Qubit multi\+Qubit, const int target\+Qubit)}{sigmaZ(MultiQubit multiQubit, const int targetQubit)}}]{\setlength{\rightskip}{0pt plus 5cm}void sigmaZ (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{const int}]{target\+Qubit}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_aebaab86326779de55d335cfea3efde8f}{}\label{qubits_8h_aebaab86326779de55d335cfea3efde8f}


Apply the single-\/qubit sigma-\/Z (also known as the Z, Pauli-\/Z or phase-\/flip) gate. 

This is a rotation of $\pi$ around the Z-\/axis (a phase shift) on the Bloch sphere. I.\+e. \[ \begin{pmatrix} 1 & 0 \\ 0 & -1 \end{pmatrix} \]

\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$\sigma_z$}; \end{tikzpicture} } \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em target\+Qubit} & qubit to operate on \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily target\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}). \\
\hline
\end{DoxyExceptions}


Definition at line 1548 of file qubits.\+c.



References phase\+Gate(), and S\+I\+G\+M\+A\+\_\+Z.


\begin{DoxyCode}
1549 \{
1550                 \hyperlink{qubits__env__local_8c_aae7a8a7f1ccbddb7f76b6c52b746bb43}{phaseGate}(multiQubit, targetQubit, \hyperlink{qubits_8h_a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac}{SIGMA\_Z});
1551 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!sync\+Qu\+E\+S\+T\+Env@{sync\+Qu\+E\+S\+T\+Env}}
\index{sync\+Qu\+E\+S\+T\+Env@{sync\+Qu\+E\+S\+T\+Env}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{sync\+Qu\+E\+S\+T\+Env(\+Qu\+E\+S\+T\+Env env)}{syncQuESTEnv(QuESTEnv env)}}]{\setlength{\rightskip}{0pt plus 5cm}void sync\+Qu\+E\+S\+T\+Env (
\begin{DoxyParamCaption}
\item[{{\bf Qu\+E\+S\+T\+Env}}]{env}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_a8d31fe2d1ad4d01e2a1f5f6b8bc15b77}{}\label{qubits_8h_a8d31fe2d1ad4d01e2a1f5f6b8bc15b77}


Guarantees that all code up to the given point has been executed on all nodes (if running in distributed mode) 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em env} & object representing the execution environment. A single instance is used for each program \\
\hline
\end{DoxyParams}


Definition at line 32 of file qubits\+\_\+env\+\_\+local.\+c.



Referenced by initialize\+State\+From\+Single\+File(), and report\+State\+To\+Screen().


\begin{DoxyCode}
32                                \{
33         \textcolor{comment}{// MPI Barrier goes here in MPI version. }
34 \} 
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!sync\+Qu\+E\+S\+T\+Success@{sync\+Qu\+E\+S\+T\+Success}}
\index{sync\+Qu\+E\+S\+T\+Success@{sync\+Qu\+E\+S\+T\+Success}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{sync\+Qu\+E\+S\+T\+Success(int success\+Code)}{syncQuESTSuccess(int successCode)}}]{\setlength{\rightskip}{0pt plus 5cm}int sync\+Qu\+E\+S\+T\+Success (
\begin{DoxyParamCaption}
\item[{int}]{success\+Code}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_ac7e38d768a1bd79019f88cc1e6295092}{}\label{qubits_8h_ac7e38d768a1bd79019f88cc1e6295092}


Performs a logical A\+ND on all success\+Codes held by all processes. 

If any one process has a zero success\+Code all processes will return a zero success code.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em env} & object representing the execution environment. A single instance is used for each program \\
\hline
\mbox{\tt in}  & {\em success\+Code} & 1 if process task succeeded, 0 if process task failed \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if all processes succeeded, 0 if any one process failed 
\end{DoxyReturn}


Definition at line 36 of file qubits\+\_\+env\+\_\+local.\+c.


\begin{DoxyCode}
36                                      \{
37         \textcolor{keywordflow}{return} successCode;
38 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!t\+Gate@{t\+Gate}}
\index{t\+Gate@{t\+Gate}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{t\+Gate(\+Multi\+Qubit multi\+Qubit, const int target\+Qubit)}{tGate(MultiQubit multiQubit, const int targetQubit)}}]{\setlength{\rightskip}{0pt plus 5cm}void t\+Gate (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{const int}]{target\+Qubit}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_af764ea63a2e870098f4e1ce08562942e}{}\label{qubits_8h_af764ea63a2e870098f4e1ce08562942e}


Apply the single-\/qubit T gate. 

This is a rotation of $\pi/4$ around the Z-\/axis on the Bloch sphere, or the unitary\+: \[ \begin{pmatrix} 1 & 0 \\ 0 & \exp\left(i \frac{\pi}{4}\right) \end{pmatrix} \]

\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {T}; \end{tikzpicture} } \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em target\+Qubit} & qubit to operate upon \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily target\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}) \\
\hline
\end{DoxyExceptions}


Definition at line 1558 of file qubits.\+c.



References phase\+Gate(), and T\+\_\+\+G\+A\+TE.


\begin{DoxyCode}
1559 \{
1560                 \hyperlink{qubits__env__local_8c_aae7a8a7f1ccbddb7f76b6c52b746bb43}{phaseGate}(multiQubit, targetQubit, \hyperlink{qubits_8h_a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab}{T\_GATE});
1561 \}
\end{DoxyCode}
\index{qubits.\+h@{qubits.\+h}!unitary@{unitary}}
\index{unitary@{unitary}!qubits.\+h@{qubits.\+h}}
\paragraph[{\texorpdfstring{unitary(\+Multi\+Qubit multi\+Qubit, const int target\+Qubit, Complex\+Matrix2 u)}{unitary(MultiQubit multiQubit, const int targetQubit, ComplexMatrix2 u)}}]{\setlength{\rightskip}{0pt plus 5cm}void unitary (
\begin{DoxyParamCaption}
\item[{{\bf Multi\+Qubit}}]{multi\+Qubit, }
\item[{const int}]{target\+Qubit, }
\item[{{\bf Complex\+Matrix2}}]{u}
\end{DoxyParamCaption}
)}\hypertarget{qubits_8h_a7a0877e33700f6bad48adb51b7b3fb67}{}\label{qubits_8h_a7a0877e33700f6bad48adb51b7b3fb67}


Apply a general single-\/qubit unitary (including a global phase factor). 

The passed 2x2 Complex\+Matrix must be unitary, otherwise an error is thrown.

\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {U}; \end{tikzpicture} } \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em multi\+Qubit} & object representing the set of all qubits \\
\hline
\mbox{\tt in}  & {\em target\+Qubit} & qubit to operate on \\
\hline
\mbox{\tt in}  & {\em u} & unitary matrix to apply \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em exit\+With\+Error} & if {\ttfamily target\+Qubit} is outside \mbox{[}0, {\ttfamily multi\+Qubit.\+num\+Qubits}), or matrix {\ttfamily u} is not unitary. \\
\hline
\end{DoxyExceptions}


Definition at line 110 of file qubits\+\_\+env\+\_\+local.\+c.



References Multi\+Qubit\+::chunk\+Id, chunk\+Is\+Upper(), exchange\+State\+Vectors(), get\+Chunk\+Pair\+Id(), get\+Rot\+Angle\+From\+Unitary\+Matrix(), half\+Matrix\+Block\+Fits\+In\+Chunk(), Multi\+Qubit\+::num\+Amps, Multi\+Qubit\+::num\+Qubits, Multi\+Qubit\+::pair\+State\+Vec, Qu\+E\+S\+T\+Assert(), Multi\+Qubit\+::state\+Vec, unitary\+Distributed(), unitary\+Local(), and validate\+Matrix\+Is\+Unitary().


\begin{DoxyCode}
111 \{
112     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(targetQubit >= 0 && targetQubit < multiQubit.
      \hyperlink{structMultiQubit_ab5b9795bdc6fb5855e1974dcbbaeb36f}{numQubits}, 1, \_\_func\_\_);
113     \hyperlink{qubits__env__local_8c_a3587b9d533e633ccf1abf9ad2ce45d8d}{QuESTAssert}(\hyperlink{qubits_8c_ae4fea133d1a8f09ff8da03038100adb2}{validateMatrixIsUnitary}(u), 5, \_\_func\_\_);
114 
115         \textcolor{comment}{// all values required to update state vector lie in this rank}
116         \hyperlink{qubits_8c_ac134fb45b0a7248c5d15e16eb7139a35}{unitaryLocal}(multiQubit, targetQubit, u);
117 \}
\end{DoxyCode}
