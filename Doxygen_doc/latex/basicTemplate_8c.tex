\hypertarget{basicTemplate_8c}{}\subsection{basic\+Template.\+c File Reference}
\label{basicTemplate_8c}\index{basic\+Template.\+c@{basic\+Template.\+c}}


Basic template for using the Q\+U\+E\+ST library.  


{\ttfamily \#include $<$stdio.\+h$>$}\\*
{\ttfamily \#include $<$stdlib.\+h$>$}\\*
{\ttfamily \#include $<$time.\+h$>$}\\*
{\ttfamily \#include $<$math.\+h$>$}\\*
{\ttfamily \#include $<$unistd.\+h$>$}\\*
{\ttfamily \#include $<$string.\+h$>$}\\*
{\ttfamily \#include $<$omp.\+h$>$}\\*
{\ttfamily \#include \char`\"{}Q\+U\+E\+S\+T/qubits.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}Q\+U\+E\+S\+T/qubits\+\_\+env\+\_\+wrapper.\+h\char`\"{}}\\*
\subsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{basicTemplate_8c_a353abace49aefb52015b80290cf26d77}{Max\+Angles}~10
\begin{DoxyCompactList}\small\item\em Max number of angles used to define qubit rotation. \end{DoxyCompactList}\item 
\#define \hyperlink{basicTemplate_8c_a8e2ba5722f048e5a9cd58d09085f6cb1}{max\+Num\+Qubits}~40
\begin{DoxyCompactList}\small\item\em Max number of qubits in the system. \end{DoxyCompactList}\item 
\#define \hyperlink{basicTemplate_8c_a64394210bc1694536cbb8411d2bab5ed}{R\+E\+P\+O\+R\+T\+\_\+\+S\+T\+A\+TE}~1
\begin{DoxyCompactList}\small\item\em 1\+: print end qubit state to file, 0\+: don\textquotesingle{}t print \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{basicTemplate_8c_a0b1907e3d123f469a739aa425bd05574}{main} (int narg, char $\ast$$\ast$varg)
\end{DoxyCompactItemize}
\subsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const long double \hyperlink{basicTemplate_8c_a00c9db5f4f80636d4da765f0893743f6}{Pi} = 3.\+14159265358979323846264338327950288419716939937510
\end{DoxyCompactItemize}


\subsubsection{Detailed Description}
Basic template for using the Q\+U\+E\+ST library. 

In general, leave the initialisation and cleanup sections as they are and edit the rotations, measurement and phase gate sections. 

\subsubsection{Macro Definition Documentation}
\index{basic\+Template.\+c@{basic\+Template.\+c}!Max\+Angles@{Max\+Angles}}
\index{Max\+Angles@{Max\+Angles}!basic\+Template.\+c@{basic\+Template.\+c}}
\paragraph[{\texorpdfstring{Max\+Angles}{MaxAngles}}]{\setlength{\rightskip}{0pt plus 5cm}\#define Max\+Angles~10}\hypertarget{basicTemplate_8c_a353abace49aefb52015b80290cf26d77}{}\label{basicTemplate_8c_a353abace49aefb52015b80290cf26d77}


Max number of angles used to define qubit rotation. 



Definition at line 19 of file basic\+Template.\+c.



Referenced by main().

\index{basic\+Template.\+c@{basic\+Template.\+c}!max\+Num\+Qubits@{max\+Num\+Qubits}}
\index{max\+Num\+Qubits@{max\+Num\+Qubits}!basic\+Template.\+c@{basic\+Template.\+c}}
\paragraph[{\texorpdfstring{max\+Num\+Qubits}{maxNumQubits}}]{\setlength{\rightskip}{0pt plus 5cm}\#define max\+Num\+Qubits~40}\hypertarget{basicTemplate_8c_a8e2ba5722f048e5a9cd58d09085f6cb1}{}\label{basicTemplate_8c_a8e2ba5722f048e5a9cd58d09085f6cb1}


Max number of qubits in the system. 



Definition at line 21 of file basic\+Template.\+c.



Referenced by main().

\index{basic\+Template.\+c@{basic\+Template.\+c}!R\+E\+P\+O\+R\+T\+\_\+\+S\+T\+A\+TE@{R\+E\+P\+O\+R\+T\+\_\+\+S\+T\+A\+TE}}
\index{R\+E\+P\+O\+R\+T\+\_\+\+S\+T\+A\+TE@{R\+E\+P\+O\+R\+T\+\_\+\+S\+T\+A\+TE}!basic\+Template.\+c@{basic\+Template.\+c}}
\paragraph[{\texorpdfstring{R\+E\+P\+O\+R\+T\+\_\+\+S\+T\+A\+TE}{REPORT_STATE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define R\+E\+P\+O\+R\+T\+\_\+\+S\+T\+A\+TE~1}\hypertarget{basicTemplate_8c_a64394210bc1694536cbb8411d2bab5ed}{}\label{basicTemplate_8c_a64394210bc1694536cbb8411d2bab5ed}


1\+: print end qubit state to file, 0\+: don\textquotesingle{}t print 



Definition at line 23 of file basic\+Template.\+c.



Referenced by main().



\subsubsection{Function Documentation}
\index{basic\+Template.\+c@{basic\+Template.\+c}!main@{main}}
\index{main@{main}!basic\+Template.\+c@{basic\+Template.\+c}}
\paragraph[{\texorpdfstring{main(int narg, char $\ast$$\ast$varg)}{main(int narg, char **varg)}}]{\setlength{\rightskip}{0pt plus 5cm}int main (
\begin{DoxyParamCaption}
\item[{int}]{narg, }
\item[{char $\ast$$\ast$}]{varg}
\end{DoxyParamCaption}
)}\hypertarget{basicTemplate_8c_a0b1907e3d123f469a739aa425bd05574}{}\label{basicTemplate_8c_a0b1907e3d123f469a739aa425bd05574}


Definition at line 31 of file basic\+Template.\+c.



References calc\+Total\+Probability(), close\+Q\+U\+E\+S\+T\+Env(), create\+Multi\+Qubit(), destroy\+Multi\+Qubit(), Complex\+::imag, init\+Q\+U\+E\+S\+T\+Env(), init\+State\+Vec(), Max\+Angles, max\+Num\+Qubits, Q\+U\+E\+S\+T\+Env\+::rank, Complex\+::real, R\+E\+P\+O\+R\+T\+\_\+\+S\+T\+A\+TE, report\+State(), and rotate\+Qubit().


\begin{DoxyCode}
31                                  \{
32 
33         \textcolor{comment}{//}
34         \textcolor{comment}{// ===== INITIALISATION}
35         \textcolor{comment}{//}
36         
37         \textcolor{comment}{// INIT ENVIRONMENT: ALWAYS REQUIRED ONCE AT BEGINNING OF PROGRAM}
38         \textcolor{comment}{// These two lines will automatically set up the environment (multinode,}
39         \textcolor{comment}{// openMP only etc)  }
40         \hyperlink{structQUESTEnv}{QUESTEnv} env;
41         \hyperlink{qubits__env__local_8c_a652d8c53f8f1cfb096133791de2b219d}{initQUESTEnv}(&env);
42 
43         \textcolor{comment}{// model vars}
44         \textcolor{keywordtype}{int} numQubits;
45         \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} index;
46         \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} numAmps;
47         
48         \textcolor{comment}{// get number of qubits from command line argument}
49         \textcolor{keywordflow}{if} (narg >= 2) \{
50                 numQubits = atoi(varg[1]);
51                 \textcolor{keywordflow}{if} (numQubits < 1 || numQubits > \hyperlink{basicTemplate_8c_a8e2ba5722f048e5a9cd58d09085f6cb1}{maxNumQubits}) \{
52                         printf(\textcolor{stringliteral}{" *** error: argument %d out of range (1 -- %d)\(\backslash\)n"}, numQubits,maxNumQubits);
53                         exit (EXIT\_FAILURE);
54                 \}
55         \} \textcolor{keywordflow}{else} \{
56                 printf(\textcolor{stringliteral}{" *** error: too few arguments, number of qubits expected\(\backslash\)n"});
57                 exit (EXIT\_FAILURE);
58         \}
59 
60         \textcolor{comment}{// Reporting}
61         numAmps = 1L << numQubits;
62         \textcolor{keywordflow}{if} (env.\hyperlink{structQUESTEnv_a1bdb6d425a2ce6a468f93929c0b26d73}{rank}==0)\{
63                 printf(\textcolor{stringliteral}{"Demo of single qubit rotations.\(\backslash\)n"});
64                 printf(\textcolor{stringliteral}{"Number of qubits is %d.\(\backslash\)n"}, numQubits);
65                 printf(\textcolor{stringliteral}{"Number of amps is %ld.\(\backslash\)n"}, numAmps);
66         \}
67 
68         \textcolor{comment}{// CREATE QUBIT OBJECT: REQUIRED ONCE PER MULTIQUBIT OBJECT     }
69         \textcolor{comment}{// Before doing any operations on a set of qubits, create the MultiQubit object that will be used
       to }
70         \textcolor{comment}{// represent the qubits}
71         \hyperlink{structMultiQubit}{MultiQubit} multiQubit; 
72         \hyperlink{qubits_8c_ae729f311efd2a426ce5161df3e017a16}{createMultiQubit}(&multiQubit, numQubits, env);
73 
74         \textcolor{comment}{// initialise the state to |0000..0>}
75         \hyperlink{qubits_8c_a492d10377278f685c7a1fabc3ee60623}{initStateVec} (&multiQubit);
76 
77 
78         \textcolor{comment}{//}
79         \textcolor{comment}{// ===== ROTATIONS}
80         \textcolor{comment}{//}
81 
82         \textcolor{comment}{// INITIALISE QUBIT ROTATION}
83         \textcolor{comment}{// Edit these lines to change rotation angle}
84         \textcolor{keywordtype}{double} ang1,ang2,ang3;
85         \hyperlink{structComplex}{Complex} alpha, beta;
86 
87         \textcolor{comment}{// define rotation angles}
88         \textcolor{keywordtype}{double} angles[\hyperlink{basicTemplate_8c_a353abace49aefb52015b80290cf26d77}{MaxAngles}][3] = \{
89                 \{ 1.2320,  0.4230, -0.6523\},
90                 \{ 2.1213,  0.0000,  3.6520\},
91                 \{-3.1213,  5.0230,  0.1230\},
92                 \{ 5.2341, -3.1001, -1.2340\},
93                 \{-0.1234, -0.9876,  4.1234\}
94         \};
95         \textcolor{keywordtype}{int} numAngles=5,iAngle;
96 
97         \textcolor{comment}{// rotate}
98         ang1 = angles[0][0];
99         ang2 = angles[0][1];
100         ang3 = angles[0][2];
101 
102         alpha.\hyperlink{structComplex_a0138f5fe2b2c6180b8fcda77a7aa51c5}{real} = cos(ang1) * cos(ang2);
103         alpha.\hyperlink{structComplex_a2bb90cc563599c3c8bdec9acf9ea40a6}{imag} = cos(ang1) * sin(ang2);
104         beta.\hyperlink{structComplex_a0138f5fe2b2c6180b8fcda77a7aa51c5}{real}  = sin(ang1) * cos(ang3);
105         beta.\hyperlink{structComplex_a2bb90cc563599c3c8bdec9acf9ea40a6}{imag}  = sin(ang1) * sin(ang3);
106 
107         \textcolor{keywordtype}{int} rotQubit;
108 
109         \textcolor{comment}{// DO QUBIT ROTATION}
110         \textcolor{comment}{// Edit these lines to perform rotations as required}
111         \textcolor{keywordflow}{for} (rotQubit=0; rotQubit<numQubits; rotQubit++) \{
112                 \textcolor{comment}{// do rotation of each qubit}
113                 \hyperlink{qubits__env__local_8c_a4ba468aa69f812efd1f964e10a45ca2f}{rotateQubit}(multiQubit,rotQubit,alpha,beta);
114         \}
115         \textcolor{comment}{// END QUBIT ROTATION}
116 
117         \textcolor{comment}{// Verification: check vector size is unchanged}
118         \textcolor{keywordtype}{double} totalProbability;
119         totalProbability = \hyperlink{qubits__env__local_8c_a2205c8fde15213df52040dc3df233090}{calcTotalProbability}(multiQubit);
120         \textcolor{keywordflow}{if} (env.\hyperlink{structQUESTEnv_a1bdb6d425a2ce6a468f93929c0b26d73}{rank}==0) printf(\textcolor{stringliteral}{"VERIFICATION: total probability=%.14f\(\backslash\)n"}, totalProbability);
121 
122         \textcolor{comment}{// report state vector to file}
123         \textcolor{keywordflow}{if} (\hyperlink{basicTemplate_8c_a64394210bc1694536cbb8411d2bab5ed}{REPORT\_STATE})\{
124                 \hyperlink{qubits_8c_a96f4de9ce7fefc7680a44d601fc3d894}{reportState}(multiQubit);
125         \}
126 
127 
128         \textcolor{comment}{//}
129         \textcolor{comment}{// ===== perform a measurement}
130         \textcolor{comment}{//}
131         \textcolor{keywordtype}{int} measureQubit;
132         \textcolor{keywordtype}{double} stateProb,randProb;
133         \textcolor{comment}{/* // keep time */}
134         \textcolor{comment}{/* wtime\_start = system\_timer (); */}
135 
136         \textcolor{comment}{// measure}
137 \textcolor{comment}{/*      }
138 \textcolor{comment}{        for (measureQubit=0; measureQubit<numQubits; measureQubit++) \{}
139 \textcolor{comment}{        //for (measureQubit=0; measureQubit<1; measureQubit++) \{}
140 \textcolor{comment}{                syncQUESTEnv(env);}
141 \textcolor{comment}{                wtime\_start = system\_timer ();}
142 \textcolor{comment}{                stateProb = findProbabilityOfZero (env.rank, numAmpsPerRank, numQubits, measureQubit,
       stateVecReal,stateVecImag);}
143 \textcolor{comment}{                syncQUESTEnv(env);}
144 \textcolor{comment}{                wtime\_stop = system\_timer ();}
145 \textcolor{comment}{                if (env.rank==0) printf("   probability of 0 for qubit %d = %.14f\(\backslash\)n", measureQubit,
       stateProb);}
146 \textcolor{comment}{                if (env.rank==0) printf(" measurement qubit %d: elapsed time = %f [s]\(\backslash\)n", measureQubit,
       wtime\_stop - wtime\_start);}
147 \textcolor{comment}{        \}}
148 \textcolor{comment}{*/}
149         \textcolor{comment}{/* // keep time */}
150         \textcolor{comment}{/* wtime\_stop = system\_timer (); */}
151 
152         \textcolor{comment}{/* // ----- timing report */}
153         \textcolor{comment}{/* printf(" measurement: elapsed time = %f [s]\(\backslash\)n", wtime\_stop - wtime\_start); */}
154 
155 
156         \textcolor{comment}{//}
157         \textcolor{comment}{// ===== two qubit phase gate}
158         \textcolor{comment}{//}
159         \textcolor{comment}{/* // keep time */}
160         \textcolor{comment}{/* wtime\_start = system\_timer (); */}
161 \textcolor{comment}{/*}
162 \textcolor{comment}{        // two qubit phase gate}
163 \textcolor{comment}{        if (numQubits >= 7) \{}
164 \textcolor{comment}{                wtime\_start = system\_timer (); }
165 \textcolor{comment}{                controlPhaseGate (env.rank, numAmpsPerRank, numQubits, 0, 2, stateVecReal, stateVecImag); }
166 \textcolor{comment}{                wtime\_stop = system\_timer (); }
167 \textcolor{comment}{                printf(" two qubit phase gate: elapsed time = %f [s]\(\backslash\)n", wtime\_stop - wtime\_start);}
168 \textcolor{comment}{                wtime\_start = system\_timer (); controlPhaseGate (env.rank, numAmpsPerRank, numQubits, 1, 3,
       stateVecReal, stateVecImag); wtime\_stop = system\_timer (); printf(" two qubit phase gate: elapsed time = %f
       [s]\(\backslash\)n", wtime\_stop - wtime\_start);}
169 \textcolor{comment}{                wtime\_start = system\_timer (); controlPhaseGate (env.rank, numAmpsPerRank, numQubits, 2, 4,
       stateVecReal, stateVecImag); wtime\_stop = system\_timer (); printf(" two qubit phase gate: elapsed time = %f
       [s]\(\backslash\)n", wtime\_stop - wtime\_start);}
170 \textcolor{comment}{                wtime\_start = system\_timer (); controlPhaseGate (env.rank, numAmpsPerRank, numQubits, 3, 5,
       stateVecReal, stateVecImag); wtime\_stop = system\_timer (); printf(" two qubit phase gate: elapsed time = %f
       [s]\(\backslash\)n", wtime\_stop - wtime\_start);}
171 \textcolor{comment}{                wtime\_start = system\_timer (); controlPhaseGate (env.rank, numAmpsPerRank, numQubits, 4, 6,
       stateVecReal, stateVecImag); wtime\_stop = system\_timer (); printf(" two qubit phase gate: elapsed time = %f
       [s]\(\backslash\)n", wtime\_stop - wtime\_start);}
172 \textcolor{comment}{        \}}
173 \textcolor{comment}{*/}
174         totalProbability = \hyperlink{qubits__env__local_8c_a2205c8fde15213df52040dc3df233090}{calcTotalProbability}(multiQubit);
175         \textcolor{keywordflow}{if} (env.\hyperlink{structQUESTEnv_a1bdb6d425a2ce6a468f93929c0b26d73}{rank}==0) printf(\textcolor{stringliteral}{"VERIFICATION: total probability=%.14f\(\backslash\)n"}, totalProbability);
176 \textcolor{comment}{/*}
177 \textcolor{comment}{if (env.rank==0)\{}
178 \textcolor{comment}{        printf("\(\backslash\)n\(\backslash\)nIn rank %d, the following is the final state after rotations.\(\backslash\)n\(\backslash\)n",env.rank);}
179 \textcolor{comment}{        printf("codeOutput=[\(\backslash\)n");}
180 \textcolor{comment}{        for(index=0; index<=numAmpsPerRank-1; index++) printf("%.8f
       %.8f\(\backslash\)n",stateVecReal[index],stateVecImag[index]);}
181 \textcolor{comment}{        printf("];\(\backslash\)n\(\backslash\)n");}
182 \textcolor{comment}{\}}
183 \textcolor{comment}{syncQUESTEnv(env);}
184 \textcolor{comment}{}
185 \textcolor{comment}{if (env.rank==1)\{}
186 \textcolor{comment}{        printf("\(\backslash\)n\(\backslash\)nIn rank %d, the following is the final state after rotations.\(\backslash\)n\(\backslash\)n",env.rank);}
187 \textcolor{comment}{        printf("codeOutput=[\(\backslash\)n");}
188 \textcolor{comment}{        for(index=0; index<=numAmpsPerRank-1; index++) printf("%.8f
       %.8f\(\backslash\)n",stateVecReal[index],stateVecImag[index]);}
189 \textcolor{comment}{        printf("];\(\backslash\)n\(\backslash\)n");}
190 \textcolor{comment}{\}}
191 \textcolor{comment}{syncQUESTEnv(env);}
192 \textcolor{comment}{*/}
193         \textcolor{comment}{/* // keep time */}
194         \textcolor{comment}{/* wtime\_stop = system\_timer (); */}
195 
196         \textcolor{comment}{/* // ----- timing report */}
197         \textcolor{comment}{/* printf(" two qubit phase gate: elapsed time = %f [s]\(\backslash\)n", wtime\_stop - wtime\_start); */}
198 
199 
200         \textcolor{comment}{//}
201         \textcolor{comment}{// ======== CLEANUP}
202         \textcolor{comment}{//}
203         
204         \textcolor{comment}{// free memory}
205 
206         \textcolor{comment}{// REQUIRED ONCE PER MULTIQUBIT OBJECT  }
207         \textcolor{comment}{// When all operations on a set of qubits are completed, destroy the object}
208         \hyperlink{qubits_8c_ab796aea79288b974f63474db650be878}{destroyMultiQubit}(multiQubit, env);
209 
210 
211         \textcolor{comment}{// ALWAYS REQUIRED ONCE AT END OF PROGRAM: }
212         \textcolor{comment}{// These two lines will perform any necessary cleanup of the environment (multinode,}
213         \textcolor{comment}{// openMP only etc)  }
214         \hyperlink{qubits__env__local_8c_ad7494473d827399d7fd9c327ea3a23e6}{closeQUESTEnv}(env);
215 
216         \textcolor{keywordflow}{return} EXIT\_SUCCESS;
217 \}
\end{DoxyCode}


\subsubsection{Variable Documentation}
\index{basic\+Template.\+c@{basic\+Template.\+c}!Pi@{Pi}}
\index{Pi@{Pi}!basic\+Template.\+c@{basic\+Template.\+c}}
\paragraph[{\texorpdfstring{Pi}{Pi}}]{\setlength{\rightskip}{0pt plus 5cm}const long double Pi = 3.\+14159265358979323846264338327950288419716939937510}\hypertarget{basicTemplate_8c_a00c9db5f4f80636d4da765f0893743f6}{}\label{basicTemplate_8c_a00c9db5f4f80636d4da765f0893743f6}


Definition at line 25 of file basic\+Template.\+c.

